<!DOCTYPE html>

<html lang="" xml:lang="" xmlns="http://www.w3.org/1999/xhtml">
<head><base href="https://docs.oasis-open.org/openc2/ap-hunt/v1.0/csd02/ap-hunt-v1.0-csd02.html"/><meta content="-" name="description"/>
<meta charset="utf-8"/>
<meta content="pandoc" name="generator"/>
<meta content="width=device-width, initial-scale=1.0, user-scalable=yes" name="viewport"/>
<title>TOSCA Version 2.0</title>
<style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
<link href="https://docs.oasis-open.org/templates/css/markdown-styles-v1.7.3a.css" rel="stylesheet"/>
</head>
<body><img alt="OASIS Logo" src="https://docs.oasis-open.org/templates/OASISLogo-v3.0.png"/><hr style="page-break-before: avoid"/>
<hr/>
<h1 id="tosca-version-2.0">TOSCA Version 2.0</h1>
<h2 id="committee-specification-draft-06">Committee Specification Draft
06</h2>
<h2 id="june-2024">20 June 2024</h2>
<p> </p>
<h4 id="this-stage">This stage:</h4>
<p><a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd06/TOSCA-v2.0-csd06.md">https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd06/TOSCA-v2.0-csd06.md</a> (Authoritative) <br/>
<a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd06/TOSCA-v2.0-csd06.html">https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd06/TOSCA-v2.0-csd06.html</a> <br/>
<a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd06/TOSCA-v2.0-csd06.pdf">https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd06/TOSCA-v2.0-csd06.pdf</a> <br/></p>
<h4 id="previous-stage">Previous stage:</h4>
<p><a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd05/TOSCA-v2.0-csd05.docx">https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd05/TOSCA-v2.0-csd05.docx</a> (Authoritative) <br/>
<a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd05/TOSCA-v2.0-csd05.html">https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd05/TOSCA-v2.0-csd05.html</a> <br/>
<a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd05/TOSCA-v2.0-csd05.pdf">https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd05/TOSCA-v2.0-csd05.pdf</a> <br/></p>
<h4 id="latest-stage">Latest stage:</h4>
<p><a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/TOSCA-v2.0.md">https://docs.oasis-open.org/tosca/TOSCA/v2.0/TOSCA-v2.0.md</a> (Authoritative) <br/>
<a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/TOSCA-v2.0.html">https://docs.oasis-open.org/tosca/TOSCA/v2.0/TOSCA-v2.0.html</a> <br/>
<a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/TOSCA-v2.0.pdf">https://docs.oasis-open.org/tosca/TOSCA/v2.0/TOSCA-v2.0.pdf</a> <br/></p>
<h4 id="technical-committee">Technical Committee:</h4>
<p><a href="https://groups.oasis-open.org/communities/tc-community-home2?CommunityKey=f9412cf3-297d-4642-8598-018dc7d3f409">OASIS Topology and Orchestration Specification for Cloud Applications (TOSCA) TC</a> <br/></p>
<h4 id="chair">Chair:</h4>
<p>Chris Lauwers (<a class="email" href="mailto:lauwers@ubicity.com">lauwers@ubicity.com</a>), Individual Member</p>
<h4 id="editors">Editors:</h4>
<p>Chris Lauwers (<a class="email" href="mailto:lauwers@ubicity.com">lauwers@ubicity.com</a>), Individual Member 
 Calin Curescu (<a class="email" href="mailto:calin.curescu@ericsson.com">calin.curescu@ericsson.com</a>), <a href="http://ericsson.com/">Ericsson</a> <br/></p>
<h4 id="related-work">Related work:</h4>
<p>This specification replaces or supersedes: * <em>Topology and Orchestration Specification for Cloud Applications Version 1.0.</em> Edited by Derek Palma and Thomas Spatzier. OASIS Standard. Latest version: <a class="uri" href="http://docs.oasis-open.org/tosca/TOSCA/v1.0/TOSCA-v1.0.html">http://docs.oasis-open.org/tosca/TOSCA/v1.0/TOSCA-v1.0.html</a>. <br/> * <em>TOSCA Simple Profile in YAML Version 1.3.</em> Edited by Matt Rutkowski, Chris Lauwers, Claude Noshpitz, and Calin Curescu. Latest stage: <a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA-Simple-Profile-YAML/v1.3/TOSCA-Simple-Profile-YAML-v1.3.html">https://docs.oasis-open.org/tosca/TOSCA-Simple-Profile-YAML/v1.3/TOSCA-Simple-Profile-YAML-v1.3.html</a>. <br/></p>
<p>This specification is related to: 
* <em>Introduction to TOSCA Version 2.0.</em> Edited by Chris Lauwers
and Calin Curescu. Work in progress.</p>
<h4 id="declared-xml-namespace">Declared XML namespace:</h4>
<ul>
<li><a class="uri" href="http://docs.oasis-open.org/tosca/ns/2.0">http://docs.oasis-open.org/tosca/ns/2.0</a></li>
</ul>
<h4 id="abstract">Abstract:</h4>
<p>The Topology and Orchestration Specification for Cloud Applications
(TOSCA) provides a language for describing application components and
their relationships by means of a service topology, and for specifying
the lifecycle management procedures for creation or modification of
services using orchestration processes. The combination of topology and
orchestration enables not only the automation of deployment but also the
automation of the complete service lifecycle management. The TOSCA
specification promotes a model-driven approach, whereby information
embedded in the model structure (the dependencies, connections,
compositions) drives the automated processes.</p>
<h4 id="status">Status:</h4>
<p>This document was last revised or approved by the OASIS Topology and Orchestration Specification for Cloud Applications (TOSCA) TC on the above date. The level of approval is also listed above. Check the “Latest stage” location noted above for possible later revisions of this document. Any other numbered Versions and other technical work produced by the Technical Committee (TC) are listed at <a class="uri" href="https://groups.oasis-open.org/communities/tc-community-home2?CommunityKey=f9412cf3-297d-4642-8598-018dc7d3f409#technical">https://groups.oasis-open.org/communities/tc-community-home2?CommunityKey=f9412cf3-297d-4642-8598-018dc7d3f409#technical</a>. <br/></p>
<p>TC members should send comments on this specification to the TC’s
email list. Any individual may submit comments to the TC by sending
email to <a class="email" href="mailto:Technical-Committee-Comments@oasis-open.org">Technical-Committee-Comments@oasis-open.org</a>. Please
use a Subject line like “Comment on TOSCA”.</p>
<p>This specification is provided under the <a href="https://www.oasis-open.org/policies-guidelines/ipr/#RF-on-Limited-Mode">RF on Limited Terms</a> of the <a href="https://www.oasis-open.org/policies-guidelines/ipr/">OASIS IPR Policy</a>, the mode chosen when the Technical Committee was established. For information on whether any patents have been disclosed that may be essential to implementing this specification, and any offers of patent licensing terms, please refer to the Intellectual Property Rights section of the TC’s web page (<a class="uri" href="https://www.oasis-open.org/committees/tosca/ipr.php">https://www.oasis-open.org/committees/tosca/ipr.php</a>). <br/></p>
<p>Note that any machine-readable content (<a href="https://www.oasis-open.org/policies-guidelines/tc-process-2017-05-26/#wpComponentsCompLang">Computer Language Definitions</a>) declared Normative for this Work Product is provided in separate plain text files. In the event of a discrepancy between any such plain text file and display content in the Work Product’s prose narrative document(s), the content in the separate plain text file prevails. <br/></p>
<h4 id="key-words">Key words:</h4>
<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”,
“SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and
“OPTIONAL” in this document are to be interpreted as described in BCP 14
[<a href="#rfc2119">RFC2119</a>] and [<a href="#rfc8174">RFC8174</a>]
when, and only when, they appear in all capitals, as shown here.</p>
<h4 id="citation-format">Citation format:</h4>
<p>When referencing this specification the following citation format
should be used:</p>
<p><strong>[TOSCA-v2.0]</strong></p>
<p><em>TOSCA Version 2.0</em>. 
Edited by Chris Lauwers and Calin Curescu. 
20 June 2024. 
OASIS Committee Specification Draft 06. <a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd06/TOSCA-v2.0-csd06.html">https://docs.oasis-open.org/tosca/TOSCA/v2.0/csd06/TOSCA-v2.0-csd06.html</a>. <br/> Latest stage: <a class="uri" href="https://docs.oasis-open.org/tosca/TOSCA/v2.0/TOSCA-v2.0.html">https://docs.oasis-open.org/tosca/TOSCA/v2.0/TOSCA-v2.0.html</a>. <br/></p>
<h4 id="notices">Notices</h4>
<p>Copyright © OASIS Open 2024. All Rights Reserved.</p>
<p>Distributed under the terms of the OASIS <a href="https://www.oasis-open.org/policies-guidelines/ipr/">IPR Policy</a>. <br/></p>
<p>The name “OASIS” is a trademark of <a href="https://www.oasis-open.org/">OASIS</a>, the owner and developer of this specification, and should be used only to refer to the organization and its official outputs. <br/></p>
<p>For complete copyright information please see the full Notices
section in an Appendix below.</p>
<hr/>
<h1 id="table-of-contents">Table of Contents</h1>
<blockquote>
<p>Provide later 
[[TOC will be inserted here]]</p>
</blockquote>
<hr/>
<h1 id="introduction">1 Introduction</h1>
<p>The Topology and Orchestration Specification for Cloud
Applications 
(TOSCA) provides a language for describing components and 
their relationships by means of a service topology, and for
specifying 
the lifecycle management procedures for creation or modification
of 
services using orchestration processes. The combination of
topology 
and orchestration enables not only the automation of deployment
but 
also the automation of the complete service lifecycle management.
The 
TOSCA specification promotes a model-driven approach, whereby 
information embedded in the model structure (the dependencies, 
connections, compositions) drives the automated processes.</p>
<p>The content in this section is non-normative.</p>
<h2 id="changes-from-earlier-versions">1.1 Changes from Earlier
Versions</h2>
<p>This version of the specification includes significant changes
from 
TOSCA 1.3. In particular:</p>
<ol type="1">
<li>TOSCA v2.0 removes the <em>Simple Profile</em> type definitions from
the<br/>
standard. These type definitions are now managed as an open source<br/>
project in the<br/>
<a href="https://github.com/oasis-open/tosca-community-contributions">tosca-community-contributions</a><br/>
github repository.</li>
<li>Rather than bundling Profiles with the TOSCA standard, TOSCA
v2.0<br/>
provides support for user-defined domain-specific profiles as follows:
<ul>
<li>It allows collections of type definitions to be bundled
together<br/>
into named profiles.</li>
<li>It supports importing profiles using their profile name.</li>
</ul></li>
<li>TOSCA v2.0 formalizes support for in-life operation of a
running<br/>
service.
<ul>
<li>It formalizes the role of a representation model and clarifies<br/>
how to create representation models from service templates.</li>
<li>It documents how to create multiple node representations from
the<br/>
same node template and multiple relationships from the same<br/>
requirement assignment.</li>
<li>It defines an operational model that provides guidance for<br/>
updating and/or upgrading a running service and for responding to<br/>
notifications about state changes or errors.</li>
</ul></li>
<li>TOSCA v2.0 introduces a new TOSCA Path syntax that allows a
defined<br/>
traversal of an arbitary graph of nodes and relationships to an<br/>
attribute or property.</li>
<li>TOSCA v2.0 significantly enhances support for functions. It<br/>
formalizes function syntax, it extends the set of built-in<br/>
functions, and it introduces support for user-defined custom<br/>
functions.</li>
<li>TOSCA v2.0 harmonizes constraint syntax, filter syntax, and<br/>
condition syntax using boolean functions.</li>
<li>TOSCA v2.0 addresses shortcomings of the v1.3 substitution
mapping<br/>
grammar.</li>
<li>TOSCA v2.0 simplifies and extends the CSAR file format.</li>
<li>TOSCA v2.0 includes a broad set of syntax clarifications,<br/>
including but not limited to:
<ul>
<li>The service template is renamed TOSCA file and service
template<br/>
is redefined.</li>
<li>Grammar for relationship types, requirement definitions, and<br/>
requirement assignments has been extended and clarified.</li>
<li>Short notation for entry_schema and key_schema has been<br/>
documented</li>
</ul></li>
</ol>
<h2 id="document-conventions">1.2 Document conventions</h2>
<ul>
<li>Naming conventions</li>
<li>Font colors and styles</li>
<li>Typographic conventions</li>
</ul>
<h2 id="glossary">1.3 Glossary</h2>
<!-- Optional section with suggested subsections -->
<h3 id="definitions-of-terms">1.3.1 Definitions of terms</h3>
<p>The following terms are used throughout this specification and
have 
the following definitions when used in context of this document.</p>
<table>
<colgroup>
<col style="width: 50%"/>
<col style="width: 50%"/>
</colgroup>
<thead>
<tr class="header">
<th>Term</th>
<th>Definition</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Representation Model</td>
<td>A deployed service is a running instance of a service template. The
instance is typically derived by running a declarative workflow that is
automatically generated based on the node templates and relationship
templates defined in the service template.</td>
</tr>
<tr class="even">
<td>Node Template</td>
<td>A <em>node template</em> specifies the occurrence of a component
node as part of a service template. Each node template refers to a node
type that defines the semantics of the node (e.g., properties,
attributes, requirements, capabilities, interfaces). Node types are
defined separately for reuse purposes.</td>
</tr>
<tr class="odd">
<td>Relationship Template</td>
<td>A <em>relationship template</em> specifies the occurrence of a
relationship between nodes in a service template. Each relationship
template refers to a relationship type that defines the semantics of the
relationship (e.g., properties, attributes, interfaces, etc.).
relationship types are defined separately for reuse purposes.</td>
</tr>
<tr class="even">
<td>Service Template</td>
<td>A <em>service template</em> is used to specify the <em>topology</em>
(or structure) and <em>orchestration</em> (or invocation of management
behavior) of services so that they can be provisioned and managed in
accordance with constraints and policies.</td>
</tr>
<tr class="odd">
<td>Topology Model</td>
<td>A Topology Model defines the structure of a service in the context
of a service template. A Topology model consists of a set of node
template and relationship template definitions that together define the
topology of a service as a (not necessarily connected) directed
graph.</td>
</tr>
<tr class="even">
<td>Abstract Node Template</td>
<td>An abstract node template is a node template that doesn’t define any
implementations for the TOSCA lifecycle management operations. Service
designers explicitly mark node templates as abstract using the
substitute directive. TOSCA orchestrators provide implementations for
abstract node templates by finding substituting templates for those node
templates.</td>
</tr>
</tbody>
</table>
<h3 id="acronyms-and-abbreviations">1.3.2 Acronyms and
abbreviations</h3>
<p>Defined in this document 
- TOSCA Topology and Orchestration Specification for Cloud
Applications 
- CSAR Cloud Service Archive A file format defined by OASIS TOSCA to
contain TOSCA files</p>
<p>Used by this specification 
- YAML Yet Another Markup Language The Language TOSCA uses for
files 
- MACD Moves, Adds, Changes, and Deletions 
- DSL Domain Specific Language</p>
<p>Used as examples 
- DBMS Database Management System 
- EJB Enterprise Java Beans 
- SD-WAN Software Defined Wide Area Network 
- SQL Structured Query Language 
- TAR Tape Archive A file format originally used in unix 
- VPN Virtual Private Network 
- USD United States Dollar 
——-</p>
<h1 id="tosca-overview">2 TOSCA Overview</h1>
<p>The <em>Topology and Orchestration Specification for Cloud
Applications</em> 
(TOSCA) is a <em>domain-specific language</em> (DSL) for
automating 
<em>Lifecycle Management</em> of large complex systems.</p>
<p>The TOSCA language allows service designers to describe system 
components and their relationships by means of a service topology,
and 
to specify the lifecycle management procedures for the creation
and 
modification of services using orchestration processes. The 
combination of <em>topology</em> and <em>orchestration</em> enables not
only the 
automation of deployment but also the automation of the complete 
service lifecycle management (including scaling, patching,
upgrading, 
monitoring, etc.).</p>
<p>The content in this section is non-normative.</p>
<h2 id="objectives">2.1 Objectives</h2>
<p>Large systems such a cloud applications, telecommunications
networks, 
and software services are becoming increasingly more difficult to 
manage. This challenge is the result of a recent technology trends 
such as the adoption of cloud-native architectures that build
systems 
as collections of microservices, the disaggregation of large
hardware 
appliances, the decoupling of hardware and software, and the
adoption 
of edge deployments that move application functionality closer to
the 
end-user.</p>
<p>As a result of the above technology trends, large systems
typically 
involve a wide variety of technologies and include components from 
multiple vendors. This results in management systems based on 
vendor-specific tools, dedicated component management systems, and 
special-purpose controllers, each of which manages only a small
subset 
of the system. To make matters worse, these tools often use 
incompatible interfaces or data schemas, resulting in integration 
nightmares. As the number of components grows—because the scale of
the 
system increases and disaggregation becomes the norm—so will the 
number of required management tools.</p>
<p>Management of such systems can be greatly simplified if the
creation 
and lifecycle management of application, infrastructure, and
network 
services can be fully automated and supported across a variety of 
deployment environments. TOSCA was expressly designed to address
the 
complexity associated with managing large systems by providing a 
language for specifying an information model and automating the 
lifecycle management of large complex systems. The goal of TOSCA
is 
to define a language that is agnostic to specific technological
and 
commercial ecosystems and that supports the design and operation
of 
large systems without being tied to specific technologies or
specific 
vendors. This enables a uniform management approach that can be
used 
for all parts of the system and can integrate components across
all 
layers of the technology stack.</p>
<p>The capabilities offered by TOSCA will facilitate higher
service 
continuity, reduce service disruption and manual mitigation,
increase 
interoperability, avoid lock-in, and achieve the intended 
orchestration. Ultimately, this will benefit the consumers, 
developers, and providers of more and more complex and
heterogeneous 
networks, systems, and cloud-native applications.</p>
<h2 id="tosca-features-and-benefits">2.2 TOSCA Features and
Benefits</h2>
<h3 id="tosca-is-model-driven">2.2.1 TOSCA is Model-Driven</h3>
<p>The TOSCA specification promotes a <em>model-driven management</em>
approach, 
whereby TOSCA processors maintain service models (<em>digital
twins</em>) for 
all system components under management. In a model-driven
approach, 
all management actions are performed on service models first and
then 
propagated to the external real-world entities by the management 
system. Similarly, changes to external resources are reflected
into 
models first and then handled by management system.</p>
<p>TOSCA’s model-driven management approach is what enables its use
for 
all Lifecycle Management Phases: information embedded in the model 
structure (the dependencies, connections, compositions) drives the 
automated processes. Specifically, it allows service models to be
used:</p>
<ul>
<li>As desired state for Moves, Adds, Changes, and Deletions
(MACDs)</li>
<li>As context for handling faults and events using Closed Loop<br/>
Automation</li>
</ul>
<p>In addition, changing or augmenting the model also 
automatically adapts the LCM / orchestration behavior. 
Without the context provided by service models, lifecycle
management 
cannot be fully automated.</p>
<h3 id="tosca-models-are-graphs">2.2.2 TOSCA Models are Graphs</h3>
<p>TOSCA models systems as graphs, where the vertices represent
the 
components of the system and the edges represents relationships, 
dependencies, and other interactions between these components.</p>
<p>The use of graphs enables <em>declarative</em> orchestration, where
system 
designers can simply create descriptions (“models”) of their
systems, 
and delegate to the orchestrator the task of translating these 
descriptions into the commands required to realize the systems
being 
described. The use of graphs enables this as follows:</p>
<ul>
<li>Relationships in a TOSCA graph encode dependencies that allow
an<br/>
orchestrator to automatically determine the <em>sequencing</em> between
the<br/>
managment operations on invoked on various components in the
system,<br/>
thereby avoiding the need for human-defined workflows.
Implementing<br/>
lifecycle or other management operations on the service can be<br/>
achieved by traversing the graph.</li>
<li>Relationships in a TOSCA graph allow an orchestrator to<br/>
automatically determine which system components may be affected by
a<br/>
component failure or by a change to an external resource. The<br/>
orchestrator can then determine corrective actions that restore
the<br/>
system as a whole to its nominal state, rather than just fixing<br/>
individual components.</li>
</ul>
<p>Declarative management is often also referred to as <em>desired
state</em> or 
<em>intent-based</em> orchestration.</p>
<h3 id="tosca-promotes-reuse-and-modularity">2.2.3 TOSCA Promotes Reuse
and Modularity</h3>
<p>TOSCA models are based on <em>service templates</em> that are created
by 
service designers. Service templates consist of node templates and 
relationship templates that have associated node types and
relationship 
types. Types in TOSCA represent reusable components that can be used
as 
building blocks from which services are constructed, thereby 
promoting modularity and reuse.</p>
<p>In addition, TOSCA allows modular designs whereby service
templates 
describe only parts of a system rather than a complete end-to-end 
system definition. Composition of partial system descriptions into 
complete system models can be done by an orchestrator at
deployment 
time. This enables automation of placement decisions, resource 
allocation, and system integration.</p>
<p>TOSCA’s modularity features allow some service design decisions to
be 
made by an orchestrator at deployment time rather than by a
service 
designer at service design time. 
TOSCA also allows for the definition of abstract components that
hide 
technology and vendor-specific implementation details. The choice
of 
how to <em>implement</em> abstract components can be left to the
orchestrator 
at deployment time. This further increases the value of TOSCA as a 
technology and vendor-neutral technology language orchestration. TOSCA
supports the use of <em>policies</em> 
to guide the service design decisions made by orchestrators at
deployment time.</p>
<h3 id="tosca-is-domain-independent">2.2.4 TOSCA is
Domain-Independent</h3>
<p>Since the fundamental abstraction defined by the TOSCA language is
a 
<em>graph</em>, TOSCA is not tied to any specific application domain.
For example, 
TOSCA can be used to specify automated lifecycle management of the
following:</p>
<ul>
<li>Infrastructure-as-a-Service Clouds: automate the deployment
and<br/>
management of workloads in IaaS clouds such as OpenStack, Amazon
Web<br/>
Services, Microsoft Azure, Google Cloud, and others.<br/>
<!-- May need to acknowledge the above terms as trademarks. Can't find guidance on OASIS web site, take advice --></li>
<li>Cloud-Native Applications: deploy containerized applications,<br/>
micro-services, and service meshes, for example by interfacing to<br/>
orchestration platforms such as Kubernetes.</li>
<li>Network Function Virtualization: define the management of
Virtual<br/>
Network Functions and their composition into complex network
services.</li>
<li>Software Defined Networking: support on-demand creation of
network<br/>
services (for example SD-WAN).</li>
<li>Functions-as-a-Service: define abstract software applications
without<br/>
any deployment or operational considerations.</li>
<li>IoT and Edge computing: deploy many very similar copies of a service
at the network edge.</li>
<li>Process Automation: support open and interoperable process
control<br/>
architectures.</li>
</ul>
<p>This list is by no means intended to be exhaustive and only serves
to 
demonstrate the breadth of application domains that can benefit
from 
TOSCA’s automated lifecycle management capabilities.</p>
<h2 id="tosca-core-concepts">2.3 TOSCA Core Concepts</h2>
<p>As stated above, the TOSCA language assumes a
<em>model-driven</em> 
management paradigm. Using model-driven management, a model 
representing the managed external components is maintained and all 
management operations are performed on this model first and any 
resulting changes to the model are then propagated to the external 
components. Similarly, any status changes or errors experienced by
the 
external components are reflected in the model first before they
are 
handled by the management system. The model maintained by the 
management system must capture all aspects of the external
components 
that are relevant for the purpose of managing those components.</p>
<p>External components under management can consist of physical
resources 
deployed in the real world as well as logical or virtual
components 
provisioned or configured on those resources. In the context of
TOSCA, 
we will refer to the physical or virtual components under
management 
as <strong>external implementations</strong>, and we will refer to the
models as 
<strong>representations</strong>. Note that the TOSCA language does not
standardize 
any object models or schemas for representations. It presumes the 
existence of such models, but the model details are implementation 
specific.</p>
<p>A model-driven management system must include a component that
is 
responsible for keeping the <em>representations</em> and the
<em>external 
implementations</em> synchronized. In the context of this specification,
we 
will refer to this component as the <strong>orchestrator</strong>. An
orchestrator 
may perform this synchronization task based on workflows, policies,
or 
other mechanisms that are defined using statements expressed in
the 
TOSCA language, in which case we will refer to the component as a 
<strong>TOSCA orchestrator</strong>. Alternatively, an orchestrator may
also 
perform this task based on domain-specific knowledge that is
built-in 
to the orchestrator rather than being defined using TOSCA. This 
specification allows for either approach.</p>
<p>The following diagram shows how external implementations are
modeled 
using representations, and how the Orchestrator synchronizes the
two.</p>
<p>Figure : Representations and Implementations</p>
<p>TOSCA representations don’t just track individual components and
their 
management aspects; they also capture how the various components 
interact, with the goal of providing complete system 
functionality. TOSCA accomplishes this by modeling the <em>topology</em>
of 
systems as <em>graphs</em> where nodes in the graph represent the
components 
under management and vertices in the graph represent containment, 
dependencies, interactions, or other relationships between these 
components. In this specification, we use the term <strong>service 
representation</strong> to refer to a graph that models the topology of
an 
entire system or subsystem, and we use the terms <strong>node 
representation</strong> and <strong>relationship representation</strong>
respectively to 
model the nodes and vertices in a service representation graph.</p>
<p>Information about how node and relationship representations are 
organized in service representation graphs is captured in designs
(a.k.a 
blueprints) that are created by service designers and expressed in
the 
TOSCA language. In this specification, we refer to those designs
as 
<strong>service templates</strong> and we use the term
<strong>resolver</strong> to refer to the 
management component that <em>instantiates</em> service representations
based 
on <em>service templates</em>. TOSCA <em>service templates</em> define
service 
elements and their relationships which results in the <em>service 
representations</em> to be created as graphs. Service templates consist
of 
<strong>node templates</strong> from which node representations are
created, and 
<strong>relationship templates</strong> from which relationship
representations are 
created. Note that while TOSCA does not standardize
representations, 
it does standardize the grammar for defining templates.</p>
<p>The use of templates supports reuse of service designs while at
the 
same time allowing for service-specific variability. Specifically, 
node templates and relationship templates can use <strong>TOSCA
functions</strong> 
to specify that configuration values need to be provided as
<strong>template inputs</strong> 
to each deployment, or that configuration values need to be retrieved
at 
deployment time from other node or relationship representations in
the 
service representation graph. At deployment time, TOSCA resolvers 
evaluate these functions to generate the values to be used when 
creating new service representations. TOSCA also includes grammar
for 
creating multiple node representations from the same node template
and 
for creating multiple relationship representations from the same 
relationship template. TOSCA supports modular designs where
different 
deployments can combine sub-system representations created from 
different service templates into deployment-specific system 
representations.</p>
<p>The following diagram shows how representations are created 
from templates by a resolver:</p>
<p>Figure : TOSCA Templates and Representations</p>
<p>To allow for <em>design-time validation</em> of service templates,
all TOSCA 
templates defined by those service templates have associated
<strong>TOSCA 
types</strong>. TOSCA types define <em>schemas</em> and
<em>constraints</em> with which 
TOSCA templates have to comply. For example, a <em>TOSCA node
type</em> 
defines configurable properties that must be provided for the 
associated component, it defines the runtime attributes that are 
expected to be available for the component, and it specifies
allowed 
and required interactions with other components. A TOSCA-based 
management system must include a <strong>TOSCA parser/validator</strong>
that checks if 
the templates used in a TOSCA file are valid for the types 
with which they are associated. This allows many kinds of errors
to 
be flagged at service <em>design time</em> rather than at service
<em>deployment 
time</em>. The following diagram shows how templates are created from
and 
validated against TOSCA type definitions:</p>
<p>Figure : TOSCA Types and TOSCA Templates</p>
<p>The use of types in TOSCA also provides the additional benefits
of 
abstraction, information hiding, and reuse. TOSCA types can be 
organized in a <em>type hierarchy</em> where one or more type
definitions 
can inherit from another type, each derived type may then be
refined. 
This promotes reuse. The base type may be abstract and the derived
types 
may be concrete which promotes abstraction. <strong>TOSCA node
types</strong> 
and <strong>TOSCA relationship types</strong> define an externally
visible 
<em>management façade</em> for entities of that type while hiding
internal 
implementation details. This management façade defines interfaces
that 
can be used by an orchestrator to interact with the external 
implementations represented by the entity. When node types and 
relationship types are packaged together with internal
implementation 
artifacts for their interfaces, they become <em>reusable building
blocks</em> 
that can greatly facilitate the creation of end-to-end services.
TOSCA 
types that define such reusable building blocks are typically 
organized in domain-specific <strong>TOSCA profiles</strong>.</p>
<p>The following figure summarizes the various concepts introduced
in 
this section. When a TOSCA implementation implements multiple
TOSCA 
processing modules such as parsing, validating, and resolving, such
an 
implementation is commonly referred to as a <strong>TOSCA
processor</strong>.</p>
<p>Figure : Summary of Core TOSCA Concepts</p>
<p>Note that this diagram is only intended to highlight concepts used
in 
this specification, not to suggest software architectures or 
implementations. Nor is this diagram intended to be comprehensive
or 
exclusive. Other kinds of processors and modules may qualify as 
implementations of TOSCA, for example:</p>
<ul>
<li>TOSCA translator: A tool that translates TOSCA files into
documents<br/>
that use another language, such as Kubernetes Helm charts or
Amazon<br/>
CloudFormation templates.</li>
<li>TOSCA template generator: A tool that generates a TOSCA file.
An<br/>
example of generator is a modeling tool capable of generating or<br/>
editing a system design expressed using TOSCA.</li>
</ul>
<h2 id="using-tosca">2.4 Using TOSCA</h2>
<h3 id="tosca-files">2.4.1 TOSCA Files</h3>
<p>TOSCA files are files describing TOSCA service templates, TOSCA
types, 
or a combination thereof.</p>
<h3 id="archive-format-for-cloud-applications">2.4.2 Archive Format for
Cloud Applications</h3>
<p>In order to support in a certain environment the execution and 
management of the lifecycle of a cloud application, all
corresponding 
artifacts have to be available in that environment. This means
that 
beside the TOSCA file of the cloud application, the deployment 
artifacts and implementation artifacts have to be available in
that 
environment. To ease the task of ensuring the availability of all
of 
these, this specification defines a corresponding archive format
called 
CSAR (Cloud Service ARchive).</p>
<p>A CSAR is a container file, i.e. it contains multiple files of
possibly 
different file types. These files are typically organized in
several 
subdirectories, each of which contains related files (and possibly
other 
subdirectories etc.). The organization into subdirectories and
their 
content is specific for a particular cloud application. CSARs are zip or
tar 
files, typically compressed. A CSAR may contain a file called
TOSCA.meta 
that describes the organization of the CSAR.</p>
<hr/>
<h1 id="tosca-language-abstractions">3 TOSCA Language Abstractions</h1>
<p>The TOSCA language introduces a YAML-based grammar for automating
the 
lifecycle management of application, infrastructure, and network 
services. The language defines a <em>metamodel</em> for specifying both
the 
structure of a service as well as its management aspects. Using
TOSCA 
statements expressed in a TOSCA file, service designers create a 
<em>service template</em> that defines the <em>structure</em> of a 
service. <em>Interfaces, operations, and workflows</em> define how
service 
elements can be created and terminated as well as how they can be 
managed during their whole lifetimes. Policies specify operational 
behavior of the service such as quality-of-service objectives, 
performance objectives, and security constraints, and allow for 
closed-loop automation.</p>
<p>The content in this section is non-normative.</p>
<h2 id="service-templates-node-templates-and-relationship-templates">3.1
Service Templates, Node Templates, and Relationship Templates</h2>
<p>Within a TOSCA file, a <strong>service template</strong> defines the
topology model 
of a service as a directed graph. Each node in this graph is 
represented by a <strong>node template</strong>. A node template
specifies the 
presence of an entity of a specific <strong>node type</strong> as a
component of a 
service. A node type defines the semantics of such a component, 
including the configurable properties of the component (via
<strong>property 
definitions</strong>), its runtime state (via <strong>attribute
definitions</strong>) and 
the operations (via <strong>interface definitions</strong>) available to
manipulate 
the component. In a service template, a node template assigns values
to 
the properties defined in the corresponding node type. An orchestrator
updates 
attribute values as a result of performing lifecycle management 
operations or in response to notifications about changes in component
state.</p>
<p>For example, consider a service that consists of an some computing
application, a database and some computing resource to run them on. A
service template 
defining that service would include one node template of the node type
for the particular software application, another node template of node
type <em>database management system</em> or a more specific derivative
(MariaDB,perhaps), and a third node template of node type
<em>compute</em> or more likely a more specific derivative. The 
DBMS node type defines properties like the IP address of 
an instance of this type, an operation for installing the database
application with the corresponding IP address, and an operation
for 
shutting down an instance of this DBMS. A constraint in 
the node template can specify a range of IP addresses available
when 
making a concrete application server available.</p>
<p>Node templates may include one or more <strong>relationship
templates</strong> to 
other node templates in the service template. These relationship 
templates represent the edges in the service topology graph and
model 
dependencies and other interactions between components. Note that in
this specification, relationship templates are more 
frequently referred to as <strong>requirements</strong> for reasons that
will be 
explained below. Relationship 
templates in TOSCA are unidirectional: the node template that
includes 
the relationship template is implicitly defined as the <strong>source
node</strong> 
of that relationship template and the relationship template
explicitly 
specifies its <strong>target node</strong>. Each relationship template
refers to a 
<strong>relationship type</strong> that defines the semantics of
the 
relationship. Just like node types, relationship types define 
properties, attributes, and interfaces. Node types and
relationship 
types are typically defined separately for reuse purposes and 
organized into profiles.</p>
<p>In the example above, a relationship can be established from the
application 
server node template to the database node template with the 
meaning <em>depends on</em>, and from both the application and DBMS node
templates to the 
compute node template with meaning <em>deployed on</em>.</p>
<!----
{"id": "95", "author": "Calin Curescu", "date": "2020-06-22T17:58:00Z", "comment": "Will this be understood correctly, since\nthis is part of the node requirement and not relationship template as\nsuch.", "target": "Node templates may include one or more\n<span class=\"comment-start\" id=\"96\" author=\"Chris Lauwers\"\ndate=\"2021-01-18T18:20:00Z\">Mike Rehder suggested to use the general\nterm \u201crelations\u201d to avoid reference to \u201crelationship templates\u201d or\ntypes.</span>*relationships* "}-->
<!----
{"id": "97", "author": "Michael Rehder", "date": "2020-12-15T08:49:00Z", "comment": "New term! It\u2019s\nconfusing to have \u201cservice template\u201d and \u201cService Topology Graph\u201d and\n\u201cTopology Template\u201d.", "target": "service topology\ngraph"}-->
<!----
{"id": "98", "author": "Chris Lauwers", "date": "2021-01-18T18:17:00Z", "comment": "Should we introduce \u201cservice topology graph\u201d\nwhen what we mean is really the \u201cinstance\nmodel\u201d.", "target": "The"}-->
<h2 id="requirements-and-capabilities">3.2 Requirements and
Capabilities</h2>
<!----
{"id": "107", "author": "Michael Rehder", "date": "2020-12-15T09:11:00Z", "comment": "Confusing \u2013 \u201cservice topology\u201d is a new\nterm. It\u2019s a \u201ctopology template\u201d but not all \u201cservice template\u201d are a\n\u201ctopology template\u201d.", "target": "service topology within a single service\ntemplate"}-->
<p>We discussed earlier how relationship templates are used to link
node 
templates together into a service topology graph. However, it may
not 
always be possible to define all node templates for a given
service 
topology within a single service template. For example, modular
design 
practices may dictate that different service sub-components be
modelled 
using separate service templates. This may result in relationships 
across multiple service 
templates. Additionally, relationships may need to target
components 
that already exist and do not need to be instantiated by an 
orchestrator. For example, relationships may reference physical 
resources that are managed in a resource inventory. Service
templates 
may not include node templates for these resources.</p>
<p>TOSCA accommodates both service template internal and external
relationships using <strong>requirements</strong> and 
<strong>capabilities</strong> of node templates. 
Requirements express that a component 
depends on a feature provided by another component, or that the 
component has certain requirements against the hosting environment 
such as for the allocation of certain resources or the enablement of
a 
specific mode of operation. Capabilities represent features exposed
by 
components that can be targeted by requirements of other 
components. A requirement defined in one node 
template is fulfilled by establishing a relationship to a corresponding
capability defined in a second node template. 
If a requirement explicitly specifies a target node 
template defined in the same service template, it acts as a 
relationship template as defined in the previous section. A 
requirement that does not explicitly specify a target node template is
referred 
to as a <strong>dangling requirement</strong>. For simplicity, this
specification 
uses the term <em>requirement</em> for both relationship templates 
and dangling requirements.</p>
<p>All mandatory dangling requirements must be fulfilled by the TOSCA
processor at 
service deployment time. While dangling requirements are defined
in 
the context of <em>node templates</em>, fulfilling dangling requirements
is 
done in the context of <em>node representations</em>. This means that
when 
finding candidates for fulfilling a dangling requirement, the
TOSCA 
processor must consider node representations rather than the
templates 
from which these representations were created. When fulfilling
requirements, 
template directives to the TOSCA processor can be used to specify
if 
the target candidates are template-internal node representations,
or 
external representations created from multiple service templates,
or 
representations for external resources managed in an inventory.
Thus, 
requirement fulfillment may result in relationships that are 
established across service template boundaries.</p>
<p>Requirements and capabilities are modelled by annotating node
types 
with <strong>requirement definitions</strong> and <strong>capability
definitions</strong> 
respectively. Capability definitions themselves have associated 
<strong>capability types</strong> that are defined as reusable entities
so that 
those definitions can be used in the context of several node 
types. Just like node types and relationship types, capability
types 
can define properties and attributes. Requirement definitions are 
effectively <em>relationship definitions</em> that specify the
relationship 
type that will be used when creating the relationship that fulfils 
the requirement.</p>
<p>The following figure summarizes the various TOSCA abstractions
used 
for defining requirements and capabilities:</p>
<p>Figure : Requirements and Capabilities</p>
<!----
{"id": "108", "author": "Michael Rehder", "date": "2020-12-15T16:33:00Z", "comment": "There should be some\ndiscussion about this issue \u2013 how are the relations defined in the\ntopology template related to the relations of the substituted node\ntype?", "target": ""}-->
<h2 id="decomposition-of-node-representations">3.3 Decomposition of Node
Representations</h2>
<!----
{"id": "114", "author": "Michael Rehder", "date": "2020-12-15T16:17:00Z", "comment": "Another\nplace where I find the use of the term \u201cservice template\u201d overly\nconfusing. It should say \u201cTopology Template\u201d as that is the construct in\nthe end that is supporting the substitution.  \nSection 4.5.1 says \u201ctopology template\u201d so I think this change is in line\nwith the practical definitions in the document.", "target": "service template\n"}-->
<p>TOSCA provides support for decomposing service components using
its 
<strong>substitution mapping</strong> feature. This feature allows for
the 
definition of <em>abstract</em> service designs that consist of
components 
that are largely independent of specific technologies or vendor 
implementations. Technology or vendor-specific implementation
details 
can be defined for each abstract component using
<em>substituting</em> 
service templates that describe the internals of that component.</p>
<p>For example, a service template for a business application that
is 
hosted on an application server tier might focus on defining the 
structure and manageability behavior of the business application 
itself. The internals of the application server tier hosting the 
application can be provided in a separate service template built
by 
another vendor specialized in deploying and managing application 
servers. This approach enables separation of concerns as well as re-use
of 
common infrastructure templates.</p>
<p>Figure : Node Decomposition</p>
<p>From the point of view of a service template (e.g. the business 
application service template from the example above) that uses
another 
service template, the other service template (e.g. the application 
server tier) <em>looks</em> just like a node template. During
deployment, 
however, the node representation created from this node template can be
<em>substituted</em> by a service created from the second service 
template if it exposes the same external <em>façade</em>
(i.e. properties, 
capabilities, requirements, etc.) as the node for which it is 
a substitution. Thus, a substitution by any service template that 
has the same <em>facade</em> as the substituted node becomes possible,
allowing for a hierarchical decomposition of 
service representations. This concept also allows for providing 
alternative substitutions that can be selected by a TOSCA
processor 
at service deployment time. For example there might exist two service
templates, one for a 
single node application server tier and another for a 
clustered application server tier, and the appropriate 
option can be selected on a deployment-by-deployment basis.</p>
<h2 id="interfaces-operations-and-artifacts">3.4 Interfaces, Operations,
and Artifacts</h2>
<p>Both node types and relationship types may define lifecycle
<strong>operations</strong> 
that define the actions an orchestration engine can invoke when 
instantiating a service from a service template or when managing a 
deployed service. For example, a node type for some software
product 
might provide a <code>create</code> operation to handle the creation of
an 
instance of a component at runtime, or a <code>start</code> or
<code>stop</code> operation 
to allow an orchestration engine to start or stop the software
component.</p>
<p>Operations that are related to the same management mission
(e.g. 
lifecycle management) are grouped together in <strong>interface 
definitions</strong> in node and relationship types. Just like other
TOSCA 
entities, interfaces have a corresponding <strong>interface
type</strong> 
that defines the group of operations that are part of the 
interface, the input parameters that are required by those
operations, 
and any output parameters returned by the operations. Interface types
can also define <strong>notifications</strong> that 
represent external events that are generated by the external 
implementations and received by the orchestrator.</p>
<p>The implementations of interface operations can be provided as
TOSCA 
<strong>artifacts</strong>. An artifact represents the content needed to
provide an 
implementation for an interface operation. A TOSCA artifact could
be 
an executable (e.g. a script, an executable program, an image), a 
configuration file or data file, or something that might be needed
so 
that another executable can run (e.g. a library). Artifacts can be
of 
different types, for example Ansible playbooks or python scripts.
The 
content of an artifact depends on its <strong>artifact type</strong>.
Typically, 
descriptive metadata (such as properties) will also be provided
along 
with the artifact. This metadata might be needed by an orchestrator
to 
properly process the artifact, for example by describing the 
appropriate execution environment.</p>
<h2 id="workflows">3.5 Workflows</h2>
<p>A deployed service is an instance of a service template. More 
precisely, a service is deployed by first creating a <em>service 
representation</em> based on the <em>service template</em> describing
the service 
and then <em>orchestrating</em> the <em>external implementations</em>
modelled by 
those representations. If TOSCA orchestration is used, the
external 
implementations are created by running workflows that invoke
interface 
operations defined in the types of the nodes and relationships in
the 
representation graph. TOSCA workflows can often be generated 
automatically by the orchestrator by using the relationships in
the 
service representation graph to determine the order in which
external 
implementations must be created. For example, during the
instantiation 
of a two-tier application that includes a web application that
depends 
on a database, an orchestration engine would first invoke the
<code>create</code> 
operation on the database component to install and configure the 
database, and it would then invoke the <code>create</code> operation of
the web 
application to install and configure the application (which
includes 
configuration of the database connection).</p>
<p>Interface operations invoked by workflows must use actual values
for 
the various properties in the node templates and relationship 
templates in the service template. These values are tracked in the 
node representations and relationship representations in the
service 
representation graph. They can be provided as inputs passed in by 
users as triggered by human interactions with the TOSCA 
processor. Alternatively, the templates can specify default values
for 
some properties, or use TOSCA functions to retrieve those values
from 
other entities in the service representation graph.</p>
<p>For example, the application server node template will be
instantiated 
by installing an actual application server at a concrete IP
address 
considering the specified range of IP addresses. Next, the process 
engine node template will be instantiated by installing a concrete 
process engine on that application server (as indicated by the
<em>hosted 
on</em> relationship template). Finally, the process model node
template 
will be instantiated by deploying the process model on that
process 
engine (as indicated by the <em>deployed on</em> relationship
template).</p>
<h2 id="policies">3.6 Policies</h2>
<p>Non-functional behavior or quality-of-services are defined in TOSCA
by 
means of <strong>policies</strong>. A policy can express such diverse
things like 
monitoring behavior, payment conditions, scalability, or
continuous 
availability, for example.</p>
<p>A node template can be associated with a set of policies
collectively 
expressing the non-functional behavior or quality-of-services that
each 
instance of the node template will expose. Each policy specifies
the 
actual properties of the non-functional behavior, like the
concrete 
payment information (payment period, currency, amount etc.) about
the 
individual instances of the node template.</p>
<p>These properties are defined by a <strong>policy type</strong>.
Policy types might 
be defined in hierarchies to properly reflect the structure of 
non-functional behavior or quality-of-services in particular
domains. 
Furthermore, a policy type might be associated with a set of node 
types the non-functional behavior or quality-of-service it
describes.</p>
<p><strong>Policy templates</strong> provide actual values of properties
of the types 
defined by policy types. For example, a policy template for
monthly 
payments for customers located in the USA will set the “payment period”
property to 
“monthly” and the “currency” property to “USD”, leaving the
“amount” 
property open. The “amount” property will be set when the 
corresponding policy template is used for a policy within a node 
template. Thus, a policy template defines the invariant properties
of 
a policy, while the policy sets the variant properties resulting
from 
the actual usage of a policy template in a node template.</p>
<hr/>
<h1 id="tosca-operational-model">4 TOSCA Operational Model</h1>
<p>The content in this section is normative unless otherwise labeled
except for: 
- the examples 
- references (unless they are labelled as normative)</p>
<p>TOSCA is designed to support all three phases of the service 
lifecycle:</p>
<ol type="1">
<li><strong>Day 0—Service Design</strong>: Service designers use TOSCA
to model<br/>
services as topology graphs that consist of nodes and
relationships.<br/>
Nodes model the components of which a service is composed, and<br/>
relationships model dependencies between these service components.</li>
<li><strong>Day 1—Service Deployment</strong>: TOSCA can also be used to
define<br/>
mechanisms for deploying TOSCA service topologies on external<br/>
platforms.</li>
<li><strong>Day 2—Service Management</strong>: TOSCA can enable run-time
management<br/>
of services by providing support for updating and/or upgrading<br/>
deployed services and by providing service assurance functionality.</li>
</ol>
<p>This section presents a TOSCA <em>functional architecture</em> and
an 
associated <em>operational model</em> that supports the three
service 
lifecycle phases outlined above. Note that this functional 
architecture is not intended to prescribe how TOSCA must be 
implemented. Instead, it aims to provide users of TOSCA with a
mental 
model of how TOSCA implementations are expected to process TOSCA 
files.</p>
<p>Note that it is not mandatory for compliant TOSCA implementations
to 
support all three service lifecycle phases. Some implementations
may 
use TOSCA only for service design and delegate orchestration and 
ongoing lifecycle management functionality to external (non-TOSCA) 
orchestrators. Other implementations may decide to use TOSCA for
all 
three phases of the service lifecycle. However, a complete 
architecture must anticipate all three lifecycle phases and must clearly
distinguish between the four kinds of TOSCA entities defined in Section
2.4.</p>
<h2 id="tosca-functional-architecture">4.1 TOSCA Functional
Architecture</h2>
<p>The following Figure shows the TOSCA functional architecture
defined 
in this section. It illustrates how the various TOSCA entities are 
used by the different functional blocks and how they are related.</p>
<p>Figure : TOSCA Functional Architecture</p>
<p>The functional architecture defines the following three blocks:</p>
<ol type="1">
<li><strong>TOSCA Processor</strong>: This functional block defines
functionality<br/>
that must be provided by all TOSCA implementations. TOSCA
processors<br/>
convert TOSCA-based service definitions into service<br/>
representations that can be processed by an Orchestrator.</li>
<li><strong>Orchestrator</strong>: This functional block creates
external<br/>
implementations on various resource platforms based on the service<br/>
representations created by a TOSCA processor. The orchestration<br/>
functionality can itself be defined using TOSCA or can be provided<br/>
by external (non-TOSCA) orchestration platforms.</li>
<li><strong>Platform</strong>: In the context of a TOSCA architecture,
platforms<br/>
represent external cloud, networking, or other infrastructure<br/>
resources on top of which service entities can be created.</li>
</ol>
<p>The remainder of this section describes each of these functional
blocks 
in more detail.</p>
<h2 id="tosca-processor">4.2 TOSCA Processor</h2>
<p>At the core of a compliant TOSCA implementation is a TOSCA
Processor 
that can create service representations from TOSCA service templates.
A 
TOSCA Processor contains the following functional blocks:</p>
<h3 id="parser">4.2.1 Parser</h3>
<p>A TOSCA parser performs the following functions:</p>
<ul>
<li>Accepts a single TOSCA file plus imported TOSCA files (files without
a<br/>
<code>service_template</code>)</li>
<li>Can (optionally) import these files from one or more
repositories,<br/>
either individually or as complete profiles</li>
<li>Outputs valid normalized node templates. Note that normalized
node<br/>
templates may include unresolved (<em>dangling</em>) requirements.<br/>
<!--- We have not explained what we mean by normalized template --></li>
</ul>
<h3 id="resolver">4.2.2 Resolver</h3>
<p>A resolver creates service representations based on normalized
service 
templates. It performs the following functions:</p>
<ol type="1">
<li><p>Creating Node Representations based on Normalized Node
Templates.</p>
<ul>
<li>Either one-to-one or one-to-many if multiplicity is involved.</li>
<li>Node templates with a <code>select</code> directive create a node in
the<br/>
local representation graph that is a reference to the selected<br/>
node (from the local or a remote representation graph).</li>
<li>Node templates with a <code>substitute</code> directive create a
node in the<br/>
local representation graph that is associated to a remote<br/>
representation graph created from the substitution template.</li>
<li>The resolver assigns values to node properties and attributes
in<br/>
node representations based on values or functions defined in the<br/>
corresponding node templates.</li>
<li>Some property and attribute values cannot be initialized since<br/>
they either depend on other uninitialized properties or<br/>
attributes or need to access other node representations via<br/>
relationships that have not been yet initialized.</li>
</ul></li>
<li><p>Creating Relationships that Connect Node Representations</p>
<ul>
<li>Some relationships can be created directly based on target
node<br/>
templates specified in node template requirements.</li>
<li>Other relationships are created by fulfilling dangling requirements.
<ul>
<li>If a requirement uses a node_filter that refers to uninitialized
properties<br/>
or attributes, then the fulfillment of this requirement is postponed
until<br/>
all referred properties or attributes are initialized.</li>
<li>A circular dependency signifies a erroneous template and shall
report an error</li>
<li>After a relationship is created, properties and attributes that
depend on it<br/>
to be initialized will be initialized.</li>
</ul></li>
<li>At the end of this process all mandatory requirements must be<br/>
satisfied and all relationships are added to the representation<br/>
graph. An unsatisfied non-optional requirement results in an<br/>
error.</li>
</ul></li>
<li><p>Substitution Mapping</p>
<ul>
<li>When substitution is directed for a node, the resolver creates
a<br/>
new service representation based on the substituting template,<br/>
basically creating a service that represents the internals of the<br/>
substituted node.</li>
<li>The substituting service is initialized from the properties of the
substituted node<br/>
and the workflows of the substituting service act as operations for the
substituted<br/>
node (that is, the behavior of the node is substituted by the
substituting service).</li>
<li>This is defined via substitution mapping rules.</li>
</ul></li>
</ol>
<h2 id="orchestrator">4.3 Orchestrator</h2>
<p>An orchestrator performs the following actions:</p>
<ul>
<li>(Continuously) turns node representations into one or more
node<br/>
implementations</li>
<li>(Continuously) updates node representation attribute values (error
if<br/>
they do not adhere to TOSCA type validation clauses or property<br/>
definition validation clauses)</li>
<li>(Continuously) reactivates the resolver: outputs may change<br/>
attribute values, which can require refulfillment of dangling<br/>
requirements or resubsitution of substituted nodes.</li>
<li>(Optionally) changes the node representations themselves for day
2<br/>
transformations.</li>
</ul>
<h2 id="changes-in-the-representation-graph">4.4 Changes in the
Representation Graph</h2>
<p>During the lifetime of a service there can be several actions or
events that 
change the representation graph of the running service.</p>
<p>We can identify the several situations that mandate the change of
the 
representation graph, for example: 
- Update: 
- The service input values have changed and need to be re-evaluated
while 
the service is running. 
- Upgrade: 
- The service template has changed and needs to be re-evaluated while
the 
service is running. 
- Runtime failures: 
- Nodes or relationships in the representation graph have failed and
need 
to be recreated or healed while the service is running. 
- Change in dependencies 
- External nodes or relationships to external nodes have failed and
new 
relationships to external nodes need to be created (i.e. external 
requirements need to be fulfilled again) while the service is
running.</p>
<p>For the service to reach the new desired runtime state, operations
that are 
associated with the creation, deletion, and modification of 
nodes and relationships in the representation graph need to be
performed.</p>
<p>We can visualize (and the orchestrator can perform) these restorative
actions 
via graph traversals on the “old” and “new” representation graph.</p>
<p>First let’s categorize the nodes and relationships in the “old” and
“new” 
representation graphs in the following four categories: 
- Unchanged: These are nodes and relationships that appear in both
the 
“old” and “new” representation graphs and have the same property
values. 
Given that a template can be upgraded, we correlate the same nodes
and 
relationships via their symbolic node names and requirement names. 
- Modified: These are nodes and relationships that appear in both
the 
“old” and “new” representation graphs and have different property
values. 
- Obsolete: These are nodes and relationships that appear in the
“old” 
representation graph but not in the “new” representation graph. 
- Novel: These are nodes and relationships that do not appear in the
“old” 
representation graph but appear in the “new” representation graph.</p>
<p>We then perform deletions of the obsolete nodes by traversing
the 
representation graph in reverse dependency order as follows:</p>
<ul>
<li>We start in parallel with all nodes that have no incoming
dependency<br/>
relationship</li>
<li>we perform operations associated with deleting on all adjacent
relationships<br/>
to this node that are in the “obsolete” category.</li>
<li>we perform operations associated with deleting on the node itself if
it is<br/>
in the “obsolete” category.</li>
<li>we move to nodes that have no incoming dependency relationship to
nodes that<br/>
have not been processed yet.</li>
</ul>
<p>After we have processed the deletion of the obsolete elements we
traverse the “new” 
representation graph in dependency order to perform the modifications
and creations: 
- we start in parallel with the nodes that have no outgoing dependency
relationship 
- we perform operations associated with creation resp. modification on
the node itself 
if it is in the “novel” resp. “modified” category 
- we perform operations associated with creation resp. modification on
all adjacent 
relationships in the “novel” resp. “modified” category if the node on
the other 
side of the relationship has been processed. 
- we move to nodes that have no outgoing dependency relationship to
nodes that 
have not been processed yet.</p>
<p>After this we can consider the service to be in the new desired
runtime state, and the 
“old” representation graph can be discarded and the “new” representation
graph becomes 
the current representation graph of the service.</p>
<p>Note that this graph traversal behavior should be associated with the
relevant 
interface types that are defined in a TOSCA profile, where it should be
specified 
which relationship types form the dependency relationships, which
operation(s) 
are associated with the deletion, modification, and creation of the
nodes and 
relationships when the representation graph changes.</p>
<table style="width:11%;">
<colgroup>
<col style="width: 11%"/>
</colgroup>
<tbody>
<tr class="odd">
<td># 5 TOSCA Grammar Overview<br/>
The content in this section is normative unless otherwise labeled
except:<br/>
- the examples<br/>
- references unless labelled as normative.</td>
</tr>
<tr class="even">
<td>## 5.1 TOSCA Modeling Concepts</td>
</tr>
<tr class="odd">
<td>This section defines concepts used in support of the modeling<br/>
functionality of the TOSCA Version 2.0 specification. Specifically,
it<br/>
introduces grammar for defining TOSCA types and templates as
defined<br/>
in <a href="#23-tosca-core-concepts">Chapter 2</a>, it introduces the
concepts of<br/>
entity definitions and entity assignments, and presents rules for
type<br/>
derivation and entity refinement.</td>
</tr>
<tr class="even">
<td>&gt; Explain separation of concerns and different roles. Refer to
email<br/>
&gt; from Peter.</td>
</tr>
<tr class="odd">
<td>### 5.1.1 Type Definitions and Entity Definitions</td>
</tr>
<tr class="even">
<td>TOSCA <em>templates</em> are defined in TOSCA files and expressed
using the TOSCA<br/>
language. All TOSCA templates are <em>typed</em> using TOSCA types that
are also<br/>
defined in TOSCA files and expressed in the TOSCA language. Not only do
types<br/>
promote reuse, they also simplify the design of TOSCA templates by
allowing<br/>
relevant TOSCA entities to use and/or modify definitions already
specified in<br/>
the types.</td>
</tr>
<tr class="odd">
<td><strong>Type definitions</strong> consist of pairs keynames and
associated values<br/>
that specify information relevant to the type. While all TOSCA
types<br/>
share a number of common keynames, each type definition has its
own<br/>
syntax, semantics, and set of keynames. TOSCA supports <em>node
types</em>,<br/>
<em>relationship types</em>, <em>capability types</em>, <em>interface
types</em>, <em>artifact<br/>
types</em>, <em>policy types</em>, <em>group types</em>, and <em>data
types</em>.</td>
</tr>
<tr class="even">
<td>Some keynames in TOSCA type definitions are used to specify
<strong>entity<br/>
definitions</strong> that <em>declare</em> the presence of other
entities in the<br/>
context of the type. For example, most TOSCA type definitions
include<br/>
<em>property definitions</em> and <em>attribute definitions</em>. Node
types and<br/>
relationship types also include <em>interface definitions</em>, and
node<br/>
types have <em>requirement definitions</em> and <em>capability
definitions</em>.<br/>
Interface types can include <em>parameter definitions</em> that
specify<br/>
required inputs and expected outputs for interface operations.</td>
</tr>
<tr class="odd">
<td>Just like type definitions, entity definitions consist of pairs
of<br/>
keynames and values. Each entity definition has it own syntax,<br/>
semantics and set of keynames, but all entity definitions share a<br/>
<code>type</code> keyname that references the TOSCA type of the entity
being<br/>
defined. Other keynames in entity definitions are used to further<br/>
define or refine definitions already specified in the<br/>
corresponding entity type. TOSCA supports <em>capability
definitions</em>,<br/>
<em>requirement definitions</em>, <em>interface definitions</em>,
<em>policy<br/>
definitions</em>, <em>group definitions</em>, <em>property
definitions</em>, <em>attribute<br/>
definitions</em>, and <em>parameter definitions</em>.</td>
</tr>
<tr class="even">
<td>### 5.1.2 Templates and Entity Assignments</td>
</tr>
<tr class="odd">
<td>The<br/>
service templates introduced in Section 2 are defined in TOSCA files and
expressed using<br/>
statements in the TOSCA language. Service representation graphs are
directed graphs of<br/>
nodes and relationships resolved from service templates that consist of
<em>node templates</em> and <em>requirements</em>. Node<br/>
templates specify a particular node type and then add additional
information using<br/>
pairs of keynames and associated values. Service templates may include
other<br/>
templates as well such as relationship templates, groups, policies<br/>
etc.</td>
</tr>
<tr class="even">
<td>Node types specified in node templates will typically include
definition of entities, many node templates will use keynames to specify
additional<br/>
information for those entity definitions. Such information is referred
to as an <strong>entity assignment</strong>. In general for<br/>
each entity definition in the type of a template, the template can<br/>
include a corresponding entity assignment that provides<br/>
template-specific information about the entity. For example, node<br/>
templates can include property assignments that assign<br/>
template-specific values for the properties defined using
<em>property<br/>
definitions</em> in the <em>node type</em>. Property assignments can be
provided<br/>
as fixed values, but more often they will be specified using a
TOSCA<br/>
function that retrieve input values or that retrieve<br/>
property or attribute values from other entities in a service<br/>
representation graph. Entity assignments make sure that the
service<br/>
template can be used to generate a complete representation of the<br/>
system under management.</td>
</tr>
<tr class="odd">
<td>### 5.1.3 Type Derivation, Augmentation, and Refinement</td>
</tr>
<tr class="even">
<td>The TOSCA type system supports <em>inheritance</em> which means that
types<br/>
can be derived from a parent type. A parent type can in turn be<br/>
derived from its own parent type. There is no limit to the depth of
a<br/>
chain of derivations. Inheritance is a useful feature in support
of<br/>
abstraction. For example, base node types can be used to define<br/>
abstract components without specifying technology or
vendor-specific<br/>
details about those components. Concrete derived node types can the
be<br/>
used to define technology-specific or vendor-specific
specializations<br/>
of the abstract types.</td>
</tr>
<tr class="odd">
<td>The TOSCA specification includes <em>type derivation rules</em> that
describe<br/>
which keyname definitions are inherited from the parent type and
which<br/>
definitions are <em>intrinsic</em> to the type declaration and are
not<br/>
inherited. An example of an intrinsic definition is version, all type
definitions include a <code>version</code><br/>
keyword the value of which is never inherited from a parent type.</td>
</tr>
<tr class="even">
<td>Except for keynames that are explicitly flagged as
<em>intrinsic</em> to each<br/>
type definition, derived types inherit all the definitions of
their<br/>
parent type. Specifically, derived types inherit all <em>entity<br/>
definitions</em> from their parent. In addition, these entity
definitions<br/>
can be expanded or modified.</td>
</tr>
<tr class="odd">
<td>- Expansion of entity definitions is done through
<strong>entity<br/>
augmentation</strong>. Derived types use entity augmentation to
<em>add</em><br/>
entity definitions to those already defined in the parent<br/>
type. Augmentation rules pertaining to an entity describe how<br/>
derived types can add to the entity definitions in the inherited<br/>
parent type.<br/>
- Modification of entity definitions is done through
<strong>entity<br/>
refinement</strong>. Derived types use entity refinement to
further<br/>
constrain or otherwise <em>specialize</em> entities already defined in
the<br/>
parent type. Refinement rules pertaining to an entity describe how<br/>
such entity definitions that are inherited from the parent type<br/>
during a type derivation can be expanded or modified.</td>
</tr>
<tr class="even">
<td>The main reason for augmentation and refinement rules is to create
a<br/>
framework useful for a consistent TOSCA type profile creation. The<br/>
intuitive idea is that a derived type follows to a large extent
the<br/>
structure and behavior of a parent type, otherwise it would be better
to<br/>
define a new “not derived” type.</td>
</tr>
<tr class="odd">
<td>The guideline regarding the derivation rules is that a node of a
derived<br/>
type should be usable instead of a node of the parent type during
the<br/>
selection and substitution mechanisms. These two mechanisms are used
by<br/>
TOSCA templates to connect to TOSCA nodes and services defined by
other<br/>
TOSCA templates:</td>
</tr>
<tr class="even">
<td>- The selection mechanism allows a node representation created<br/>
a-priori from another service template to be selected for usage<br/>
(i.e., building relationships) by node representations created
from<br/>
the current TOSCA template.<br/>
- The substitution mechanism allows a node representation to be<br/>
decomposed by a service created simultaneously from a substituting<br/>
template.</td>
</tr>
<tr class="odd">
<td>### 5.1.4 Template reuse<br/>
A single TOSCA template may be reused by including it in one or more
other TOSCA templates. Each template may be separately maintained and
use it’s own naming scheme. The resolution of naming scheme conflicts is
discussed later in this document.<br/>
<!--- Should this template reuse not specify that it's only the node types that can be reused not the service templates temselves. --></td>
</tr>
<tr class="even">
<td>## 5.2 Mandatory Keynames</td>
</tr>
<tr class="odd">
<td>The TOSCA metamodel includes complex definitions used in types
(e.g.,<br/>
node types, relationship types, capability types, data types,
etc.),<br/>
definitions and refinements (e.g., Requirement Definitions,
Capability<br/>
Definitions, Property and Parameter Definitions, etc.) and
templates<br/>
(e.g., service template, node template, etc.) all of which include
their<br/>
own list of reserved keynames that are sometimes marked as<br/>
<strong>mandatory</strong>. If a keyname is marked as mandatory it
<strong>MUST</strong> be<br/>
defined in that particular definition context. In some
definitions,<br/>
certain keywords may be mandatory depending on the value of other<br/>
keywords in the definition. In that case, the keyword will be marked
as<br/>
<strong>conditional</strong> and the condition will be explained in the
description<br/>
column. Note that in the context of type definitions, types may be
used<br/>
to derive other types, and keyname definitions <strong>MAY</strong> be
inherited from<br/>
parent types (according to the derivation rules of that type entity). A
derived type does not have to provide a keyname definition if this has
already been defined in a parent type.</td>
</tr>
<tr class="even">
<td>## 5.3 Common Keynames</td>
</tr>
<tr class="odd">
<td>Except where explicitly noted, all multi-line TOSCA grammar
elements<br/>
support the following keynames:</td>
</tr>
<tr class="even">
<td>|Keyname|Mandatory|Type|Description|<br/>
| :—- | :—— | :—- | :—— |<br/>
|metadata|no|map of YAML values|Defines a section used to declare
additional metadata information about the element being defined.|<br/>
|description|no|string|Declares a description for the TOSCA element
being defined.|</td>
</tr>
<tr class="odd">
<td>Grammar for these keynames is described here and may not be
repeated<br/>
for each entity definition.</td>
</tr>
<tr class="even">
<td>### 5.3.1 metadata<br/>
This optional keyname is used to associate domain-specific
metadata<br/>
with a TOSCA element. The metadata keyname allows a declaration of
a<br/>
map of keynames with values that can use all types supported by<br/>
the <a href="https://yaml.org/spec/1.2.2/#chapter-10-recommended-schemas">YAML
1.2.2 recommended<br/>
schemas</a><br/>
[Yaml-1.2] as follows:</td>
</tr>
<tr class="odd">
<td>The following shows an example that uses metadata to track
revision<br/>
status of a TOSCA file:</td>
</tr>
<tr class="even">
<td>### 5.3.2 description</td>
</tr>
<tr class="odd">
<td>This optional keyname provides a means to include single or
multiline<br/>
descriptions within a TOSCA element as a <em>YAML scalar string
value</em> as<br/>
follows:</td>
</tr>
<tr class="even">
<td>if needed. However, (multiple) line breaks are folded into a single
space<br/>
character when processed into a single string value.<br/>
```</td>
</tr>
</tbody>
</table>
<h1 id="tosca-file-definition">6 TOSCA File Definition</h1>
<!----
{"id": "172", "author": "Calin Curescu", "date": "2020-04-20T18:49:00Z", "comment": "TBD. Here comes some intro and generic description of the different specification blocks that will build the following sections.", "target": "TOSCA Service"}-->
<!----
{"id": "173", "author": "Michael Rehder", "date": "2020-12-15T08:38:00Z", "comment": "This isn\u2019t true \u2013 if a \u201cservice template\u201d\ncan contain just supporting parts like type definitions then it won\u2019t\ncontain a \u201cTOSCA Service\u201d.  \nIn the end, I think that the term \u201cservice template\u201d is very confusing\nas it is never used as a \u201ctemplate\u201d, as an object. It\u2019s a collection of\ndefinitions, some of which are supporting and one of which is the\nworking code definition for the service to be realized.  \n\u201cService Definition\u201d is a more practical term.", "target": "A TOSCA Service is\nspecified by a TOSCA Service <span class=\"comment-start\" id=\"174\"\nauthor=\"Chris Lauwers\" date=\"2022-12-05T18:44:00Z\">We haven't defined\nservice template yet.</span>Template"}-->
<!----
{"id": "178", "author": "Chris Lauwers", "date": "2022-06-22T14:26:00Z", "comment": "Update to reflect new naming", "target": "TOSCA file definition"}-->
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative.</p>
<p>A TOSCA file can contain definitions of reusable building blocks
for 
use in cloud applications, complete models of cloud applications,
or 
both. This section describes the top-level TOSCA keynames—along
with 
their grammars—that are allowed to appear in a TOSCA file.</p>
<p>The major entities that can be defined in a TOSCA file are depicted
in 
Figure 1.</p>
<p>Figure : Structural Elements of a TOSCA File</p>
<h2 id="keynames">6.1 Keynames</h2>
<p>The following is the list of recognized keynames for a TOSCA
file:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">tosca_definitions_version</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Defines the version of the TOSCA
specification used in this TOSCA file.</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Declares a description for this TOSCA file
and its contents.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of YAML values</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information. Domain-specific TOSCA profile
specifications may define keynames that are mandatory for their
implementations.</td>
</tr>
<tr class="even">
<td style="text-align: left;">dsl_definitions</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">N/A</td>
<td style="text-align: left;">Defines reusable YAML macros (i.e., YAML
alias anchors) for use throughout this TOSCA file.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">artifact_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of artifact Types</td>
<td style="text-align: left;">Declares a map of artifact type
definitions for use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="even">
<td style="text-align: left;">data_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of data types</td>
<td style="text-align: left;">Declares a map of TOSCA data type
definitions for use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">capability_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of capability types</td>
<td style="text-align: left;">Declares a map of capability type
definitions for use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="even">
<td style="text-align: left;">interface_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of interface types</td>
<td style="text-align: left;">Declares a map of interface type
definitions for use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">relationship_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of relationship types</td>
<td style="text-align: left;">Declares a map of relationship type
definitions for use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="even">
<td style="text-align: left;">node_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of node types</td>
<td style="text-align: left;">Declares a map of node type definitions
for use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">group_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of group types</td>
<td style="text-align: left;">Declares a map of group type definitions
for use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="even">
<td style="text-align: left;">policy_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of policy types</td>
<td style="text-align: left;">Declares a map of policy type definitions
for use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">repositories</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of repository definitions</td>
<td style="text-align: left;">Declares a map of external repositories
that contain artifacts that are referenced in this TOSCA file along with
the addresses used to connect to them in order to retrieve the
artifacts.</td>
</tr>
<tr class="even">
<td style="text-align: left;">functions</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of function definitions</td>
<td style="text-align: left;">Declares a map of function definitions for
use in this TOSCA file and/or external TOSCA files.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">profile</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The profile name that can be used by other
TOSCA files to import the type definitions in this document.</td>
</tr>
<tr class="even">
<td style="text-align: left;">imports</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of import definitions</td>
<td style="text-align: left;">Declares a list of import statements
pointing to external TOSCA files or well-known profiles. For example,
these may be file locations or URIs relative to the TOSCA file within
the same TOSCA CSAR file.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">service_template</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">service template definition</td>
<td style="text-align: left;">Defines a template from which to create a
mode/representation of an application or service. Service templates
consist of node templates that represent the application’s or service’s
components, as well as relationship templates representing relations
between these components.</td>
</tr>
</tbody>
</table>
<p>The following rules apply:</p>
<ul>
<li>The key <code>tosca_definitions_version</code> MUST be the first
line of each<br/>
TOSCA file.</li>
<li>TOSCA files do not have to define a <code>service_template</code>
and MAY<br/>
contain simply type definitions, repository definitions, function<br/>
definitions, or other import statements and be imported for use in<br/>
other TOSCA files. However, a TOSCA file that defines a
<code>profile</code><br/>
MUST NOT define a <code>service_template</code>.</li>
</ul>
<!----
{"id": "194", "author": "Matt Rutkowski", "date": "2015-08-25T21:52:00Z", "comment": "**[TOSCA-246](../customXml/item1.xml): Comments captured**: Perhaps need an advanced concept to define \u201cfeatures\u201d that are not necessarily attached to a particular node. (like things you might include in a manifest). Like the requirement for a global time sync. How do we reference that feature, where is that feature attached to (some node?). perhaps add a new keyword like \u201ccloud\u201d that can hold all these Features that have no immediate Node to attach them to. Perhaps a syntax convention, where we might just list the names of the features (in some precedent order (sequence). Need to answer: -Who requires, it who fulfills it and how do u maintain the relationship? Luc: Environmental requirements. e.g., Python or something similar.", "target": "Notes"}-->
<p>The remainder of this chapter provides detailed descriptions of
the 
keynames and associated grammars used in a TOSCA file definition.</p>
<h2 id="tosca-definitions-version">6.2 TOSCA Definitions Version</h2>
<p>The mandatory <code>tosca_definitions_version</code> keyname provides
a means to 
specify the TOSCA version used within the TOSCA file as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a aria-hidden="true" href="#cb1-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> &lt;tosca_version&gt; </span></span></code></pre></div>
<p>It is an indicator for the version of the TOSCA grammar that MUST
be 
used to parse the remainder of the TOSCA file. TOSCA uses the 
following version strings for the various revisions of the TOSCA 
specification:</p>
<table>
<thead>
<tr class="header">
<th>Version String</th>
<th>TOSCA Specification</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>tosca_2_0</td>
<td>TOSCA Version 2.0</td>
</tr>
<tr class="even">
<td>tosca_simple_yaml_1_3</td>
<td>TOSCA Simple Profile in YAML Version 1.3</td>
</tr>
<tr class="odd">
<td>tosca_simple_yaml_1_2</td>
<td>TOSCA Simple Profile in YAML Version 1.2</td>
</tr>
<tr class="even">
<td>tosca_simple_yaml_1_1</td>
<td>TOSCA Simple Profile in YAML Version 1.1</td>
</tr>
<tr class="odd">
<td>tosca_simple_yaml_1_0</td>
<td>TOSCA Simple Profile in YAML Version 1.0</td>
</tr>
</tbody>
</table>
<p>The version for this specification is <code>tosca_2_0</code>. The
following 
shows an example <code>tosca_definitions_version</code> in a TOSCA file
created 
using the TOSCA Version 2.0 specification:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a aria-hidden="true" href="#cb2-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span></code></pre></div>
<p>Note that it is not mandatory for TOSCA Version 2.0 implementations
to 
support older versions of the TOSCA specifications.</p>
<h2 id="dsl-definitions">6.3 DSL Definitions</h2>
<p>The optional <code>dsl_definitions</code> keyname provides a section
where 
template designers can define YAML-style macros for use elsewhere
in 
the TOSCA file. DSL definitions use the following grammar:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a aria-hidden="true" href="#cb3-1" tabindex="-1"></a><span class="fu">dsl_definitions</span><span class="kw">:</span></span>
<span id="cb3-2"><a aria-hidden="true" href="#cb3-2" tabindex="-1"></a><span class="at">   &lt;dsl_definition_1&gt;</span></span>
<span id="cb3-3"><a aria-hidden="true" href="#cb3-3" tabindex="-1"></a><span class="at">   ...</span></span>
<span id="cb3-4"><a aria-hidden="true" href="#cb3-4" tabindex="-1"></a><span class="at">   &lt;dsl_definition_n&gt;</span></span></code></pre></div>
<p>The grammar for each <code>&lt;dsl_definition&gt;</code> is as
follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb4-1"><a aria-hidden="true" href="#cb4-1" tabindex="-1"></a><span class="fu">&lt;anchor_block&gt;</span><span class="kw">:</span><span class="at"> </span><span class="ot">&amp;&lt;anchor&gt;</span></span>
<span id="cb4-2"><a aria-hidden="true" href="#cb4-2" tabindex="-1"></a><span class="at">  &lt;anchor_definitions&gt;</span></span></code></pre></div>
<p>where <code>&lt;anchor_block&gt;</code> defines a set of reusable
YAML definitions (the 
<code>&lt;anchor_definitions&gt;</code>) for which
<code>&lt;anchor&gt;</code> can be used as an alias 
elsewhere in the document.</p>
<p>The following example shows DSL definitions for common image
property 
assignments: 
<!----
{"id": "236", "author": "Jordan,PM,Paul,TNK6 R", "date": "2020-11-05T11:18:00Z", "comment": "There should also be an example of how to use the macro once defined.", "target": "Example"}--></p>
<pre><code>dsl_definitions:
    ubuntu_image_props: &amp;ubuntu_image_props
      architecture: x86_64
      type: linux
      distribution: ubuntu
      os_version: 14.04
    redhat_image_props: &amp;redhat_image_props
      architecture: x86_64
      type: linux
      distribution: rhel
      os_version: 6.6</code></pre>
<h2 id="type-definitions">6.4 Type definitions</h2>
<p>TOSCA provides a type system to describe reusable building blocks
to 
construct a service template (i.e. for the nodes, relationship,
group 
and policy templates, and the data, capabilities, interfaces, and 
artifacts used in the node and relationship templates). TOSCA types
are 
reusable TOSCA entities and are defined in their specific sections
in 
the TOSCA file.</p>
<p>In this section, we present the definitions of common keynames
that 
are used by all TOSCA type definitions. Type-specific definitions for
the 
different TOSCA type entities are presented further in the document:</p>
<blockquote>
<p>Cross references need to be updated later</p>
</blockquote>
<ul>
<li>Node Type in Section 4.3.1 Node Type.</li>
<li>Relationship Type in Section 4.3.3 Relationship Type.</li>
<li>Interface Type in Section 4.3.6.1 Interface Type.</li>
<li>Capability Type in Section 4.3.5.1 Capability Type.</li>
<li>Data Type in Section 4.4.4 Data Type.</li>
<li>Artifact Type in Section 4.3.7.1 Artifact Type.</li>
<li>Group Type in Section 4.6.1 Group Type.</li>
<li>Policy Type in Section 4.6.3 Policy Type.</li>
</ul>
<h3 id="common-keynames-in-type-definitions">6.4.1 Common Keynames in
Type Definitions</h3>
<p>The following keynames are used by all TOSCA type entities in the
same 
way. This section serves to define them at once. 
|Keyname|Mandatory|Type|Description| 
| :—- | :—— | :—- | :—— | 
|derived_from|no|string|An optional parent type name from which this
type derives.| 
|version|no|version|An optional version for the type definition.| 
|metadata|no|map|Defines a section used to declare additional metadata
information.| 
|description|no|string|An optional description for the type.|</p>
<p>The common keynames in type definitions have the following
grammar:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb6-1"><a aria-hidden="true" href="#cb6-1" tabindex="-1"></a><span class="fu">&lt;type_name&gt;</span><span class="kw">:</span></span>
<span id="cb6-2"><a aria-hidden="true" href="#cb6-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;parent_type_name&gt;</span></span>
<span id="cb6-3"><a aria-hidden="true" href="#cb6-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb6-4"><a aria-hidden="true" href="#cb6-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb6-5"><a aria-hidden="true" href="#cb6-5" tabindex="-1"></a><span class="at">    &lt;metadata_map&gt;</span></span>
<span id="cb6-6"><a aria-hidden="true" href="#cb6-6" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;type_description&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>parent_type_name: represents the optional parent type
name.</p></li>
<li><p>version_number: represents the optional TOSCA version number for
the 
type.</p></li>
<li><p>entity_description: represents the optional description string
for the 
type.</p></li>
<li><p>metadata_map: represents the optional metadata map of
string.</p></li>
</ul>
<h3 id="type-derivation">6.4.2 Type Derivation</h3>
<p>To simplify type creation and to promote type extensibility
TOSCA 
allows the definition of a new type (the derived type) based on 
another type (the parent type). The derivation process can be
applied 
recursively, where a type may be derived from a long list of
ancestor 
types (the parent, the parent of the parent, etc). Unless 
specifically stated in the derivation rules, when deriving new
types 
from parent types the keyname definitions are inherited from the 
parent type. Moreover, the inherited definitions may be refined 
according to the derivation rules of that particular type entity.
For 
definitions that are not inherited, a new definition
<strong>MUST</strong> be 
provided (if the keyname is mandatory) or <strong>MAY</strong> be
provided (if the 
keyname is not mandatory). If not provided, the keyname remains 
undefined. For definitions that are inherited, a refinement of the 
inherited definition is not mandatory even for mandatory keynames 
(since it has been inherited). A definition refinement that is
exactly 
the same as the definition in the parent type does not change in
any 
way the inherited definition. While unnecessary, it is not wrong.</p>
<p>The following are some generic derivation rules used during
type 
derivation (the specific rules of each TOSCA type entity are
presented 
in their respective sections):</p>
<ul>
<li><p>If not refined, usually a keyname/entity definition, is
inherited 
unchanged from the parent type, unless explicitly specified in the 
rules that it is “not inherited”.</p></li>
<li><p>New entities (such as properties, attributes, capabilities, 
requirements, interfaces, operations, notification, parameters) may
be 
added during derivation.</p></li>
<li><p>Already defined entities that have a type may be redefined to
have a 
type derived from the original type.</p></li>
</ul>
<!----
{"id": "427", "author": "Mike Rehder", "date": "2020-12-14T14:25:00Z", "comment": "New term \u201credefined\u201d. The sentence is\n  confusing \u2013 what is it trying to say? Is it saying that you can change\n  the type of a derived_from type (how?)?", "target": "redefined\n  "}-->
<ul>
<li><p>New validation clause is added to already defined 
keynames/entities (i.e. the defined validation clause does not 
replace the validation clauses of the parent type but are 
added to them).</p></li>
<li><p>Some definitions must be totally flexible, so they will
overwrite 
the definition in the parent type.</p></li>
</ul>
<!----
{"id": "428", "author": "Mike Rehder", "date": "2020-12-14T14:29:00Z", "comment": "Why \u201cshould\u201d? Isn\u2019t\n  this \u201care treated as a new declaration and\u201d?", "target": "must be totally\n  flexible"}-->
<ul>
<li>Some definitions must not be changed at all once defined
(i.e. they<br/>
represent some sort of “signature” fundamental to the type).</li>
</ul>
<!----
{"id": "429", "author": "Mike Rehder", "date": "2020-12-14T14:28:00Z", "comment": "Why \u201cshould\u201d? Isn\u2019t\n  this \u201ccannot\u201d?", "target": "must "}-->
<p>During type derivation the common keynames in type definitions use
the 
following rules:</p>
<ul>
<li>derived_from: obviously, the definition is not inherited from
the<br/>
parent type. If not defined, it remains undefined and this type
does<br/>
not derive from another type. If defined, then this type derives
from<br/>
another type, and all its keyname definitions must respect the<br/>
derivation rules of the type entity.</li>
<li>version: the definition is not inherited from the parent type.
If<br/>
undefined, it remains undefined.</li>
<li>metadata: the definition is not inherited from the parent type.
If<br/>
undefined, it remains undefined.</li>
<li>description: the definition is not inherited from the parent type.
If<br/>
undefined, it remains undefined.</li>
</ul>
<h3 id="types-of-types">6.4.3 Types of Types</h3>
<p>TOSCA supports eight different <em>types of types</em>. These types
can 
be defined in a TOSCA file using the grammars described in this 
section.</p>
<h4 id="artifact-types">6.4.3.1 Artifact Types</h4>
<p>Artifact types can be defined in a TOSCA file using the
optional 
<code>artifact_types</code> keyword using the following grammar:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb7-1"><a aria-hidden="true" href="#cb7-1" tabindex="-1"></a><span class="fu">artifact_types</span><span class="kw">:</span></span>
<span id="cb7-2"><a aria-hidden="true" href="#cb7-2" tabindex="-1"></a><span class="at">  &lt;artifact_type_defn_1&gt;</span></span>
<span id="cb7-3"><a aria-hidden="true" href="#cb7-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb7-4"><a aria-hidden="true" href="#cb7-4" tabindex="-1"></a><span class="at">  &lt;artifact type_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example artifact type
definition:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb8-1"><a aria-hidden="true" href="#cb8-1" tabindex="-1"></a><span class="fu">artifact_types</span><span class="kw">:</span></span>
<span id="cb8-2"><a aria-hidden="true" href="#cb8-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.artifacttypes.myFileType</span><span class="kw">:</span></span>
<span id="cb8-3"><a aria-hidden="true" href="#cb8-3" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> tosca.artifacts.File</span></span></code></pre></div>
<p>A detailed description of the artifact type definition grammar
is 
provided in Section XXX.</p>
<h4 id="data-types">6.4.3.2 Data Types</h4>
<p>Data types can be defined in a TOSCA file using the optional 
<code>data_types</code> keyword using the following grammar:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb9-1"><a aria-hidden="true" href="#cb9-1" tabindex="-1"></a><span class="fu">data_types</span><span class="kw">:</span></span>
<span id="cb9-2"><a aria-hidden="true" href="#cb9-2" tabindex="-1"></a><span class="at">   &lt;tosca_datatype_def_1&gt;</span></span>
<span id="cb9-3"><a aria-hidden="true" href="#cb9-3" tabindex="-1"></a><span class="at">   ...</span></span>
<span id="cb9-4"><a aria-hidden="true" href="#cb9-4" tabindex="-1"></a><span class="at">   &lt;tosca_datatype_def_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example of data type
definition:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb10-1"><a aria-hidden="true" href="#cb10-1" tabindex="-1"></a><span class="fu">data_types</span><span class="kw">:</span></span>
<span id="cb10-2"><a aria-hidden="true" href="#cb10-2" tabindex="-1"></a><span class="co">  # A complex datatype definition</span></span>
<span id="cb10-3"><a aria-hidden="true" href="#cb10-3" tabindex="-1"></a><span class="at">  </span><span class="fu">simple_contact_info</span><span class="kw">:</span></span>
<span id="cb10-4"><a aria-hidden="true" href="#cb10-4" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb10-5"><a aria-hidden="true" href="#cb10-5" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span></span>
<span id="cb10-6"><a aria-hidden="true" href="#cb10-6" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb10-7"><a aria-hidden="true" href="#cb10-7" tabindex="-1"></a><span class="at">      </span><span class="fu">email</span><span class="kw">:</span></span>
<span id="cb10-8"><a aria-hidden="true" href="#cb10-8" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb10-9"><a aria-hidden="true" href="#cb10-9" tabindex="-1"></a><span class="at">      </span><span class="fu">phone</span><span class="kw">:</span></span>
<span id="cb10-10"><a aria-hidden="true" href="#cb10-10" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb10-11"><a aria-hidden="true" href="#cb10-11" tabindex="-1"></a><span class="co">  # datatype definition derived from an existing type</span></span>
<span id="cb10-12"><a aria-hidden="true" href="#cb10-12" tabindex="-1"></a><span class="at">  </span><span class="fu">full_contact_info</span><span class="kw">:</span></span>
<span id="cb10-13"><a aria-hidden="true" href="#cb10-13" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> simple_contact_info</span></span>
<span id="cb10-14"><a aria-hidden="true" href="#cb10-14" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb10-15"><a aria-hidden="true" href="#cb10-15" tabindex="-1"></a><span class="at">      </span><span class="fu">street_address</span><span class="kw">:</span></span>
<span id="cb10-16"><a aria-hidden="true" href="#cb10-16" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb10-17"><a aria-hidden="true" href="#cb10-17" tabindex="-1"></a><span class="at">      </span><span class="fu">city</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb10-18"><a aria-hidden="true" href="#cb10-18" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb10-19"><a aria-hidden="true" href="#cb10-19" tabindex="-1"></a><span class="at">      </span><span class="fu">state</span><span class="kw">:</span></span>
<span id="cb10-20"><a aria-hidden="true" href="#cb10-20" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb10-21"><a aria-hidden="true" href="#cb10-21" tabindex="-1"></a><span class="at">      </span><span class="fu">postal_code</span><span class="kw">:</span></span>
<span id="cb10-22"><a aria-hidden="true" href="#cb10-22" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span></code></pre></div>
<p>A detailed description of the data type definition grammar is 
provided in Section XXX. 
#### 6.4.3.3 Capability Types 
Capability types can be defined in a TOSCA file using the optional 
<code>capability_types</code> keyword using the following grammar:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb11-1"><a aria-hidden="true" href="#cb11-1" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb11-2"><a aria-hidden="true" href="#cb11-2" tabindex="-1"></a><span class="at">  &lt;capability_type_defn_1&gt;</span></span>
<span id="cb11-3"><a aria-hidden="true" href="#cb11-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb11-4"><a aria-hidden="true" href="#cb11-4" tabindex="-1"></a><span class="at">  &lt;capability type_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows example capability type
definitions:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb12-1"><a aria-hidden="true" href="#cb12-1" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb12-2"><a aria-hidden="true" href="#cb12-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.mytypes.myGenericFeature</span><span class="kw">:</span></span>
<span id="cb12-3"><a aria-hidden="true" href="#cb12-3" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb12-4"><a aria-hidden="true" href="#cb12-4" tabindex="-1"></a><span class="co">      # more details ...</span></span>
<span id="cb12-5"><a aria-hidden="true" href="#cb12-5" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.mytypes.myfeatures.myFirstCustomFeature</span><span class="kw">:</span></span>
<span id="cb12-6"><a aria-hidden="true" href="#cb12-6" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> mycompany.mytypes.myfeatures.myGenericFeature</span></span>
<span id="cb12-7"><a aria-hidden="true" href="#cb12-7" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb12-8"><a aria-hidden="true" href="#cb12-8" tabindex="-1"></a><span class="co">      # more details ...</span></span>
<span id="cb12-9"><a aria-hidden="true" href="#cb12-9" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.mytypes.myfeatures.transactSQL</span><span class="kw">:</span></span>
<span id="cb12-10"><a aria-hidden="true" href="#cb12-10" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> mycompany.mytypes.myfeatures.myGenericFeature</span></span>
<span id="cb12-11"><a aria-hidden="true" href="#cb12-11" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb12-12"><a aria-hidden="true" href="#cb12-12" tabindex="-1"></a><span class="co">      # more details ...</span></span></code></pre></div>
<p>A detailed description of the capability type definition grammar
is 
provided in Section XXX. 
#### 6.4.3.4 Interface Types 
Interface types can be defined in a TOSCA file using the optional 
<code>interface_types</code> keyword using the following grammar:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb13-1"><a aria-hidden="true" href="#cb13-1" tabindex="-1"></a><span class="fu">interface_types</span><span class="kw">:</span></span>
<span id="cb13-2"><a aria-hidden="true" href="#cb13-2" tabindex="-1"></a><span class="at">  &lt;interface_type_defn_1&gt;</span></span>
<span id="cb13-3"><a aria-hidden="true" href="#cb13-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb13-4"><a aria-hidden="true" href="#cb13-4" tabindex="-1"></a><span class="at">  &lt;interface type_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example interface type
definition:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb14-1"><a aria-hidden="true" href="#cb14-1" tabindex="-1"></a><span class="fu">interface_types</span><span class="kw">:</span></span>
<span id="cb14-2"><a aria-hidden="true" href="#cb14-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.interfaces.service.Signal</span><span class="kw">:</span></span>
<span id="cb14-3"><a aria-hidden="true" href="#cb14-3" tabindex="-1"></a><span class="at">    </span><span class="fu">operations</span><span class="kw">:</span></span>
<span id="cb14-4"><a aria-hidden="true" href="#cb14-4" tabindex="-1"></a><span class="at">      </span><span class="fu">signal_begin_receive</span><span class="kw">:</span></span>
<span id="cb14-5"><a aria-hidden="true" href="#cb14-5" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Operation to signal start of some message processing.</span></span>
<span id="cb14-6"><a aria-hidden="true" href="#cb14-6" tabindex="-1"></a><span class="at">      </span><span class="fu">signal_end_receive</span><span class="kw">:</span></span>
<span id="cb14-7"><a aria-hidden="true" href="#cb14-7" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Operation to signal end of some message processed.</span></span></code></pre></div>
<p>A detailed description of the interface type definition grammar
is 
provided in Section XXX. 
#### 6.4.3.5 Relationship Types 
Relationship types can be defined in a TOSCA file using the
optional 
<code>relationship_types</code> keyword using the following grammar:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb15-1"><a aria-hidden="true" href="#cb15-1" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb15-2"><a aria-hidden="true" href="#cb15-2" tabindex="-1"></a><span class="at">  &lt;relationship_type_defn_1&gt;</span></span>
<span id="cb15-3"><a aria-hidden="true" href="#cb15-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb15-4"><a aria-hidden="true" href="#cb15-4" tabindex="-1"></a><span class="at">  &lt;relationship type_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows example relationship type
definitions:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb16-1"><a aria-hidden="true" href="#cb16-1" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb16-2"><a aria-hidden="true" href="#cb16-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.mytypes.HostedOn</span><span class="kw">:</span></span>
<span id="cb16-3"><a aria-hidden="true" href="#cb16-3" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb16-4"><a aria-hidden="true" href="#cb16-4" tabindex="-1"></a><span class="co">      # more details ...</span></span>
<span id="cb16-5"><a aria-hidden="true" href="#cb16-5" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.mytypes.myCustomClientServerType</span><span class="kw">:</span></span>
<span id="cb16-6"><a aria-hidden="true" href="#cb16-6" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> mycompany.mytypes.HostedOn</span></span>
<span id="cb16-7"><a aria-hidden="true" href="#cb16-7" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb16-8"><a aria-hidden="true" href="#cb16-8" tabindex="-1"></a><span class="co">      # more details ...</span></span>
<span id="cb16-9"><a aria-hidden="true" href="#cb16-9" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.mytypes.myCustomConnectionType</span><span class="kw">:</span></span>
<span id="cb16-10"><a aria-hidden="true" href="#cb16-10" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb16-11"><a aria-hidden="true" href="#cb16-11" tabindex="-1"></a><span class="co">      # more details ...</span></span></code></pre></div>
<p>A detailed description of the relationship type definition grammar
is 
provided in Section XXX. 
#### 6.4.3.6 Node Types 
Node types can be defined in a TOSCA file using the optional 
<code>node_types</code> keyword using the following grammar:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb17-1"><a aria-hidden="true" href="#cb17-1" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb17-2"><a aria-hidden="true" href="#cb17-2" tabindex="-1"></a><span class="at">  &lt;node_type_defn_1&gt;</span></span>
<span id="cb17-3"><a aria-hidden="true" href="#cb17-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb17-4"><a aria-hidden="true" href="#cb17-4" tabindex="-1"></a><span class="at">  &lt;node_type_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows example node type definitions:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb18-1"><a aria-hidden="true" href="#cb18-1" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb18-2"><a aria-hidden="true" href="#cb18-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Database</span><span class="kw">:</span></span>
<span id="cb18-3"><a aria-hidden="true" href="#cb18-3" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">"An abstract node type for all databases"</span></span>
<span id="cb18-4"><a aria-hidden="true" href="#cb18-4" tabindex="-1"></a><span class="at">  </span><span class="fu">WebApplication</span><span class="kw">:</span></span>
<span id="cb18-5"><a aria-hidden="true" href="#cb18-5" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">"An abstract node type"</span></span>
<span id="cb18-6"><a aria-hidden="true" href="#cb18-6" tabindex="-1"></a><span class="at">  </span><span class="fu">my_webapp_node_type</span><span class="kw">:</span></span>
<span id="cb18-7"><a aria-hidden="true" href="#cb18-7" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> WebApplication</span></span>
<span id="cb18-8"><a aria-hidden="true" href="#cb18-8" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb18-9"><a aria-hidden="true" href="#cb18-9" tabindex="-1"></a><span class="at">      </span><span class="fu">my_port</span><span class="kw">:</span></span>
<span id="cb18-10"><a aria-hidden="true" href="#cb18-10" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb18-11"><a aria-hidden="true" href="#cb18-11" tabindex="-1"></a><span class="at">  </span><span class="fu">my_database_node_type</span><span class="kw">:</span></span>
<span id="cb18-12"><a aria-hidden="true" href="#cb18-12" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> Database</span></span>
<span id="cb18-13"><a aria-hidden="true" href="#cb18-13" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb18-14"><a aria-hidden="true" href="#cb18-14" tabindex="-1"></a><span class="at">      mycompany.mytypes.myfeatures.transactSQL</span></span></code></pre></div>
<p>A detailed description of the node type definition grammar is 
provided in Section XXX. 
#### 6.4.3.7 Group Types 
Group types can be defined in a TOSCA file using the optional 
<code>group_types</code> keyword using the following grammar:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb19-1"><a aria-hidden="true" href="#cb19-1" tabindex="-1"></a><span class="fu">group_types</span><span class="kw">:</span></span>
<span id="cb19-2"><a aria-hidden="true" href="#cb19-2" tabindex="-1"></a><span class="at">  &lt;group_type_defn_1&gt;</span></span>
<span id="cb19-3"><a aria-hidden="true" href="#cb19-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb19-4"><a aria-hidden="true" href="#cb19-4" tabindex="-1"></a><span class="at">  &lt;group type_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example group type
definition:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb20-1"><a aria-hidden="true" href="#cb20-1" tabindex="-1"></a><span class="fu">group_types</span><span class="kw">:</span></span>
<span id="cb20-2"><a aria-hidden="true" href="#cb20-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.mytypes.myScalingGroup</span><span class="kw">:</span></span>
<span id="cb20-3"><a aria-hidden="true" href="#cb20-3" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> mycompany.mytypes.mygroups</span></span></code></pre></div>
<p>A detailed description of the group type definition grammar is 
provided in Section XXX. 
#### 6.4.3.8 Policy Types 
Policy types can be defined in a TOSCA file using the optional 
<code>policy_types</code> keyword using the following grammar:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb21-1"><a aria-hidden="true" href="#cb21-1" tabindex="-1"></a><span class="fu">policy_types</span><span class="kw">:</span></span>
<span id="cb21-2"><a aria-hidden="true" href="#cb21-2" tabindex="-1"></a><span class="at">  &lt;policy_type_defn_1&gt;</span></span>
<span id="cb21-3"><a aria-hidden="true" href="#cb21-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb21-4"><a aria-hidden="true" href="#cb21-4" tabindex="-1"></a><span class="at">  &lt;policy type_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example policy type
definition: 
<!----
{"id": "327", "author": "Jordan,PM,Paul,TNK6 R", "date": "2020-11-09T08:48:00Z", "comment": "There should be a second policy definition in the example or it is just a repeat of the policy type definition example", "target": "Example"}--></p>
<pre><code>policy_types:
  mycompany.mytypes.myScalingPolicy:
    derived_from: Scaling</code></pre>
<p>A detailed description of the policy type definition grammar is 
provided in Section XXX.</p>
<h2 id="repository-definitions">6.5 Repository Definitions</h2>
<p>A repository definition defines an external <em>repository</em> that
contains 
TOSCA files and/or artifacts that are referenced or imported by
this 
TOSCA file. Repositories are defined using the optional
<code>repositories</code> 
keyname as follows:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb23-1"><a aria-hidden="true" href="#cb23-1" tabindex="-1"></a><span class="fu">repositories</span><span class="kw">:</span></span>
<span id="cb23-2"><a aria-hidden="true" href="#cb23-2" tabindex="-1"></a><span class="at">   &lt;repository_definition_1&gt;</span></span>
<span id="cb23-3"><a aria-hidden="true" href="#cb23-3" tabindex="-1"></a><span class="at">   ...</span></span>
<span id="cb23-4"><a aria-hidden="true" href="#cb23-4" tabindex="-1"></a><span class="at">   &lt;repository_definition_n&gt;</span></span></code></pre></div>
<p>The following is the list of recognized keynames for a TOSCA
repository 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Declares a description for the repository
being defined.</td>
</tr>
<tr class="even">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of YAML values</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information about the repository being defined.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">url</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The URL or network address used to access
the repository.</td>
</tr>
</tbody>
</table>
<!---- Calin: as we already define previously that any multiline definition admits the description and metadata shold we keep it here (and all subsequent places?) -->
<p>These keynames can be used to define a repository using a 
grammar as follows:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb24-1"><a aria-hidden="true" href="#cb24-1" tabindex="-1"></a><span class="fu">&lt;repository_name&gt;</span><span class="kw">:</span></span>
<span id="cb24-2"><a aria-hidden="true" href="#cb24-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;repository_description&gt;</span></span>
<span id="cb24-3"><a aria-hidden="true" href="#cb24-3" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb24-4"><a aria-hidden="true" href="#cb24-4" tabindex="-1"></a><span class="at">    &lt;metadata_definitions&gt;</span></span>
<span id="cb24-5"><a aria-hidden="true" href="#cb24-5" tabindex="-1"></a><span class="at">  </span><span class="fu">url</span><span class="kw">:</span><span class="at"> &lt;repository_address&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li>repository_name: represents the mandatory symbolic name of the<br/>
repository as a string</li>
<li>repository_description: contains an optional description of
the<br/>
repository.</li>
<li>metadata_definitions: contains an optional map of metadata
using<br/>
YAML types</li>
<li>repository_address: represents the mandatory URL to access the<br/>
repository as a string.</li>
</ul>
<p>If only the <code>url</code> needs to be specified, repository
definitions can 
also use a single-line grammar as follows:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb25-1"><a aria-hidden="true" href="#cb25-1" tabindex="-1"></a><span class="fu">&lt;repository_name&gt;</span><span class="kw">:</span><span class="at"> &lt;repository_address&gt;</span></span></code></pre></div>
<p>The following example show repository definitions using both 
multi-line as well as single-line grammars.</p>
<pre><code>repositories:
  my_code_repo:
    description: My project’s code repository in GitHub
    url: https://github.com/my-project/
  external_repo: https://foo.bar</code></pre>
<h2 id="function-definitions">6.6 Function Definitions</h2>
<p>A function definition defines an custom <em>function</em> that can be
used 
within this TOSCA file. Function definitions may include one or
more 
<em>function signatures</em> as well as function implementations.
Functions 
are defined using the optional <code>functions</code> keyname as
follows:</p>
<pre><code>functions:
   &lt;function_definition_1&gt;
   ...
   &lt;function_definition_n&gt;</code></pre>
<!---- Calin 2023-05-28: the validation clause(s) is a mess throughout the document, we should make it singular, and eliminate the lists -->
<p>The following example shows the definition of a square root
function:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb28-1"><a aria-hidden="true" href="#cb28-1" tabindex="-1"></a><span class="fu">functions</span><span class="kw">:</span></span>
<span id="cb28-2"><a aria-hidden="true" href="#cb28-2" tabindex="-1"></a><span class="at">  </span><span class="fu">sqrt</span><span class="kw">:</span></span>
<span id="cb28-3"><a aria-hidden="true" href="#cb28-3" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb28-4"><a aria-hidden="true" href="#cb28-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span></span>
<span id="cb28-5"><a aria-hidden="true" href="#cb28-5" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb28-6"><a aria-hidden="true" href="#cb28-6" tabindex="-1"></a><span class="at">          </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb28-7"><a aria-hidden="true" href="#cb28-7" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span></span>
<span id="cb28-8"><a aria-hidden="true" href="#cb28-8" tabindex="-1"></a><span class="at">          </span><span class="fu">type</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb28-9"><a aria-hidden="true" href="#cb28-9" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/sqrt.py</span></span>
<span id="cb28-10"><a aria-hidden="true" href="#cb28-10" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span></span>
<span id="cb28-11"><a aria-hidden="true" href="#cb28-11" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb28-12"><a aria-hidden="true" href="#cb28-12" tabindex="-1"></a><span class="at">          </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="fl">0.0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb28-13"><a aria-hidden="true" href="#cb28-13" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span></span>
<span id="cb28-14"><a aria-hidden="true" href="#cb28-14" tabindex="-1"></a><span class="at">          </span><span class="fu">type</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb28-15"><a aria-hidden="true" href="#cb28-15" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/sqrt.py</span></span>
<span id="cb28-16"><a aria-hidden="true" href="#cb28-16" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;</span></span>
<span id="cb28-17"><a aria-hidden="true" href="#cb28-17" tabindex="-1"></a>      This is a square root function that defines two signatures:</span>
<span id="cb28-18"><a aria-hidden="true" href="#cb28-18" tabindex="-1"></a>      the argument is either integer or float and the function</span>
<span id="cb28-19"><a aria-hidden="true" href="#cb28-19" tabindex="-1"></a>      returns the square root as a float.</span></code></pre></div>
<h2 id="profiles">6.7 Profiles</h2>
<p>A TOSCA profile is a named collection of TOSCA type
definitions, 
repository definitions, artifacts, and function definitions that 
logically belong together. One can think of TOSCA profiles as
platform 
libraries exposed by the TOSCA processor and made available to all 
services that use that processor. Profiles in TOSCA are similar to 
libraries in traditional computer programming languages. They are 
intended to define collections of domain-specific components that
can 
be used by service designers to compose complex service 
templates. Entities defined in TOSCA profiles are used as follows:</p>
<ul>
<li>Types defined in a TOSCA profile provide reusable building
blocks<br/>
on which services can be composed.</li>
<li>Artifacts defined in a TOSCA profile can provide<br/>
implementations for the TOSCA types defined in the profile.</li>
</ul>
<p>TOSCA implementations can organize supported profiles in a catalog
to 
allow other service templates to import those profiles by profile
name. 
This avoids the need for every service that uses those profiles to 
include the profile type definitions in their service definition 
packages.</p>
<p>TOSCA files that define profiles can be bundled together with
other 
TOSCA files in the same CSAR package. For example, a TOSCA profile 
that defines <em>abstract</em> node types can be packaged together with
TOSCA 
files that define substituting service templates for those
abstract 
types.</p>
<h3 id="grammar">6.7.1 Grammar</h3>
<p>A TOSCA file defines a TOSCA Profile using the <code>profile</code>
keyword as 
follows:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb29-1"><a aria-hidden="true" href="#cb29-1" tabindex="-1"></a><span class="fu">profile</span><span class="kw">:</span><span class="at"> &lt;profile_name&gt; </span></span></code></pre></div>
<p>Using this grammar, the <code>profile</code> keyword assigns a
<em>profile name</em> to 
the collection of types, repositories, and functions defined in
this 
TOSCA file. The specified <code>profile_name</code> can be an arbitrary
string 
value that defines the name by which other TOSCA files can import
this 
profile. TOSCA does not place any restrictions on the value of the 
profile name string. However, we encourage a Java-style
reverse-domain 
notation with version as a best-practice convention. For example,
the 
following profile statement is used to define Version 2.0 of a set
of 
definitions suitable for describing cloud computing in an example
company:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb30-1"><a aria-hidden="true" href="#cb30-1" tabindex="-1"></a><span class="fu">profile</span><span class="kw">:</span><span class="at"> com.example.tosca_profiles.cloud_computing:2.0 </span></span></code></pre></div>
<p>The following defines a domain-specific profile for Kubernetes:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb31-1"><a aria-hidden="true" href="#cb31-1" tabindex="-1"></a><span class="fu">profile</span><span class="kw">:</span><span class="at"> io.kubernetes:1.30</span></span></code></pre></div>
<p>TOSCA parsers MUST process profile definitions according to the 
following rules:</p>
<ul>
<li>TOSCA files that define a profile (i.e., that contain a
<code>profile</code><br/>
keyname) MUST NOT also define a service template.</li>
<li>If the parser encounters the <code>profile</code> keyname in a TOSCA
file, then the<br/>
corresponding profile name will be applied to all types defined in<br/>
that file as well as to types defined in any imported TOSCA files.</li>
<li>If one of those imported files itself contains also defines the
<code>profile</code> keyname—and<br/>
that profile name is different from the name of the importing<br/>
profile, then that profile name overrides the profile name value
from<br/>
that point in the import tree onward, recursively.</li>
</ul>
<h3 id="tosca-simple-profile">6.7.2 TOSCA Simple Profile</h3>
<p>Version 1.x of the TOSCA specification included a collection of 
normative type definitions for building cloud applications. This 
collection of type definitions was defined as the <strong>TOSCA
Simple 
Profile</strong>. Implementations of TOSCA Version 1.x were expected to
include 
implementations for the types defined in the TOSCA Simple Profile,
and 
service templates defined using TOSCA Version 1.x implicitly
imported 
the corresponding TOSCA Simple Profile version.</p>
<p>Starting with TOSCA Version 2.0, the TOSCA Simple Profile type 
definitions are no longer part of the TOSCA standard and support for
the 
TOSCA Simple Profile is no longer mandatory. Instead, the definition
of 
the TOSCA Simple Profile has been moved to an OASIS Open Github 
repository with the goal of being maintained by the TOSCA community
and 
governed as an open-source project. In addition, TOSCA Version 2.0 
removes the implicit import of the TOSCA Simple Profile. Service 
templates that want to continue to use the TOSCA Simple Profile
type 
definitions must explicitly import that profile.</p>
<p>Eliminating mandatory support for the TOSCA Simple Profile makes
it 
easier for TOSCA to be used for additional application domains.
For 
example, the European Telecommunications Standards Institute (ETSI)
has 
introduced a TOSCA profile for <strong>Network Functions
Virtualization</strong> 
defines Virtualized Network Function Descriptors (VNFDs), Network 
Service Descriptors (NSDs) and a Physical Network Function
Descriptors 
(PNFDs).</p>
<blockquote>
<p>We should give a couple of additional examples.</p>
</blockquote>
<h3 id="profile-versions">6.7.3 Profile Versions</h3>
<p>TOSCA Profiles are likely to evolve over time and profile designers
will 
release different versions of their profiles. For example, the
TOSCA 
Simple Profile has gone through minor revisions with each release of
the 
TOSCA Version 1 standard. It is expected that profile designers will
use 
a version qualifier to distinguish between different versions of
their 
profiles, and service template designers must use the proper string
name 
to make sure they import the desired versions of these profiles.</p>
<blockquote>
<p>Do we impose a structure on profile names that distinguishes the
version 
qualifier from the base profile name? If so, is there a specific 
separator character or string (in which case the use of the
separator 
must be escaped somehow (or disallowed) in profile names.</p>
</blockquote>
<p>When multiple versions of the same profile exist, it is possibly
that 
service templates could mix and match different versions of a profile
in 
the same service definition. The following code snippets illustrate
this 
scenario:</p>
<p>Assume a profile designer creates version 1 of a base profile
that 
defines (among other things) a <strong>Host</strong> capability type and
a 
corresponding <strong>HostedOn</strong> relationship type as
follows:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb32-1"><a aria-hidden="true" href="#cb32-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb32-2"><a aria-hidden="true" href="#cb32-2" tabindex="-1"></a><span class="fu">profile</span><span class="kw">:</span><span class="at"> org.base:v1</span></span>
<span id="cb32-3"><a aria-hidden="true" href="#cb32-3" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb32-4"><a aria-hidden="true" href="#cb32-4" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb32-5"><a aria-hidden="true" href="#cb32-5" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Hosting capability</span></span>
<span id="cb32-6"><a aria-hidden="true" href="#cb32-6" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb32-7"><a aria-hidden="true" href="#cb32-7" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb32-8"><a aria-hidden="true" href="#cb32-8" tabindex="-1"></a><span class="at">    </span><span class="fu">valid_capability_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> Host </span><span class="kw">]</span></span></code></pre></div>
<p>Now let’s assume a different profile designer creates a 
platform-specific profile that defines (among other things) a 
<strong>Platform</strong> node type. The Platform node type defines a
capability of 
type <strong>Host</strong>. Since the <strong>Host</strong> capability
is defined in the 
<strong>org.base:v1</strong> profile, that profile must be imported as
shown in the 
snippet below:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb33-1"><a aria-hidden="true" href="#cb33-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb33-2"><a aria-hidden="true" href="#cb33-2" tabindex="-1"></a><span class="fu">profile</span><span class="kw">:</span><span class="at"> org.platform</span></span>
<span id="cb33-3"><a aria-hidden="true" href="#cb33-3" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb33-4"><a aria-hidden="true" href="#cb33-4" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">profile</span><span class="kw">:</span><span class="at"> org.base:v1</span></span>
<span id="cb33-5"><a aria-hidden="true" href="#cb33-5" tabindex="-1"></a><span class="at">    </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> p1</span></span>
<span id="cb33-6"><a aria-hidden="true" href="#cb33-6" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb33-7"><a aria-hidden="true" href="#cb33-7" tabindex="-1"></a><span class="at">  </span><span class="fu">Platform</span><span class="kw">:</span></span>
<span id="cb33-8"><a aria-hidden="true" href="#cb33-8" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb33-9"><a aria-hidden="true" href="#cb33-9" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb33-10"><a aria-hidden="true" href="#cb33-10" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> p1:Host</span></span></code></pre></div>
<p>At some later point of time, the original profile designer updates
the 
<strong>org.base</strong> profile to Version 2. The updated version of
this profile 
just adds a <strong>Credential</strong> data type (in addition to
defining the 
<strong>Host</strong> capability type and the <strong>HostedOn</strong>
relationship type), as 
follows:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb34-1"><a aria-hidden="true" href="#cb34-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb34-2"><a aria-hidden="true" href="#cb34-2" tabindex="-1"></a><span class="fu">profile</span><span class="kw">:</span><span class="at"> org.base:v2</span></span>
<span id="cb34-3"><a aria-hidden="true" href="#cb34-3" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb34-4"><a aria-hidden="true" href="#cb34-4" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb34-5"><a aria-hidden="true" href="#cb34-5" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Hosting capability</span></span>
<span id="cb34-6"><a aria-hidden="true" href="#cb34-6" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb34-7"><a aria-hidden="true" href="#cb34-7" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb34-8"><a aria-hidden="true" href="#cb34-8" tabindex="-1"></a><span class="at">    </span><span class="fu">valid_capability_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> Host </span><span class="kw">]</span></span>
<span id="cb34-9"><a aria-hidden="true" href="#cb34-9" tabindex="-1"></a><span class="fu">data_types</span><span class="kw">:</span></span>
<span id="cb34-10"><a aria-hidden="true" href="#cb34-10" tabindex="-1"></a><span class="at">  </span><span class="fu">Credential</span><span class="kw">:</span></span>
<span id="cb34-11"><a aria-hidden="true" href="#cb34-11" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb34-12"><a aria-hidden="true" href="#cb34-12" tabindex="-1"></a><span class="at">      </span><span class="fu">key</span><span class="kw">:</span></span>
<span id="cb34-13"><a aria-hidden="true" href="#cb34-13" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span></code></pre></div>
<p>Finally, let’s assume a service designer creates a template for
a 
service that is to be hosted on the platform defined in the 
<strong>org.platform</strong> profile. The template introduces a
<strong>Service</strong> node 
type that has a requirement for the platform’s <strong>Host</strong>
capability. It 
also has a credential property of type <strong>Credential</strong> as
defined in 
<strong>org.base:v2</strong>:</p>
<pre><code>tosca_definitions_version: tosca_2_0
imports:
  - profile: org.base:v2
    namespace: p2
  - profile: org.platform
    namespace: pl
node_types:
  Service:
    properties:
      credential:
        type: p2:Credential
    requirements:
      - host:
          capability: p2:Host
          relationship: p2:HostedOn
service_template:
  node_templates:
    service:
      type: Service
      properties:
        credential:
          key: password
      requirements:
        - host: platform
    platform:
      type: pl:Platform</code></pre>
<p>This service template is invalid, since the <strong>platform</strong>
node template 
does not define a capability of a type that is compatible with the 
<strong>valid_capability_types</strong> specified by the
<strong>host</strong> requirement in the 
<strong>service</strong> node template. TOSCA grammar extensions are
needed to 
specify that the <strong>Host</strong> capability type defined in
<strong>org.base:v2</strong> is 
the same as the <strong>Host</strong> capability type defined in
<strong>org.base:v1</strong></p>
<p>The example in this section illustrates a general version
compatibility 
issue that exists when different versions of the same profile are
used 
in a TOSCA service.</p>
<blockquote>
<p>A number of suggestions for these extensions are currently
being 
discussed. Grammar extensions will be included in this document one
they 
are agreed upon.</p>
</blockquote>
<h2 id="imports-and-namespaces">6.8 Imports and Namespaces</h2>
<p>Modern software projects typically use <em>modular designs</em> that
divide 
large systems into smaller subsystems (<em>modules</em>) that
together 
achieve complete system functionality. TOSCA includes a number of 
features in support of functionality, including the ability for a 
TOSCA file to <em>import</em> TOSCA definitions from another TOSCA file.
For 
example, a first TOSCA file could contain reusable TOSCA type 
definitions (e.g., node types, relationship types, artifact types, 
etc.), function definitions, or repository definitions created by
a 
domain expert. A system integrator could create a second TOSCA
file 
that defines a <em>service template</em> comprised of node templates
and 
relationship templates that use those types. TOSCA supports this 
scenario by allowing the second TOSCA file to <em>import</em> the first
TOSCA 
file, thereby making the definitions in the first file available
to 
the second file. This mechanism provides an effective way for 
companies and organizations to define domain-specific types and/or 
describe their software applications for reuse in other TOSCA files.</p>
<h3 id="import-definitions">6.8.1 Import Definitions</h3>
<!----
{"id": "350", "author": "Calin Curescu", "date": "2019-01-30T15:54:00Z", "comment": "It would be good to allow also the import of specific types (via their fully qualified names) and also entire namespaces (i.e. types from entire namespaces) from a/the catalogue. That is, in addition to importing from a file: Globally well-known Local catalog File", "target": "Import definition"}-->
<p><em>Import definitions</em> are used within a TOSCA file to uniquely
identify 
and locate other TOSCA files that have type, repository, and
function 
definitions to be imported (included) into this TOSCA file. Import 
definitions are defined in a TOSCA file using the optional
<code>imports</code> 
keyname as follows:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb36-1"><a aria-hidden="true" href="#cb36-1" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb36-2"><a aria-hidden="true" href="#cb36-2" tabindex="-1"></a><span class="at">   </span><span class="kw">-</span><span class="at"> &lt;import_definition_1&gt;</span></span>
<span id="cb36-3"><a aria-hidden="true" href="#cb36-3" tabindex="-1"></a><span class="at">   </span><span class="kw">-</span><span class="at"> ...</span></span>
<span id="cb36-4"><a aria-hidden="true" href="#cb36-4" tabindex="-1"></a><span class="at">   </span><span class="kw">-</span><span class="at"> &lt;import_definition_n&gt;</span></span></code></pre></div>
<p>The value of the <code>imports</code> keyname consists of a list of
import 
definitions that identify the TOSCA files to be imported. The 
following is the list of recognized keynames for a TOSCA import 
definition:</p>
<!----
{"id": "351", "author": "Chris Lauwers", "date": "2020-09-01T00:21:00Z", "comment": "I think it should be illegal to import a\nservice template that contains a topology\ntemplate.", "target": ""}-->
<!----
{"id": "352", "author": "Matt Rutkowski", "date": "2016-09-06T09:49:00Z", "comment": "Nodejs has NPM that uses the following to\nimport new package modules:  \nA package is:  \na) a folder containing a program described by a\n[package.json](numbering.xml) file  \nb) a gzipped tarball containing (a)  \nc) a url that resolves to (b)  \nd) a \\<name\\>@\\<version\\> that is published on the registry (see\n[npm-registry](styles.xml)) with (c)  \ne) a \\<name\\>@\\<tag\\> (see [npm-dist-tag](settings.xml)) that points to\n(d)  \nf) a \\<name\\> that has a \"latest\" tag satisfying (e)  \ng) a \\<git remote url\\> that resolves to (a)  \nwe may want to adopt something similar if TOSCA references service\ntemplate (packages) from a\ncatalog)", "target": "imported"}-->
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">url</td>
<td style="text-align: left;">conditional</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The url that references a TOSCA file to be
imported. An import statement must include either a url or a profile,
but not both.</td>
</tr>
<tr class="even">
<td style="text-align: left;">profile</td>
<td style="text-align: left;">conditional</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The profile name that references a named
type profile to be imported. An import statement must include either a
url or a profile, but not both.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">repository</td>
<td style="text-align: left;">conditional</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional symbolic name of the
repository definition where the imported file can be found as a string.
The repository name can only be used when a url is specified.</td>
</tr>
<tr class="even">
<td style="text-align: left;">namespace</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional name of the namespace into
which to import the type definitions from the imported template or
profile.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Declares a description for the import
definition.</td>
</tr>
<tr class="even">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of YAML values</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information about the import definition.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used to import individual TOSCA files using
the 
following grammar:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb37-1"><a aria-hidden="true" href="#cb37-1" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span><span class="at">  </span></span>
<span id="cb37-2"><a aria-hidden="true" href="#cb37-2" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> &lt;file_uri&gt;</span></span>
<span id="cb37-3"><a aria-hidden="true" href="#cb37-3" tabindex="-1"></a><span class="at">    </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> &lt;repository_name&gt;</span></span>
<span id="cb37-4"><a aria-hidden="true" href="#cb37-4" tabindex="-1"></a><span class="at">    </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> &lt;namespace_name&gt;</span></span></code></pre></div>
<p>The following grammar can be used for importing TOSCA 
profiles:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb38-1"><a aria-hidden="true" href="#cb38-1" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span><span class="at">  </span></span>
<span id="cb38-2"><a aria-hidden="true" href="#cb38-2" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">profile</span><span class="kw">:</span><span class="at"> &lt;profile_name&gt;   </span></span>
<span id="cb38-3"><a aria-hidden="true" href="#cb38-3" tabindex="-1"></a><span class="at">    </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> &lt;namespace_name&gt;</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li>file_uri: contains the URL that references the service template
file<br/>
to be imported as a string.</li>
<li>repository_name: represents the optional symbolic name of the<br/>
repository definition where the imported file can be found as a<br/>
string</li>
<li>profile_name: the name of the well-known profile to be
imported.</li>
<li>namespace_name: represents the optional name of the namespace
into<br/>
which type definitions will be imported. The namespace name can be<br/>
used to form a namespace-qualified name that uniquely references
type<br/>
definitions from the imported file or profile. If no namespace name
is<br/>
specified, type definitions will be imported into the root
namespace.</li>
</ul>
<p>If only the <file_uri> needs to be specified, import definitions
can 
also use a single-line grammar as follows:</file_uri></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb39-1"><a aria-hidden="true" href="#cb39-1" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb39-2"><a aria-hidden="true" href="#cb39-2" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;file_uri_1&gt;</span></span>
<span id="cb39-3"><a aria-hidden="true" href="#cb39-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;file_uri_2&gt;</span></span></code></pre></div>
<h3 id="import-processing-rules">6.8.2 Import Processing Rules</h3>
<p>TOSCA processors and tooling MUST handle import statements as
follows:</p>
<h4 id="importing-profiles">6.8.2.1 Importing Profiles</h4>
<p>If the <code>profile</code> keyname is used in the import definition,
then the 
TOSCA processor SHOULD attempt to import the profile by name:</p>
<ul>
<li>If <profile_name> represents the name of a profile that is known
to<br/>
the TOSCA processor, then it SHOULD cause that profile’s type<br/>
definitions to be imported.</profile_name></li>
<li>If <profile_name> is not known, the import SHOULD be considered
a<br/>
failure.</profile_name></li>
</ul>
<h4 id="importing-tosca-file">6.8.2.2 Importing TOSCA File</h4>
<p>If the <code>url</code> keyname is used, the TOSCA processor SHOULD
attempt to 
import the file referenced by <file_uri> as follows:</file_uri></p>
<ul>
<li><p>If the &lt;file_uri&gt; includes a URL scheme (e.g. file: or <a href="https:)">https:)</a> <br/> 
then&lt;file_uri&gt; is considered to be a network accessible 
resource. If the resource identified by &lt;file_URL&gt; represents
a 
valid TOSCA file, then it SHOULD cause that TOSCA file to be 
imported.</p>
<ul>
<li>Note that if in addition to a URL with a URL scheme, the
import<br/>
definition also specifies a &lt;repository_name&gt; (using the
repository<br/>
key), then that import definition SHOULD be considered invalid.</li>
</ul></li>
<li><p>If the &lt;file_uri&gt; does not include a URL scheme, it is
considered 
a relative path URL. The TOSCA processor SHOULD handle such a 
&lt;file_uri&gt; as follows:</p>
<ul>
<li><p>If the import definition also specifies a &lt;repository_name&gt;
(using 
the repository keyname), then &lt;file_uri&gt; refers to the path name
of 
a file relative to the root of the named repository</p></li>
<li><p>If the import definition does not specify a &lt;profile_name&gt;
then 
&lt;file_uri&gt; refers to a TOSCA file located in the repository
that 
contains the TOSCA file that includes the import definition. If 
the importing TOSCA file is located in a CSAR file, then that CSAR 
file should be treated as the repository in which to locate the 
TOSCA file that must be imported.</p>
<ul>
<li><p>If &lt;file_uri&gt; starts with a leading slash (‘/’) then
&lt;file_uri&gt; 
specifies a path name starting at the root of the repository.</p></li>
<li><p>If &lt;file_uri&gt; does not start with a leading slash, then
&lt;file_uri&gt; 
specifies a path that is relative to the importing document’s
location 
within the repository. Double dot notation (‘../’) can be used to 
refer to parent directories in a file path name.</p></li>
</ul></li>
</ul></li>
<li><p>If &lt;file_uri&gt; does not reference a valid TOSCA file file,
then the 
import SHOULD be considered a failure.</p></li>
</ul>
<h3 id="examples">6.8.3 Examples</h3>
<p>The first example shows how to use an import definition import
a 
well-known profile by name:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb40-1"><a aria-hidden="true" href="#cb40-1" tabindex="-1"></a><span class="co"># Importing a profile</span></span>
<span id="cb40-2"><a aria-hidden="true" href="#cb40-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb40-3"><a aria-hidden="true" href="#cb40-3" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">profile</span><span class="kw">:</span><span class="at"> org.oasis-open.tosca.simple:2.0</span></span></code></pre></div>
<p>The next example shows an import definition used to import a network-accessible resource using the <a href="https">https</a> protocol: <br/></p>
<div class="sourceCode" id="cb41"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb41-1"><a aria-hidden="true" href="#cb41-1" tabindex="-1"></a><span class="co"># Absolute URL with scheme</span></span>
<span id="cb41-2"><a aria-hidden="true" href="#cb41-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb41-3"><a aria-hidden="true" href="#cb41-3" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> https://myorg.org/tosca/types/mytypes.yaml</span></span></code></pre></div>
<p>The following shows an import definition used to import a TOSCA
file 
located in the same repository as the importing file. The file to
be 
imported is referenced using a path name that is relative to the 
location of the importing file. This example shows the short
notation:</p>
<pre><code># Short notation supported
imports:
- ../types/mytypes.yaml </code></pre>
<p>The following shows the same example but using the long notation:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb43-1"><a aria-hidden="true" href="#cb43-1" tabindex="-1"></a><span class="co"># Long notation</span></span>
<span id="cb43-2"><a aria-hidden="true" href="#cb43-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb43-3"><a aria-hidden="true" href="#cb43-3" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> ../types/mytypes.yaml</span></span></code></pre></div>
<p>The following example mixes short-notation and 
long-notation import definitions:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb44-1"><a aria-hidden="true" href="#cb44-1" tabindex="-1"></a><span class="co"># Short notation and long notation supported</span></span>
<span id="cb44-2"><a aria-hidden="true" href="#cb44-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb44-3"><a aria-hidden="true" href="#cb44-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> relative_path/my_defns/my_typesdefs_1.yaml</span></span>
<span id="cb44-4"><a aria-hidden="true" href="#cb44-4" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> my_defns/my_typesdefs_n.yaml    </span></span>
<span id="cb44-5"><a aria-hidden="true" href="#cb44-5" tabindex="-1"></a><span class="at">    </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> my_company_repo</span></span>
<span id="cb44-6"><a aria-hidden="true" href="#cb44-6" tabindex="-1"></a><span class="at">    </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> mycompany</span></span></code></pre></div>
<p>The following example shows how to import TOSCA files using
absolute 
path names (i.e. path names that start at the root of the
repository):</p>
<pre><code># Root file
imports:
- url: /base.yaml</code></pre>
<p>And finally, the following shows how to import TOSCA files from
a 
repository that is different than the repository that contains the 
importing TOSCA file:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb46-1"><a aria-hidden="true" href="#cb46-1" tabindex="-1"></a><span class="co"># External repository</span></span>
<span id="cb46-2"><a aria-hidden="true" href="#cb46-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb46-3"><a aria-hidden="true" href="#cb46-3" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> types/mytypes.yaml</span></span>
<span id="cb46-4"><a aria-hidden="true" href="#cb46-4" tabindex="-1"></a><span class="at">  </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> my_repository</span></span></code></pre></div>
<h3 id="namespaces">6.8.4 Namespaces</h3>
<!----
{"id": "373", "author": "Chris Lauwers", "date": "2020-09-01T00:19:00Z", "comment": "I recommend removing this entire section and rewriting any parts that are still relevant inside the \u201cimports\u201d section.", "target": "Namespace"}-->
<p>When importing TOSCA files or TOSCA profiles, there exists a 
possibility for name collision. For example, an imported file may 
define a node type with the same name as a node type defined in
the 
importing file.</p>
<p>For example, let say we have two TOSCA files, A and B, both of
which 
contain a node type definition for <em>MyNode</em>:</p>
<p><strong>TOSCA File B</strong></p>
<pre><code>tosca_definitions_version: tosca_2_0
description: TOSCA File B
  
node_types:
  MyNode:
    derived_from: SoftwareComponent
    properties:
      # omitted here for brevity 
    capabilities:
      # omitted here for brevity</code></pre>
<p><strong>TOSCA File A</strong></p>
<pre><code>tosca_definitions_version: tosca_2_0
description: TOSCA File A
imports:
  - url: /templates/TOSCAFileB.yaml
node_types:
  MyNode:
    derived_from: Root
    properties:
      # omitted here for brevity 
    capabilities:
      # omitted here for brevity
service_template:
  node_templates:
    my_node:
      type: MyNode</code></pre>
<p>As you can see, TOSCA file A imports TOSCA file B which results
in 
duplicate definitions of the MyNode node type. In this example, it
is 
not clear which type is intended to be used for the my_node node 
template.</p>
<p>To address this issue, TOSCA uses the concept of namespaces:</p>
<ul>
<li><p>Each TOSCA file defines a root namespace for all type
definitions 
defined in that file. Root namespaces are unnamed.</p></li>
<li><p>When a TOSCA file imports other TOSCA files, it has two
options:</p>
<ul>
<li><p>It can import any type definitions from the imported TOSCA
files 
into its root namespace.</p></li>
<li><p>Or it can import type definitions from the imported TOSCA
files 
into a separate named namespace. This is done using the 
<code>namespace</code> keyname in the associated import definition.
When 
using types imported into a named namespace, those type names must 
be qualified by using the namespace name as a prefix.</p></li>
</ul></li>
</ul>
<p>The following snippets update the previous example using namespaces
to 
disambiguate between the two MyNode type definitions. This first
snippet 
shows the scenario where the MyNode definition from TOSCA file B
is 
intended to be used:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb49-1"><a aria-hidden="true" href="#cb49-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb49-2"><a aria-hidden="true" href="#cb49-2" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> TOSCA file A</span></span>
<span id="cb49-3"><a aria-hidden="true" href="#cb49-3" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb49-4"><a aria-hidden="true" href="#cb49-4" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> /templates/TOSCAFileB.yaml</span></span>
<span id="cb49-5"><a aria-hidden="true" href="#cb49-5" tabindex="-1"></a><span class="at">    </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> fileB</span></span>
<span id="cb49-6"><a aria-hidden="true" href="#cb49-6" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb49-7"><a aria-hidden="true" href="#cb49-7" tabindex="-1"></a><span class="at">  </span><span class="fu">MyNode</span><span class="kw">:</span></span>
<span id="cb49-8"><a aria-hidden="true" href="#cb49-8" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> Root</span></span>
<span id="cb49-9"><a aria-hidden="true" href="#cb49-9" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb49-10"><a aria-hidden="true" href="#cb49-10" tabindex="-1"></a><span class="co">      # omitted here for brevity </span></span>
<span id="cb49-11"><a aria-hidden="true" href="#cb49-11" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb49-12"><a aria-hidden="true" href="#cb49-12" tabindex="-1"></a><span class="co">      # omitted here for brevity</span></span>
<span id="cb49-13"><a aria-hidden="true" href="#cb49-13" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb49-14"><a aria-hidden="true" href="#cb49-14" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb49-15"><a aria-hidden="true" href="#cb49-15" tabindex="-1"></a><span class="at">    </span><span class="fu">my_node</span><span class="kw">:</span></span>
<span id="cb49-16"><a aria-hidden="true" href="#cb49-16" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> fileB:MyNode</span></span></code></pre></div>
<p>The second snippet shows the scenario where the MyNode definition
from 
TOSCA file A is intended to be used:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb50-1"><a aria-hidden="true" href="#cb50-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb50-2"><a aria-hidden="true" href="#cb50-2" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> TOSCA file A</span></span>
<span id="cb50-3"><a aria-hidden="true" href="#cb50-3" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb50-4"><a aria-hidden="true" href="#cb50-4" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> /templates/TOSCAFileB.yaml</span></span>
<span id="cb50-5"><a aria-hidden="true" href="#cb50-5" tabindex="-1"></a><span class="at">    </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> fileB</span></span>
<span id="cb50-6"><a aria-hidden="true" href="#cb50-6" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb50-7"><a aria-hidden="true" href="#cb50-7" tabindex="-1"></a><span class="at">  </span><span class="fu">MyNode</span><span class="kw">:</span></span>
<span id="cb50-8"><a aria-hidden="true" href="#cb50-8" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> Root</span></span>
<span id="cb50-9"><a aria-hidden="true" href="#cb50-9" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb50-10"><a aria-hidden="true" href="#cb50-10" tabindex="-1"></a><span class="co">      # omitted here for brevity </span></span>
<span id="cb50-11"><a aria-hidden="true" href="#cb50-11" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb50-12"><a aria-hidden="true" href="#cb50-12" tabindex="-1"></a><span class="co">      # omitted here for brevity</span></span>
<span id="cb50-13"><a aria-hidden="true" href="#cb50-13" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb50-14"><a aria-hidden="true" href="#cb50-14" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb50-15"><a aria-hidden="true" href="#cb50-15" tabindex="-1"></a><span class="at">    </span><span class="fu">my_node</span><span class="kw">:</span></span>
<span id="cb50-16"><a aria-hidden="true" href="#cb50-16" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> MyNode</span></span></code></pre></div>
<p>In many scenarios, imported TOSCA files may in turn import their
own 
TOSCA files, and introduce their own namespaces to avoid name 
collisions. In those scenarios, nested namespace names are used to 
uniquely identify type definitions in the import tree.</p>
<p>The following example shows a mytypes.yaml TOSCA file that imports
a 
Kubernetes profile into the k8s namespace. It defines a SuperPod
node 
type that derives from the Pod node type defined in that
Kubernetes 
profile:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb51-1"><a aria-hidden="true" href="#cb51-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb51-2"><a aria-hidden="true" href="#cb51-2" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> mytypes.yaml</span></span>
<span id="cb51-3"><a aria-hidden="true" href="#cb51-3" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb51-4"><a aria-hidden="true" href="#cb51-4" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">profile</span><span class="kw">:</span><span class="at"> io.kubernetes:1.30</span></span>
<span id="cb51-5"><a aria-hidden="true" href="#cb51-5" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> k8s</span></span>
<span id="cb51-6"><a aria-hidden="true" href="#cb51-6" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb51-7"><a aria-hidden="true" href="#cb51-7" tabindex="-1"></a><span class="at">  </span><span class="fu">MyNode</span><span class="kw">:</span><span class="at"> </span><span class="kw">{}</span></span>
<span id="cb51-8"><a aria-hidden="true" href="#cb51-8" tabindex="-1"></a><span class="at">  </span><span class="fu">SuperPod</span><span class="kw">:</span></span>
<span id="cb51-9"><a aria-hidden="true" href="#cb51-9" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> k8s:Pod</span></span></code></pre></div>
<p>The mytypes.yaml file is then imported into the main.yaml TOSCA 
file, which defines both a node template of type SuperPod as well as
a 
node template of type Pod. Nested namespace names are used to
identify 
the Pod node type from the Kubernetes profile:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb52-1"><a aria-hidden="true" href="#cb52-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb52-2"><a aria-hidden="true" href="#cb52-2" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> main.yaml</span></span>
<span id="cb52-3"><a aria-hidden="true" href="#cb52-3" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb52-4"><a aria-hidden="true" href="#cb52-4" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">url</span><span class="kw">:</span><span class="at"> mytypes.yaml</span></span>
<span id="cb52-5"><a aria-hidden="true" href="#cb52-5" tabindex="-1"></a><span class="at">  </span><span class="fu">namespace</span><span class="kw">:</span><span class="at"> my</span></span>
<span id="cb52-6"><a aria-hidden="true" href="#cb52-6" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb52-7"><a aria-hidden="true" href="#cb52-7" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb52-8"><a aria-hidden="true" href="#cb52-8" tabindex="-1"></a><span class="at">    </span><span class="fu">mynode</span><span class="kw">:</span></span>
<span id="cb52-9"><a aria-hidden="true" href="#cb52-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> my:MyType</span></span>
<span id="cb52-10"><a aria-hidden="true" href="#cb52-10" tabindex="-1"></a><span class="at">    </span><span class="fu">pod</span><span class="kw">:</span></span>
<span id="cb52-11"><a aria-hidden="true" href="#cb52-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> my:k8s:Pod</span></span></code></pre></div>
<p>Within each namespace (including the unnamed root namespace),
names 
must be unique. This means that duplicate local names (i.e.,
within 
the same TOSCA file SHALL be considered an error. These include,
but 
are not limited to duplicate names found for the following 
definitions:</p>
<ul>
<li>Repositories (<code>repositories</code>)</li>
<li>Data Types (<code>data_types</code>)</li>
<li>Node Types (<code>node_types</code>)</li>
<li>Relationship Types (<code>relationship_types</code>)</li>
<li>Capability Types (<code>capability_types</code>)</li>
<li>Artifact Types (<code>artifact_types</code>)</li>
<li>Interface Types (<code>interface_types</code>)</li>
<li>Policy Types (<code>policy_types</code>)</li>
<li>Group Types (<code>group_types</code>)</li>
<li>Function definitions (<code>functions</code>)</li>
</ul>
<h2 id="service-template-definition">6.9 Service Template
Definition</h2>
<p>This section defines the service template of a TOSCA file. The
main 
ingredients of the service template are node templates
representing 
components of the application and relationship templates
representing 
links between the components. These elements are defined in the
nested 
<code>node_templates</code> section and the nested
<code>relationship_templates</code> 
sections, respectively. Furthermore, a service template allows for 
defining input parameters, output parameters, workflows as well as 
grouping of node templates and associated policies.</p>
<h3 id="service-template-grammar">6.9.1 Service Template Grammar</h3>
<p>The following is the list of recognized keynames for a TOSCA
service 
template:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional description for the service
template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of YAML values</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information about this service template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter definitions</td>
<td style="text-align: left;">An optional map of input parameters (i.e.,
as parameter definitions) for the service template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">node_templates</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">map of node templates</td>
<td style="text-align: left;">A mandatory map of node template
definitions for the service template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">relationship_templates</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of relationship templates</td>
<td style="text-align: left;">An optional map of relationship templates
for the service template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">groups</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of group definitions</td>
<td style="text-align: left;">An optional map of Group definitions whose
members are node templates defined within this same service
template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">workflows</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of workflow definitions</td>
<td style="text-align: left;">An optional map of workflow definitions
for the service template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">policies</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of policy definitions</td>
<td style="text-align: left;">An optional list of policy definitions for
the service template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">outputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter definitions</td>
<td style="text-align: left;">An optional map of output parameters
(i.e., as parameter definitions) for the service template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">substitution_mappings</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">substitution_mapping</td>
<td style="text-align: left;">An optional declaration that exports the
service template as an implementation of a Node type. This also includes
the mappings between the external node type’s capabilities and
requirements to existing implementations of those capabilities and
requirements on node templates declared within the service
template.</td>
</tr>
</tbody>
</table>
<p>The overall grammar of the service_template section is shown 
below. Detailed grammar definitions are provided in subsequent 
subsections.</p>
<pre><code>service_template:
  description: &lt;template_description&gt;
  metadata: &lt;metadata definition&gt;
  inputs: &lt;input_parameters&gt;
  outputs: &lt;output_parameters&gt;
  node_templates: &lt;node_templates&gt;
  relationship_templates: &lt;relationship_templates&gt;
  workflows : &lt;workflow_definitions&gt;
  groups: &lt;group_definitions&gt;
  policies: 
    - &lt;policy_definition_list&gt;
  substitution_mappings:
    &lt;substitution_mappings&gt;</code></pre>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>input_parameters: represents the optional map of input
parameter 
definitions for the service template.</p></li>
<li><p>output_parameters: represents the optional map of output
parameter 
definitions for the service template.</p></li>
<li><p>group_definitions: represents the optional map of group
definitions 
whose members are node templates that also are defined within this 
service template.</p></li>
<li><p>policy_definition_list: represents the optional ordered list
of 
policy definitions for the service template.</p></li>
<li><p>workflow_definitions: represents the optional map of
imperative 
workflow definitions for the service template.</p></li>
<li><p>node_templates: represents the mandatory map of node
template 
definitions for the service template.</p></li>
<li><p>relationship_templates: represents the optional map of
relationship 
templates for the service template.</p></li>
<li><p>substitution_mappings: defines how services created from
this 
template can substitute other nodes.</p></li>
</ul>
<p>Note that duplicate template names within a service template SHALL
be 
considered an error. These include, but are not limited to
duplicate 
names found for the following template types:</p>
<ul>
<li>Node Templates (node_templates)</li>
<li>Relationship Templates (relationship_templates)</li>
<li>Inputs (inputs)</li>
<li>Outputs (outputs)</li>
<li>Workflows (workflows)</li>
<li>Policies (policies)</li>
<li>Groups (groups)</li>
</ul>
<p>More detailed explanations for each of the service template
grammar’s 
keynames appears in the sections below.</p>
<h3 id="input-parameters">6.9.2 Input Parameters</h3>
<p>The <code>inputs</code> section of a service template provides a
means to define 
parameters using TOSCA parameter definitions, their allowed values
via 
validation clauses and default values. Input parameters defined in the
inputs section of a service 
template can be mapped to properties of node templates or
relationship 
templates within the same service template and can thus be used
for 
parameterizing the instantiation of the service template.</p>
<p>When deploying a service from the service template, values must
be 
provided for all mandatory input parameters that have no default
value 
defined. If no input is provided, then the default value is used.</p>
<p>The grammar of the inputs section is as follows:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb54-1"><a aria-hidden="true" href="#cb54-1" tabindex="-1"></a><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb54-2"><a aria-hidden="true" href="#cb54-2" tabindex="-1"></a><span class="at">  &lt;parameter_definitions&gt;</span></span></code></pre></div>
<p>The following code snippet shows a simple inputs example without
any 
validation clause:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb55-1"><a aria-hidden="true" href="#cb55-1" tabindex="-1"></a><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb55-2"><a aria-hidden="true" href="#cb55-2" tabindex="-1"></a><span class="at">  </span><span class="fu">fooName</span><span class="kw">:</span></span>
<span id="cb55-3"><a aria-hidden="true" href="#cb55-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb55-4"><a aria-hidden="true" href="#cb55-4" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Simple string parameter without a validation clause.</span></span>
<span id="cb55-5"><a aria-hidden="true" href="#cb55-5" tabindex="-1"></a><span class="at">    </span><span class="fu">default</span><span class="kw">:</span><span class="at"> bar</span></span></code></pre></div>
<p>The following is an example of input parameter definitions with
a 
validation clause:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb56-1"><a aria-hidden="true" href="#cb56-1" tabindex="-1"></a><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb56-2"><a aria-hidden="true" href="#cb56-2" tabindex="-1"></a><span class="at">  </span><span class="fu">SiteName</span><span class="kw">:</span></span>
<span id="cb56-3"><a aria-hidden="true" href="#cb56-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb56-4"><a aria-hidden="true" href="#cb56-4" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> String parameter with validation clause.</span></span>
<span id="cb56-5"><a aria-hidden="true" href="#cb56-5" tabindex="-1"></a><span class="at">    </span><span class="fu">default</span><span class="kw">:</span><span class="at"> My Site</span></span>
<span id="cb56-6"><a aria-hidden="true" href="#cb56-6" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">9</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<h3 id="node-templates">6.9.3 Node Templates</h3>
<p>The <code>node_templates</code> section of a service template lists
the node 
templates that describe the components that are used to compose 
applications.</p>
<p>The grammar of the node_templates section is a follows:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb57-1"><a aria-hidden="true" href="#cb57-1" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb57-2"><a aria-hidden="true" href="#cb57-2" tabindex="-1"></a><span class="at">  &lt;node_template_defn_1&gt;</span></span>
<span id="cb57-3"><a aria-hidden="true" href="#cb57-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb57-4"><a aria-hidden="true" href="#cb57-4" tabindex="-1"></a><span class="at">  &lt;node_template_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example of a node_templates
section:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb58-1"><a aria-hidden="true" href="#cb58-1" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb58-2"><a aria-hidden="true" href="#cb58-2" tabindex="-1"></a><span class="at">  </span><span class="fu">my_webapp_node_template</span><span class="kw">:</span></span>
<span id="cb58-3"><a aria-hidden="true" href="#cb58-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> WebApplication</span></span>
<span id="cb58-4"><a aria-hidden="true" href="#cb58-4" tabindex="-1"></a></span>
<span id="cb58-5"><a aria-hidden="true" href="#cb58-5" tabindex="-1"></a><span class="at">  </span><span class="fu">my_database_node_template</span><span class="kw">:</span></span>
<span id="cb58-6"><a aria-hidden="true" href="#cb58-6" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Database</span></span></code></pre></div>
<h3 id="relationship-templates">6.9.4 Relationship Templates</h3>
<p>The <code>relationship_templates</code> section of a service template
lists the 
relationship templates that describe the relations between
components 
that are used to compose cloud applications. Note that the
explicit 
definition of relationship templates is optional, since
relationships 
between nodes get implicitly defined by referencing other node 
templates in the <code>requirements</code> sections of node
templates.</p>
<p>The grammar of the relationship_templates section is as follows:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb59-1"><a aria-hidden="true" href="#cb59-1" tabindex="-1"></a><span class="fu">relationship_templates</span><span class="kw">:</span></span>
<span id="cb59-2"><a aria-hidden="true" href="#cb59-2" tabindex="-1"></a><span class="at">  &lt;relationship_template_defn_1&gt;</span></span>
<span id="cb59-3"><a aria-hidden="true" href="#cb59-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb59-4"><a aria-hidden="true" href="#cb59-4" tabindex="-1"></a><span class="at">  &lt;relationship_template_defn_n&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example of a
relationship_templates section:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb60-1"><a aria-hidden="true" href="#cb60-1" tabindex="-1"></a><span class="fu">relationship_templates</span><span class="kw">:</span></span>
<span id="cb60-2"><a aria-hidden="true" href="#cb60-2" tabindex="-1"></a><span class="at">  </span><span class="fu">my_connects_to_relationship</span><span class="kw">:</span></span>
<span id="cb60-3"><a aria-hidden="true" href="#cb60-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ConnectsTo</span></span>
<span id="cb60-4"><a aria-hidden="true" href="#cb60-4" tabindex="-1"></a><span class="at">    </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb60-5"><a aria-hidden="true" href="#cb60-5" tabindex="-1"></a><span class="at">      </span><span class="fu">Configure</span><span class="kw">:</span></span>
<span id="cb60-6"><a aria-hidden="true" href="#cb60-6" tabindex="-1"></a><span class="at">        </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb60-7"><a aria-hidden="true" href="#cb60-7" tabindex="-1"></a><span class="at">          </span><span class="fu">speed</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$$get_attribute</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> SELF</span><span class="kw">,</span><span class="at"> SOURCE</span><span class="kw">,</span><span class="at"> connect_speed </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span><span class="at">      </span></span></code></pre></div>
<h3 id="output-parameters">6.9.5 Output Parameters</h3>
<p>The <code>outputs</code> section of a service template provides a
means to define 
the output parameters that are available from a deployed TOSCA 
service. It allows for exposing attributes defined in node
templates 
or relationship templates within the containing service_template
to 
users of a service.</p>
<p>The grammar of the outputs section is as follows:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb61-1"><a aria-hidden="true" href="#cb61-1" tabindex="-1"></a><span class="fu">outputs</span><span class="kw">:</span></span>
<span id="cb61-2"><a aria-hidden="true" href="#cb61-2" tabindex="-1"></a><span class="at">  &lt;parameter_definitions&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example of the outputs
section:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb62-1"><a aria-hidden="true" href="#cb62-1" tabindex="-1"></a><span class="fu">outputs</span><span class="kw">:</span></span>
<span id="cb62-2"><a aria-hidden="true" href="#cb62-2" tabindex="-1"></a><span class="at">  </span><span class="fu">server_address</span><span class="kw">:</span></span>
<span id="cb62-3"><a aria-hidden="true" href="#cb62-3" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> The first private IP address for the provisioned server.</span></span>
<span id="cb62-4"><a aria-hidden="true" href="#cb62-4" tabindex="-1"></a><span class="at">    </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_attribute</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> node5</span><span class="kw">,</span><span class="at"> networks</span><span class="kw">,</span><span class="at"> private</span><span class="kw">,</span><span class="at"> addresses</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<h3 id="workflow-definitions">6.9.6 Workflow Definitions</h3>
<p>The <code>workflows</code> section of a service template allows for
declaring 
imperative workflows that can operate on entities in the service 
template.</p>
<p>The grammar of the workflows section is as follows:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb63-1"><a aria-hidden="true" href="#cb63-1" tabindex="-1"></a><span class="fu">workflows</span><span class="kw">:</span></span>
<span id="cb63-2"><a aria-hidden="true" href="#cb63-2" tabindex="-1"></a><span class="at">  &lt;workflow_defn_1&gt;</span></span>
<span id="cb63-3"><a aria-hidden="true" href="#cb63-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb63-4"><a aria-hidden="true" href="#cb63-4" tabindex="-1"></a><span class="at">  &lt;workflow_defn_n&gt;</span></span></code></pre></div>
<p>The following example shows the definition of a workflow</p>
<pre><code>workflows:
  scaling_workflow:
    steps:
      TO BE PROVIDED</code></pre>
<h3 id="group-definitions">6.9.7 Group Definitions</h3>
<p>The <code>groups</code> section of a service template allows for
grouping node 
representations created from one or more node templates within a
TOSCA 
service template. This grouping can then be used to apply policies
to 
the group.</p>
<p>The grammar of the groups section is as follows:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb65-1"><a aria-hidden="true" href="#cb65-1" tabindex="-1"></a><span class="fu">groups</span><span class="kw">:</span></span>
<span id="cb65-2"><a aria-hidden="true" href="#cb65-2" tabindex="-1"></a><span class="at">  &lt;group_defn_1&gt;</span></span>
<span id="cb65-3"><a aria-hidden="true" href="#cb65-3" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb65-4"><a aria-hidden="true" href="#cb65-4" tabindex="-1"></a><span class="at">  &lt;group_defn_n&gt;</span></span></code></pre></div>
<p>The following example shows the definition of three Compute nodes in
the 
node_templates section of a service_template as well as the grouping
of 
two of the Compute nodes in a group server_group_1.</p>
<pre><code>node_templates:
  server1:
    type: Compute
    # more details ...
  server2:
    type: Compute
    # more details ...
  server3:
    type: Compute
    # more details ...
groups:
  # server2 and server3 are part of the same group
  server_group_1:
    type: mycompany.mytypes.myScalingGroup
    members: [ server2, server3 ]</code></pre>
<h3 id="policy-definitions">6.9.8 Policy Definitions</h3>
<p>The <code>policies</code> section of a service template allows for
declaring 
policies that can be applied to entities in the service template.</p>
<p>The grammar of the policies section is as follows:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb67-1"><a aria-hidden="true" href="#cb67-1" tabindex="-1"></a><span class="fu">policies</span><span class="kw">:</span></span>
<span id="cb67-2"><a aria-hidden="true" href="#cb67-2" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;policy_defn_1&gt;</span></span>
<span id="cb67-3"><a aria-hidden="true" href="#cb67-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> ...</span></span>
<span id="cb67-4"><a aria-hidden="true" href="#cb67-4" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;policy_defn_n&gt;</span></span></code></pre></div>
<p>The following example shows the definition of a placement policy.</p>
<pre><code>policies:
  - my_placement_policy:
      type: mycompany.placement</code></pre>
<h3 id="substitution-mapping">6.9.10 Substitution Mapping</h3>
<p>The <code>substitution_mappings</code>section of a service template
declares this 
service template as a candidate for substituting nodes marked with
the 
<code>substitute</code> directive in other service templates.</p>
<p>The grammar of a substitution_mapping is as follows:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb69-1"><a aria-hidden="true" href="#cb69-1" tabindex="-1"></a><span class="fu">substitution_mappings&gt;</span><span class="kw">:</span></span>
<span id="cb69-2"><a aria-hidden="true" href="#cb69-2" tabindex="-1"></a><span class="at">  &lt;substitution_mapping&gt;</span></span></code></pre></div>
<p>The following code snippet shows an example substitution mapping.</p>
<pre><code>service_template:
  inputs:
   cpus: 
     type: integer
     validation: { $less_than: [ $value, 5 ] }
  substitution_mappings:
    node_type: MyService
    properties:  
      num_cpus: cpus
    capabilities:
      bar: [ some_service, bar ]
    requirements:
      foo: [ some_service, foo ]
  node_templates:
    some_service:
      type: MyService
      properties: 
        rate: 100
      capabilities:
        bar:
          ...
      requirements:
        - foo: 
            ...</code></pre>
<hr/>
<h1 id="nodes-and-relationships">7 Nodes and Relationships</h1>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative. 
## 7.1 Node Type</p>
<p>A <em>node type</em> is a reusable entity that defines the structure
of 
observable properties and attributes of a node, the capabilities
and 
requirements of that node, as well as its supported interfaces and
the 
artifacts it uses.</p>
<p>A node type definition is a type of TOSCA type definition and as
a 
result supports the common keynames listed in <a href="#641-common-keynames-in-type-definitions">Section 
6.4.1</a>. In addition, the 
node type definition has the following recognized keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property definitions</td>
<td style="text-align: left;">An optional map of property definitions
for the node type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute definitions</td>
<td style="text-align: left;">An optional map of attribute definitions
for the node type.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">capabilities</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of capability definitions</td>
<td style="text-align: left;">An optional map of capability definitions
for the node type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">requirements</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of requirement definitions</td>
<td style="text-align: left;">An optional list of requirement
definitions for the node type.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">interfaces</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of interface definitions</td>
<td style="text-align: left;">An optional map of interface definitions
supported by the node type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">artifacts</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of artifact definitions</td>
<td style="text-align: left;">An optional map of artifact definitions
for the node type.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb71-1"><a aria-hidden="true" href="#cb71-1" tabindex="-1"></a><span class="fu">&lt;node_type_name&gt;</span><span class="kw">:</span><span class="at">  </span></span>
<span id="cb71-2"><a aria-hidden="true" href="#cb71-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;parent_node_type_name&gt; </span></span>
<span id="cb71-3"><a aria-hidden="true" href="#cb71-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb71-4"><a aria-hidden="true" href="#cb71-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb71-5"><a aria-hidden="true" href="#cb71-5" tabindex="-1"></a><span class="at">    &lt;map of string&gt;</span></span>
<span id="cb71-6"><a aria-hidden="true" href="#cb71-6" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;node_type_description&gt;</span></span>
<span id="cb71-7"><a aria-hidden="true" href="#cb71-7" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb71-8"><a aria-hidden="true" href="#cb71-8" tabindex="-1"></a><span class="at">    &lt;property_definitions&gt;</span></span>
<span id="cb71-9"><a aria-hidden="true" href="#cb71-9" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb71-10"><a aria-hidden="true" href="#cb71-10" tabindex="-1"></a><span class="at">    &lt;attribute_definitions&gt;</span></span>
<span id="cb71-11"><a aria-hidden="true" href="#cb71-11" tabindex="-1"></a><span class="at">  </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb71-12"><a aria-hidden="true" href="#cb71-12" tabindex="-1"></a><span class="at">    &lt;capability_definitions&gt;</span></span>
<span id="cb71-13"><a aria-hidden="true" href="#cb71-13" tabindex="-1"></a><span class="at">  </span><span class="fu">requirements</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb71-14"><a aria-hidden="true" href="#cb71-14" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> &lt;requirement_definitions&gt;</span></span>
<span id="cb71-15"><a aria-hidden="true" href="#cb71-15" tabindex="-1"></a><span class="at">  </span><span class="fu">interfaces</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb71-16"><a aria-hidden="true" href="#cb71-16" tabindex="-1"></a><span class="at">    &lt;interface_definitions&gt; </span></span>
<span id="cb71-17"><a aria-hidden="true" href="#cb71-17" tabindex="-1"></a><span class="at">  </span><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb71-18"><a aria-hidden="true" href="#cb71-18" tabindex="-1"></a><span class="at">    &lt;artifact_definitions&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>node_type_name: represents the mandatory symbolic name of the
node 
type being declared.</p></li>
<li><p>parent_node_type_name: represents the name (string) of the node
type 
from which this node type definition derives (i.e. its parent 
type). Parent node types names can be qualified using a namespace 
prefix.</p></li>
<li><p>property_definitions: represents the optional map of
property 
definitions for the node type.</p></li>
<li><p>attribute_definitions: represents the optional map of
attribute 
definitions for the node type.</p></li>
<li><p>capability_definitions: represents the optional map of
capability 
definitions for the node type.</p></li>
<li><p>requirement_definitions: represents the optional list of
requirement 
definitions for the node type. Note that requirements are 
intentionally expressed as a list of TOSCA Requirement definitions 
that <strong>SHOULD</strong> be resolved (processed) in sequence by
TOSCA 
processors. Requirement names must be unique within the context of
a 
node type definition.</p></li>
<li><p>interface_definitions: represents the optional map of
interface 
definitions supported by the node type.</p></li>
<li><p>artifact_definitions: represents the optional map of
artifact 
definitions for the node type</p></li>
</ul>
<p>During node type derivation, the keynames follow these rules:</p>
<ul>
<li><p>properties: existing property definitions may be refined; new
property 
definitions may be added.</p></li>
<li><p>attributes: existing attribute definitions may be refined;
new 
attribute definitions may be added.</p></li>
<li><p>capabilities: existing capability definitions may be refined;
new 
capability definitions may be added.</p></li>
<li><p>requirements: existing requirement definitions may be refined;
new 
requirement definitions may be added.</p></li>
<li><p>interfaces: existing interface definitions may be refined;
new 
interface definitions may be added.</p></li>
<li><p>artifacts: existing artifact definitions (identified by their
symbolic 
name) may be redefined; new artifact definitions may be added.</p>
<ul>
<li><p>note that an artifact is created for a specific purpose and 
corresponds to a specific file (with e.g. a path name and
checksum); 
if it cannot meet its purpose in a derived type then a new
artifact 
should be defined and used.</p></li>
<li><p>thus, if an artifact defined in a parent node type does not
correspond 
anymore with the needs in the child node type, its definition may
be 
completely redefined; thus, an existing artifact definition is not 
refined, but completely overwritten.</p></li>
</ul></li>
</ul>
<p>The following code snippet shows an example node type definition:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb72-1"><a aria-hidden="true" href="#cb72-1" tabindex="-1"></a><span class="fu">my_app_node_type</span><span class="kw">:</span></span>
<span id="cb72-2"><a aria-hidden="true" href="#cb72-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> SoftwareComponent</span></span>
<span id="cb72-3"><a aria-hidden="true" href="#cb72-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> My company’s custom applicaton</span></span>
<span id="cb72-4"><a aria-hidden="true" href="#cb72-4" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb72-5"><a aria-hidden="true" href="#cb72-5" tabindex="-1"></a><span class="at">    </span><span class="fu">my_app_password</span><span class="kw">:</span></span>
<span id="cb72-6"><a aria-hidden="true" href="#cb72-6" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb72-7"><a aria-hidden="true" href="#cb72-7" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> application password</span></span>
<span id="cb72-8"><a aria-hidden="true" href="#cb72-8" tabindex="-1"></a><span class="at">      </span><span class="fu">validation</span><span class="kw">:</span></span>
<span id="cb72-9"><a aria-hidden="true" href="#cb72-9" tabindex="-1"></a><span class="at">        </span><span class="fu">$and</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb72-10"><a aria-hidden="true" href="#cb72-10" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">6</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb72-11"><a aria-hidden="true" href="#cb72-11" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$less_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">10</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb72-12"><a aria-hidden="true" href="#cb72-12" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb72-13"><a aria-hidden="true" href="#cb72-13" tabindex="-1"></a><span class="at">    </span><span class="fu">my_app_port</span><span class="kw">:</span></span>
<span id="cb72-14"><a aria-hidden="true" href="#cb72-14" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb72-15"><a aria-hidden="true" href="#cb72-15" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> application port number</span></span>
<span id="cb72-16"><a aria-hidden="true" href="#cb72-16" tabindex="-1"></a><span class="at">  </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb72-17"><a aria-hidden="true" href="#cb72-17" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> </span><span class="fu">some_database</span><span class="kw">:</span></span>
<span id="cb72-18"><a aria-hidden="true" href="#cb72-18" tabindex="-1"></a><span class="at">        </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> EndPoint.Database</span></span>
<span id="cb72-19"><a aria-hidden="true" href="#cb72-19" tabindex="-1"></a><span class="at">        </span><span class="fu">node</span><span class="kw">:</span><span class="at"> Database    </span></span>
<span id="cb72-20"><a aria-hidden="true" href="#cb72-20" tabindex="-1"></a><span class="at">        </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ConnectsTo</span></span></code></pre></div>
<h2 id="node-template">7.2 Node Template</h2>
<p>A <em>node template</em> specifies the occurrence of one or more
instances of 
a component of a given type in an application or service. A node 
template defines application-specific values for the properties, 
relationships, or interfaces defined by its node type.</p>
<p>The following is the list of recognized keynames for a TOSCA
node 
template definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The mandatory name of the node type on
which the node template is based.</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">An optional description for the node
template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of string</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information.</td>
</tr>
<tr class="even">
<td style="text-align: left;">directives</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of directive values to
provide processing instructions to orchestrators and tooling.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property assignments</td>
<td style="text-align: left;">An optional map of property value
assignments for the node template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute assignments</td>
<td style="text-align: left;">An optional map of attribute value
assignments for the node template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">requirements</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of requirement assignments</td>
<td style="text-align: left;">An optional list of requirement
assignments for the node template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">capabilities</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of capability assignments</td>
<td style="text-align: left;">An optional map of capability assignments
for the node template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">interfaces</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of interface assignments</td>
<td style="text-align: left;">An optional map of interface assignments
for the node template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">artifacts</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of artifact definitions</td>
<td style="text-align: left;">An optional map of artifact definitions
for the node template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">count</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">non-negative integer</td>
<td style="text-align: left;">An optional keyname that specifies how
many node representations must be created from this node template. If
not defined, the assumed count value is 1.</td>
</tr>
<tr class="even">
<td style="text-align: left;">node_filter</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">node filter</td>
<td style="text-align: left;">The optional filter definition that TOSCA
orchestrators will use to select an already existing node if this node
template is marked with the <code>select</code> directive.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">copy</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional (symbolic) name of another
node template from which to copy all keynames and values into this node
template.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb73-1"><a aria-hidden="true" href="#cb73-1" tabindex="-1"></a><span class="fu">&lt;node_template_name&gt;</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb73-2"><a aria-hidden="true" href="#cb73-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;node_type_name&gt;</span></span>
<span id="cb73-3"><a aria-hidden="true" href="#cb73-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;node_template_description&gt;</span></span>
<span id="cb73-4"><a aria-hidden="true" href="#cb73-4" tabindex="-1"></a><span class="at">  </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">&lt;directives&gt;</span><span class="kw">]</span></span>
<span id="cb73-5"><a aria-hidden="true" href="#cb73-5" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb73-6"><a aria-hidden="true" href="#cb73-6" tabindex="-1"></a><span class="at">    &lt;map of string&gt;</span></span>
<span id="cb73-7"><a aria-hidden="true" href="#cb73-7" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb73-8"><a aria-hidden="true" href="#cb73-8" tabindex="-1"></a><span class="at">    &lt;property_assignments&gt;</span></span>
<span id="cb73-9"><a aria-hidden="true" href="#cb73-9" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb73-10"><a aria-hidden="true" href="#cb73-10" tabindex="-1"></a><span class="at">    &lt;attribute_assignments&gt;</span></span>
<span id="cb73-11"><a aria-hidden="true" href="#cb73-11" tabindex="-1"></a><span class="at">  </span><span class="fu">requirements</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb73-12"><a aria-hidden="true" href="#cb73-12" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> &lt;requirement_assignments&gt;</span></span>
<span id="cb73-13"><a aria-hidden="true" href="#cb73-13" tabindex="-1"></a><span class="at">  </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb73-14"><a aria-hidden="true" href="#cb73-14" tabindex="-1"></a><span class="at">    &lt;capability_assignments&gt;</span></span>
<span id="cb73-15"><a aria-hidden="true" href="#cb73-15" tabindex="-1"></a><span class="at">  </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb73-16"><a aria-hidden="true" href="#cb73-16" tabindex="-1"></a><span class="at">    &lt;interface_assignments&gt;</span></span>
<span id="cb73-17"><a aria-hidden="true" href="#cb73-17" tabindex="-1"></a><span class="at">  </span><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb73-18"><a aria-hidden="true" href="#cb73-18" tabindex="-1"></a><span class="at">    &lt;artifact_definitions&gt;</span></span>
<span id="cb73-19"><a aria-hidden="true" href="#cb73-19" tabindex="-1"></a><span class="at">  </span><span class="fu">copy</span><span class="kw">:</span><span class="at"> &lt;node_count_value&gt;</span></span>
<span id="cb73-20"><a aria-hidden="true" href="#cb73-20" tabindex="-1"></a><span class="at">  </span><span class="fu">node_filter</span><span class="kw">:</span></span>
<span id="cb73-21"><a aria-hidden="true" href="#cb73-21" tabindex="-1"></a><span class="at">    &lt;node_filter_definition&gt;</span></span>
<span id="cb73-22"><a aria-hidden="true" href="#cb73-22" tabindex="-1"></a><span class="at">  </span><span class="fu">copy</span><span class="kw">:</span><span class="at"> &lt;source_node_template_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>node_template_name: represents the mandatory symbolic name of the
node 
template being defined.</p></li>
<li><p>node_type_name: represents the name of the node type on which
the 
node template is based.</p></li>
<li><p>directives: represents the optional list of processing
instruction 
keywords (as strings) for use by tooling and orchestrators. Valid 
directives supported by this version of the standard are
<code>create</code>, 
<code>select</code>, and <code>substitute</code>. If no directives are
specified, <code>create</code> 
is used as the default value.</p></li>
<li><p>property_assignments: represents the optional map of
property 
assignments for the node template that provide values for
properties 
defined in its declared node type.</p></li>
<li><p>attribute_assignments: represents the optional map of
attribute 
assignments for the node template that provide values for
attributes 
defined in its declared node type.</p></li>
<li><p>requirement_assignments: represents the optional list of
requirement 
assignments for the node template for requirement definitions
provided 
in its declared node type.</p></li>
<li><p>capability_assignments: represents the optional map of
capability 
assignments for the node template for capability definitions
provided 
in its declared node type.</p></li>
<li><p>interface_assignments: represents the optional map of
interface 
assignments for the node template interface definitions provided
in 
its declared node type.</p></li>
<li><p>artifact_definitions: represents the optional map of
artifact 
definitions for the node template that augment or replace those 
provided by its declared node type.</p></li>
<li><p>node_count_value: represents the number of node representations
that 
must be created from this node template. If not specified, a
default 
value of 1 is used.</p></li>
<li><p>node_filter_definition: represents the optional node filter
TOSCA 
orchestrators will use for selecting a matching node template.</p></li>
<li><p>source_node_template_name: represents the optional (symbolic)
name 
of another node template from which to copy all keynames and
values 
into this node template. Note that he source node template
provided 
as a value on the copy keyname <strong>MUST NOT</strong> itself use the
copy 
keyname (i.e., it must itself be a complete node template 
description and not copied from another node template).</p></li>
</ul>
<p>The following code snippet shows an example node template
definition:</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb74-1"><a aria-hidden="true" href="#cb74-1" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb74-2"><a aria-hidden="true" href="#cb74-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mysql</span><span class="kw">:</span></span>
<span id="cb74-3"><a aria-hidden="true" href="#cb74-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> DBMS.MySQL</span></span>
<span id="cb74-4"><a aria-hidden="true" href="#cb74-4" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb74-5"><a aria-hidden="true" href="#cb74-5" tabindex="-1"></a><span class="at">      </span><span class="fu">root_password</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> my_mysql_rootpw </span><span class="kw">}</span></span>
<span id="cb74-6"><a aria-hidden="true" href="#cb74-6" tabindex="-1"></a><span class="at">      </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> my_mysql_port </span><span class="kw">}</span></span>
<span id="cb74-7"><a aria-hidden="true" href="#cb74-7" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb74-8"><a aria-hidden="true" href="#cb74-8" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> db_server</span></span>
<span id="cb74-9"><a aria-hidden="true" href="#cb74-9" tabindex="-1"></a><span class="at">    </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb74-10"><a aria-hidden="true" href="#cb74-10" tabindex="-1"></a><span class="at">      </span><span class="fu">Standard</span><span class="kw">:</span></span>
<span id="cb74-11"><a aria-hidden="true" href="#cb74-11" tabindex="-1"></a><span class="at">        </span><span class="fu">operations</span><span class="kw">:</span></span>
<span id="cb74-12"><a aria-hidden="true" href="#cb74-12" tabindex="-1"></a><span class="at">          </span><span class="fu">configure</span><span class="kw">:</span><span class="at"> scripts/my_own_configure.sh</span></span></code></pre></div>
<h2 id="relationship-type">7.3 Relationship Type</h2>
<p>A <em>relationship type</em> is a reusable entity that defines the
structure 
of observable properties and attributes of a relationship as well
as 
its supported interfaces.</p>
<p>A relationship type definition is a type of TOSCA type definition
and 
as a result supports the common keynames listed in <a href="#641-common-keynames-in-type-definitions">Section 
6.4.1</a>. In addition, the 
relationship type definition has the following recognized keynames:</p>
<!----
{"id": "520", "author": "Michael Rehder", "date": "2020-12-15T13:33:00Z", "comment": "I still think this is simply a Requirement Type \u2013 I can\u2019t see why it isn\u2019t and what advantage there is in calling it something else.", "target": "relationship type"}-->
<!----
{"id": "521", "author": "Michael Rehder", "date": "2020-12-15T12:12:00Z", "comment": "There is no\nrelationship type in a node template so why is this stated\nhere?", "target": "Node Templates"}-->
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Definition/Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property definitions</td>
<td style="text-align: left;">An optional map of property definitions
for the relationship type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute definitions</td>
<td style="text-align: left;">An optional map of attribute definitions
for the relationship type.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">interfaces</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of interface definitions</td>
<td style="text-align: left;">An optional map of interface definitions
supported by the relationship type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">valid_capability_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of one or more names of
capability types that are valid targets for this relationship. If
undefined, all capability types are valid.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">valid_target_node_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of one or more names of
node types that are valid targets for this relationship. If undefined,
all node types are valid targets.</td>
</tr>
<tr class="even">
<td style="text-align: left;">valid_source_node_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of one or more names of
node types that are valid sources for this relationship. If undefined,
all node types are valid sources.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb75-1"><a aria-hidden="true" href="#cb75-1" tabindex="-1"></a><span class="fu">&lt;relationship_type_name&gt;</span><span class="kw">:</span></span>
<span id="cb75-2"><a aria-hidden="true" href="#cb75-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;parent_relationship_type_name&gt;</span></span>
<span id="cb75-3"><a aria-hidden="true" href="#cb75-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb75-4"><a aria-hidden="true" href="#cb75-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb75-5"><a aria-hidden="true" href="#cb75-5" tabindex="-1"></a><span class="at">    &lt;map of string&gt;</span></span>
<span id="cb75-6"><a aria-hidden="true" href="#cb75-6" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;relationship_description&gt;</span></span>
<span id="cb75-7"><a aria-hidden="true" href="#cb75-7" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb75-8"><a aria-hidden="true" href="#cb75-8" tabindex="-1"></a><span class="at">    &lt;property_definitions&gt;</span></span>
<span id="cb75-9"><a aria-hidden="true" href="#cb75-9" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb75-10"><a aria-hidden="true" href="#cb75-10" tabindex="-1"></a><span class="at">    &lt;attribute_definitions&gt;</span></span>
<span id="cb75-11"><a aria-hidden="true" href="#cb75-11" tabindex="-1"></a><span class="at">  </span><span class="fu">interfaces</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb75-12"><a aria-hidden="true" href="#cb75-12" tabindex="-1"></a><span class="at">    &lt;interface_definitions&gt;</span></span>
<span id="cb75-13"><a aria-hidden="true" href="#cb75-13" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_capability_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;capability_type_names&gt; </span><span class="kw">]</span></span>
<span id="cb75-14"><a aria-hidden="true" href="#cb75-14" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_target_node_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;target_node_type_names&gt; </span><span class="kw">]</span></span>
<span id="cb75-15"><a aria-hidden="true" href="#cb75-15" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_source_node_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;source_node_type_names&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>relationship_type_name: represents the mandatory symbolic name of
the 
relationship type being declared as a string.</p></li>
<li><p>parent_relationship_type_name: represents the name (string) of
the 
relationship type from which this relationship type definition 
derives (i.e., its “parent” type). Parent node type names can be 
qualified using a namespace prefix.</p></li>
<li><p>property_definitions: represents the optional map of
property 
definitions for the relationship type.</p></li>
<li><p>attribute_definitions: represents the optional map of
attribute 
definitions for the relationship type.</p></li>
<li><p>interface_definitions: represents the optional map of
interface 
definitions supported by the relationship type.</p></li>
<li><p>capability_type_names: represents the optional list of valid
target 
capability types for the relationship. Target capability type
names 
can be qualified using a namespace prefix. If undefined, the valid 
target types are not restricted at all (i.e., all capability types 
are valid).</p></li>
<li><p>target_node_type_names: represents the optional list of valid
target 
node types for the relationship. Target node type names can be 
qualified using a namespace prefix. If undefined, the valid types 
are not restricted at all (i.e., all node types are valid).</p></li>
<li><p>source_node_type_names: represents the optional list of valid
source 
node types for the relationship. Source node type names canbe 
qualified using a namespace prefix. If undefined, the valid types 
are not restricted at all (i.e., all node types are valid).</p></li>
</ul>
<p>During relationship type derivation the keyname definitions follow
these 
rules:</p>
<ul>
<li><p>properties: existing property definitions may be refined; new
property 
definitions may be added.</p></li>
<li><p>attributes: existing attribute definitions may be refined;
new 
attribute definitions may be added.</p></li>
<li><p>interfaces: existing interface definitions may be refined;
new 
interface definitions may be added.</p></li>
<li><p>valid_capability_types: A derived type is only allowed to
further 
restrict the list of valid capability types, not to expand it.
This 
means that if valid_capability_types is defined in the parent
type, 
each element in the derived type’s list of valid capability types 
must either be in the parent type list or derived from an element
in 
the parent type list; if valid_target_types is not defined in the 
parent type then no derivation restrictions need to be applied.</p></li>
<li><p>valid_target_node_types: same derivation rules as for 
valid_capability_types</p></li>
<li><p>valid_source_node_types: same derivation rules as for 
valid_capability_types</p></li>
</ul>
<p>The following code snippet shows an example relationship type
definition:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb76-1"><a aria-hidden="true" href="#cb76-1" tabindex="-1"></a><span class="fu">mycompanytypes.myrelationships.AppDependency</span><span class="kw">:</span></span>
<span id="cb76-2"><a aria-hidden="true" href="#cb76-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> tosca.relationships.DependsOn</span></span>
<span id="cb76-3"><a aria-hidden="true" href="#cb76-3" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_capability_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> mycompanytypes.mycapabilities.SomeAppCapability </span><span class="kw">]</span></span></code></pre></div>
<h2 id="relationship-template">7.4 Relationship Template</h2>
<p>A <em>relationship template</em> specifies the occurrence of a
relationship 
of a given type between nodes in an application or service. A 
relationship template defines application-specific values for the 
properties, relationships, or interfaces defined by its
relationship 
type.</p>
<!----
{"id": "532", "author": "Michael Rehder", "date": "2020-12-15T13:23:00Z", "comment": "My understanding is that this is an\nalternative to relations defined within node templates.  \nIt\u2019s not clear why this option would be chosen over the node-template\noption.  \nIf both relations in node-templates and relationship templates are used,\nhow are they combined together?  \nOr is this not recommended?  \nI can imagine that combination rules would be very difficult to define\nbut if it is possible, it must be defined", "target": "A relationship template\nspecifies the occurrence of a manageable relationship between node\ntemplates as part of an application\u2019s topology model that is defined in\na TOSCA service template. A Relationship template is an instance of a\nspecified relationship type and can provide customized properties, or\noperations that complement and change the defaults provided by its\nrelationship type and its implementations."}-->
<p>TOSCA allows relationships between nodes to be defined
<em>inline</em> using 
requirement assignments within node templates or <em>out-of-band</em>
using 
relationship templates as defined in this section. While the use
of 
requirement assignments is more common, the use of relationship 
templates decouples relationship definitions from specific node 
templates, allowing reuse of these relationship templates by
multiple 
node templates. Relationship templates are local within a service 
template and so have a limited scope.</p>
<p>Note that relationship template grammar is underspecified
currently 
and needs further work.</p>
<p>The following is the list of recognized keynames for a TOSCA 
relationship template definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The mandatory name of the relationship
type on which the relationship template is based.</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">An optional description for the
relationship template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of string</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information.</td>
</tr>
<tr class="even">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property assignments</td>
<td style="text-align: left;">An optional map of property assignments
for the relationship template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute assignments</td>
<td style="text-align: left;">An optional map of attribute assignments
for the relationship template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">interfaces</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of interface assignments</td>
<td style="text-align: left;">An optional map of interface assignments
for the relationship template.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">copy</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional (symbolic) name of another
relationship template from which to copy all keynames and values into
this relationship template.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb77-1"><a aria-hidden="true" href="#cb77-1" tabindex="-1"></a><span class="fu">&lt;relationship_template_name&gt;</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb77-2"><a aria-hidden="true" href="#cb77-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;relationship_type_name&gt;</span></span>
<span id="cb77-3"><a aria-hidden="true" href="#cb77-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;relationship_type_description&gt;</span></span>
<span id="cb77-4"><a aria-hidden="true" href="#cb77-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb77-5"><a aria-hidden="true" href="#cb77-5" tabindex="-1"></a><span class="at">    &lt;map of string&gt;</span></span>
<span id="cb77-6"><a aria-hidden="true" href="#cb77-6" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb77-7"><a aria-hidden="true" href="#cb77-7" tabindex="-1"></a><span class="at">    &lt;property_assignments&gt;</span></span>
<span id="cb77-8"><a aria-hidden="true" href="#cb77-8" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb77-9"><a aria-hidden="true" href="#cb77-9" tabindex="-1"></a><span class="at">    &lt;attribute_assignments&gt;</span></span>
<span id="cb77-10"><a aria-hidden="true" href="#cb77-10" tabindex="-1"></a><span class="at">  </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb77-11"><a aria-hidden="true" href="#cb77-11" tabindex="-1"></a><span class="at">    &lt;interface_assignments&gt;</span></span>
<span id="cb77-12"><a aria-hidden="true" href="#cb77-12" tabindex="-1"></a><span class="at">  </span><span class="fu">copy</span><span class="kw">:</span></span>
<span id="cb77-13"><a aria-hidden="true" href="#cb77-13" tabindex="-1"></a><span class="at">    &lt;source_relationship_template_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>relationship_template_name: represents the mandatory symbolic
name of 
the relationship template being declared.</p></li>
<li><p>relationship_type_name: represents the name of the relationship
type 
the relationship template is based upon.</p></li>
<li><p>relationship_template_description: represents the optional
description 
string for the relationship template.</p></li>
<li><p>property_assignments: represents the optional map of
property 
assignments for the relationship template that provide values for 
properties defined in its declared relationship type.</p></li>
<li><p>attribute_assignments: represents the optional map of
attribute 
assignments for the relationship template that provide values for 
attributes defined in its declared relationship type.</p></li>
<li><p>interface_assignments: represents the optional map of
interface 
assignments for the relationship template for interface
definitions 
provided by its declared relationship type.</p></li>
<li><p>source_relationship_template_name: represents the optional
(symbolic) 
name of another relationship template to copy into (all keynames
and 
values) and use as a basis for this relationship template.</p></li>
<li><p>source_relationship_template_name: represents the optional 
(symbolic) name of another relationship template from which to
copy 
all keynames and values into this relationship template. Note that 
he source relationship template provided as a value on the copy 
keyname <strong>MUST NOT</strong> itself use the copy keyname (i.e., it
must 
itself be a complete relationship template description and not 
copied from another relationship template).</p></li>
</ul>
<p>The following code snippet shows an example relationship template
definition.</p>
<pre><code>relationship_templates:
  storage_attachment:
    type: AttachesTo
    properties:
      location: /my_mount_point</code></pre>
<hr/>
<h1 id="capabilities-and-requirements">8 Capabilities and
Requirements</h1>
<p>The content in this section is non-normative. 
The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative. 
## 8.1 Capability Type</p>
<p>A <em>capability type</em> is a reusable entity that describes the
properties 
and attributes of a capability that a node type can declare to 
expose. Requirements that are declared as part of one node can be 
fulfilled by the capabilities declared by another node.</p>
<p>A capability type definition is a type of TOSCA type definition and
as 
a result supports the common keynames listed in <a href="#641-common-keynames-in-type-definitions">Section 
6.4.1</a>. In addition, the 
capability type definition has the following recognized keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property definitions</td>
<td style="text-align: left;">An optional map of property definitions
for the capability type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute definitions</td>
<td style="text-align: left;">An optional map of attribute definitions
for the capability type.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">valid_source_node_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of one or more valid
names of node types that are supported as valid sources of any
relationship established to the declared capability type. If undefined,
all node types are valid sources.</td>
</tr>
<tr class="even">
<td style="text-align: left;">valid_relationship_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of one or more valid
names of relationship types that are supported as valid types of any
relationship established to the declared capability type. If undefined,
all relationship types are valid.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb79-1"><a aria-hidden="true" href="#cb79-1" tabindex="-1"></a><span class="fu">&lt;capability_type_name&gt;</span><span class="kw">:</span></span>
<span id="cb79-2"><a aria-hidden="true" href="#cb79-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;parent_capability_type_name&gt;</span></span>
<span id="cb79-3"><a aria-hidden="true" href="#cb79-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb79-4"><a aria-hidden="true" href="#cb79-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb79-5"><a aria-hidden="true" href="#cb79-5" tabindex="-1"></a><span class="at">    &lt;map of string&gt;</span></span>
<span id="cb79-6"><a aria-hidden="true" href="#cb79-6" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;capability_description&gt;</span></span>
<span id="cb79-7"><a aria-hidden="true" href="#cb79-7" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb79-8"><a aria-hidden="true" href="#cb79-8" tabindex="-1"></a><span class="at">    &lt;property_definitions&gt;</span></span>
<span id="cb79-9"><a aria-hidden="true" href="#cb79-9" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb79-10"><a aria-hidden="true" href="#cb79-10" tabindex="-1"></a><span class="at">    &lt;attribute_definitions&gt;</span></span>
<span id="cb79-11"><a aria-hidden="true" href="#cb79-11" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_source_node_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;node_type_names&gt; </span><span class="kw">]</span></span>
<span id="cb79-12"><a aria-hidden="true" href="#cb79-12" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_relationship_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;relationship_type_names&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>capability_type_name: represents the mandatory name of the
capability 
type being declared as a string.</p></li>
<li><p>parent_capability_type_name: represents the name of the
capability 
type from which this capability type derives (i.e., its parent 
type). Parent capability type names can be qualified using a 
namespace prefix.</p></li>
<li><p>property_definitions: represents the optional map of
property 
definitions for the capability type.</p></li>
<li><p>attribute_definitions: represents the optional map of
attribute 
definitions for the capability type.</p></li>
<li><p>node_type_names: represents the optional list of one or more
type 
names for nodes that are allowed to establish a relationship to a 
capability of this capability type; if undefined, the valid source 
types are not restricted at all (i.e. all node types are
valid).</p></li>
<li><p>relationship_type_names: represents the optional list of one or
more 
type names for relationship that are allowed to be established to
a 
capability of this capability type; if undefined, the valid types 
are not restricted at all (i.e. all relationship types are
valid).</p></li>
</ul>
<p>During capability type derivation the keyname definitions follow
these 
rules:</p>
<ul>
<li><p>properties: existing property definitions may be refined; new
property 
definitions may be added.</p></li>
<li><p>attributes: existing attribute definitions may be refined;
new 
attribute definitions may be added.</p></li>
<li><p>valid_source_node_types: A derived type is only allowed to
further 
restrict the list of valid source node types, not to expand it.
This 
means that if valid_source_node_types is defined in the parent
type, 
each element in the derived type’s list of valid source node types 
must either be in the parent type list or derived from an element
in 
the parent type list; if valid_source_node_types is not defined in 
the parent type then no derivation restrictions need to be
applied.</p></li>
<li><p>valid_relationship_types: same derivations rules as for 
valid_source_node_types.</p></li>
</ul>
<p>The following code snippet shows an example capability type 
definition:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb80-1"><a aria-hidden="true" href="#cb80-1" tabindex="-1"></a><span class="fu">MyFeature</span><span class="kw">:</span></span>
<span id="cb80-2"><a aria-hidden="true" href="#cb80-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> a custom feature of my company’s application</span></span>
<span id="cb80-3"><a aria-hidden="true" href="#cb80-3" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb80-4"><a aria-hidden="true" href="#cb80-4" tabindex="-1"></a><span class="at">    </span><span class="fu">my_feature_setting</span><span class="kw">:</span></span>
<span id="cb80-5"><a aria-hidden="true" href="#cb80-5" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb80-6"><a aria-hidden="true" href="#cb80-6" tabindex="-1"></a><span class="at">    </span><span class="fu">my_feature_value</span><span class="kw">:</span></span>
<span id="cb80-7"><a aria-hidden="true" href="#cb80-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb80-8"><a aria-hidden="true" href="#cb80-8" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_source_node_types</span><span class="kw">:</span></span>
<span id="cb80-9"><a aria-hidden="true" href="#cb80-9" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> MyCompanyNodes</span></span></code></pre></div>
<h2 id="capability-definition">8.2 Capability Definition</h2>
<p>A <em>capability definition</em> defines a typed set of data that a
node can 
expose and that is used to describe a relevant feature of the 
component described by the node that can be used to <em>fulfill</em>
a 
requirement exposed by another node. A capability is defined as
part 
of a node type definition and may be refined during node type 
derivation.</p>
<p>The following is the list of recognized keynames for a TOSCA
capability 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The mandatory name of the capability type
on which this capability definition is based.</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional description of the Capability
definition.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of string</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information.</td>
</tr>
<tr class="even">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property refinements</td>
<td style="text-align: left;">An optional map of property refinements
for the capability definition. The referred properties must have been
defined in the capability type definition referred by the type keyword.
New properties may not be added.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute refinements</td>
<td style="text-align: left;">An optional map of attribute refinements
for the capability definition. The referred attributes must have been
defined in the capability type definition referred by the type keyword.
New attributes may not be added.</td>
</tr>
<tr class="even">
<td style="text-align: left;">valid_source_node_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of one or more valid
names of node types that are supported as valid sources of any
relationship established to the declared capability type. If undefined,
all node types are valid sources. If valid_source_node_types is defined
in the capability type, each element in this list must either be or
derived from an element in the list defined in the type.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">valid_relationship_types</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of one or more valid
names of relationship types that are supported as valid types of any
relationship established to the declared capability type. If undefined,
all relationship types are valid. If valid_relationship_types is defined
in the capability type, each element in this list must either be or
derived from an element in the list defined in the type.</td>
</tr>
</tbody>
</table>
<p>Note that the <code>occurrences</code> keyname is deprecated in TOSCA
2.0. By 
default, the number of occurrences is UNBOUNDED, i.e. any number
of 
relationships can be created with a certain capability as a target.
To 
constrain the creation of a relationship to a target capability,
the 
new <code>allocation</code> keyname is used within a requirement
assignment.</p>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb81-1"><a aria-hidden="true" href="#cb81-1" tabindex="-1"></a><span class="fu">&lt;capability_definition_name&gt;</span><span class="kw">:</span></span>
<span id="cb81-2"><a aria-hidden="true" href="#cb81-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;capability_type&gt;</span></span>
<span id="cb81-3"><a aria-hidden="true" href="#cb81-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;capability_description&gt;</span></span>
<span id="cb81-4"><a aria-hidden="true" href="#cb81-4" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb81-5"><a aria-hidden="true" href="#cb81-5" tabindex="-1"></a><span class="at">    &lt;property_refinements&gt;</span></span>
<span id="cb81-6"><a aria-hidden="true" href="#cb81-6" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb81-7"><a aria-hidden="true" href="#cb81-7" tabindex="-1"></a><span class="at">    &lt;attribute_refinements&gt;</span></span>
<span id="cb81-8"><a aria-hidden="true" href="#cb81-8" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_source_node_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;node_type_names&gt; </span><span class="kw">]</span></span>
<span id="cb81-9"><a aria-hidden="true" href="#cb81-9" tabindex="-1"></a><span class="at">  </span><span class="fu">valid_relationship_types</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;relationship_type_names&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>capability_definition_name: represents the symbolic name of
the 
capability as a string. Capability symbolic names SHALL be unique; 
it is an error if a capability name is found to occur more than 
once.</p></li>
<li><p>capability_type: represents the mandatory name of a capability
type 
on which the capability definition is based.</p></li>
<li><p>property_refinements: represents the optional map of
property 
refinements for properties already defined in the capability type; 
new properties may not be added.</p></li>
<li><p>attribute_refinements: represents the optional map of
attribute 
refinements for attributes already defined in the capability type; 
new attributes may not be added.</p></li>
<li><p>node_type_names: represents the optional list of one or more
node 
type names for nodes that are allowed to establish a relationship
to 
this capability.</p>
<ul>
<li>if valid_source_node_types is defined in the capability type,
each<br/>
element in this list MUST either be in that list or derived from
an<br/>
element in that list; if valid_source_types is not defined in the<br/>
capability type then no restrictions are applied.</li>
</ul></li>
<li><p>relationship_type_names: represents the optional list of one or
more 
relationship type names for relationships that are allowed to be 
established to this capability</p>
<ul>
<li>if valid_relationship_types is defined in the capability type,
each<br/>
element in this list MUST either be in that list or derived from
an<br/>
element in that list; if valid_source_types is not defined in the<br/>
capability type then no restrictions are applied.</li>
</ul></li>
</ul>
<p>The following single-line grammar may be used when only the
capability 
type needs to be declared, without further refinement of the
definitions 
in the capability type:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb82-1"><a aria-hidden="true" href="#cb82-1" tabindex="-1"></a><span class="fu">&lt;capability_definition_name&gt;</span><span class="kw">:</span><span class="at"> &lt;capability_type&gt; </span></span></code></pre></div>
<p>The following code snippet shows an example capability
definition:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb83-1"><a aria-hidden="true" href="#cb83-1" tabindex="-1"></a><span class="fu">some_capability</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb83-2"><a aria-hidden="true" href="#cb83-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> MyCapabilityTypeName</span></span>
<span id="cb83-3"><a aria-hidden="true" href="#cb83-3" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb83-4"><a aria-hidden="true" href="#cb83-4" tabindex="-1"></a><span class="at">    </span><span class="fu">limit</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb83-5"><a aria-hidden="true" href="#cb83-5" tabindex="-1"></a><span class="at">      </span><span class="fu">default</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span></code></pre></div>
<p>The following shows a capability definition using single-line
grammar:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb84-1"><a aria-hidden="true" href="#cb84-1" tabindex="-1"></a><span class="fu">some_capability</span><span class="kw">:</span><span class="at"> MyCapabilityTypeName</span></span></code></pre></div>
<h2 id="capability-refinement">8.3 Capability Refinement</h2>
<p>If a node type defines a capability with the same name as a
capability 
that is already defined in one of its parent node types, then that 
capability definition is considered a <em>capability refinement</em>
rather 
than a capability definition. Capability refinements adhere to the 
following refinement rules for the supported keynames:</p>
<ul>
<li><p>type: in a capability refinement, the type keyname is no
longer 
mandatory. If the type is omitted, the type of the refined 
capability definition will be used. If the type is specified, it 
must be derived from (or the same as) the type in the capability 
definition in the parent node type definition.</p></li>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the capability definition in the parent node
type 
definition.</p></li>
<li><p>properties: not applicable to the definitions in the parent node
type 
but to the definitions in the capability type referred by the type 
keyname (see grammar above for the rules).</p></li>
<li><p>attributes: not applicable to the definitions in the parent node
type 
but to the definitions in the capability type referred by the type 
keyname (see grammar above for the rules).</p></li>
<li><p>valid_source_node_types: not applicable to the definitions in
the 
parent node type but to the definitions in the capability type 
referred by the type keyname (see grammar above for the rules).</p></li>
<li><p>valid_relationship_types: not applicable to the definitions in
the 
parent node type but to the definitions in the capability type 
referred by the type keyname (see grammar above for the rules).</p></li>
</ul>
<h2 id="capability-assignment">8.4 Capability Assignment</h2>
<p>A capability assignment allows node template authors to assign values
to 
properties and attributes for a capability definition that is part
of 
the node template’s type definition.</p>
<p>The following is the list of recognized keynames for a TOSCA
capability 
assignment:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property assignments</td>
<td style="text-align: left;">An optional map of property assignments
for the capability definition.</td>
</tr>
<tr class="even">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute assignments</td>
<td style="text-align: left;">An optional map of attribute assignments
for the capability definition.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">directives</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">An optional list of directive values to
provide processing instructions to orchestrators and tooling.</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>Note that the occurrences keyname is deprecated in TOSCA 2.0.
By 
default, the number of “occurrences” is UNBOUNDED, i.e. any number
of 
relationships can be created with a certain capability as a target.
To 
constrain the creation of a relationship to a target capability,
the 
new <code>allocation</code> keyname is used within a requirement
assignment.</p>
<p>Thes capability definition keynames can be used according to
the 
following grammar:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb85-1"><a aria-hidden="true" href="#cb85-1" tabindex="-1"></a><span class="fu">&lt;capability_definition_name&gt;</span><span class="kw">:</span></span>
<span id="cb85-2"><a aria-hidden="true" href="#cb85-2" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb85-3"><a aria-hidden="true" href="#cb85-3" tabindex="-1"></a><span class="at">    &lt;property_assignments&gt;</span></span>
<span id="cb85-4"><a aria-hidden="true" href="#cb85-4" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb85-5"><a aria-hidden="true" href="#cb85-5" tabindex="-1"></a><span class="at">    &lt;attribute_assignments&gt;</span></span>
<span id="cb85-6"><a aria-hidden="true" href="#cb85-6" tabindex="-1"></a><span class="at">  </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> &lt;directives_list&gt;</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>capability_definition_name: represents the symbolic name of
the 
capability as a string.</p></li>
<li><p>property_assignments: represents the optional map of
property 
assignments that provide values for properties defined in the 
Capability definition.</p></li>
<li><p>attribute_assignments: represents the optional map of
attribute 
assignments that provide values for attributes defined in the 
Capability definition.</p></li>
<li><p>directives_list: represents the optional list of strings
that 
defines if this capability allows relationships from source nodes 
created within this service template (<em>internal</em>) or from
source 
nodes created outside this service template as available to the 
TOSCA environment (<em>external</em>) or if it should use a combination
of 
the above. Valid values for the strings are as follows:</p>
<ul>
<li><p><code>internal</code>: relationships to this capability can be
created from 
source nodes created within this template.</p></li>
<li><p><code>external</code>: relationships to this capability can be
created from 
source nodes created outside this template as available to the 
TOSCA environment.</p></li>
</ul>
<p>The order of the strings in the list defines which scope should
be 
attempted first when fulfilling the assignment.</p>
<p>If no directives are defined, the default value is left to the 
particular implementation.</p></li>
</ul>
<p>The following code snippet shows an example capability
assignment:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb86-1"><a aria-hidden="true" href="#cb86-1" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb86-2"><a aria-hidden="true" href="#cb86-2" tabindex="-1"></a><span class="at">  </span><span class="fu">some_node_template</span><span class="kw">:</span></span>
<span id="cb86-3"><a aria-hidden="true" href="#cb86-3" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb86-4"><a aria-hidden="true" href="#cb86-4" tabindex="-1"></a><span class="at">      </span><span class="fu">some_capability</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb86-5"><a aria-hidden="true" href="#cb86-5" tabindex="-1"></a><span class="at">        </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb86-6"><a aria-hidden="true" href="#cb86-6" tabindex="-1"></a><span class="at">          </span><span class="fu">limit</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span></code></pre></div>
<h2 id="requirement-definition">8.5 Requirement Definition</h2>
<p>The <em>requirement definition</em> describes a requirement of a
TOSCA node 
that needs to be fulfilled by a matching capability declared by 
another TOSCA node. A requirement is defined as part of a node
type 
definition and may be refined during node type derivation.</p>
<p>The following is the list of recognized keynames for a TOSCA 
requirement definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional description of the
requirement definition.</td>
</tr>
<tr class="even">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of string</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">relationship</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">relationship definition</td>
<td style="text-align: left;">The mandatory keyname used to define the
relationship created as a result of fulfilling the requirement.</td>
</tr>
<tr class="even">
<td style="text-align: left;">node</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional keyname used to provide the
name of a valid node type that contains the capability definition that
can be used to fulfill the requirement.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">capability</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The mandatory keyname used to specify the
capability type for capabilities that can be used to fulfill this
requirement. If the requirement definition defines a target node type,
the capability keyname can also be used instead to specify the symbolic
name of a capability defined by that target node type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">node_filter</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">node filter</td>
<td style="text-align: left;">The optional filter definition that TOSCA
orchestrators will use to select a type-compatible target node that can
fulfill this requirement at runtime.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">count_range</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">range of integer</td>
<td style="text-align: left;">The optional minimum required and maximum
allowed number of relationships created by the requirement. If this key
is not specified, the implied default of [0, UNBOUNDED] will be used.
Note: the keyword UNBOUNDED is also supported to represent any positive
integer.</td>
</tr>
</tbody>
</table>
<p>The <code>relationship</code> keyname in a requirement definition
specifies a 
<em>relationship definition</em> that provides information needed by
TOSCA 
Orchestrators to construct a relationship to the TOSCA node that 
contains the matching target capability. Relationship definitions 
support the following keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The mandatory keyname used to provide the
name of the relationship type used for the relationship.</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional description of the
relationship definition.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of string</td>
<td style="text-align: left;">Defines a section used to declare
additional metadata information.</td>
</tr>
<tr class="even">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property refinements</td>
<td style="text-align: left;">An optional map of property refinements
for the relationship definition. The referred properties must have been
defined in the relationship type definition referred by the type
keyword. New properties may not be added.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute refinements</td>
<td style="text-align: left;">An optional map of attribute refinements
for the relationship definition. The referred attributes must have been
defined in the relationship type definition referred by the type
keyword. New attributes may not be added.</td>
</tr>
<tr class="even">
<td style="text-align: left;">interfaces</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of interface refinements</td>
<td style="text-align: left;">The optional keyname used to define
interface refinements for interfaces defined by the relationship
type.</td>
</tr>
</tbody>
</table>
<p>The keynames supported by requirement definitions and
relationship 
definitions can be used according to the following grammar:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb87-1"><a aria-hidden="true" href="#cb87-1" tabindex="-1"></a><span class="fu">&lt;requirement_definition_name&gt;</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb87-2"><a aria-hidden="true" href="#cb87-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;requirement_description&gt;</span></span>
<span id="cb87-3"><a aria-hidden="true" href="#cb87-3" tabindex="-1"></a><span class="at">  </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> &lt;capability_type_name&gt; | &lt;capability_symbolic_name&gt;</span></span>
<span id="cb87-4"><a aria-hidden="true" href="#cb87-4" tabindex="-1"></a><span class="at">  </span><span class="fu">node</span><span class="kw">:</span><span class="at"> &lt;node_type_name&gt;</span></span>
<span id="cb87-5"><a aria-hidden="true" href="#cb87-5" tabindex="-1"></a><span class="at">  </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb87-6"><a aria-hidden="true" href="#cb87-6" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;relationship_type_name&gt;</span></span>
<span id="cb87-7"><a aria-hidden="true" href="#cb87-7" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_refinements&gt;</span></span>
<span id="cb87-8"><a aria-hidden="true" href="#cb87-8" tabindex="-1"></a><span class="at">    </span><span class="fu">attributes</span><span class="kw">:</span><span class="at"> &lt;attribute_refinements&gt;</span></span>
<span id="cb87-9"><a aria-hidden="true" href="#cb87-9" tabindex="-1"></a><span class="at">    </span><span class="fu">interfaces</span><span class="kw">:</span><span class="at"> &lt;interface_refinements&gt;</span></span>
<span id="cb87-10"><a aria-hidden="true" href="#cb87-10" tabindex="-1"></a><span class="at">  </span><span class="fu">node_filter</span><span class="kw">:</span><span class="at"> &lt;node_filter_definition&gt;</span></span>
<span id="cb87-11"><a aria-hidden="true" href="#cb87-11" tabindex="-1"></a><span class="at">  </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;min_count&gt;</span><span class="kw">,</span><span class="at"> &lt;max_count&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>If the relationship definition only needs to specify the
relationship 
type without refining properties, attributes, or interfaces then as
a 
convenience the following short-hand grammar can also be used:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb88-1"><a aria-hidden="true" href="#cb88-1" tabindex="-1"></a><span class="fu">&lt;requirement_definition_name&gt;</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb88-2"><a aria-hidden="true" href="#cb88-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;requirement_description&gt;</span></span>
<span id="cb88-3"><a aria-hidden="true" href="#cb88-3" tabindex="-1"></a><span class="at">  </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> &lt;capability_symbolic_name&gt; | &lt;capability_type_name&gt;</span></span>
<span id="cb88-4"><a aria-hidden="true" href="#cb88-4" tabindex="-1"></a><span class="at">  </span><span class="fu">node</span><span class="kw">:</span><span class="at"> &lt;node_type_name&gt;</span></span>
<span id="cb88-5"><a aria-hidden="true" href="#cb88-5" tabindex="-1"></a><span class="at">  </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> &lt;relationship_type_name&gt;</span></span>
<span id="cb88-6"><a aria-hidden="true" href="#cb88-6" tabindex="-1"></a><span class="at">  </span><span class="fu">node_filter</span><span class="kw">:</span><span class="at"> &lt;node_filter_definition&gt;</span></span>
<span id="cb88-7"><a aria-hidden="true" href="#cb88-7" tabindex="-1"></a><span class="at">  </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;min_count&gt;</span><span class="kw">,</span><span class="at"> &lt;max_count&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>requirement_definition_name: represents the mandatory symbolic
name 
of the requirement definition as a string. Requirement definition 
names SHALL be unique within a node type definition; it is an
error 
if the same requirement name occurs more than once.</p></li>
<li><p>capability_type_name: represents the mandatory name of a
capability 
type that can be used to fulfill the requirement.</p></li>
<li><p>capability_symbolic_name: represents the mandatory symbolic name
of 
the capability definition within the target node type; a 
capability_symbolic_name is only allowed if a node_type_name is 
provided.</p></li>
<li><p>node_type_name: represents the optional name of a node type that
contains 
either a capability of type <capability_type_name> or a capability 
named <capability_symbolic_name> that can be used to fulfill the 
requirement.</capability_symbolic_name></capability_type_name></p></li>
<li><p>relationship_type_name: represents the mandatory name of a 
relationship type to be used to construct a relationship from this 
requirement definition (i.e. in the source node) to a matching 
capability definition (in a target node).</p></li>
<li><p>interface_refinements: represents refinements for one or more
already 
declared interface definitions in the relationship type (as
declared 
on the type keyname)</p>
<ul>
<li>allowing for the declaration of new parameter definitions for
these<br/>
interfaces or for specific operation or notification definitions
of<br/>
these interfaces or for the change of the description or<br/>
implementation definitions.</li>
</ul></li>
<li><p>property_refinements: represents the optional map of
property 
refinements for properties already defined in the relationship
type; 
new properties may not be added.</p></li>
<li><p>attribute_refinements: represents the optional map of
attribute 
refinements for attributes already defined in the relationship
type; 
new attributes may not be added.</p></li>
<li><p>node_filter_definition: represents the optional node filter
TOSCA 
orchestrators will use to fulfill the requirement when selecting a 
target node, or to verify that the specified node template
fulfills 
the requirement (if a node template was specified during
requirement 
assignment).</p></li>
<li><p>min_count, max_count: represents the optional range between a
minimum 
required and maximum allowed count of the requirement</p>
<ul>
<li><p>this range constrains how many relationships from this
requirement 
towards target capabilities (in target nodes) are created, and
that 
number MUST be within the range specified here.</p></li>
<li><p>If the count_range keyname is not present, then a default
declaration 
will be assumed as follows:</p></li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb89-1"><a aria-hidden="true" href="#cb89-1" tabindex="-1"></a><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="dv">0</span><span class="kw">,</span><span class="at"> UNBOUNDED</span><span class="kw">]</span></span></code></pre></div></li>
</ul>
<h2 id="requirement-refinement">8.6 Requirement Refinement</h2>
<p>If a node type defines a requirement with the same name as a
requirement 
that is already defined in one of its parent node types, then that 
requirement definition is considered a <em>requirement refinement</em>
rather 
than a requirement definition. Requirement refinements adhere to
the 
following refinement rules for the supported keynames:</p>
<ul>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the requirement definition in the parent node
type 
definition.</p></li>
<li><p>capability: the type of the capability must be derived from (or
the 
same as) the capability type in the requirement definition in the 
parent node type definition.</p>
<ul>
<li>if the capability was specified using the symbolic name of a<br/>
capability definition in the target node type, then the capability<br/>
keyname definition MUST remain unchanged in any subsequent<br/>
refinements or during assignment.</li>
</ul></li>
<li><p>node: must be derived from (or the same as) the node type in
the 
requirement definition in the parent node type definition; if node
is 
not defined in the parent type then no restrictions are applied;</p>
<ul>
<li>the node type specified by the node keyname must also contain
a<br/>
capability definition that fulfills the requirement set via the<br/>
capability keyname above.</li>
</ul></li>
<li><p>relationship: must be derived from (or the same as) the
relationship 
type in the requirement definition in the parent node type
definition.</p></li>
<li><p>node_filter: a new definition is unrestricted and will be
considered 
in addition (i.e. logical and) to the node_filter definition in
the 
parent node type definition; further refinements may add further
node 
filters.</p></li>
<li><p>count_range: the new range MUST be within the range defined in
the 
requirement definition in the parent node type definition.</p></li>
</ul>
<h2 id="requirement-assignment">8.7 Requirement Assignment</h2>
<p>A <em>requirement assignment</em> is used by node template authors to
provide 
assignments for the corresponding requirement definition in the
node 
template’s node type. This includes specifying target nodes, either
by 
providing symbolic names of target nodes or by providing selection 
criteria for TOSCA orchestrators to find candidate nodes that can
be 
used to fulfill the requirement. In addition, requirement
assignments 
must uniquely identify the specific target capability in the
target 
node for the requirement. Requirement assignments must also assign 
values to properties and attributes defined in the relationship 
definition that is part of the requirement definition, and provide 
values for the input parameters defined by the relationship 
definition’s interfaces.</p>
<p>Note that several requirement assignments in a node template can
have 
the same symbolic name, each referring to different counts of the 
corresponding requirement definition. The number of instances a 
particular assignment allows is set via the <code>count</code> 
keyname. Nevertheless, the sum of the count values for all of the 
requirement assignments with the same symbolic name MUST be within
the 
range of count_range specified by the corresponding requirement 
definition.</p>
<h3 id="supported-keynames">8.7.1 Supported Keynames</h3>
<p>The following is the list of recognized keynames for a TOSCA
requirement 
assignment:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">node</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string or 2-entry list</td>
<td style="text-align: left;">The optional keyname used to identify the
target node of the requirement: <br/> - This can either be the symbolic
name of a node template, where the TOSCA processor will select a node
representation created from that template. If the count of the node
template is 1 then the potential target is unique, otherwise the
processor can select from several node representations. <br/> - It can
also be a 2-entry list, where the first entry is a string denoting the
symbolic name of a node template, while the second entry is an index,
thus uniquely identifying the node representation when multiple
representations are created from the same node template. The index is a
non-negative integer, with 0 being the first index. Note that functions
like <em><span class="math inline"><em>n</em><em>o</em><em>d</em><em>e</em><sub><em>i</em></sub><em>n</em><em>d</em><em>e</em><em>x</em> * <em>o</em><em>r</em>*</span>relationship_index</em>
may be used to match the target index withe the source/relationship
index. More information on multiplicity and node and relationship
indexes can be found in <a href="#14-creating-multiple-representations-from-templates">Chapter
14</a>. <br/> - Finally, it can also be the name of a node type that the
TOSCA processor will use to select a type-compatible target node to
fulfill the requirement.</td>
</tr>
<tr class="even">
<td style="text-align: left;">capability</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional keyname used to identify the
target capability of the requirement. This can either be the name of a
capability defined within a target node or the name of a target
capability type that the TOSCA orchestrator will use to select a
type-compatible target node to fulfill the requirement at runtime.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">relationship</td>
<td style="text-align: left;">conditional</td>
<td style="text-align: left;">relationship assignment or string</td>
<td style="text-align: left;">The conditional keyname used to provide
values for the relationship definition in the corresponding requirement
definition. This keyname can also be overloaded to define a symbolic
name that references a relationship template defined elsewhere in the
service template.</td>
</tr>
<tr class="even">
<td style="text-align: left;">allocation</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">allocation block</td>
<td style="text-align: left;">The optional keyname that allows the
inclusion of an allocation block. The allocation block contains a map of
property assignments that semantically represent <em>allocations</em>
from the property with the same name in the target capability. The
allocation acts as a <em>capacity filter</em> for the target capability
in the target node. When the requirement is resolved, a capability in a
node is a valid target for the requirement relationship if for each
property of the target capability, the sum of all existing allocations
plus the current allocation is less_or_equal to the property value.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">count</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">non-negative integer</td>
<td style="text-align: left;">An optional keyname that sets the
cardinality of the requirement assignment, that is how many
relationships must be established from this requirement assignment. If
not defined, the default count for an assignment is 1. Note that there
can be multiple requirement assignments for a requirement with a
specific symbolic name. The sum of all count values of assignments for a
requirement with a specific symbolic name must be within the count_range
defined in the requirement definition. Moreover, the sum of all count
values of non-optional assignments for a requirement with a specific
symbolic name must also be within the count_range defined in the
requirement definition.</td>
</tr>
<tr class="even">
<td style="text-align: left;">node_filter</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">node filter</td>
<td style="text-align: left;">The optional filter definition that TOSCA
orchestrators will use to select a type-compatible target node that can
fulfill the requirement at runtime.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">directives</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">An optional list of directive values to
provide processing instructions to orchestrators and tooling.</td>
</tr>
<tr class="even">
<td style="text-align: left;">optional</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">Describes if the fulfillment of this
requirement assignment is optional (true) or not (false). If not
specified, the requirement assignment must be fulfilled, i.e. the
default value is false. Note also, that non-optional requirements have
precedence, thus during a service deployment, the optional requirements
for all nodes should be resolved only after the non-optional
requirements for all nodes have been resolved.</td>
</tr>
</tbody>
</table>
<p>The <code>relationship</code> keyname in a requirement assignment
typically 
specifies a <em>relationship assignment</em> that provides information
needed 
by TOSCA Orchestrators to construct a relationship to the TOSCA
node 
that is the target of the requirement. Relationship assignments<br/>
support the following keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional keyname used to provide the
name of the relationship type for the requirement assignment’s
relationship.</td>
</tr>
<tr class="even">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property assignments</td>
<td style="text-align: left;">An optional map of property assignments
for the relationship.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">attributes</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of attribute assignments</td>
<td style="text-align: left;">An optional map of attribute assignments
for the relationship.</td>
</tr>
<tr class="even">
<td style="text-align: left;">interfaces</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of interface assignments</td>
<td style="text-align: left;">An optional map of interface assignments
for the corresponding interface definitions in the relationship
type.</td>
</tr>
</tbody>
</table>
<h3 id="requirement-assignment-grammar">8.7.2 Requirement Assignment
Grammar</h3>
<p>The keynames supported by requirement assignments and
relationship 
assignments can be used according to the following grammar:</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb90-1"><a aria-hidden="true" href="#cb90-1" tabindex="-1"></a><span class="fu">&lt;requirement_name&gt;</span><span class="kw">:</span></span>
<span id="cb90-2"><a aria-hidden="true" href="#cb90-2" tabindex="-1"></a><span class="at">  </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> &lt;capability_symbolic_name&gt; | &lt;capability_type_name&gt;</span></span>
<span id="cb90-3"><a aria-hidden="true" href="#cb90-3" tabindex="-1"></a><span class="at">  </span><span class="fu">node</span><span class="kw">:</span><span class="at"> &lt;node_template_name&gt; | &lt;tuple_of_node_template_and_index&gt; | &lt;node_type_name&gt;</span></span>
<span id="cb90-4"><a aria-hidden="true" href="#cb90-4" tabindex="-1"></a><span class="at">  </span><span class="fu">relationship</span><span class="kw">:</span></span>
<span id="cb90-5"><a aria-hidden="true" href="#cb90-5" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;relationship_type_name&gt;</span></span>
<span id="cb90-6"><a aria-hidden="true" href="#cb90-6" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_assignments&gt;</span></span>
<span id="cb90-7"><a aria-hidden="true" href="#cb90-7" tabindex="-1"></a><span class="at">    </span><span class="fu">attributes</span><span class="kw">:</span><span class="at"> &lt;attribute_assignments&gt;</span></span>
<span id="cb90-8"><a aria-hidden="true" href="#cb90-8" tabindex="-1"></a><span class="at">    </span><span class="fu">interfaces</span><span class="kw">:</span><span class="at"> &lt;interface_assignments&gt;</span></span>
<span id="cb90-9"><a aria-hidden="true" href="#cb90-9" tabindex="-1"></a><span class="at">  </span><span class="fu">node_filter</span><span class="kw">:</span><span class="at"> &lt;node_filter_definition&gt;</span></span>
<span id="cb90-10"><a aria-hidden="true" href="#cb90-10" tabindex="-1"></a><span class="at">  </span><span class="fu">count</span><span class="kw">:</span><span class="at"> &lt;count_value&gt;</span></span>
<span id="cb90-11"><a aria-hidden="true" href="#cb90-11" tabindex="-1"></a><span class="at">  </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> &lt;directives_list&gt;</span></span>
<span id="cb90-12"><a aria-hidden="true" href="#cb90-12" tabindex="-1"></a><span class="at">  </span><span class="fu">optional</span><span class="kw">:</span><span class="at"> &lt;is_optional&gt;</span></span>
<span id="cb90-13"><a aria-hidden="true" href="#cb90-13" tabindex="-1"></a><span class="at">  </span><span class="fu">allocation</span><span class="kw">:</span><span class="at"> &lt;allocation_property_assignments&gt;</span></span></code></pre></div>
<p>In some cases, a relationship assignment only needs to refine the
type 
of the relationship and does not need to assign properties, 
attributes, or interfaces. In that case, a single-line
relationship 
assignment grammar can be used where the value of the
<code>relationship</code> 
keyname in the requirement assignment refers to the symbolic name
of 
the type of the relationship. This single-line relationship grammar
is 
shown here:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb91-1"><a aria-hidden="true" href="#cb91-1" tabindex="-1"></a><span class="fu">&lt;requirement_name&gt;</span><span class="kw">:</span></span>
<span id="cb91-2"><a aria-hidden="true" href="#cb91-2" tabindex="-1"></a><span class="at">  </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> &lt;capability_symbolic_name&gt; | &lt;capability_type_name&gt;</span></span>
<span id="cb91-3"><a aria-hidden="true" href="#cb91-3" tabindex="-1"></a><span class="at">  </span><span class="fu">node</span><span class="kw">:</span><span class="at"> &lt;node_template_name&gt; | &lt;tuple_of_node_template_and_index&gt; | &lt;node_type_name&gt;</span></span>
<span id="cb91-4"><a aria-hidden="true" href="#cb91-4" tabindex="-1"></a><span class="at">  </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> &lt;relationship_type_name&gt;</span></span>
<span id="cb91-5"><a aria-hidden="true" href="#cb91-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_filter</span><span class="kw">:</span><span class="at"> &lt;node_filter_definition&gt;</span></span>
<span id="cb91-6"><a aria-hidden="true" href="#cb91-6" tabindex="-1"></a><span class="at">  </span><span class="fu">count</span><span class="kw">:</span><span class="at"> &lt;count_value&gt;</span></span>
<span id="cb91-7"><a aria-hidden="true" href="#cb91-7" tabindex="-1"></a><span class="at">  </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> &lt;directives_list&gt;</span></span>
<span id="cb91-8"><a aria-hidden="true" href="#cb91-8" tabindex="-1"></a><span class="at">  </span><span class="fu">optional</span><span class="kw">:</span><span class="at"> &lt;is_optional&gt;</span></span>
<span id="cb91-9"><a aria-hidden="true" href="#cb91-9" tabindex="-1"></a><span class="at">  </span><span class="fu">allocation</span><span class="kw">:</span><span class="at"> &lt;allocation_property_assignments&gt;</span></span></code></pre></div>
<p>As stated in the description of the supported keynames, 
the <code>relationship</code> keyname in a requirement assignment can
also be 
overloaded to specify the symbolic name of a relationship template
to 
use for creating the relationship to the target node when
fulfilling 
the requirement. In that case, the following single-line
relationship 
grammar is used:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb92-1"><a aria-hidden="true" href="#cb92-1" tabindex="-1"></a><span class="fu">&lt;requirement_name&gt;</span><span class="kw">:</span></span>
<span id="cb92-2"><a aria-hidden="true" href="#cb92-2" tabindex="-1"></a><span class="at">  </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> &lt;capability_symbolic_name&gt; | &lt;capability_type_name&gt;</span></span>
<span id="cb92-3"><a aria-hidden="true" href="#cb92-3" tabindex="-1"></a><span class="at">  </span><span class="fu">node</span><span class="kw">:</span><span class="at"> &lt;node_template_name&gt; | &lt;tuple_of_node_template_and_index&gt; | &lt;node_type_name&gt;</span></span>
<span id="cb92-4"><a aria-hidden="true" href="#cb92-4" tabindex="-1"></a><span class="at">  </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> &lt;relationship_template_name&gt;</span></span>
<span id="cb92-5"><a aria-hidden="true" href="#cb92-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_filter</span><span class="kw">:</span><span class="at"> &lt;node_filter_definition&gt;</span></span>
<span id="cb92-6"><a aria-hidden="true" href="#cb92-6" tabindex="-1"></a><span class="at">  </span><span class="fu">count</span><span class="kw">:</span><span class="at"> &lt;count_value&gt;</span></span>
<span id="cb92-7"><a aria-hidden="true" href="#cb92-7" tabindex="-1"></a><span class="at">  </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> &lt;directives_list&gt;</span></span>
<span id="cb92-8"><a aria-hidden="true" href="#cb92-8" tabindex="-1"></a><span class="at">  </span><span class="fu">optional</span><span class="kw">:</span><span class="at"> &lt;is_optional&gt;</span></span>
<span id="cb92-9"><a aria-hidden="true" href="#cb92-9" tabindex="-1"></a><span class="at">  </span><span class="fu">allocation</span><span class="kw">:</span><span class="at"> &lt;allocation_property_assignments&gt;</span></span></code></pre></div>
<p>When single-line relationship grammar is used, TOSCA Processors
MUST 
first try to resolve the value of the <code>relationship</code> keyword
as the 
symbolic name of a relationship type. If no relationship type with 
that name is found, the Processor MUST then try to find a
relationship 
template with that name. If no such relationship template is
found, 
the grammar must be determined to be in error.</p>
<p>And finally, to simplify requirement assignment grammar, the
following 
single-line grammar may be used if only a concrete node template
for 
the target node needs to be assigned:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb93-1"><a aria-hidden="true" href="#cb93-1" tabindex="-1"></a><span class="fu">&lt;requirement_name&gt;</span><span class="kw">:</span><span class="at"> &lt;node_template_name&gt;</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>requirement_name: represents the symbolic name of a
requirement 
assignment as a string.</p></li>
<li><p>capability_symbolic_name: represents the optional name of
the 
capability definition within the target node type or node template;</p>
<ul>
<li><p>if the capability in the requirement definition was
specified 
using the symbolic name of a capability definition in a target 
node type, then the capability keyname definition MUST remain 
unchanged in any subsequent refinements or during assignment.</p></li>
<li><p>if the capability in the requirement definition was
specified 
using the name of a capability type, then the capability 
definition referred here by the capability_symbolic_name must be 
of a type that is the same as or derived from the said capability 
type in the requirement definition.</p></li>
</ul></li>
<li><p>capability_type_name: represents the optional name of a
capability 
type definition within the target node type or node template this 
requirement needs to form a relationship with;</p>
<ul>
<li><p>may not be used if the capability in the requirement definition
was 
specified using the symbolic name of a capability definition in a 
target node type.</p></li>
<li><p>otherwise the capability_type_name must be of a type that is the
same 
as or derived from the type defined by the capability keyname in
the 
requirement definition.</p></li>
</ul></li>
<li><p>node_template_name: represents the optional name of a node
template 
that contains the capability that fulfills this requirement;</p>
<ul>
<li><p>in addition, the node type of the node template must be of a type
that 
is the same as or derived from the type defined by the node
keyname 
(if the node keyname is defined) in the requirement definition,</p></li>
<li><p>note that if the template has count &gt; 1 there are several
target node 
representation candidates,</p></li>
<li><p>in addition, the node representation created from the
template 
must fulfill the node filter 
requirements of the node_filter (if a node_filter is defined) in
the 
Requirement definition.</p></li>
</ul></li>
<li><p>tuple_of_node_template_and_index: represents an optional 2-entry
list, where 
the first entry is the name of a node template, and the second entry is
an index;</p>
<ul>
<li><p>the node template is subject to the same conditions as presented
above,</p></li>
<li><p>the index is a non-negative integer,</p></li>
<li><p>for indexes outside the count range of the template, no valid
target node 
representation candidate will exist.</p></li>
</ul></li>
<li><p>node_type_name: represents the optional name of a node type
that 
contains the capability that fulfills this requirement;</p>
<ul>
<li>in addition, the node_type_name must be of a type that is the same
as<br/>
or derived from the type defined by the node keyname (if the node<br/>
keyname is defined) in the requirement definition.</li>
</ul></li>
<li><p>relationship_template_name: represents the optional name of
a 
relationship template to be used when relating the requirement to
the 
capability in the target node.</p>
<ul>
<li>in addition, the relationship type of the relationship template
must<br/>
be of a type that is the same as or derived from the type defined
by<br/>
the relationship keyname (if the relationship keyname is defined)
in<br/>
the requirement definition.</li>
</ul></li>
<li><p>relationship_type_name: represents the optional name of a
relationship 
type that is compatible with the capability type in the target node;</p>
<ul>
<li>in addition, the relationship_type_name must be of a type that
is<br/>
the same as or derived from the type defined by the relationship<br/>
keyname in the requirement definition.</li>
</ul></li>
<li><p>property_assignments: within the relationship declaration,
it 
represents the optional map of property assignments for the
declared 
relationship.</p></li>
<li><p>attribute_assignments: within the relationship declaration,
it 
represents the optional map of attribute assignments for the
declared 
relationship.</p></li>
<li><p>interface_assignments: represents the optional map of
interface 
assignments for the declared relationship used to provide
parameter 
assignments on inputs and outputs of interfaces, operations and 
notifications or changing the implementation definition.</p></li>
<li><p>allocation_property_assignments: within the allocation
declaration, it 
represents the optional map of property assignments that
semantically 
represent <em>allocations</em> from the property with the same name in
the 
target capability. Syntactically their form is the same as for a 
normal property assignments.</p></li>
<li><p>node_filter_definition: represents the optional node filter
TOSCA 
orchestrators will use to fulfill the requirement for selecting a 
target node; if a node template was specified during requirement 
assignment, the TOSCA orchestrator verifies that the specified
node 
template fulfills the node filter.</p>
<ul>
<li>this node_filter does not replace the node_filter definition in
the<br/>
requirement definition, it is applied in addition to that.</li>
</ul></li>
<li><p>count_value: represents the optional cardinality of this
requirement 
assignment, that is how many relationships are to be established
from 
this requirement assignment specification.</p>
<ul>
<li>If count is not defined, the default count_value for an assignment
is
<ol type="1">
<li></li>
</ol></li>
</ul></li>
<li><p>directives_list: represents the optional list of strings
that 
defines if this requirement needs to be fulfilled using target
nodes 
created within this service template only, target nodes created 
outside this service template only, or both. Valid values for the 
strings are as follows:</p>
<ul>
<li><p><code>internal</code>: this requirement is fulfilled using target
nodes 
created within this template.</p></li>
<li><p><code>external</code>: this requirement is fulfilled using target
nodes 
created outside this template as available to the TOSCA 
environment.</p></li>
</ul>
<p>The order of the strings in the list defines which directive
should 
be attempted first when fulfilling the assignment.</p>
<p>If no directives are defined, the default value is left to the 
particular implementation.</p></li>
<li><p>is_optional: represents the optional boolean value specifying if
this 
requirement assignment is optional or not.</p>
<ul>
<li><p>If is_optional is false, the assignment MUST be
fulfilled.</p></li>
<li><p>If is_optional is true, the assignment SHOULD be fulfilled, but
if not 
possible the service deployment is still considered valid.</p></li>
<li><p>The default value for is_optional is false.</p></li>
</ul>
<p>Non-optional requirements have precedence, thus during a
service 
deployment, the optional requirements for all nodes should be 
fulfilled only after the non-optional requirements for all nodes 
have been fulfilled.</p></li>
</ul>
<p>The following code snippet shows an example requirement assignment.
It 
defines a web application node template named 
‘my_application_node_template’ of type <code>WebApplication</code> that
declares 
a requirement named <code>host</code> that needs to be fulfilled by any
node that 
derives from the node type <code>WebServer</code>:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb94-1"><a aria-hidden="true" href="#cb94-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb94-2"><a aria-hidden="true" href="#cb94-2" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb94-3"><a aria-hidden="true" href="#cb94-3" tabindex="-1"></a><span class="at">    </span><span class="fu">my_application_node_template</span><span class="kw">:</span></span>
<span id="cb94-4"><a aria-hidden="true" href="#cb94-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> WebApplication</span></span>
<span id="cb94-5"><a aria-hidden="true" href="#cb94-5" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb94-6"><a aria-hidden="true" href="#cb94-6" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb94-7"><a aria-hidden="true" href="#cb94-7" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> WebServer</span></span></code></pre></div>
<p>In this case, the <code>WebApplication</code> type defines a
<code>host</code> requirement 
that uses relationship type <code>HostedOn</code> relate to the target
node. The 
<code>host</code> requirement also specifies a capability type of
<code>Container</code> to 
be the specific target of the requirement in the target node.</p>
<p>The following example targets a WebServer created from the
tomcat_server 
template that has the same multiplicity index as the actual
my_application node.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb95-1"><a aria-hidden="true" href="#cb95-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb95-2"><a aria-hidden="true" href="#cb95-2" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb95-3"><a aria-hidden="true" href="#cb95-3" tabindex="-1"></a><span class="at">    </span><span class="fu">my_application</span><span class="kw">:</span></span>
<span id="cb95-4"><a aria-hidden="true" href="#cb95-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> WebApplication</span></span>
<span id="cb95-5"><a aria-hidden="true" href="#cb95-5" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb95-6"><a aria-hidden="true" href="#cb95-6" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb95-7"><a aria-hidden="true" href="#cb95-7" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb95-8"><a aria-hidden="true" href="#cb95-8" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> tomcat_server</span><span class="kw">,</span><span class="at"> $node_index </span><span class="kw">]</span></span></code></pre></div>
<p>The following example shows a requirement named <code>database</code>
that 
describes a requirement for a connection to a capability of type 
<code>Endpoint.Database</code> in a node template called
<code>my_database</code>. However, 
the connection requires a custom relationship type 
(my.types.CustomDbConnection’) declared on the keyname
‘relationship’.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb96-1"><a aria-hidden="true" href="#cb96-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb96-2"><a aria-hidden="true" href="#cb96-2" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb96-3"><a aria-hidden="true" href="#cb96-3" tabindex="-1"></a><span class="at">    </span><span class="fu">my_application_node_template</span><span class="kw">:</span></span>
<span id="cb96-4"><a aria-hidden="true" href="#cb96-4" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb96-5"><a aria-hidden="true" href="#cb96-5" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">database</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb96-6"><a aria-hidden="true" href="#cb96-6" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> my_database</span></span>
<span id="cb96-7"><a aria-hidden="true" href="#cb96-7" tabindex="-1"></a><span class="at">            </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Endpoint.Database</span></span>
<span id="cb96-8"><a aria-hidden="true" href="#cb96-8" tabindex="-1"></a><span class="at">            </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> my.types.CustomDbConnection</span></span></code></pre></div>
<h3 id="requirement-count">8.7.4 Requirement Count</h3>
<p>A node template may include multiple requirement assignments with
the 
same symbolic requirement name. In addition, each of these
requirement 
assignments may define their own count value, and some requirement 
assignments may be marked as optional. This section specifies
rules 
for handling requirement counts:</p>
<ul>
<li><p>The sum of all count values for requirement assignments with
a 
specific symbolic name MUST be within the count_range defined in
the 
corresponding requirement definition.</p></li>
<li><p>Moreover, the sum of all count values for non-optional
requirement 
assignments with a specific symbolic name MUST also be within the 
count_range defined in the requirement definition.</p></li>
<li><p>If a node template does not define an explicit requirement 
assignment for a requirement defined in its corresponding node
type, 
an <em>implicit</em> requirement assignment will be created
automatically 
if the lower bound of the count_range in the requirement
definition 
is greater than zero</p>
<ul>
<li>The automatically created requirement assignments use the same<br/>
values for the capability, node, relationship, and node_filter<br/>
keynames as defined in the corresponding requirement definition.</li>
<li>Additionally, the count_value is assumed to be equal to the
min_count<br/>
value of the requirement definition in the corresponding node type.</li>
</ul></li>
</ul>
<p>The following example illustrates requirement assignment count 
rules. It uses the types defined in the following code snippet:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb97-1"><a aria-hidden="true" href="#cb97-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb97-2"><a aria-hidden="true" href="#cb97-2" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb97-3"><a aria-hidden="true" href="#cb97-3" tabindex="-1"></a><span class="at">  </span><span class="fu">Service</span><span class="kw">:</span></span>
<span id="cb97-4"><a aria-hidden="true" href="#cb97-4" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb97-5"><a aria-hidden="true" href="#cb97-5" tabindex="-1"></a>      Ability to provide service.</span>
<span id="cb97-6"><a aria-hidden="true" href="#cb97-6" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb97-7"><a aria-hidden="true" href="#cb97-7" tabindex="-1"></a><span class="at">  </span><span class="fu">ServedBy</span><span class="kw">:</span></span>
<span id="cb97-8"><a aria-hidden="true" href="#cb97-8" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb97-9"><a aria-hidden="true" href="#cb97-9" tabindex="-1"></a>      Connection to a service.</span>
<span id="cb97-10"><a aria-hidden="true" href="#cb97-10" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb97-11"><a aria-hidden="true" href="#cb97-11" tabindex="-1"></a><span class="at">  </span><span class="fu">Client</span><span class="kw">:</span></span>
<span id="cb97-12"><a aria-hidden="true" href="#cb97-12" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb97-13"><a aria-hidden="true" href="#cb97-13" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb97-14"><a aria-hidden="true" href="#cb97-14" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb97-15"><a aria-hidden="true" href="#cb97-15" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb97-16"><a aria-hidden="true" href="#cb97-16" tabindex="-1"></a><span class="at">          </span><span class="fu">node</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb97-17"><a aria-hidden="true" href="#cb97-17" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">4</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb97-18"><a aria-hidden="true" href="#cb97-18" tabindex="-1"></a><span class="at">  </span><span class="fu">Server</span><span class="kw">:</span></span>
<span id="cb97-19"><a aria-hidden="true" href="#cb97-19" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb97-20"><a aria-hidden="true" href="#cb97-20" tabindex="-1"></a><span class="at">      </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb97-21"><a aria-hidden="true" href="#cb97-21" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Service</span></span></code></pre></div>
<p>In this example, the <code>Client</code> node type defines a
<code>service</code> 
requirement with a <code>count_range</code> of <code>[1, 4]</code>. This
means that a client 
can have up to four <code>service</code> connections to
<code>Server</code> nodes, but only 
one of those is mandatory.</p>
<p>Any service template that uses the <code>Client</code> node type must
specify the 
correct number of requirement assignments, i.e, the number of 
mandatory requirements must be greater than or equal to the lower 
bound of the <code>count_range</code> and he total number of
requirement 
assignments (optional as well as mandatory) must be less than or
equal 
to the upper bound of the count range.</p>
<p>The following shows a valid service template that uses
<code>Client</code> and 
<code>Server</code> nodes.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb98-1"><a aria-hidden="true" href="#cb98-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb98-2"><a aria-hidden="true" href="#cb98-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb98-3"><a aria-hidden="true" href="#cb98-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb98-4"><a aria-hidden="true" href="#cb98-4" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb98-5"><a aria-hidden="true" href="#cb98-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb98-6"><a aria-hidden="true" href="#cb98-6" tabindex="-1"></a><span class="at">    </span><span class="fu">server1</span><span class="kw">:</span></span>
<span id="cb98-7"><a aria-hidden="true" href="#cb98-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb98-8"><a aria-hidden="true" href="#cb98-8" tabindex="-1"></a><span class="at">    </span><span class="fu">server2</span><span class="kw">:</span></span>
<span id="cb98-9"><a aria-hidden="true" href="#cb98-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb98-10"><a aria-hidden="true" href="#cb98-10" tabindex="-1"></a><span class="at">    </span><span class="fu">server3</span><span class="kw">:</span></span>
<span id="cb98-11"><a aria-hidden="true" href="#cb98-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb98-12"><a aria-hidden="true" href="#cb98-12" tabindex="-1"></a><span class="at">    </span><span class="fu">client</span><span class="kw">:</span></span>
<span id="cb98-13"><a aria-hidden="true" href="#cb98-13" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb98-14"><a aria-hidden="true" href="#cb98-14" tabindex="-1"></a><span class="at">      </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> substitute </span><span class="kw">]</span></span>
<span id="cb98-15"><a aria-hidden="true" href="#cb98-15" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb98-16"><a aria-hidden="true" href="#cb98-16" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> server1</span></span>
<span id="cb98-17"><a aria-hidden="true" href="#cb98-17" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> server2</span></span>
<span id="cb98-18"><a aria-hidden="true" href="#cb98-18" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> server3</span></span></code></pre></div>
<p>In this example, the requirement assignments specify the target
nodes 
directly, but it is also valid to leave requirements dangling as
in 
the following example:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb99-1"><a aria-hidden="true" href="#cb99-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb99-2"><a aria-hidden="true" href="#cb99-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb99-3"><a aria-hidden="true" href="#cb99-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb99-4"><a aria-hidden="true" href="#cb99-4" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb99-5"><a aria-hidden="true" href="#cb99-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb99-6"><a aria-hidden="true" href="#cb99-6" tabindex="-1"></a><span class="at">    </span><span class="fu">server1</span><span class="kw">:</span></span>
<span id="cb99-7"><a aria-hidden="true" href="#cb99-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb99-8"><a aria-hidden="true" href="#cb99-8" tabindex="-1"></a><span class="at">    </span><span class="fu">server2</span><span class="kw">:</span></span>
<span id="cb99-9"><a aria-hidden="true" href="#cb99-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb99-10"><a aria-hidden="true" href="#cb99-10" tabindex="-1"></a><span class="at">    </span><span class="fu">server3</span><span class="kw">:</span></span>
<span id="cb99-11"><a aria-hidden="true" href="#cb99-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb99-12"><a aria-hidden="true" href="#cb99-12" tabindex="-1"></a><span class="at">    </span><span class="fu">client</span><span class="kw">:</span></span>
<span id="cb99-13"><a aria-hidden="true" href="#cb99-13" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb99-14"><a aria-hidden="true" href="#cb99-14" tabindex="-1"></a><span class="at">      </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> substitute </span><span class="kw">]</span></span>
<span id="cb99-15"><a aria-hidden="true" href="#cb99-15" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb99-16"><a aria-hidden="true" href="#cb99-16" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> server1</span></span>
<span id="cb99-17"><a aria-hidden="true" href="#cb99-17" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb99-18"><a aria-hidden="true" href="#cb99-18" tabindex="-1"></a><span class="at">            </span><span class="fu">optional</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb99-19"><a aria-hidden="true" href="#cb99-19" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb99-20"><a aria-hidden="true" href="#cb99-20" tabindex="-1"></a><span class="at">            </span><span class="fu">optional</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<p>In this example, only the first <code>service</code> assignment is
mandatory. The 
next two are optional. However, after the orchestrator <em>fulfills</em>
the 
dangling (optional) requirements, the resulting service topology
for 
this second example will likely be identical to the service
topology 
in the first example, since the orchestrator is able to fulfill
both 
of the optional requirements using <code>server</code> nodes in this
topology.</p>
<p>Note that after requirements have been fulfilled, it no longer
matters 
whether the requirement were mandatory or optional. All that
matters 
is that if the service topology is valid, the number of
established 
relationships is guaranteed to fall within the <code>count_range</code>
specified 
in the corresponding requirement definition.</p>
<h3 id="capability-allocation">8.7.5 Capability Allocation</h3>
<p>The value of the <code>allocation</code> keyword in a requirement
assignment acts 
as a <em>capacity filter</em> for the target capability in the
target 
node. When the requirement is fulfilled, a capability in a node is
a 
valid target for the requirement if, for each property of the
target 
capability, the sum of all existing allocations plus the current 
allocation is less than or equal to the property value.</p>
<p>The following allocation rules apply:</p>
<ul>
<li><p>The sum of allocations from all the incoming relationships for
a 
certain capability property cannot exceed the value of the
property.</p></li>
<li><p>If the allocation refers (via its name) to a property that does
not 
exist in a capability, then the allocation statement is
invalid.</p></li>
</ul>
<p>Of course, allocations can be defined only for integer, float,
or 
scalar property types.</p>
<p>The following example shows a <em>capacity allocation</em> on the
properties 
of a target capability of type <code>Compute</code>. When this
requirement is 
fulfilled, a node is a valid target and a relationship is created
only 
if both the capacity allocations for num_cpu and mem_size are 
fulfilled, that is if the sum of the capacity allocations from all 
established relationships + current allocation is less or equal to
the 
value of each respective property in the target capability.</p>
<p>So assuming that num_cpu property in the target capability of a 
candidate node has value 4 and the sum of capacity allocations of
the 
other fulfilled requirements to that capability for num_cpu is 1
then 
then there is enough <em>remaining capacity</em> (4 – 1 = 3) to fulfill
the 
current allocation (2), and a relationship to that node is
established. 
Another node with num_cpu with value 2 could not be a valid target
since 
1 (existing) + 2 (current) = 3, and that is larger than the
property 
value which is 2. Of course, similar calculations must be done for
the 
mem_size allocation.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb100-1"><a aria-hidden="true" href="#cb100-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb100-2"><a aria-hidden="true" href="#cb100-2" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb100-3"><a aria-hidden="true" href="#cb100-3" tabindex="-1"></a><span class="at">    </span><span class="fu">my_critical_application_node_template</span><span class="kw">:</span></span>
<span id="cb100-4"><a aria-hidden="true" href="#cb100-4" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb100-5"><a aria-hidden="true" href="#cb100-5" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb100-6"><a aria-hidden="true" href="#cb100-6" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb100-7"><a aria-hidden="true" href="#cb100-7" tabindex="-1"></a><span class="at">            </span><span class="fu">allocation</span><span class="kw">:</span></span>
<span id="cb100-8"><a aria-hidden="true" href="#cb100-8" tabindex="-1"></a><span class="at">              </span><span class="fu">num_cpu</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb100-9"><a aria-hidden="true" href="#cb100-9" tabindex="-1"></a><span class="at">              </span><span class="fu">mem_size</span><span class="kw">:</span><span class="at"> 128 MB</span></span></code></pre></div>
<h2 id="node-filter-definition">8.8 Node Filter definition</h2>
<p>In addition to the node, relationship and capability types, a
filter, 
with the keyname node_filter, may be provided in requirement 
definitions and requirement assignments to constrain the allowed
set 
of potential target nodes based upon their properties and their 
capabilities’ properties. This allows TOSCA orchestrators to help
find 
the <em>best fit</em> when selecting among multiple potential target
nodes 
for the expressed requirements. Also, if a node template was
specified 
during requirement assignment it allows TOSCA orchestrators to
verify 
that the specified node template fulfills the requirement.</p>
<p>Node filters are defined using condition clauses as shown in
the 
following grammar:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb101-1"><a aria-hidden="true" href="#cb101-1" tabindex="-1"></a><span class="fu">node_filter</span><span class="kw">:</span><span class="at"> &lt;condition_clause&gt; </span></span></code></pre></div>
<p>In the above grammar, the condition_clause represents a Boolean 
expression that will be used to select (filter) TOSCA nodes that
are 
valid candidates for fulfilling the requirement that defines the
node 
filter. TOSCA orchestrators use node filters are follows:</p>
<ul>
<li><p>Orchestrators select an initial set of target node candidates
based on 
the target capability type and/or the target node type specified
in 
the requirement definition.</p></li>
<li><p>A node in this initial set is a valid target node candidate if,
when 
that node is used as the target node for the requirement, the node 
filter condition clause evaluates to True.</p></li>
<li><p>Note that the context within which the node filter must be
evaluated 
is the relationship that is established to the target node as a
result 
of fulfilling the requirement. Specifically, this means that the
SELF 
keyword in any TOSCA Path expressions refer to that
relationship.</p></li>
</ul>
<p>The following example shows a node filter that will be used to
select 
a Compute node based upon the values of its defined 
capabilities. Specifically, this filter will select Compute nodes
that 
support a specific range of CPUs (i.e., num_cpus value between 1
and 
4) and memory size (i.e., mem_size of 2 or greater) from its
declared 
<code>host</code> capability.</p>
<pre><code>service_template:
  node_templates:
    my_node_template:
      # other details omitted for brevity
      requirements:
        - host:
            node_filter:
              $and:
                - $in_range:
                  - $get_property: [ SELF, CAPABILITY, num_cpus ]
                  - [ 1, 4 ]
                - $greater_or_equal:
                  - $get_property: [ SELF, CAPABILITY, mem_size ]
                  - 512 MB </code></pre>
<hr/>
<h1 id="properties-attributes-and-parameters">9 Properties, Attributes,
and Parameters</h1>
<p>This section presents how data are handled in TOSCA via
properties, 
attributes, and parameters. As with other entities in TOSCA, all
data 
are <em>typed</em>. TOSCA data types can be divided into built-in data
types 
and user-defined types. Built-in types comprise primitive types, 
special types, and collection types. Custom (<em>user-defined</em>)
types can 
be user-defined refinements of the built-in types as well as
complex 
data types.</p>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative.</p>
<h2 id="tosca-built-in-types">9.1 TOSCA Built-In Types</h2>
<p>The following table summarizes the TOSCA built-in data types. All
of 
these type names are reserved and cannot be used for custom data 
types. Note, however, that it is possible to derive a custom data
type 
from a primitive type, for example to add a validation clause or
to 
specify a default value.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Primitive Types</th>
<th style="text-align: left;">Special Types</th>
<th style="text-align: left;">Collection Types</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">string</td>
<td style="text-align: left;">timestamp</td>
<td style="text-align: left;">list</td>
</tr>
<tr class="even">
<td style="text-align: left;">integer</td>
<td style="text-align: left;">scalar-unit</td>
<td style="text-align: left;">map</td>
</tr>
<tr class="odd">
<td style="text-align: left;">float</td>
<td style="text-align: left;">scalar-unit.time</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">version</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">bytes</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">nil</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="primitive-types">9.1.1 Primitive Types</h3>
<p>The TOSCA primitive types have been specified to allow for the 
broadest possible support for implementations. TOSCA types use the 
following guiding principles:</p>
<ol type="1">
<li><p>Because TOSCA files are written in YAML they must support all
the 
literal primitives in YAML. However, it is important to also allow 
for consistency of representation of external data, e.g. service 
template inputs and outputs, property and attribute values stored
in 
a database, etc.</p></li>
<li><p>Adherence to 64-bit precision to ensure portability of numeric
data.</p></li>
<li><p>TOSCA parsers <em>shall not</em> automatically convert between
primitive 
types. Thus, care should be taken to use the correct YAML notation 
for that type. Details will be provided below.</p></li>
</ol>
<h4 id="string">9.1.1.1 string</h4>
<p>A TOSCA <em>string</em> is an array of Unicode runes. (For storing
an 
arbitrary array of bytes see the <em>bytes</em> type, below.)</p>
<p>Because TOSCA adheres to 64-bit precision, the minimum length
of 
strings is 0 and the maximum length of strings is 4,294,967,295.</p>
<p>TOSCA <em>does not</em> specify a character encoding. For example, a
string 
could be encoded as UTF-8 or UTF-16. The exact encoding used
depends 
on the implementation.</p>
<p>Be aware that YAML parsers will attempt to parse unquoted
character 
sequences as other types (booleans, integers, floats, etc.)
<em>before</em> 
falling back to the !!string type. For example, the unquoted
sequence 
<code>0.1</code> would be interpreted as a YAML !!float. Likewise, the
unquoted 
sequence <code>nan</code> would become the !!float value of 
not-a-number. However, in TOSCA a string value <em>must</em> be
specified in 
YAML as a !!string.</p>
<p>A TOSCA parser <em>shall not</em> attempt to convert other primitive
types to 
strings if a string type is required. This requirement is necessary
for 
ensuring portability, because there is no single, standard 
representation for the other types, e.g. scientific notations for 
decimals, the words <code>true</code> vs. <code>True</code> for
booleans, etc. In YAML users 
should thus add quotation marks around literal strings that YAML
would 
otherwise interpret as other types.</p>
<p>This following example would be invalid if there were no quotation
marks 
around <code>0.1</code>:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb103-1"><a aria-hidden="true" href="#cb103-1" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb103-2"><a aria-hidden="true" href="#cb103-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Node</span><span class="kw">:</span></span>
<span id="cb103-3"><a aria-hidden="true" href="#cb103-3" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb103-4"><a aria-hidden="true" href="#cb103-4" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span></span>
<span id="cb103-5"><a aria-hidden="true" href="#cb103-5" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb103-6"><a aria-hidden="true" href="#cb103-6" tabindex="-1"></a></span>
<span id="cb103-7"><a aria-hidden="true" href="#cb103-7" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb103-8"><a aria-hidden="true" href="#cb103-8" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb103-9"><a aria-hidden="true" href="#cb103-9" tabindex="-1"></a><span class="at">    </span><span class="fu">node</span><span class="kw">:</span></span>
<span id="cb103-10"><a aria-hidden="true" href="#cb103-10" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Node</span></span>
<span id="cb103-11"><a aria-hidden="true" href="#cb103-11" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb103-12"><a aria-hidden="true" href="#cb103-12" tabindex="-1"></a><span class="at">        </span><span class="fu">name</span><span class="kw">:</span><span class="at"> </span><span class="st">"0.1"</span></span></code></pre></div>
<p>Please note: 
1. There are various ways to specify literal !!string data in YAML
for 
handling indentation, newlines, as well as convenient support for 
line folding for multiline strings. All may be used in TOSCA. A 
TOSCA parser shall not modify the YAML string in any way, e.g. no trimming of whitespace or newlines. <a href="https://yaml.org/spec/1.2/spec.html#Basic">[YAML 1.2 chapter <br/> 
6]</a></p>
<ol start="2" type="1">
<li><p>The TOSCA functions <em>concat</em>, <em>join</em>,
<em>token</em>, <em>length</em>, 
and <em>matches</em> are all Unicode-aware. 
Specifically, the length of a string is a count of its runes, not 
the length of the byte array, which may differ according to the 
encoding. [See XXX]</p></li>
<li><p>The TOSCA functions that check for equality, <em>equal</em>
and 
<em>valid_values</em>, should work regardless of the Unicode encoding.
For 
example, comparing two strings that are <code>!</code>, one of which is
in 
UTF-8 and is encoded as <code>0x21</code>, the other which is in UTF-16
and is 
encoded as <code>0x0021</code>, would result in equality. For
simplicity, 
implementations may standardize on a single encoding, e.g., UTF-8, 
and convert all other encodings to it. [See XXX]</p></li>
<li><p>Relatedly, although in YAML 1.2 a !!string is already defined as
a Unicode sequence <a href="https://yaml.org/spec/1.2/spec.html#id2802842">[YAML 1.2 section <br/> 
10.1.1.3]</a>, this 
sequence can be variously encoded according to the character set
and encoding of the YAML stream <a href="https://yaml.org/spec/1.2/spec.html#Characters">[YAML 1.2 chapter <br/> 
5]</a>. The 
consequence is that a TOSCA string specified in literal YAML may 
inherit the encoding of the YAML document. Again, implementations 
may prefer to convert all strings to a single encoding.</p></li>
<li><p>TOSCA strings <em>cannot</em> be the null value but <em>can</em>
be empty strings 
(a string with length zero). [See <em>nil</em>, below]</p></li>
<li><p>YAML is a streaming format, but TOSCA strings are explicitly
<em>not</em> 
streams and thus do have a size limit. Thus, TOSCA implementations 
should check against the size limit.</p></li>
</ol>
<blockquote>
<p>Tal’s comment: for functions we should specify their exact
behavior 
for various primitive types. Some won’t work on all types,
e.g. “length” 
should not work on integers.</p>
</blockquote>
<h4 id="integer">9.1.1.2 integer</h4>
<p>A TOSCA <em>integer</em> is a 64-bit signed integer.</p>
<p>For simplicity, TOSCA does not have integers of other bit widths,
nor 
does it have an unsigned integer type. However, it is possible to 
enforce most of these variations using data type validation
clauses 
[see XXX].</p>
<p>For example, this would be a custom data type for unsigned
16-bit 
integers:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb104-1"><a aria-hidden="true" href="#cb104-1" tabindex="-1"></a><span class="fu">data_types</span><span class="kw">:</span></span>
<span id="cb104-2"><a aria-hidden="true" href="#cb104-2" tabindex="-1"></a><span class="at">  </span><span class="fu">UInt16</span><span class="kw">:</span></span>
<span id="cb104-3"><a aria-hidden="true" href="#cb104-3" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb104-4"><a aria-hidden="true" href="#cb104-4" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$in_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> </span><span class="dv">0xFFFF</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>YAML allows for the standard decimal notation as well as hexadecimal
and octal notations [<a href="https://yaml.org/spec/1.2/spec.html#id2761509">YAML 1.2 example <br/> 
2.19</a>]. In the above 
example we indeed used the hexadecimal notation.</p>
<p>Please note:</p>
<ol type="1">
<li><p>The JSON schema for YAML 1.2 <a href="https://yaml.org/spec/1.2/spec.html#id2803231">[YAML 1.2 chapter <br/> 
10.2]</a> allows for 
compatibility with JSON, such that YAML would be a superset of
JSON. 
However, note that the JSON format does not distinguish between 
integers and floats, and thus many JSON implementations use floats 
instead of integers.</p></li>
<li><p>TOSCA does not specify the endianness of integers and indeed
makes 
no requirements for data representation.</p></li>
</ol>
<h4 id="float">9.1.1.3 float</h4>
<p>A TOSCA <em>float</em> is a 64-bit (double-precision) floating-point
number 
[IEEE 754], including the standard values for negative infinity, 
positive infinity, and not-a-number.</p>
<p>Be aware that YAML parsers will parse numbers with a decimal point
as 
!!float even if they <em>could</em> be represented as !!int, and
likewise 
numbers without a decimal point would <em>always</em> be parsed as
!!int.</p>
<p>A TOSCA parser <em>shall not</em> attempt to convert a YAML !!int to
a float except where the int is supplied as the value of a TOSCA
property of type float. 
Type conversion in this exceptional case is to prevent the need for
users to add a “.0” suffix to literal integers 
that must be floats.</p>
<p>Thus following example MUST NOT result in an error:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb105-1"><a aria-hidden="true" href="#cb105-1" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb105-2"><a aria-hidden="true" href="#cb105-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Node</span><span class="kw">:</span></span>
<span id="cb105-3"><a aria-hidden="true" href="#cb105-3" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb105-4"><a aria-hidden="true" href="#cb105-4" tabindex="-1"></a><span class="at">      </span><span class="fu">speed</span><span class="kw">:</span></span>
<span id="cb105-5"><a aria-hidden="true" href="#cb105-5" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb105-6"><a aria-hidden="true" href="#cb105-6" tabindex="-1"></a></span>
<span id="cb105-7"><a aria-hidden="true" href="#cb105-7" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb105-8"><a aria-hidden="true" href="#cb105-8" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb105-9"><a aria-hidden="true" href="#cb105-9" tabindex="-1"></a><span class="at">    </span><span class="fu">node</span><span class="kw">:</span></span>
<span id="cb105-10"><a aria-hidden="true" href="#cb105-10" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Node</span></span>
<span id="cb105-11"><a aria-hidden="true" href="#cb105-11" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb105-12"><a aria-hidden="true" href="#cb105-12" tabindex="-1"></a><span class="at">          </span><span class="fu">speed</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span></code></pre></div>
<p>Please note:</p>
<ol type="1">
<li><p>In addition to decimal, YAML also allows for specifying floats
using 
scientific notation as well as special unquoted words for negative infinity, positive infinity, and not-a-number <a href="https://yaml.org/spec/1.2/spec.html#id2761530">[YAML 1.2 example <br/> 
2.20]</a>.</p></li>
<li><p>TOSCA does not specify how to convert to other precisions nor
to 
other formats, e.g. Bfloat16 and TensorFloat-32.</p></li>
<li><p>TOSCA does not specify the endianness of floats and indeed makes
no requirements for data representation.</p></li>
</ol>
<h4 id="boolean">9.1.1.4 boolean</h4>
<p>A TOSCA <em>boolean</em> is a single bit.</p>
<p>Note that in YAML literal booleans can be <em>only</em> either the
unquoted 
all-lowercase words “true” or “false”.</p>
<p>A TOSCA parser <em>shall not</em> attempt to convert these values,
nor 
variations such as “yes” or “True”, as quoted strings to booleans,
nor 
shall it attempt to convert integer values (such as 1 and 0) to 
booleans. This requirement is necessary for ensuring portability as
well 
as clarity.</p>
<h4 id="bytes">9.1.1.5 bytes</h4>
<p>TOSCA <em>bytes</em> are an array of arbitrary bytes. Because we
adhere to 
64-bit precision, the minimum length of bytes is 0 and the maximum 
length of bytes is 4,294,967,295.</p>
<p>To specify literal bytes in YAML you <em>must</em> use a
Base64-encoded 
!!string [RFC 2045 section 6.8]. There exist many free tools to
help 
you convert arbitrary data to Base64.</p>
<p>Example:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb106-1"><a aria-hidden="true" href="#cb106-1" tabindex="-1"></a><span class="fu">ode_types</span><span class="kw">:</span></span>
<span id="cb106-2"><a aria-hidden="true" href="#cb106-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Node</span><span class="kw">:</span></span>
<span id="cb106-3"><a aria-hidden="true" href="#cb106-3" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb106-4"><a aria-hidden="true" href="#cb106-4" tabindex="-1"></a><span class="at">      </span><span class="fu">preamble</span><span class="kw">:</span></span>
<span id="cb106-5"><a aria-hidden="true" href="#cb106-5" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> bytes</span></span>
<span id="cb106-6"><a aria-hidden="true" href="#cb106-6" tabindex="-1"></a></span>
<span id="cb106-7"><a aria-hidden="true" href="#cb106-7" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb106-8"><a aria-hidden="true" href="#cb106-8" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb106-9"><a aria-hidden="true" href="#cb106-9" tabindex="-1"></a><span class="at">    </span><span class="fu">node</span><span class="kw">:</span></span>
<span id="cb106-10"><a aria-hidden="true" href="#cb106-10" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Node</span></span>
<span id="cb106-11"><a aria-hidden="true" href="#cb106-11" tabindex="-1"></a><span class="at">        </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb106-12"><a aria-hidden="true" href="#cb106-12" tabindex="-1"></a><span class="at">          </span><span class="fu">preamble</span><span class="kw">:</span><span class="at"> </span><span class="st">"\</span></span>
<span id="cb106-13"><a aria-hidden="true" href="#cb106-13" tabindex="-1"></a><span class="st">R0lGODlhDAAMAIQAAP//9/X17unp5WZmZgAAAOfn515eXvPz7Y6OjuDg4J+fn5\</span></span>
<span id="cb106-14"><a aria-hidden="true" href="#cb106-14" tabindex="-1"></a><span class="st">OTk6enp56enmlpaWNjY6Ojo4SEhP/++f/++f/++f/++f/++f/++f/++f/++f/+\</span></span>
<span id="cb106-15"><a aria-hidden="true" href="#cb106-15" tabindex="-1"></a><span class="st">+f/++f/++f/++f/++f/++SH+Dk1hZGUgd2l0aCBHSU1QACwAAAAADAAMAAAFLC\</span></span>
<span id="cb106-16"><a aria-hidden="true" href="#cb106-16" tabindex="-1"></a><span class="st">AgjoEwnuNAFOhpEMTRiggcz4BNJHrv/zCFcLiwMWYNG84BwwEeECcgggoBADs="</span></span></code></pre></div>
<p>Please note:</p>
<ol type="1">
<li><p>There is no standard way to represent literal bytes in YAML
1.2. Though some YAML implementations may support the <a href="https://yaml.org/type/binary.html">!!binary type <br/> 
working draft</a>, to ensure 
portability TOSCA implementations <em>shall not</em> accept this YAML
type.</p></li>
<li><p>The TOSCA function “length” works 
differently for the bytes type vs. the string type. For the latter 
the length is the count of Unicode runes, not the count of
bytes.</p></li>
<li><p>TOSCA bytes values <em>cannot</em> be the null value but
<em>can</em> be empty 
arrays (a bytes value with length zero). [See “nil”, below]</p></li>
</ol>
<h4 id="nil">9.1.1.6 nil</h4>
<p>The TOSCA <em>nil</em> type always has the same singleton value. No
other type can have 
this value.</p>
<p>This value is provided literally in YAML via the unquoted
all-lowercase 
word “null”.</p>
<p>Example:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb107-1"><a aria-hidden="true" href="#cb107-1" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb107-2"><a aria-hidden="true" href="#cb107-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Node</span><span class="kw">:</span></span>
<span id="cb107-3"><a aria-hidden="true" href="#cb107-3" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb107-4"><a aria-hidden="true" href="#cb107-4" tabindex="-1"></a><span class="at">      </span><span class="fu">nothing</span><span class="kw">:</span></span>
<span id="cb107-5"><a aria-hidden="true" href="#cb107-5" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> nil</span></span>
<span id="cb107-6"><a aria-hidden="true" href="#cb107-6" tabindex="-1"></a><span class="at">        </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb107-7"><a aria-hidden="true" href="#cb107-7" tabindex="-1"></a></span>
<span id="cb107-8"><a aria-hidden="true" href="#cb107-8" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb107-9"><a aria-hidden="true" href="#cb107-9" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb107-10"><a aria-hidden="true" href="#cb107-10" tabindex="-1"></a><span class="at">    </span><span class="fu">node</span><span class="kw">:</span></span>
<span id="cb107-11"><a aria-hidden="true" href="#cb107-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Node</span></span>
<span id="cb107-12"><a aria-hidden="true" href="#cb107-12" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb107-13"><a aria-hidden="true" href="#cb107-13" tabindex="-1"></a><span class="at">        </span><span class="fu">nothing</span><span class="kw">:</span><span class="at"> </span><span class="ch">null</span></span></code></pre></div>
<p>Note that a nil-typed value is <em>distinct</em> from an unassigned
value. For 
consistency TOSCA <em>requires</em> you to assign nil values even though
their 
value is obvious. Thus, the above example would be invalid if we did
not 
specify the null value for the property at the node template.</p>
<p>Following is a valid example of <em>not</em> assigning a value:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb108-1"><a aria-hidden="true" href="#cb108-1" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb108-2"><a aria-hidden="true" href="#cb108-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Node</span><span class="kw">:</span></span>
<span id="cb108-3"><a aria-hidden="true" href="#cb108-3" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb108-4"><a aria-hidden="true" href="#cb108-4" tabindex="-1"></a><span class="at">      </span><span class="fu">nothing</span><span class="kw">:</span></span>
<span id="cb108-5"><a aria-hidden="true" href="#cb108-5" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> nil</span></span>
<span id="cb108-6"><a aria-hidden="true" href="#cb108-6" tabindex="-1"></a><span class="at">        </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb108-7"><a aria-hidden="true" href="#cb108-7" tabindex="-1"></a></span>
<span id="cb108-8"><a aria-hidden="true" href="#cb108-8" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb108-9"><a aria-hidden="true" href="#cb108-9" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb108-10"><a aria-hidden="true" href="#cb108-10" tabindex="-1"></a><span class="at">    </span><span class="fu">node</span><span class="kw">:</span></span>
<span id="cb108-11"><a aria-hidden="true" href="#cb108-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Node</span></span></code></pre></div>
<h3 id="special-types">9.1.2 Special Types</h3>
<h4 id="timestamp">9.1.2.1 timestamp</h4>
<p>The TOSCA <em>timestamp</em> type represents a local instant in
time 
containing two elements: the local notation plus the time zone
offset.</p>
<p>TOSCA timestamps are represented as strings following [<a href="https://tools.ietf.org/html/rfc3339">RFC <br/> 
3339</a>], which in turn uses a simplified profile of [<a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO <br/> 
8601</a>]. TOSCA 
adds an exception to RFC 3339: though RFC 3339 supports timestamps
with <a href="https://tools.ietf.org/html/rfc3339#section-4.3">unknown local <br/> 
offsets</a>, represented 
as the “-0” timezone, TOSCA <em>does not</em> support this feature and
will 
treat the unknown time zone as UTC. There are two reasons for this 
exception: the first is that many systems do not support this 
distinction and TOSCA aims for interoperability, and the second is
that 
timestamps with unknown time zones cannot be converted to UTC, making
it 
impossible to apply comparison functions. If this feature is
required, 
it can be supported via a custom data type (see XXX).</p>
<p>Please note:</p>
<ul>
<li><p>It is strongly recommended that all literal YAML timestamps
be 
enclosed in quotation marks to ensure that they are parsed as
strings. 
Otherwise, some YAML parsers might interpret them as the YAML 
!!timestamp type, which is rejected by TOSCA (see below).</p></li>
<li><p>The TOSCA functions “equal”, “greater_than”,
“greater_or_equal”, 
“less_than”, and “less_or_equal” all use the <em>universal</em> instant,
i.e. 
as the local instant is converted to UTC by applying the timezone 
offset.</p></li>
<li><p>Some YAML implementations may support the <a href="https://yaml.org/type/timestamp.html">!!timestamp type working <br/> 
draft</a>, but to ensure 
portability TOSCA implementations <em>shall not</em> accept this YAML
type. 
Also note that the YAML !!timestamp supports a relaxed notation
with 
whitespace, which <em>does not</em> conform to RFC 3339.</p></li>
<li><p>RFC 3339 is based on the Gregorian calendar, including leap years
and 
leap seconds, and is thus explicitly culturally biased. It cannot
be 
used for non-Gregorian locales. Other calendar representations can
be 
supported via custom data types (see XXX).</p></li>
<li><p>Time zone information is expressed and stored numerically as an
offset 
from UTC, thus daylight savings and other local changes are not 
included.</p></li>
<li><p>TOSCA does not specify a canonical representation for timestamps.
The 
only requirement is that representations adhere to RFC 3339.</p></li>
</ul>
<h4 id="scalar-unit">9.1.2.2 scalar-unit</h4>
<p>The TOSCA <em>scalar-unit</em> types can be used to define scalar
values 
along with an associated unit.</p>
<p>TOSCA scalar-unit typed values have the following grammar:</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb109-1"><a aria-hidden="true" href="#cb109-1" tabindex="-1"></a><span class="at">&lt;scalar&gt; &lt;unit_symbol_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>scalar: is a mandatory scalar value</p></li>
<li><p>unit_symbol_name: is a mandatory name string.</p></li>
</ul>
<p>The following additional requirements apply:</p>
<ul>
<li><p>Any number of spaces (including zero or none) SHALL be
allowed 
between the scalar value and the unit symbol.</p></li>
<li><p>The unit symbol MUST be defined in a concrete scalar type
definition.</p></li>
<li><p>It SHALL be considered an error if either the scalar or unit
symbol portion is missing on a property or attribute declaration derived
from any scalar-unit type.</p></li>
</ul>
<p>The scalar-unit type is abstract and cannot be used ‘as is’ in a
valid TOSCA document, rather it must be refined into a concrete scalar
type by means of a type definition. Scalar type definitions use the
common key names.</p>
<p>A concrete scalar type is defined using the following grammar:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb110-1"><a aria-hidden="true" href="#cb110-1" tabindex="-1"></a><span class="fu">&lt;scalar_unit_name&gt;</span><span class="kw">:</span></span>
<span id="cb110-2"><a aria-hidden="true" href="#cb110-2" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;scalar-unit_type_name&gt;</span></span>
<span id="cb110-3"><a aria-hidden="true" href="#cb110-3" tabindex="-1"></a><span class="at">    </span><span class="fu">data_value_type</span><span class="kw">:</span><span class="at"> &lt;data_type_name&gt;</span></span>
<span id="cb110-4"><a aria-hidden="true" href="#cb110-4" tabindex="-1"></a><span class="at">    </span><span class="fu">unit_suffix</span><span class="kw">:</span><span class="at"> &lt;suffix&gt;</span></span>
<span id="cb110-5"><a aria-hidden="true" href="#cb110-5" tabindex="-1"></a><span class="at">    </span><span class="fu">unit_symbol_map</span><span class="kw">:</span></span>
<span id="cb110-6"><a aria-hidden="true" href="#cb110-6" tabindex="-1"></a><span class="at">      </span><span class="fu">&lt;unit_symbol_1&gt;</span><span class="kw">:</span><span class="at"> &lt;unit_symbol_multiplier_1&gt;</span></span>
<span id="cb110-7"><a aria-hidden="true" href="#cb110-7" tabindex="-1"></a><span class="at">      ...</span></span>
<span id="cb110-8"><a aria-hidden="true" href="#cb110-8" tabindex="-1"></a><span class="at">      </span><span class="fu">&lt;unit_symbol_n&gt;</span><span class="kw">:</span><span class="at"> &lt;unit_symbol_multiplier_n&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle brackets
have the following meaning:</p>
<pre><code>&lt;scalar-unit_type_name&gt;: represents the mandatory name of the parent type which must be either scalar-unit or a data type derived from scalar-unit.

&lt;data_type_name&gt;: The TOSCA data type of the scalar. MUST be either TOSCA float, TOSCA intger or derived from them.

&lt;suffix&gt;: An optional string. If not present then unit_symbol_name is equal to unit_symbol. If present then unit_symbol_name is equal to unit_symbol&amp;&amp;unit_suffix. It is provided as a convenience so that metric units can use YAML anchor and alias to avoid repeating the table of SI prefixes. The multiplier for unit_symbol_name has an implict value of 1.0

&lt;unit_symbol&gt; A name string, with no white space, used to identify the unit.

&lt;unit_symbol_multiplier&gt; A value of type TOSCA float which MUST be used by a TOSCA parser to convert values with the symbol into values in the base unit.

Note that unit_symbol_name, unit_symbol and unit_suffix are all case sensitive.</code></pre>
<p>The following gives an example of the use of a scalar_units:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb112-1"><a aria-hidden="true" href="#cb112-1" tabindex="-1"></a><span class="fu">data_types</span><span class="kw">:</span></span>
<span id="cb112-2"><a aria-hidden="true" href="#cb112-2" tabindex="-1"></a><span class="at">  </span><span class="fu">non_negative_number</span><span class="kw">:</span></span>
<span id="cb112-3"><a aria-hidden="true" href="#cb112-3" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb112-4"><a aria-hidden="true" href="#cb112-4" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at">  </span><span class="dv">0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb112-5"><a aria-hidden="true" href="#cb112-5" tabindex="-1"></a></span>
<span id="cb112-6"><a aria-hidden="true" href="#cb112-6" tabindex="-1"></a><span class="at">  </span><span class="fu">bitrate</span><span class="kw">:</span></span>
<span id="cb112-7"><a aria-hidden="true" href="#cb112-7" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">2.0</span></span>
<span id="cb112-8"><a aria-hidden="true" href="#cb112-8" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> bitrate allowing multiples of 1024 as well as 1000 but not including prefixes above 10^12</span></span>
<span id="cb112-9"><a aria-hidden="true" href="#cb112-9" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> scalar-unit</span></span>
<span id="cb112-10"><a aria-hidden="true" href="#cb112-10" tabindex="-1"></a><span class="at">    </span><span class="fu">data_value_type</span><span class="kw">:</span><span class="at"> non_negative_number</span></span>
<span id="cb112-11"><a aria-hidden="true" href="#cb112-11" tabindex="-1"></a><span class="at">    </span><span class="fu">unit_symbol_map</span><span class="kw">:</span></span>
<span id="cb112-12"><a aria-hidden="true" href="#cb112-12" tabindex="-1"></a><span class="at">      </span><span class="fu">B</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span><span class="co"> # No unit_suffix defined so base unit must be included in the list</span></span>
<span id="cb112-13"><a aria-hidden="true" href="#cb112-13" tabindex="-1"></a><span class="at">      </span><span class="fu">kB</span><span class="kw">:</span><span class="at"> </span><span class="dv">1000</span><span class="co"> # No unit_suffix defined so unit_symbol includes the B character as well as the k</span></span>
<span id="cb112-14"><a aria-hidden="true" href="#cb112-14" tabindex="-1"></a><span class="at">      </span><span class="fu">KiB</span><span class="kw">:</span><span class="at"> </span><span class="dv">1024</span></span>
<span id="cb112-15"><a aria-hidden="true" href="#cb112-15" tabindex="-1"></a><span class="at">      </span><span class="fu">MB</span><span class="kw">:</span><span class="at"> </span><span class="dv">1000000</span></span>
<span id="cb112-16"><a aria-hidden="true" href="#cb112-16" tabindex="-1"></a><span class="at">      </span><span class="fu">MiB</span><span class="kw">:</span><span class="at"> </span><span class="dv">1048576</span></span>
<span id="cb112-17"><a aria-hidden="true" href="#cb112-17" tabindex="-1"></a><span class="at">      </span><span class="fu">GB</span><span class="kw">:</span><span class="at">  </span><span class="dv">1000000000</span></span>
<span id="cb112-18"><a aria-hidden="true" href="#cb112-18" tabindex="-1"></a><span class="at">      </span><span class="fu">GiB</span><span class="kw">:</span><span class="at"> </span><span class="dv">1073741824</span></span>
<span id="cb112-19"><a aria-hidden="true" href="#cb112-19" tabindex="-1"></a><span class="at">      </span><span class="fu">TB</span><span class="kw">:</span><span class="at">  </span><span class="dv">1000000000000</span></span>
<span id="cb112-20"><a aria-hidden="true" href="#cb112-20" tabindex="-1"></a><span class="at">      </span><span class="fu">TiB</span><span class="kw">:</span><span class="at"> </span><span class="dv">1099511627776</span></span>
<span id="cb112-21"><a aria-hidden="true" href="#cb112-21" tabindex="-1"></a></span>
<span id="cb112-22"><a aria-hidden="true" href="#cb112-22" tabindex="-1"></a><span class="at">  </span><span class="fu">length</span><span class="kw">:</span></span>
<span id="cb112-23"><a aria-hidden="true" href="#cb112-23" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> scalar-unit</span></span>
<span id="cb112-24"><a aria-hidden="true" href="#cb112-24" tabindex="-1"></a><span class="at">    </span><span class="fu">unit_symbol_map</span><span class="kw">:</span><span class="at"> </span><span class="ot">&amp;ISO80000</span></span>
<span id="cb112-25"><a aria-hidden="true" href="#cb112-25" tabindex="-1"></a><span class="co">      # symbols for smaller multipliers ommitted for brevity</span></span>
<span id="cb112-26"><a aria-hidden="true" href="#cb112-26" tabindex="-1"></a><span class="at">      </span><span class="fu">μ</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0001</span></span>
<span id="cb112-27"><a aria-hidden="true" href="#cb112-27" tabindex="-1"></a><span class="at">      </span><span class="fu">m</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.001</span></span>
<span id="cb112-28"><a aria-hidden="true" href="#cb112-28" tabindex="-1"></a><span class="at">      </span><span class="fu">c</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.01</span></span>
<span id="cb112-29"><a aria-hidden="true" href="#cb112-29" tabindex="-1"></a><span class="at">      </span><span class="fu">d</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.1</span></span>
<span id="cb112-30"><a aria-hidden="true" href="#cb112-30" tabindex="-1"></a><span class="at">      </span><span class="fu">da</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span><span class="co"> # symbols may be muliple characters</span></span>
<span id="cb112-31"><a aria-hidden="true" href="#cb112-31" tabindex="-1"></a><span class="at">      </span><span class="fu">h</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span><span class="co"> # integer auto converted to float</span></span>
<span id="cb112-32"><a aria-hidden="true" href="#cb112-32" tabindex="-1"></a><span class="at">      </span><span class="fu">k</span><span class="kw">:</span><span class="at"> </span><span class="dv">1000</span></span>
<span id="cb112-33"><a aria-hidden="true" href="#cb112-33" tabindex="-1"></a><span class="at">      </span><span class="fu">M</span><span class="kw">:</span><span class="at"> </span><span class="dv">1000000</span></span>
<span id="cb112-34"><a aria-hidden="true" href="#cb112-34" tabindex="-1"></a><span class="co">      # symbols for larger multipliers omiited</span></span>
<span id="cb112-35"><a aria-hidden="true" href="#cb112-35" tabindex="-1"></a><span class="at">    </span><span class="fu">unit_suffix</span><span class="kw">:</span><span class="at"> m</span><span class="co">  ## Note suffix is defined so will be appended to entries in the unit_symbol_map</span></span>
<span id="cb112-36"><a aria-hidden="true" href="#cb112-36" tabindex="-1"></a></span>
<span id="cb112-37"><a aria-hidden="true" href="#cb112-37" tabindex="-1"></a><span class="at">  </span><span class="fu">mass</span><span class="kw">:</span></span>
<span id="cb112-38"><a aria-hidden="true" href="#cb112-38" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> scalar-unit</span></span>
<span id="cb112-39"><a aria-hidden="true" href="#cb112-39" tabindex="-1"></a><span class="at">    </span><span class="fu">unit_symbol_map</span><span class="kw">:</span><span class="at"> </span><span class="ot">*ISO80000</span><span class="co"> # Note map is used by both length and mass by means of YAML anchor and alias</span></span>
<span id="cb112-40"><a aria-hidden="true" href="#cb112-40" tabindex="-1"></a><span class="at">    </span><span class="fu">unit_suffix</span><span class="kw">:</span><span class="at"> g</span></span>
<span id="cb112-41"><a aria-hidden="true" href="#cb112-41" tabindex="-1"></a></span>
<span id="cb112-42"><a aria-hidden="true" href="#cb112-42" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb112-43"><a aria-hidden="true" href="#cb112-43" tabindex="-1"></a><span class="at">  </span><span class="fu">box</span><span class="kw">:</span></span>
<span id="cb112-44"><a aria-hidden="true" href="#cb112-44" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb112-45"><a aria-hidden="true" href="#cb112-45" tabindex="-1"></a><span class="at">      </span><span class="fu">weight</span><span class="kw">:</span></span>
<span id="cb112-46"><a aria-hidden="true" href="#cb112-46" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> mass</span></span>
<span id="cb112-47"><a aria-hidden="true" href="#cb112-47" tabindex="-1"></a><span class="at">      </span><span class="fu">height</span><span class="kw">:</span></span>
<span id="cb112-48"><a aria-hidden="true" href="#cb112-48" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> length</span></span>
<span id="cb112-49"><a aria-hidden="true" href="#cb112-49" tabindex="-1"></a><span class="at">      </span><span class="fu">width</span><span class="kw">:</span></span>
<span id="cb112-50"><a aria-hidden="true" href="#cb112-50" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> length</span></span>
<span id="cb112-51"><a aria-hidden="true" href="#cb112-51" tabindex="-1"></a><span class="at">        </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$less_than</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> 15 cm </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span><span class="co"> ## Validation is in centimeters</span></span>
<span id="cb112-52"><a aria-hidden="true" href="#cb112-52" tabindex="-1"></a><span class="at">      </span><span class="fu">throughput</span><span class="kw">:</span></span>
<span id="cb112-53"><a aria-hidden="true" href="#cb112-53" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> bitrate</span></span>
<span id="cb112-54"><a aria-hidden="true" href="#cb112-54" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb112-55"><a aria-hidden="true" href="#cb112-55" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb112-56"><a aria-hidden="true" href="#cb112-56" tabindex="-1"></a><span class="at">    </span><span class="fu">node</span><span class="kw">:</span></span>
<span id="cb112-57"><a aria-hidden="true" href="#cb112-57" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> box</span></span>
<span id="cb112-58"><a aria-hidden="true" href="#cb112-58" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb112-59"><a aria-hidden="true" href="#cb112-59" tabindex="-1"></a><span class="at">        </span><span class="fu">weight</span><span class="kw">:</span><span class="at"> 10.0kg</span><span class="co"> # No space</span></span>
<span id="cb112-60"><a aria-hidden="true" href="#cb112-60" tabindex="-1"></a><span class="at">        </span><span class="fu">height</span><span class="kw">:</span><span class="at"> 0.1 m</span></span>
<span id="cb112-61"><a aria-hidden="true" href="#cb112-61" tabindex="-1"></a><span class="at">        </span><span class="fu">width</span><span class="kw">:</span><span class="at"> 125.3 mm</span><span class="co"> ## Defintion is in millimeters, conversion of units within a scalar is performed by the parser</span></span>
<span id="cb112-62"><a aria-hidden="true" href="#cb112-62" tabindex="-1"></a><span class="at">        </span><span class="fu">throughput</span><span class="kw">:</span><span class="at"> 10 KiB</span><span class="co"> # Integer auto converted to float</span></span></code></pre></div>
<p>Derivation of scalar-types uses the following rules:</p>
<pre><code>- derived_from, data_value_type and unit_suffix may not be changed
- Additonal entries may be added to the unit_symbol_map</code></pre>
<h5 id="scalar-unit.time">9.1.2.2.2 scalar-unit.time</h5>
<p>TOSCA no longer has an in-built date type for time but one can be
defined using the scalar-unit abstract class as shown in the following
example:</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb114-1"><a aria-hidden="true" href="#cb114-1" tabindex="-1"></a><span class="fu">data_types</span><span class="kw">:</span></span>
<span id="cb114-2"><a aria-hidden="true" href="#cb114-2" tabindex="-1"></a><span class="at">  </span><span class="fu">scalar-unit.time</span><span class="kw">:</span></span>
<span id="cb114-3"><a aria-hidden="true" href="#cb114-3" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">2.0</span></span>
<span id="cb114-4"><a aria-hidden="true" href="#cb114-4" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Time including non-SI units accepted for use with the SI units</span></span>
<span id="cb114-5"><a aria-hidden="true" href="#cb114-5" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> scalar-unit</span></span>
<span id="cb114-6"><a aria-hidden="true" href="#cb114-6" tabindex="-1"></a><span class="at">    </span><span class="fu">data_value_type</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb114-7"><a aria-hidden="true" href="#cb114-7" tabindex="-1"></a><span class="at">    </span><span class="fu">unit_symbol_map</span><span class="kw">:</span></span>
<span id="cb114-8"><a aria-hidden="true" href="#cb114-8" tabindex="-1"></a><span class="co">      # symbols for smaller multipliers ommitted for brevity</span></span>
<span id="cb114-9"><a aria-hidden="true" href="#cb114-9" tabindex="-1"></a><span class="at">      </span><span class="fu">μs</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.0001</span></span>
<span id="cb114-10"><a aria-hidden="true" href="#cb114-10" tabindex="-1"></a><span class="at">      </span><span class="fu">ms</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.001</span></span>
<span id="cb114-11"><a aria-hidden="true" href="#cb114-11" tabindex="-1"></a><span class="at">      </span><span class="fu">cs</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.01</span></span>
<span id="cb114-12"><a aria-hidden="true" href="#cb114-12" tabindex="-1"></a><span class="at">      </span><span class="fu">ds</span><span class="kw">:</span><span class="at"> </span><span class="fl">0.1</span></span>
<span id="cb114-13"><a aria-hidden="true" href="#cb114-13" tabindex="-1"></a><span class="at">      </span><span class="fu">das</span><span class="kw">:</span><span class="at"> </span><span class="dv">10</span></span>
<span id="cb114-14"><a aria-hidden="true" href="#cb114-14" tabindex="-1"></a><span class="at">      </span><span class="fu">hs</span><span class="kw">:</span><span class="at"> </span><span class="dv">100</span></span>
<span id="cb114-15"><a aria-hidden="true" href="#cb114-15" tabindex="-1"></a><span class="at">      </span><span class="fu">ks</span><span class="kw">:</span><span class="at"> </span><span class="dv">1000</span></span>
<span id="cb114-16"><a aria-hidden="true" href="#cb114-16" tabindex="-1"></a><span class="at">      </span><span class="fu">Ms</span><span class="kw">:</span><span class="at"> </span><span class="dv">1000000</span></span>
<span id="cb114-17"><a aria-hidden="true" href="#cb114-17" tabindex="-1"></a><span class="at">      </span><span class="fu">min</span><span class="kw">:</span><span class="at"> </span><span class="dv">60</span><span class="at"> </span></span>
<span id="cb114-18"><a aria-hidden="true" href="#cb114-18" tabindex="-1"></a><span class="at">      </span><span class="fu">h</span><span class="kw">:</span><span class="at"> </span><span class="dv">3600</span><span class="co"> # hour</span></span>
<span id="cb114-19"><a aria-hidden="true" href="#cb114-19" tabindex="-1"></a><span class="at">      </span><span class="fu">d</span><span class="kw">:</span><span class="at"> </span><span class="dv">86400</span><span class="co"> # day</span></span>
<span id="cb114-20"><a aria-hidden="true" href="#cb114-20" tabindex="-1"></a><span class="co">      # symbols for larger multipliers omiited</span></span></code></pre></div>
<h4 id="version">9.1.2.3 version</h4>
<p>The TOSCA <em>version</em> type represents a version string.</p>
<p>TOSCA versions provide a normative means to represent a version
string 
which enables the comparison and management of version information 
over time.</p>
<p>TOSCA version strings have the following grammar:</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb115-1"><a aria-hidden="true" href="#cb115-1" tabindex="-1"></a><span class="at">&lt;major_version&gt;.&lt;minor_version&gt;[.&lt;fix_version&gt;[.&lt;qualifier&gt;[-&lt;build_version&gt;] ] ] </span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>major_version: is a mandatory integer value greater than or equal
to 0 
(zero)</p></li>
<li><p>minor_version: is a mandatory integer value greater than or equal
to 0 
(zero).</p></li>
<li><p>fix_version: is an optional integer value greater than or equal
to 0 
(zero).</p></li>
<li><p>qualifier: is an optional string that indicates a named,
pre-release 
version of the associated code that has been derived from the
version 
of the code identified by the combination major_version,
minor_version 
and fix_version numbers.</p></li>
<li><p>build_version: is an optional integer value greater than or equal
to 0 
(zero) that can be used to further qualify different build versions
of 
the code that has the same qualifer_string.</p></li>
</ul>
<p>A version value of zero (i.e., ‘0.0’, or ‘0.0.0’) SHALL indicate
there 
no version provided.</p>
<p>When specifying a version string that contains just a major and
a 
minor version number, the version string must be enclosed in quotes
to 
prevent the YAML parser from treating the version as a floating
point 
value.</p>
<p>The TOSCA version type is compatible with the Apache Maven
versioning 
policy [<a href="#CIT_MAVEN_VERSION">Maven-Version</a>]. It supports
version 
comparison as follows:</p>
<ul>
<li><p>When comparing TOSCA versions, all component versions (i.e.,
<em>major</em>, 
<em>minor</em> and <em>fix</em>) are compared in sequence from left to
right.</p></li>
<li><p>TOSCA versions that include the optional qualifier are
considered 
older than those without a qualifier.</p></li>
<li><p>TOSCA versions with the same major, minor, and fix versions and
have 
the same qualifier string, but with different build versions can
be 
compared based upon the build version.</p></li>
<li><p>Qualifier strings are considered domain-specific. Therefore,
this 
specification makes no recommendation on how to compare TOSCA
versions 
with the same major, minor and fix versions, but with different 
qualifiers strings and simply considers them different branches 
derived from the same code.</p></li>
</ul>
<p>The following are examples of valid TOSCA version strings:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb116-1"><a aria-hidden="true" href="#cb116-1" tabindex="-1"></a><span class="co"># basic version strings</span></span>
<span id="cb116-2"><a aria-hidden="true" href="#cb116-2" tabindex="-1"></a><span class="at">‘6.1’</span></span>
<span id="cb116-3"><a aria-hidden="true" href="#cb116-3" tabindex="-1"></a><span class="fl">2.0.1</span></span>
<span id="cb116-4"><a aria-hidden="true" href="#cb116-4" tabindex="-1"></a></span>
<span id="cb116-5"><a aria-hidden="true" href="#cb116-5" tabindex="-1"></a><span class="co"># version string with optional qualifier</span></span>
<span id="cb116-6"><a aria-hidden="true" href="#cb116-6" tabindex="-1"></a><span class="at">3.1.0.beta</span></span>
<span id="cb116-7"><a aria-hidden="true" href="#cb116-7" tabindex="-1"></a></span>
<span id="cb116-8"><a aria-hidden="true" href="#cb116-8" tabindex="-1"></a><span class="co"># version string with optional qualifier and build version</span></span>
<span id="cb116-9"><a aria-hidden="true" href="#cb116-9" tabindex="-1"></a><span class="at">1.0.0.alpha-10</span></span></code></pre></div>
<h3 id="collection-types">9.1.3 Collection Types</h3>
<h4 id="list">9.1.3.1 list</h4>
<p>The TOSCA <em>list</em> type allows for specifying multiple values
for a a 
parameter or property. For example, if an application allows for
being 
configured to listen on multiple ports, a list of ports could be 
configured using the list data type.</p>
<!----
{"id": "859", "author": "Mike Rehder", "date": "2020-12-14T14:56:00Z", "comment": "What is a \u201cparameter of property\u201d?  \nShould just say \u201cfor a property\u201d.", "target": "a parameter of\nproperty"}-->
<p>Note that all entries in a list must be of the same type. The
type 
(for simple entries) or schema (for complex entries) is defined by
the 
mandatory entry_schema attribute of the respective <a href="#_Schema_Definition">property 
definition</a>, <a href="#to-implement-this-throughout-the-specification.-default-can-have-also-value_expression-i-think-we-might-need-also-an-attribute-value_expresssion-keyname-that-allows-to-define-an-attribute-as-a-function-of-a-different-attribute-of-the-same-entity-that-we-can-define-when-creating-noderelationship-types-even-before-template-design-time.attribute-definition">attribute 
definitions</a>, 
or input or output <a href="#parameter-definition">parameter
definitions</a>. 
Schema definitions can be arbitrarily complex (they may themselves 
define a list).</p>
<p>TOSCA list values are essentially normal YAML lists. They support
the 
square bracket notation as follows:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb117-1"><a aria-hidden="true" href="#cb117-1" tabindex="-1"></a><span class="kw">[</span><span class="at"> &lt;list_entry_1&gt;</span><span class="kw">,</span><span class="at"> &lt;list_entry_2&gt;</span><span class="kw">,</span><span class="at"> ... </span><span class="kw">]</span><span class="at"> </span></span></code></pre></div>
<p>TOSCA list values also support bulleted list notation as follows:</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb118-1"><a aria-hidden="true" href="#cb118-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> &lt;list_entry_1&gt;</span></span>
<span id="cb118-2"><a aria-hidden="true" href="#cb118-2" tabindex="-1"></a><span class="kw">-</span><span class="at"> ...</span></span>
<span id="cb118-3"><a aria-hidden="true" href="#cb118-3" tabindex="-1"></a><span class="kw">-</span><span class="at"> &lt;list_entry_n&gt;</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li>&lt;list_entry_*&gt;: represents one entry of the list.</li>
</ul>
<p>The following example shows a list assignment using the square
bracket 
notation:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb119-1"><a aria-hidden="true" href="#cb119-1" tabindex="-1"></a><span class="at">  </span><span class="fu">listen_ports</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">80</span><span class="kw">,</span><span class="at"> </span><span class="dv">8080</span><span class="at"> </span><span class="kw">]</span></span></code></pre></div>
<p>The following example shows the same list assignment using the 
bulleted list notation:</p>
<pre><code>listen_ports:
  - 80
  - 8080</code></pre>
<p>The following example shows a list declaration with an entry
schema 
based upon a simple integer type (which has an additional
validation 
clause):</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb121-1"><a aria-hidden="true" href="#cb121-1" tabindex="-1"></a><span class="fu">&lt;some_entity&gt;</span><span class="kw">:</span></span>
<span id="cb121-2"><a aria-hidden="true" href="#cb121-2" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb121-3"><a aria-hidden="true" href="#cb121-3" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at">  </span></span>
<span id="cb121-4"><a aria-hidden="true" href="#cb121-4" tabindex="-1"></a><span class="at">    </span><span class="fu">listen_ports</span><span class="kw">:</span></span>
<span id="cb121-5"><a aria-hidden="true" href="#cb121-5" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> list</span></span>
<span id="cb121-6"><a aria-hidden="true" href="#cb121-6" tabindex="-1"></a><span class="at">      </span><span class="fu">entry_schema</span><span class="kw">:</span></span>
<span id="cb121-7"><a aria-hidden="true" href="#cb121-7" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> listen port entry (simple integer type)</span></span>
<span id="cb121-8"><a aria-hidden="true" href="#cb121-8" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb121-9"><a aria-hidden="true" href="#cb121-9" tabindex="-1"></a><span class="at">        </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$less_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">128</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>The following example shows a list declaration with an entry
schema 
based upon a complex type:</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb122-1"><a aria-hidden="true" href="#cb122-1" tabindex="-1"></a><span class="fu">&lt;some_entity&gt;</span><span class="kw">:</span></span>
<span id="cb122-2"><a aria-hidden="true" href="#cb122-2" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb122-3"><a aria-hidden="true" href="#cb122-3" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at">  </span></span>
<span id="cb122-4"><a aria-hidden="true" href="#cb122-4" tabindex="-1"></a><span class="at">    </span><span class="fu">products</span><span class="kw">:</span></span>
<span id="cb122-5"><a aria-hidden="true" href="#cb122-5" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> list</span></span>
<span id="cb122-6"><a aria-hidden="true" href="#cb122-6" tabindex="-1"></a><span class="at">      </span><span class="fu">entry_schema</span><span class="kw">:</span></span>
<span id="cb122-7"><a aria-hidden="true" href="#cb122-7" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Product information entry (complex type) defined elsewhere</span></span>
<span id="cb122-8"><a aria-hidden="true" href="#cb122-8" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ProductInfo</span></span></code></pre></div>
<h4 id="map">9.1.3.2 map</h4>
<p>The TOSCA <em>map</em> type allows for specifying multiple values for
a parameter of 
property as a map. In contrast to the list type, where each entry
can 
only be addressed by its index in the list, entries in a map are
named 
elements that can be addressed by their keys.</p>
<p>Note that entries in a map for one property or parameter must be
of 
the same type. The type (for simple entries) or schema (for
complex 
entries) is defined by the entry_schema attribute of the
respective 
<a href="#_Schema_Definition">property definition</a>, <a href="#to-implement-this-throughout-the-specification.-default-can-have-also-value_expression-i-think-we-might-need-also-an-attribute-value_expresssion-keyname-that-allows-to-define-an-attribute-as-a-function-of-a-different-attribute-of-the-same-entity-that-we-can-define-when-creating-noderelationship-types-even-before-template-design-time.attribute-definition">attribute 
definition</a>, 
or input or output <a href="#parameter-definition">parameter
definition</a>. In 
addition, the keys that identify entries in a map must be of the
same 
type as well. The type of these keys is defined by the key_schema 
attribute of the respective property_definition,
attribute_definition, 
or input or output parameter_definition. If the key_schema is not 
specified, keys are assumed to be of type string.</p>
<p>TOSCA maps are normal YAML dictionaries. They support the
following 
single-line grammar:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb123-1"><a aria-hidden="true" href="#cb123-1" tabindex="-1"></a><span class="kw">{</span><span class="at"> </span><span class="fu">&lt;entry_key_1&gt;</span><span class="kw">:</span><span class="at"> &lt;entry_value_1&gt;</span><span class="kw">,</span><span class="at"> ...</span><span class="kw">,</span><span class="at"> </span><span class="fu">&lt;entry_key_n&gt;</span><span class="kw">:</span><span class="at"> &lt;entry_value_n&gt; </span><span class="kw">}</span></span></code></pre></div>
<p>In addition, TOSCA maps also support the following multi-line
grammar:</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb124-1"><a aria-hidden="true" href="#cb124-1" tabindex="-1"></a><span class="fu">&lt;entry_key_1&gt;</span><span class="kw">:</span><span class="at"> &lt;entry_value_1&gt;</span></span>
<span id="cb124-2"><a aria-hidden="true" href="#cb124-2" tabindex="-1"></a><span class="co">...</span></span>
<span id="cb124-3"><a aria-hidden="true" href="#cb124-3" tabindex="-1"></a><span class="co">&lt;entry_key_n&gt;: &lt;entry_value_n&gt;</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>entry_key_*: the mandatory key for an entry in the map. While
YAML 
allows arbitrary data to be used as dictionary keys, TOSCA map
keys 
must be strings.</p></li>
<li><p>entry_value_*: is the value of the respective entry in the
map</p></li>
</ul>
<p>The following example shows the single-line option which is
useful 
for only short maps with simple entries:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb125-1"><a aria-hidden="true" href="#cb125-1" tabindex="-1"></a><span class="co"># notation option for shorter maps</span></span>
<span id="cb125-2"><a aria-hidden="true" href="#cb125-2" tabindex="-1"></a><span class="fu">user_name_to_id_map</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">user1</span><span class="kw">:</span><span class="at"> </span><span class="dv">1001</span><span class="kw">,</span><span class="at"> </span><span class="fu">user2</span><span class="kw">:</span><span class="at"> </span><span class="dv">1002</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>The next example shows the multi-line option where each map entry
is 
on a separate line; this option is typically useful or more
readable 
if there is a large number of entries, or if the entries are
complex.</p>
<pre><code># notation for longer maps
user_name_to_id_map:
  user1: 1001
  user2: 1002</code></pre>
<p>The following example shows a declaration of a property of type
map 
with an entry schema definition based upon the built-in string
type 
(which has an additional validation clause):</p>
<pre><code>&lt;some_entity&gt;:
  ...
  properties:  
    emails:
      type: map
      entry_schema:
        description: basic email address
        type: string
        validation: { $less_or_equal: [ $value, 128 ] }</code></pre>
<p>The next example shows a map with an entry schema definition
for 
contact information:</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb128-1"><a aria-hidden="true" href="#cb128-1" tabindex="-1"></a><span class="fu">&lt;some_entity&gt;</span><span class="kw">:</span></span>
<span id="cb128-2"><a aria-hidden="true" href="#cb128-2" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb128-3"><a aria-hidden="true" href="#cb128-3" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at">  </span></span>
<span id="cb128-4"><a aria-hidden="true" href="#cb128-4" tabindex="-1"></a><span class="at">    </span><span class="fu">contacts</span><span class="kw">:</span></span>
<span id="cb128-5"><a aria-hidden="true" href="#cb128-5" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> map</span></span>
<span id="cb128-6"><a aria-hidden="true" href="#cb128-6" tabindex="-1"></a><span class="at">      </span><span class="fu">entry_schema</span><span class="kw">:</span></span>
<span id="cb128-7"><a aria-hidden="true" href="#cb128-7" tabindex="-1"></a><span class="at">        </span><span class="fu">description</span><span class="kw">:</span><span class="at"> simple contact information</span></span>
<span id="cb128-8"><a aria-hidden="true" href="#cb128-8" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ContactInfo</span></span></code></pre></div>
<h2 id="data-type">9.2 Data Type</h2>
<p>A <em>data type</em> defines the schema for user-defined data types
in 
TOSCA. User-defined data types comprise <em>derived types</em> that
derive 
from from the TOSCA built-in types and <em>complex types</em> that
define 
collections of properties that each have their own data types.</p>
<p>A data type definition is a type of TOSCA type definition and as
a 
result supports the common keynames listed in <a href="#641-common-keynames-in-type-definitions">Section 
6.4.1</a>. In addition, the 
data type definition has the following recognized keynames:</p>
<!----
{"id": "904", "author": "Chris Lauwers", "date": "2021-01-26T03:12:00Z", "comment": "Edit suggested by Mike Rehder: Not valid for a type derived from a complex type (parent has property definitions) or a type with property, key_schema or entry_schema definitions.", "target": "Type"}-->
<!----
{"id": "905", "author": "Chris Lauwers", "date": "2021-01-26T03:13:00Z", "comment": "Edit suggested by Mike Rehder: Not valid for a type derived from a simple type (parent has no property definitions) or a type with constraint definitions.", "target": "TOSCA"}-->
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">validation</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">validation clause</td>
<td style="text-align: left;">The optional validation clause that must
evaluate to True for values of this data type to be valid.</td>
</tr>
<tr class="even">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property definitions</td>
<td style="text-align: left;">The optional map property definitions that
comprise the schema for a complex data type in TOSCA.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">key_schema</td>
<td style="text-align: left;">conditional</td>
<td style="text-align: left;">schema definition</td>
<td style="text-align: left;">For data types that derive from the TOSCA
map data type, the optional schema definition for the keys used to
identify entries in properties of this data type. If not specified, the
key_schema defaults to string. If present, the key_schema must derive
from string. For data types that do not derive from the TOSCA map data
type, the key_schema is not allowed.</td>
</tr>
<tr class="even">
<td style="text-align: left;">entry_schema</td>
<td style="text-align: left;">conditional</td>
<td style="text-align: left;">schema definition</td>
<td style="text-align: left;">For data types that derive from the TOSCA
map or list data types, the mandatory schema definition for the entries
in properties of this data type. For data types that do not derive from
the TOSCA list or map data type, the entry_schema is not allowed.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb129-1"><a aria-hidden="true" href="#cb129-1" tabindex="-1"></a><span class="fu">&lt;data_type_name&gt;</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb129-2"><a aria-hidden="true" href="#cb129-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;existing_type_name&gt;</span></span>
<span id="cb129-3"><a aria-hidden="true" href="#cb129-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb129-4"><a aria-hidden="true" href="#cb129-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map of yaml_values&gt;</span></span>
<span id="cb129-5"><a aria-hidden="true" href="#cb129-5" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;datatype_description&gt;</span></span>
<span id="cb129-6"><a aria-hidden="true" href="#cb129-6" tabindex="-1"></a><span class="at">  </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> &lt;validation_clause&gt;</span></span>
<span id="cb129-7"><a aria-hidden="true" href="#cb129-7" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_definitions&gt;</span></span>
<span id="cb129-8"><a aria-hidden="true" href="#cb129-8" tabindex="-1"></a><span class="at">  </span><span class="fu">key_schema</span><span class="kw">:</span><span class="at"> &lt;key_schema_definition&gt;</span></span>
<span id="cb129-9"><a aria-hidden="true" href="#cb129-9" tabindex="-1"></a><span class="at">  </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> &lt;entry_schema_definition&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>data_type_name: represents the mandatory symbolic name of the
data 
type as a string.</p></li>
<li><p>existing_type_name: represents the optional name of a valid
TOSCA 
built-in type or data type from which this new data type
derives.</p></li>
<li><p>validation_clause: represents the optional validation clause that
must 
evaluate to True for values of this data type to be valid.</p></li>
<li><p>property_definitions: represents the optional map of one or
more 
property definitions that provide the schema for the data type</p>
<ul>
<li>property_definitions are only allowed for complex type
definitions<br/>
and MAY NOT be added to custom data types derived_from TOSCA<br/>
built-in types.</li>
</ul></li>
<li><p>key_schema_definition: if the data type derives from the TOSCA
map 
type (i.e existing_type_name is a map or derives from a map), it 
represents the optional schema definition for the keys used to 
identify entry properties of this type.</p></li>
<li><p>entry_schema_definition: if the data type derives from the TOSCA
map 
or list types (i.e. existing_type name is a map or list or derives 
from a map or list), it represents the mandatory schema definition
for 
the entries in properties of this type.</p></li>
</ul>
<p>The following requirements apply:</p>
<ul>
<li><p>A valid datatype definition <strong>MUST</strong> have either a
valid 
derived_from declaration or at least one valid property
definition.</p></li>
<li><p>A validation clause <strong>SHALL</strong> be type-compatible
with the type 
declared by the derived_from keyname.</p></li>
<li><p>If a properties keyname is provided, it <strong>SHALL</strong>
contain one or more 
valid property definitions.</p></li>
</ul>
<p>During data type derivation the keyname definitions follow these
rules:</p>
<ul>
<li><p>validation: a new validation clause may be defined; this
validation 
clause does not replace the validation clause defined in the
parent 
type but is considered in addition to it.</p></li>
<li><p>properties: existing property definitions may be refined; new
property 
definitions may be added.</p></li>
<li><p>key_schema: the key_schema definition may be refined according
to 
schema refinement rules.</p></li>
<li><p>entry_schema: the entry_schema definition may be refined
according to 
schema refinement rules.</p></li>
</ul>
<p>The following code snippet shows an example data type definition
that 
derives from the built-in string type:</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb130-1"><a aria-hidden="true" href="#cb130-1" tabindex="-1"></a><span class="fu">ShortString</span><span class="kw">:</span></span>
<span id="cb130-2"><a aria-hidden="true" href="#cb130-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb130-3"><a aria-hidden="true" href="#cb130-3" tabindex="-1"></a><span class="at">  </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$less_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">16</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>The next example defines a complex data type that represents a phone
number:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb131-1"><a aria-hidden="true" href="#cb131-1" tabindex="-1"></a><span class="fu">PhoneNumber</span><span class="kw">:</span></span>
<span id="cb131-2"><a aria-hidden="true" href="#cb131-2" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb131-3"><a aria-hidden="true" href="#cb131-3" tabindex="-1"></a><span class="at">    </span><span class="fu">countrycode</span><span class="kw">:</span></span>
<span id="cb131-4"><a aria-hidden="true" href="#cb131-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb131-5"><a aria-hidden="true" href="#cb131-5" tabindex="-1"></a><span class="at">    </span><span class="fu">areacode</span><span class="kw">:</span></span>
<span id="cb131-6"><a aria-hidden="true" href="#cb131-6" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb131-7"><a aria-hidden="true" href="#cb131-7" tabindex="-1"></a><span class="at">    </span><span class="fu">number</span><span class="kw">:</span></span>
<span id="cb131-8"><a aria-hidden="true" href="#cb131-8" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span></code></pre></div>
<p>The following example shows a complex data type that derives from
and 
extends a previously defined complex data type:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb132-1"><a aria-hidden="true" href="#cb132-1" tabindex="-1"></a><span class="fu">ExtendPhoneNumber</span><span class="kw">:</span></span>
<span id="cb132-2"><a aria-hidden="true" href="#cb132-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> PhoneNumber</span></span>
<span id="cb132-3"><a aria-hidden="true" href="#cb132-3" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb132-4"><a aria-hidden="true" href="#cb132-4" tabindex="-1"></a><span class="at">    </span><span class="fu">phone_description</span><span class="kw">:</span></span>
<span id="cb132-5"><a aria-hidden="true" href="#cb132-5" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb132-6"><a aria-hidden="true" href="#cb132-6" tabindex="-1"></a><span class="at">      </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$less_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">128</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<h2 id="schema-definition">9.3 Schema Definition</h2>
<p>All entries in a map or list for one property or parameter must be
of 
the same type. Similarly, all keys for map entries for one property
or 
parameter must be of the same type as well. A TOSCA schema
definition 
must be used to specify the type (for simple entries) or schema
(for 
complex entries) for keys and entries in TOSCA set types such as
the 
TOSCA list or map.</p>
<p>If the schema definition specifies a map key, the type of the key
schema 
must be derived originally from the string type (which basically
ensures 
that the schema type is a string with additional validation clause).
As 
there is little need for complex keys this caters to more 
straight-forward and clear specifications. If the key schema is
not 
defined it is assumed to be string by default.</p>
<p>Schema definitions appear in data type definitions when derived_from
a 
map or list type or in parameter, property, or attribute definitions
of 
a map or list type.</p>
<p>The following is the list of recognized keynames for a TOSCA
schema 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>type</td>
<td>yes</td>
<td>string</td>
<td>The mandatory data type for the key or entry. If this schema
definition is for a map key, then the referred type must be derived
originally from string.</td>
</tr>
<tr class="even">
<td>description</td>
<td>no</td>
<td>string</td>
<td>The optional description for the schema.</td>
</tr>
<tr class="odd">
<td>validation</td>
<td>no</td>
<td>validation clause</td>
<td>The optional validation clause that must evaluate to True for the
property.</td>
</tr>
<tr class="even">
<td>key_schema</td>
<td>no</td>
<td>schema definition</td>
<td>When the schema itself is of type map, the optional schema
definition that is used to specify the type of the keys of that map’s
entries (if key_schema is not defined it is assumed to be “string” by
default). For other schema types, the key_schema must not be
defined.</td>
</tr>
<tr class="odd">
<td>entry_schema</td>
<td>conditional</td>
<td>schema definition</td>
<td>When the schema itself is of type map or list, the schema definition
is mandatory and is used to specify the type of the entries in that map
or list. For other schema types, the entry_schema must not be
defined.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb133-1"><a aria-hidden="true" href="#cb133-1" tabindex="-1"></a><span class="fu">&lt;schema_definition&gt;</span><span class="kw">:</span></span>
<span id="cb133-2"><a aria-hidden="true" href="#cb133-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;schema_type&gt; </span></span>
<span id="cb133-3"><a aria-hidden="true" href="#cb133-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;schema_description&gt;</span></span>
<span id="cb133-4"><a aria-hidden="true" href="#cb133-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map_of_yaml_values&gt;</span></span>
<span id="cb133-5"><a aria-hidden="true" href="#cb133-5" tabindex="-1"></a><span class="at">  </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> &lt;schema_validation_clause&gt;</span></span>
<span id="cb133-6"><a aria-hidden="true" href="#cb133-6" tabindex="-1"></a><span class="at">  </span><span class="fu">key_schema</span><span class="kw">:</span><span class="at"> &lt;key_schema_definition&gt;</span></span>
<span id="cb133-7"><a aria-hidden="true" href="#cb133-7" tabindex="-1"></a><span class="at">  </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> &lt;entry_schema_definition&gt;</span></span></code></pre></div>
<p>The following single-line grammar may be used when only the schema
type 
needs to be declared:</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb134-1"><a aria-hidden="true" href="#cb134-1" tabindex="-1"></a><span class="fu">&lt;schema_definition&gt;</span><span class="kw">:</span><span class="at"> &lt;schema_type&gt;</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>schema_type: represents the mandatory type name for entries of
the 
specified schema</p>
<ul>
<li>if this schema definition is for a map key, then the schema_type
must<br/>
be derived originally from string.</li>
</ul></li>
<li><p>schema_validation_clause: represents the optional validation
clause 
for entries of the specified schema.</p></li>
<li><p>key_schema_definition: if the schema_type is map, it represents
the 
optional schema definition for the keys of that map’s entries.</p></li>
<li><p>entry_schema_definition: if the schema_type is map or list,
it 
represents the mandatory schema definition for the entries in that
map 
or list.</p></li>
</ul>
<p>A schema definition uses the following definition refinement rules
when 
the containing entity type is derived:</p>
<ul>
<li><p>type: must be derived from (or the same as) the type in the
schema 
definition in the parent entity type definition.</p></li>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the schema definition in the parent entity type 
definition.</p></li>
<li><p>validation: a new definition is unrestricted; this validation
clause 
does not replace the validation clause defined in the schema 
definition in the parent entity type but is considered in addition
to 
it.</p></li>
<li><p>key_schema: may be refined (recursively) according to
schema 
refinement rules.</p></li>
<li><p>entry_schema: may be refined (recursively) according to
schema 
refinement rules.</p></li>
</ul>
<h2 id="property-definition">9.3 Property Definition</h2>
<p>A property definition defines a named, typed value and related
data 
that can be associated with an entity defined in this
specification 
(e.g., node types, relationship types, capability types, 
etc.). Properties are used by template authors to provide 
configuration values to TOSCA entities that indicate their
<em>desired 
state</em> when they are instantiated. The value of a property can
be 
retrieved using the <code>$get_property</code> function within TOSCA
service 
templates.</p>
<p>The following is the list of recognized keynames for a TOSCA
property 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>type</td>
<td>yes</td>
<td>string</td>
<td>The mandatory data type for the property.</td>
</tr>
<tr class="even">
<td>description</td>
<td>no</td>
<td>string</td>
<td>The optional description for the property.</td>
</tr>
<tr class="odd">
<td>metadata</td>
<td>no</td>
<td>map of yaml values</td>
<td>Defines a section used to declare additional metadata
information.</td>
</tr>
<tr class="even">
<td>required</td>
<td>no</td>
<td>boolean</td>
<td>An optional key that declares a property as required (true) or not
(false). Defaults to true.</td>
</tr>
<tr class="odd">
<td>default</td>
<td>no</td>
<td>&lt;must match property type&gt;</td>
<td>An optional key that may provide a value to be used as a default if
not provided by another means. The default keyname SHALL NOT be defined
when property is not required (i.e. the value of the required keyname is
false).</td>
</tr>
<tr class="even">
<td>value</td>
<td>no</td>
<td>&lt;see below&gt;</td>
<td>An optional key that may provide a fixed value to be used. A
property that has a fixed value provided (as part of a definition or
refinement) cannot be subject to a further refinement or assignment.
That is, a fixed value cannot be changed.</td>
</tr>
<tr class="odd">
<td>validation</td>
<td>no</td>
<td>validation clause</td>
<td>The optional validation clause for the property.</td>
</tr>
<tr class="even">
<td>key_schema</td>
<td>conditional</td>
<td>schema definition</td>
<td>The schema definition for the keys used to identify entries in
properties of type TOSCA map (or types that derive from map). If not
specified, the key_schema defaults to string. For properties of type
other than map, the key_schema is not allowed.</td>
</tr>
<tr class="odd">
<td>entry_schema</td>
<td>conditional</td>
<td>schema definition</td>
<td>The schema definition for the entries in properties of TOSCA
collection types such as list, map, or types that derive from list or
map) If the property type is a collection type, the entry schema is
mandatory. For other types, the entry_schema is not allowed.</td>
</tr>
</tbody>
</table>
<p>Property definitions have the following grammar:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb135-1"><a aria-hidden="true" href="#cb135-1" tabindex="-1"></a><span class="fu">&lt;property_name&gt;</span><span class="kw">:</span></span>
<span id="cb135-2"><a aria-hidden="true" href="#cb135-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;property_type&gt; </span></span>
<span id="cb135-3"><a aria-hidden="true" href="#cb135-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;property_description&gt;</span></span>
<span id="cb135-4"><a aria-hidden="true" href="#cb135-4" tabindex="-1"></a><span class="at">  </span><span class="fu">required</span><span class="kw">:</span><span class="at"> &lt;property_required&gt;</span></span>
<span id="cb135-5"><a aria-hidden="true" href="#cb135-5" tabindex="-1"></a><span class="at">  </span><span class="fu">default</span><span class="kw">:</span><span class="at"> &lt;default_value&gt;</span></span>
<span id="cb135-6"><a aria-hidden="true" href="#cb135-6" tabindex="-1"></a><span class="at">  </span><span class="fu">value</span><span class="kw">:</span><span class="at"> &lt;property_value&gt; | &lt;property_value_expression&gt;</span></span>
<span id="cb135-7"><a aria-hidden="true" href="#cb135-7" tabindex="-1"></a><span class="at">  </span><span class="fu">status</span><span class="kw">:</span><span class="at"> &lt;status_value&gt;</span></span>
<span id="cb135-8"><a aria-hidden="true" href="#cb135-8" tabindex="-1"></a><span class="at">  </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> &lt;validation_clause&gt;</span></span>
<span id="cb135-9"><a aria-hidden="true" href="#cb135-9" tabindex="-1"></a><span class="at">  </span><span class="fu">key_schema</span><span class="kw">:</span><span class="at"> &lt;key_schema_definition&gt;</span></span>
<span id="cb135-10"><a aria-hidden="true" href="#cb135-10" tabindex="-1"></a><span class="at">  </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> &lt;entry_schema_definition&gt;</span></span>
<span id="cb135-11"><a aria-hidden="true" href="#cb135-11" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb135-12"><a aria-hidden="true" href="#cb135-12" tabindex="-1"></a><span class="at">    &lt;metadata_map&gt;</span></span></code></pre></div>
<p>The following single-line grammar is supported when only a fixed
value 
or fixed value expression needs to be provided to a property:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb136-1"><a aria-hidden="true" href="#cb136-1" tabindex="-1"></a><span class="fu">&lt;property_name&gt;</span><span class="kw">:</span><span class="at"> &lt;property_value&gt; | &lt;property_value_expression&gt;</span></span></code></pre></div>
<p>This single-line grammar is equivalent to the following:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb137-1"><a aria-hidden="true" href="#cb137-1" tabindex="-1"></a><span class="fu">&lt;property_name&gt;</span><span class="kw">:</span></span>
<span id="cb137-2"><a aria-hidden="true" href="#cb137-2" tabindex="-1"></a><span class="at">    </span><span class="fu">value</span><span class="kw">:</span><span class="at"> &lt;property_value&gt; | &lt;property_value_expression&gt;</span></span></code></pre></div>
<p>Note that the short form can be used only during a refinement
(i.e. the 
property has been previously defined).</p>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>property_name: represents the mandatory symbolic name of the
property 
as a string.</p></li>
<li><p>property_type: represents the mandatory data type of the
property.</p></li>
<li><p>property_required: represents an optional boolean value (true
or 
false) indicating whether or not the property is required. If this 
keyname is not present on a property definition, then the property 
SHALL be considered required (i.e., true) by default.</p></li>
<li><p>default_value: contains a type-compatible value that is used as
a 
default value if a value is not provided by another means (via the 
fixed_value definition or via property assignment);</p>
<ul>
<li>the default_value shall not be defined for properties that are
not<br/>
required (i.e. property_required is “false”) as they will stay<br/>
undefined.</li>
</ul></li>
<li><p><property_value> or <property_value_expression>: contains a 
type-compatible value or value expression that may be defined
during 
property definition or refinement to set and fix the value 
definition of the property.</property_value_expression></property_value></p>
<ul>
<li>note that a value definition cannot be changed; once defined,
the<br/>
property cannot be further refined or assigned. Thus, value<br/>
definitions should be avoided in data_type definitions.</li>
</ul></li>
<li><p>validation_clause: represents the optional Boolean expression
that 
must evaluate to true for a value of this property to be valid.</p></li>
<li><p>key_schema_definition: if the property_type is map or derives
from 
map, represents the optional schema definition for the keys used
to 
identify entries in that map.</p></li>
<li><p>entry_schema_definition: if the property_type is map or list,
or 
derives from map or list, represents the mandatory schema
definition 
for the entries in that map or list.</p></li>
</ul>
<p>A property definition within data, capability, node,
relationship, 
group, policy, and artifact types (including capability definitions
in 
node types) matching the name of a property in the derived entity
type 
uses the following refinement rules to combine the two property 
definitions together:</p>
<ul>
<li><p>type: must be derived from (or the same as) the type in the
property 
definition in the parent entity type definition.</p></li>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the property definition in the parent entity
type 
definition.</p></li>
<li><p>required: if defined to “false” in the property definition
parent 
entity type it may be redefined to “true”; note that if undefined
it 
is automatically considered as being defined to “true”.</p></li>
<li><p>default: a new definition is unrestricted and will overwrite the
one 
inherited from the property definition in the parent entity type 
definition (note that the definition of a default value is only 
allowed if the required keyname is (re)defined as “true”).</p></li>
<li><p>value: if undefined in the property definition in the parent
entity 
type, it may be defined to any type-compatible value; once
defined, 
the property cannot be further refined or assigned.</p></li>
<li><p>validation: a new definition is unrestricted; this validation
clause 
does not replace the validation clause defined in the property 
definition in the parent entity type but is considered in addition
to 
it.</p></li>
<li><p>key_schema: if defined in the property definition in the parent
entity 
type it may be refined according to schema refinement rules.</p></li>
<li><p>entry_schema: if defined in the property definition in the
parent 
entity type it may be refined according to schema refinement
rules.</p></li>
</ul>
<p>The following code snippet shows an example property definition with
a 
validation clause:</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb138-1"><a aria-hidden="true" href="#cb138-1" tabindex="-1"></a><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb138-2"><a aria-hidden="true" href="#cb138-2" tabindex="-1"></a><span class="at">  </span><span class="fu">num_cpus</span><span class="kw">:</span></span>
<span id="cb138-3"><a aria-hidden="true" href="#cb138-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb138-4"><a aria-hidden="true" href="#cb138-4" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Number of CPUs requested for a software node instance.</span></span>
<span id="cb138-5"><a aria-hidden="true" href="#cb138-5" tabindex="-1"></a><span class="at">    </span><span class="fu">default</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb138-6"><a aria-hidden="true" href="#cb138-6" tabindex="-1"></a><span class="at">    </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb138-7"><a aria-hidden="true" href="#cb138-7" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$valid_values</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">2</span><span class="kw">,</span><span class="at"> </span><span class="dv">4</span><span class="kw">,</span><span class="at"> </span><span class="dv">8</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>The following shows an example of a property refinement. Consider
the 
definition of an Endpoint capability type:</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb139-1"><a aria-hidden="true" href="#cb139-1" tabindex="-1"></a><span class="fu">Endpoint</span><span class="kw">:</span></span>
<span id="cb139-2"><a aria-hidden="true" href="#cb139-2" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb139-3"><a aria-hidden="true" href="#cb139-3" tabindex="-1"></a><span class="at">    </span><span class="fu">protocol</span><span class="kw">:</span></span>
<span id="cb139-4"><a aria-hidden="true" href="#cb139-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb139-5"><a aria-hidden="true" href="#cb139-5" tabindex="-1"></a><span class="at">      </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb139-6"><a aria-hidden="true" href="#cb139-6" tabindex="-1"></a><span class="at">      </span><span class="fu">default</span><span class="kw">:</span><span class="at"> tcp</span></span>
<span id="cb139-7"><a aria-hidden="true" href="#cb139-7" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span></span>
<span id="cb139-8"><a aria-hidden="true" href="#cb139-8" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> PortDef</span></span>
<span id="cb139-9"><a aria-hidden="true" href="#cb139-9" tabindex="-1"></a><span class="at">      </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb139-10"><a aria-hidden="true" href="#cb139-10" tabindex="-1"></a><span class="at">    </span><span class="fu">secure</span><span class="kw">:</span></span>
<span id="cb139-11"><a aria-hidden="true" href="#cb139-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> boolean</span></span>
<span id="cb139-12"><a aria-hidden="true" href="#cb139-12" tabindex="-1"></a><span class="at">      </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span>
<span id="cb139-13"><a aria-hidden="true" href="#cb139-13" tabindex="-1"></a><span class="at">      </span><span class="fu">default</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span></code></pre></div>
<p>The Endpoint.Admin capability type refines the secure property of
the 
Endpoint capability type from which it derives by forcing its value
to 
always be true:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb140-1"><a aria-hidden="true" href="#cb140-1" tabindex="-1"></a><span class="fu">Endpoint.Admin</span><span class="kw">:</span></span>
<span id="cb140-2"><a aria-hidden="true" href="#cb140-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> Endpoint</span></span>
<span id="cb140-3"><a aria-hidden="true" href="#cb140-3" tabindex="-1"></a><span class="co">  # Change Endpoint secure indicator to true from its default of false</span></span>
<span id="cb140-4"><a aria-hidden="true" href="#cb140-4" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb140-5"><a aria-hidden="true" href="#cb140-5" tabindex="-1"></a><span class="at">    </span><span class="fu">secure</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span></code></pre></div>
<h2 id="property-assignment">9.4 Property Assignment</h2>
<p>A property assignment is used to assign a value to a property within
a 
TOSCA template. A TOSCA property assignment has no keynames.
Property 
assignments have the following grammar:</p>
<pre><code>&lt;property_name&gt;: &lt;property_value&gt; | &lt;property_value_expression&gt;</code></pre>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>property_name: represents the name of a property that will be
used to 
select a property definition with the same name within on a TOSCA 
entity (e.g., node template, relationship template, etc.) which is 
declared in its declared type (e.g., a node type, node template, 
capability type, etc.).</p></li>
<li><p>property_value, property_value_expression: represent the 
type-compatible value to assign to the property. Property values
may 
be provided as the result of the evaluation of 
an expression or a 
function.</p></li>
</ul>
<p>The following requirements apply:</p>
<ul>
<li><p>Properties that have a (fixed) value defined during their
definition 
or during a subsequent refinement may not be assigned (as their
value 
is already set).</p></li>
<li><p>If a required property has no value defined or assigned, its
default 
value is assigned</p></li>
<li><p>A non-required property that is not assigned stays undefined,
thus 
the default keyname is irrelevant for a non-required property.</p></li>
</ul>
<h2 id="attribute-definition">9.5 Attribute Definition</h2>
<!----
{"id": "990", "author": "Calin Curescu", "date": "2020-05-07T23:14:00Z", "comment": "%%% !!! To implement this, throughout the specification. Default can have also value_expression! I think we might need also an attribute \u201cvalue_expresssion\u201d keyname that allows to define an attribute as a function of a different attribute (of the same entity), that we can define when creating node/relationship types, even before template design time.", "target": "Attribute definition"}-->
<p>An attribute definition defines a named, typed value that can
be 
associated with an entity defined in this specification (e.g., a
node, 
relationship or capability type). Specifically, it is used to
expose 
the <em>actual state</em> of some a TOSCA entity after it has been
deployed 
and instantiated (as set by the TOSCA orchestrator).</p>
<p>Attribute definitions are very similar to property definitions; 
however, properties of entities reflect a configuration value that 
carries the template author’s requested or desired value (i.e., 
desired state) which the orchestrator (attempts to) use when 
instantiating the entity. Attributes on the other hand reflect the 
actual value (i.e., actual state) that provides the actual 
instantiated value. For example, a property can be used to request
the 
IP address of a node using a property (setting); however, the
actual 
IP address after the node is instantiated may by different and
made 
available by an attribute. To allow both the desired state and the 
actual state to be tracked, TOSCA orchestrators <strong>MUST</strong>
automatically 
create an attribute for every declared property (with the same 
symbolic name) to allow introspection of both the desired state 
(property) and actual state (attribute). If an attribute is
reflected 
from a property, its initial value is the value of the reflected 
property.</p>
<p>Attribute values can be retrieved via the <code>$get_attribute</code>
function 
from the representation model and used as values to other entities 
within TOSCA service templates. Attribute values an also be set by 
output mappings defined in interface operations.</p>
<p>The following is the list of recognized keynames for a TOSCA
attribute 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>type</td>
<td>yes</td>
<td>string</td>
<td>The mandatory data type for the attribute.</td>
</tr>
<tr class="even">
<td>description</td>
<td>no</td>
<td>string</td>
<td>The optional description for the attribute.</td>
</tr>
<tr class="odd">
<td>metadata</td>
<td>no</td>
<td>map of yaml data</td>
<td>Defines a section used to declare additional metadata
information.</td>
</tr>
<tr class="even">
<td>default</td>
<td>no</td>
<td>&lt;must match attribute type&gt;</td>
<td>An optional key that may provide a value to be used as a default if
not provided by another means. This value SHALL be type compatible with
the type declared by the attribute definition’s type keyname.</td>
</tr>
<tr class="odd">
<td>validation</td>
<td>no</td>
<td>validation clause</td>
<td>The optional validation clause for the attribute.</td>
</tr>
<tr class="even">
<td>key_schema</td>
<td>conditional</td>
<td>schema definition</td>
<td>The schema definition for the keys used to identify entries in
attributes of type TOSCA map (or types that derive from map). If not
specified, the key_schema defaults to string. For attributes of type
other than map, the key_schema is not allowed.</td>
</tr>
<tr class="odd">
<td>entry_schema</td>
<td>conditional</td>
<td>schema definition</td>
<td>The schema definition for the entries in attributes of TOSCA
collection types such as list, map, or types that derive from list or
map) If the attribute type is a collection type, the entry schema is
mandatory. For other types, the entry_schema is not allowed.</td>
</tr>
</tbody>
</table>
<p>Attribute definitions have the following grammar:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb142-1"><a aria-hidden="true" href="#cb142-1" tabindex="-1"></a><span class="fu">attributes</span><span class="kw">:</span></span>
<span id="cb142-2"><a aria-hidden="true" href="#cb142-2" tabindex="-1"></a><span class="at">  </span><span class="fu">&lt;attribute_name&gt;</span><span class="kw">:</span></span>
<span id="cb142-3"><a aria-hidden="true" href="#cb142-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;attribute_type&gt;</span></span>
<span id="cb142-4"><a aria-hidden="true" href="#cb142-4" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;attribute_description&gt;</span></span>
<span id="cb142-5"><a aria-hidden="true" href="#cb142-5" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;metadata_map&gt;</span></span>
<span id="cb142-6"><a aria-hidden="true" href="#cb142-6" tabindex="-1"></a><span class="at">    </span><span class="fu">default</span><span class="kw">:</span><span class="at"> &lt;default_value&gt; </span></span>
<span id="cb142-7"><a aria-hidden="true" href="#cb142-7" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> &lt;attribute_validation_clause&gt;</span></span>
<span id="cb142-8"><a aria-hidden="true" href="#cb142-8" tabindex="-1"></a><span class="at">    </span><span class="fu">key_schema</span><span class="kw">:</span><span class="at"> &lt;key_schema_definition&gt;</span></span>
<span id="cb142-9"><a aria-hidden="true" href="#cb142-9" tabindex="-1"></a><span class="at">    </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> &lt;entry_schema_definition&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>attribute_name: represents the mandatory symbolic name of
the 
attribute as a string.</p></li>
<li><p>attribute_type: represents the mandatory data type of the
attribute.</p></li>
<li><p>default_value: contains a type-compatible value that may be used
as 
a default if not provided by another means. Values for the default 
keyname <strong>MUST</strong> be derived or calculated from other
attribute or 
operation output values (that reflect the actual state of the 
instance of the corresponding resource) and not hard-coded or 
derived from a property settings or inputs (i.e., desired
state).</p></li>
<li><p>attribute_validation_clause: represents the optional
validation 
clause that must evaluate to True for values for the defined 
attribute to be valid.</p></li>
<li><p>key_schema_definition: if the attribute_type is map, represents
the 
optional schema definition for the keys used to identify entries
in 
that map.</p></li>
<li><p>entry_schema_definition: if the attribute_type is map or
list, 
represents the mandatory schema definition for the entries in that
map 
or list.</p></li>
</ul>
<p>An attribute definition within data, capability, node, relationship,
and 
group types (including capability definitions in node types) uses
the 
following refinement rules when the containing entity type is
derived:</p>
<ul>
<li><p>type: must be derived from (or the same as) the type in the
attribute 
definition in the parent entity type definition.</p></li>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the attribute definition in the parent entity
type 
definition.</p></li>
<li><p>default: a new definition is unrestricted and will overwrite the
one 
inherited from the attribute definition in the parent entity type 
definition.</p></li>
<li><p>validation: a new definition is unrestricted; this validation
clause 
does not replace the validation clause defined in the attribute 
definition in the parent entity type but is considered in addition
to 
it.</p></li>
<li><p>key_schema: if defined in the attribute definition in the
parent 
entity type it may be refined according to schema refinement
rules.</p></li>
<li><p>entry_schema: if defined in the attribute definition in the
parent 
entity type it may be refined according to schema refinement
rules.</p></li>
</ul>
<p>The following represents a mandatory attribute definition:</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb143-1"><a aria-hidden="true" href="#cb143-1" tabindex="-1"></a><span class="fu">actual_cpus</span><span class="kw">:</span></span>
<span id="cb143-2"><a aria-hidden="true" href="#cb143-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb143-3"><a aria-hidden="true" href="#cb143-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Actual number of CPUs allocated to the node instance.</span></span></code></pre></div>
<h2 id="attribute-assignment">9.6 Attribute Assignment</h2>
<p>An attribute assignment is used to assign a value to an
attribute 
within a TOSCA template. A TOSCA attribute assignment has no 
keynames. Attribute assignments have the following grammar:</p>
<pre><code>&lt;attribute_name&gt;: &lt;attribute_value&gt; |  &lt;attribute_value_expression&gt; </code></pre>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>attribute_name: represents the name of an attribute that will be
used 
to select an attribute definition with the same name within on a
TOSCA 
entity (e.g., node template, relationship template, etc.) which is 
declared (or reflected from a Property definition) in its declared 
type (e.g., a node type, node template, capability type, etc.).</p></li>
<li><p>attribute_value, attribute_value_expresssion: represent the 
type-compatible value to assign to the attribute. Attribute values
may 
be provided as the result from the evaluation of an expression or
a 
function.</p></li>
</ul>
<p>Note that attributes that are the target of a parameter mapping 
assignment cannot also be assigned a value using an attribute 
assignment.</p>
<h2 id="parameter-definition">9.7 Parameter Definition</h2>
<p>A parameter definition defines a named, typed value and related data
that 
may be used to exchange values between the TOSCA orchestrator and
the 
external world. Such values may be</p>
<ul>
<li><p>inputs and outputs of interface operations and
notifications</p></li>
<li><p>inputs and outputs of workflows</p></li>
<li><p>inputs and outputs of service templates</p></li>
</ul>
<p>From the perspective of the TOSCA orchestrator such parameters
are 
either <em>incoming</em> (i.e. transferring a value from the external
world 
to the orchestrator) or <em>outgoing</em> (transferring a value from
the 
orchestrator to the external world). Thus:</p>
<ul>
<li><p>outgoing parameters are:</p>
<ul>
<li><p>template outputs</p></li>
<li><p>internal workflow outputs</p></li>
<li><p>external workflow inputs</p></li>
<li><p>operation inputs</p></li>
</ul></li>
<li><p>incoming parameters are:</p>
<ul>
<li><p>template inputs</p></li>
<li><p>internal workflow inputs</p></li>
<li><p>external workflow outputs</p></li>
<li><p>operation outputs</p></li>
<li><p>notification outputs</p></li>
</ul></li>
</ul>
<p>An <em>outgoing</em> parameter definition is essentially the same as
a TOSCA 
property definition, however it may optionally inherit the data type
of 
the value assigned to it rather than have an explicit data type
defined.</p>
<p>An “<em>incoming</em> parameter definition may define an attribute
mapping of 
the parameter value to an attribute of a node. Optionally, it may 
inherit the data type of the attribute it is mapped to, rather than
have 
an explicit data type defined for it.</p>
<p>The TOSCA parameter definition has all the keynames of a TOSCA
property 
definition with the following additional or changed keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>type</td>
<td>no</td>
<td>string</td>
<td>The data type of the parameter. While this keyname is mandatory for
a TOSCA Property definition, it is not mandatory for a TOSCA parameter
definition.</td>
</tr>
<tr class="even">
<td>value</td>
<td>no</td>
<td>&lt;must match parameter type&gt;</td>
<td>The type-compatible value to assign to the parameter. Parameter
values may be provided as the result from the evaluation of an
expression or a function. May only be defined for outgoing parameters.
Mutually exclusive with the <em>mapping</em> keyname.</td>
</tr>
<tr class="odd">
<td>mapping</td>
<td>no</td>
<td>attribute selection format</td>
<td>A mapping that specifies the node or relationship attribute into
which the returned output value must be stored. May only be defined for
incoming parameters. Mutually exclusive with the <em>value</em>
keyname.</td>
</tr>
</tbody>
</table>
<p>Parameter definitions have the following grammar:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb145-1"><a aria-hidden="true" href="#cb145-1" tabindex="-1"></a><span class="fu">&lt;parameter_name&gt;</span><span class="kw">:</span></span>
<span id="cb145-2"><a aria-hidden="true" href="#cb145-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;parameter_type&gt; </span></span>
<span id="cb145-3"><a aria-hidden="true" href="#cb145-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;parameter_description&gt;</span></span>
<span id="cb145-4"><a aria-hidden="true" href="#cb145-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;metadata_map&gt;</span></span>
<span id="cb145-5"><a aria-hidden="true" href="#cb145-5" tabindex="-1"></a><span class="at">  </span><span class="fu">value</span><span class="kw">:</span><span class="at"> &lt;parameter_value&gt; | &lt;parameter_value_expression&gt; </span></span>
<span id="cb145-6"><a aria-hidden="true" href="#cb145-6" tabindex="-1"></a><span class="at">  </span><span class="fu">mapping</span><span class="kw">:</span><span class="at"> &lt;attribute_selection_form&gt;</span></span>
<span id="cb145-7"><a aria-hidden="true" href="#cb145-7" tabindex="-1"></a><span class="at">  </span><span class="fu">required</span><span class="kw">:</span><span class="at"> &lt;parameter_required&gt;</span></span>
<span id="cb145-8"><a aria-hidden="true" href="#cb145-8" tabindex="-1"></a><span class="at">  </span><span class="fu">default</span><span class="kw">:</span><span class="at"> &lt;parameter_default_value&gt;</span></span>
<span id="cb145-9"><a aria-hidden="true" href="#cb145-9" tabindex="-1"></a><span class="at">  </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> &lt;parameter_validation_clause&gt;</span></span>
<span id="cb145-10"><a aria-hidden="true" href="#cb145-10" tabindex="-1"></a><span class="at">  </span><span class="fu">key_schema</span><span class="kw">:</span><span class="at"> &lt;key_schema_definition&gt;</span></span>
<span id="cb145-11"><a aria-hidden="true" href="#cb145-11" tabindex="-1"></a><span class="at">  </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> &lt;entry_schema_definition&gt;</span></span></code></pre></div>
<p>The following single-line grammar is supported for
<em>outgoing</em> 
parameter definitions when only a fixed value needs to be provided:</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb146-1"><a aria-hidden="true" href="#cb146-1" tabindex="-1"></a><span class="fu">&lt;parameter_name&gt;</span><span class="kw">:</span><span class="at"> &lt;parameter_value&gt; |  &lt;parameter_value_expression&gt; </span></span></code></pre></div>
<p>This single-line grammar is equivalent to the following:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb147-1"><a aria-hidden="true" href="#cb147-1" tabindex="-1"></a><span class="fu">&lt;parameter_name&gt;</span><span class="kw">:</span></span>
<span id="cb147-2"><a aria-hidden="true" href="#cb147-2" tabindex="-1"></a><span class="at">    </span><span class="fu">value</span><span class="kw">:</span><span class="at"> &lt;parameter_value&gt; |  &lt;parameter_value_expression&gt; </span></span></code></pre></div>
<p>The following single-line grammar is supported for
<em>incoming</em> 
parameter definitions when only a parameter to attribute mapping
needs 
to be provided:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb148-1"><a aria-hidden="true" href="#cb148-1" tabindex="-1"></a><span class="fu">&lt;parameter_name&gt;</span><span class="kw">:</span><span class="at"> &lt;attribute_selection_form&gt;</span></span></code></pre></div>
<p>This single-line grammar is equivalent to the following:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb149-1"><a aria-hidden="true" href="#cb149-1" tabindex="-1"></a><span class="fu">&lt;parameter_name&gt;</span><span class="kw">:</span></span>
<span id="cb149-2"><a aria-hidden="true" href="#cb149-2" tabindex="-1"></a><span class="at">    </span><span class="fu">mapping</span><span class="kw">:</span><span class="at"> &lt;attribute_selection_form&gt;</span></span></code></pre></div>
<p>Note that the context of the parameter definition unambiguously 
determines if the parameter is an incoming or an outgoing parameter.</p>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>parameter_name: represents the mandatory symbolic name of
the 
parameter as a string.</p></li>
<li><p>parameter_type: represents the optional data type of the
parameter. 
Note, this keyname is mandatory for a TOSCA Property definition,
but 
is not for a TOSCA Parameter definition.</p></li>
<li><p>parameter_value, parameter_value_expresssion: represent the 
type-compatible value to assign to the parameter. Parameter values
may 
be provided as the result from the evaluation of an expression or
a 
function.</p>
<ul>
<li><p>once the value keyname is defined, the parameter cannot be
further 
refined or assigned.</p></li>
<li><p>the value keyname is relevant only for <em>outgoing</em>
parameter 
definitions and SHOULD NOT be defined in <em>incoming</em>
parameter 
definitions.</p></li>
</ul></li>
<li><p>parameter_required: represents an optional boolean value (true
or 
false) indicating whether or not the parameter is required. If
this 
keyname is not present on a parameter definition, then the
parameter 
SHALL be considered required (i.e., true) by default.</p></li>
<li><p>default_value: contains a type-compatible value that may be used
as a 
default if not provided by other means.</p>
<ul>
<li>the default keyname SHALL NOT be defined for parameters that are
not<br/>
required (i.e. parameter_required is “false”) as they will stay<br/>
undefined.</li>
</ul></li>
<li><p>parameter_validation_clause: represents the optional
validation 
clause on the parameter definition.</p></li>
<li><p>key_schema_definition: if the parameter_type is map, represents
the 
optional schema definition for the keys used to identify entries
in 
that map. Note that if the key_schema is not defined, the
key_schema 
defaults to string.</p></li>
<li><p>entry_schema_definition: if the parameter_type is map or
list, 
represents the mandatory schema definition for the entries in that
map 
or list.</p></li>
<li><p>attribute_selection_form: a list that corresponds to a
valid 
attribute_selection_format; the parameter is mapped onto an
attribute 
of the containing entity</p>
<ul>
<li>the mapping keyname is relevant only for <em>incoming</em>
parameter<br/>
definitions and SHOULD NOT be defined in <em>outgoing</em>
parameter<br/>
definitions.</li>
</ul></li>
</ul>
<p>A parameter definition within interface types, interface definitions
in 
node and relationship types, uses the following refinement rules
when 
the containing entity type is derived:</p>
<ul>
<li><p>type: must be derived from (or the same as) the type in the
parameter 
definition in the parent entity type definition.</p></li>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the parameter definition in the parent entity
type 
definition.</p></li>
<li><p>required: if defined to “false” in the parameter definition
parent 
entity type it may be redefined to “true”; note that if undefined
it 
is automatically considered as being defined to “true”.</p></li>
<li><p>default: a new definition is unrestricted and will overwrite the
one 
inherited from the parameter definition in the parent entity type 
definition (note that the definition of a default value is only 
allowed if the required keyname is (re)defined as “true”).</p></li>
<li><p>value: if undefined in the parameter definition in the parent
entity 
type, it may be defined to any type-compatible value; once
defined, 
the parameter cannot be further refined or assigned</p>
<ul>
<li>the value keyname should be defined only for “outgoing”
parameters.</li>
</ul></li>
<li><p>mapping: if undefined in the parameter definition in the parent
entity 
type, it may be defined to any type-compatible attribute mapping;
once 
defined, the parameter cannot be further refined or mapped</p>
<ul>
<li><p>the mapping keyname should be defined only for “incoming”
parameters.</p></li>
<li><p>status: a new definition is unrestricted and will overwrite the
one 
inherited from the parameter definition in the parent entity type 
definition.</p></li>
</ul></li>
<li><p>validation: a new definition is unrestricted; this validation
clause 
does not replace the validation clause defined in the parameter 
definition in the parent entity type but is considered in addition
to 
it.</p></li>
<li><p>key_schema: if defined in the parameter definition in the
parent 
entity type it may be refined according to schema refinement
rules.</p></li>
<li><p>entry_schema: if defined in the parameter definition in the
parent 
entity type it may be refined according to schema refinement
rules.</p></li>
<li><p>metadata: a new definition is unrestricted and will overwrite the
one 
inherited from the parameter definition in the parent entity type 
definition.</p></li>
</ul>
<p>The following represents an example of an input parameter
definition 
with a validation clause:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb150-1"><a aria-hidden="true" href="#cb150-1" tabindex="-1"></a><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb150-2"><a aria-hidden="true" href="#cb150-2" tabindex="-1"></a><span class="at">  </span><span class="fu">cpus</span><span class="kw">:</span></span>
<span id="cb150-3"><a aria-hidden="true" href="#cb150-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb150-4"><a aria-hidden="true" href="#cb150-4" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Number of CPUs for the server.</span></span>
<span id="cb150-5"><a aria-hidden="true" href="#cb150-5" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$valid_values</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">2</span><span class="kw">,</span><span class="at"> </span><span class="dv">4</span><span class="kw">,</span><span class="at"> </span><span class="dv">8</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>The following represents an example of an (untyped) output
parameter 
definition:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb151-1"><a aria-hidden="true" href="#cb151-1" tabindex="-1"></a><span class="fu">outputs</span><span class="kw">:</span></span>
<span id="cb151-2"><a aria-hidden="true" href="#cb151-2" tabindex="-1"></a><span class="at">  </span><span class="fu">server_ip</span><span class="kw">:</span></span>
<span id="cb151-3"><a aria-hidden="true" href="#cb151-3" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> The private IP address of the provisioned server.</span></span>
<span id="cb151-4"><a aria-hidden="true" href="#cb151-4" tabindex="-1"></a><span class="at">    </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_attribute</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> my_server</span><span class="kw">,</span><span class="at"> private_address </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<h2 id="parameter-value-assignment">9.8 Parameter Value Assignment</h2>
<p>A parameter value assignment is used to assing a value to an 
<em>outgoing</em> parameter within a TOSCA template. A TOSCA parameter
value 
assignment has no keynames. Parameter value assignments have the 
following grammar:</p>
<pre><code>&lt;parameter_name&gt;: &lt;parameter_value&gt; | &lt;parameter_value_expression&gt; </code></pre>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>parameter_name: represents the symbolic name of the parameter
to 
assign; note that in some cases, even parameters that do not have
a 
corresponding definition in the entity type of the entity
containing 
them may be assigned (see e.g. inputs and outputs in
interfaces).</p></li>
<li><p>parameter_value, parameter_value_expression: represent the 
type-compatible value to assign to the parameter. Parameter values
may 
be provided as the result from the evaluation of an expression or
a 
function.</p></li>
</ul>
<p>The following requirements apply:</p>
<ul>
<li><p>Parameters that have a (fixed) value defined during their
definition 
or during a subsequent refinement may not be assigned (as their
value 
is already set).</p></li>
<li><p>If a required parameter has no value defined or assigned, its
default 
value is assigned.</p></li>
<li><p>A non-required parameter that has no value assigned it
stays 
undefined, thus the default keyname is irrelevant for a
non-required 
parameter.</p></li>
</ul>
<h2 id="parameter-mapping-assignment">9.9 Parameter Mapping
Assignment</h2>
<p>A parameter mapping assignment is used to define the mapping of
an 
<em>incoming</em> parameter value (e.g. an output value that is expected
to 
be returned by an operation implementation) to an attribute into
which 
the returned <em>incoming</em> parameter value must be stored. A
TOSCA 
parameter value assignment has no keynames. Parameter value 
assignments use the following grammar:</p>
<pre><code>&lt;parameter_name&gt;: &lt;tosca_path, &lt;attribute_name&gt;, &lt;nested_attribute_name_or_index_or_key_1&gt;, ..., &lt;nested_attribute_name_or_index_or_key_n&gt;</code></pre>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>parameter_name: represents the symbolic name of the parameter to
assign 
assign; note that in some cases, even parameters that do not have
a 
corresponding definition in the entity type of the entity
containing 
them may be assigned (see e.g. inputs and outputs in
interfaces).</p></li>
<li><p>tosca_path using the &lt;tosca_path&gt; a TOSCA 
processor can traverse the representation graph to reach the 
attribute into which to store the output value. Note that while
the 
&lt;tosca_path is very powerful, its usage should be 
restricted to only reach attributes in the local node or local 
relationship or in a local capability.</p></li>
<li><p>attribute_name: represents the name of the attribute in the
local 
node or relationship context (i.e.,<code>SELF</code>) into which to map
the 
value of the incoming parameter referred to by parameter_name.</p></li>
<li><p>nested_attribute_name_or_index_or_key_*: Some TOSCA attributes
are 
complex (i.e. composed as nested structures). These parameters are 
used to dereference into the names of these nested structures when 
needed. Som attributes are lists or maps. In these cases, an index 
or key may be provided to reference a specific entry in the list
or 
map (identified by the previous parameter).</p></li>
</ul>
<p>Note that it is possible for multiple operations to define outputs
that 
map onto the same attribute value. For example, a <em>create</em>
operation 
could include an output value that sets an attribute to an initial 
value, and the subsequence <em>configure</em> operation could then
update that 
same attribute to a new value.</p>
<p>It is also possible that a node template assigns a value to an
attribute 
that has an operation output mapped to it (including a value that is
the 
result of calling an intrinsic function). Orchestrators could use
the 
assigned value for the attribute as its initial value. After the 
operation runs that maps an output value onto that attribute, the 
orchestrator must then use the updated value, and the value specified
in 
the node template will no longer be used.</p>
<p>Note that parameters that have a mapping defined during their 
definition or during a subsequent refinement may not be assigned
(as 
their mapping is already set).</p>
<h2 id="validation-clause">9.10 Validation Clause</h2>
<p>A validation clause is a Boolean expression that must evaluate to
True 
if the value for the entity it references is considered valid. 
Validation clauses have the following grammar:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb154-1"><a aria-hidden="true" href="#cb154-1" tabindex="-1"></a><span class="fu">validation</span><span class="kw">:</span><span class="at"> &lt; validation_clause&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li>validation_clause: represents a Boolean expression that must
evaluate<br/>
to True in order for values to be valid. Any Boolean expression can
be<br/>
used with any function with any degree of nesting.</li>
</ul>
<p>The Boolean expression used as a validation clause must have a 
mechanism for referencing the value to which the expression applies.
A 
special-purpose function is introduced for this purpose. This
function 
is named <code>$value</code> and refers to the value used for the data
type or 
the parameter definition that contains the validation clause.</p>
<p>The following shows an example of validation clauses used in data
type 
definitions. They also illustrate the various alternatives for the 
<code>$value</code> function syntax:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb155-1"><a aria-hidden="true" href="#cb155-1" tabindex="-1"></a><span class="fu">data_types</span><span class="kw">:</span></span>
<span id="cb155-2"><a aria-hidden="true" href="#cb155-2" tabindex="-1"></a><span class="co">  # Full function syntax for the $value function</span></span>
<span id="cb155-3"><a aria-hidden="true" href="#cb155-3" tabindex="-1"></a><span class="at">  </span><span class="fu">Count1</span><span class="kw">:</span></span>
<span id="cb155-4"><a aria-hidden="true" href="#cb155-4" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb155-5"><a aria-hidden="true" href="#cb155-5" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$value</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]</span><span class="at"> </span><span class="kw">},</span><span class="at"> </span><span class="dv">0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb155-6"><a aria-hidden="true" href="#cb155-6" tabindex="-1"></a><span class="co">  # Simple function syntax for the $value function</span></span>
<span id="cb155-7"><a aria-hidden="true" href="#cb155-7" tabindex="-1"></a><span class="at">  </span><span class="fu">Count2</span><span class="kw">:</span></span>
<span id="cb155-8"><a aria-hidden="true" href="#cb155-8" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb155-9"><a aria-hidden="true" href="#cb155-9" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb155-10"><a aria-hidden="true" href="#cb155-10" tabindex="-1"></a><span class="co">  # Full function syntax with arguments</span></span>
<span id="cb155-11"><a aria-hidden="true" href="#cb155-11" tabindex="-1"></a><span class="at">  </span><span class="fu">FrequencyRange</span><span class="kw">:</span></span>
<span id="cb155-12"><a aria-hidden="true" href="#cb155-12" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb155-13"><a aria-hidden="true" href="#cb155-13" tabindex="-1"></a><span class="at">      </span><span class="fu">low</span><span class="kw">:</span></span>
<span id="cb155-14"><a aria-hidden="true" href="#cb155-14" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> scalar-unit.frequency</span></span>
<span id="cb155-15"><a aria-hidden="true" href="#cb155-15" tabindex="-1"></a><span class="at">      </span><span class="fu">high</span><span class="kw">:</span></span>
<span id="cb155-16"><a aria-hidden="true" href="#cb155-16" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> scalar-unit.frequency</span></span>
<span id="cb155-17"><a aria-hidden="true" href="#cb155-17" tabindex="-1"></a><span class="at">    </span><span class="fu">validation</span><span class="kw">:</span></span>
<span id="cb155-18"><a aria-hidden="true" href="#cb155-18" tabindex="-1"></a><span class="at">      </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$value</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> high </span><span class="kw">]</span><span class="at"> </span><span class="kw">},</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$value</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> low </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span><span class="at"> </span><span class="kw">]</span></span></code></pre></div>
<p>The following shows an example of validation clauses used in
property 
definitions:</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb156-1"><a aria-hidden="true" href="#cb156-1" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb156-2"><a aria-hidden="true" href="#cb156-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Scalable</span><span class="kw">:</span></span>
<span id="cb156-3"><a aria-hidden="true" href="#cb156-3" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb156-4"><a aria-hidden="true" href="#cb156-4" tabindex="-1"></a><span class="at">      </span><span class="fu">minimum_instances</span><span class="kw">:</span></span>
<span id="cb156-5"><a aria-hidden="true" href="#cb156-5" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb156-6"><a aria-hidden="true" href="#cb156-6" tabindex="-1"></a><span class="at">        </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at">  </span><span class="dv">0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span><span class="at"> </span></span>
<span id="cb156-7"><a aria-hidden="true" href="#cb156-7" tabindex="-1"></a><span class="at">      </span><span class="fu">maximum_instances</span><span class="kw">:</span></span>
<span id="cb156-8"><a aria-hidden="true" href="#cb156-8" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb156-9"><a aria-hidden="true" href="#cb156-9" tabindex="-1"></a><span class="at">        </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb156-10"><a aria-hidden="true" href="#cb156-10" tabindex="-1"></a><span class="at">          </span><span class="fu">$greater_or_equal</span><span class="kw">:</span></span>
<span id="cb156-11"><a aria-hidden="true" href="#cb156-11" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> $value</span></span>
<span id="cb156-12"><a aria-hidden="true" href="#cb156-12" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">$get_property</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> SELF</span><span class="kw">,</span><span class="at"> minimum_instances </span><span class="kw">]</span></span>
<span id="cb156-13"><a aria-hidden="true" href="#cb156-13" tabindex="-1"></a><span class="at">      </span><span class="fu">default_instances</span><span class="kw">:</span></span>
<span id="cb156-14"><a aria-hidden="true" href="#cb156-14" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb156-15"><a aria-hidden="true" href="#cb156-15" tabindex="-1"></a><span class="at">        </span><span class="fu">validation</span><span class="kw">:</span></span>
<span id="cb156-16"><a aria-hidden="true" href="#cb156-16" tabindex="-1"></a><span class="at">          </span><span class="fu">$and</span><span class="kw">:</span></span>
<span id="cb156-17"><a aria-hidden="true" href="#cb156-17" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb156-18"><a aria-hidden="true" href="#cb156-18" tabindex="-1"></a><span class="at">              </span><span class="kw">-</span><span class="at"> $value</span></span>
<span id="cb156-19"><a aria-hidden="true" href="#cb156-19" tabindex="-1"></a><span class="at">              </span><span class="kw">-</span><span class="at"> </span><span class="fu">$get_property</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> SELF</span><span class="kw">,</span><span class="at"> minimum_instances </span><span class="kw">]</span></span>
<span id="cb156-20"><a aria-hidden="true" href="#cb156-20" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">$less_or_equal</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb156-21"><a aria-hidden="true" href="#cb156-21" tabindex="-1"></a><span class="at">              </span><span class="kw">-</span><span class="at"> $value</span></span>
<span id="cb156-22"><a aria-hidden="true" href="#cb156-22" tabindex="-1"></a><span class="at">              </span><span class="kw">-</span><span class="at"> </span><span class="fu">$get_property</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> SELF</span><span class="kw">,</span><span class="at"> maximum_instances </span><span class="kw">]</span></span>
<span id="cb156-23"><a aria-hidden="true" href="#cb156-23" tabindex="-1"></a><span class="at">        </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span></code></pre></div>
<hr/>
<h1 id="tosca-functions">10 TOSCA Functions</h1>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative. 
## 10.1 Function Syntax</p>
<p>TOSCA supports the use of functions for providing dynamic service
data 
values at runtime. The syntax of a function has two representations:</p>
<ul>
<li><p>Any function can be represented by a YAML map with a single
key, 
where the key is a string starting with a <code>$</code> (dollar
sign) 
character and where the remainder of the string represents the 
function name. If present, the value in the key-value pair 
represents the function arguments.</p></li>
<li><p>A function without arguments can alternatively be represented by
a 
YAML string value, where the string starts with a <code>$</code> (dollar
sign) 
character and where the remainder of the string represents the 
function name. This representation cannot be used in map keys.</p></li>
<li><p>Function names may not contain the <code>$</code> character as it
will 
conflict with the escape mechanisms described below.</p></li>
</ul>
<p>Therefore, any string starting with a <code>$</code> (dollar sign)
character 
will be interpreted as a function call. To allow for strings
starting 
with <code>\$</code> character to be specified, the <code>$</code>
character at the start of 
the string needs to be escaped by using <code>$$</code>(two dollar
signs) 
characters instead. For example:</p>
<ul>
<li><p><code>$$name</code> will represent the literal string
<code>$name</code></p></li>
<li><p><code>$$$item</code> will represent the literal string
<code>$$item</code>, as only 
the first <code>$</code> character is escaped.</p></li>
</ul>
<p>As we could have function calls that return values to be used as keys
in 
a map, hypothetically it is possible that we use the same function
call 
as a YAML key more than once. Because YAML does not allow for
duplicate 
map keys, in such cases we must allow for key variation. This is 
achieved by adding suffixes after the function name starting with
a 
second $ character. For example, the following is a valid map where
the 
function “keygen” is called three times and the returned values are
used 
as keys in the hint map:</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb157-1"><a aria-hidden="true" href="#cb157-1" tabindex="-1"></a><span class="fu">hint</span><span class="kw">:</span></span>
<span id="cb157-2"><a aria-hidden="true" href="#cb157-2" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at"> </span><span class="fu">$keygen</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> UUID </span><span class="kw">]</span><span class="at"> </span><span class="kw">}:</span><span class="at"> </span><span class="dv">34</span></span>
<span id="cb157-3"><a aria-hidden="true" href="#cb157-3" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at"> </span><span class="fu">$keygen$1</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> UUID </span><span class="kw">]</span><span class="at"> </span><span class="kw">}:</span><span class="at"> </span><span class="dv">56</span></span>
<span id="cb157-4"><a aria-hidden="true" href="#cb157-4" tabindex="-1"></a><span class="at">  </span><span class="kw">{</span><span class="at"> </span><span class="fu">$keygen$2</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> UUID </span><span class="kw">]</span><span class="at"> </span><span class="kw">}:</span><span class="at"> </span><span class="dv">78</span></span></code></pre></div>
<p>TOSCA functions may be used wherever a value is expected, such
as:</p>
<ul>
<li><p>a value for a TOSCA keyname</p></li>
<li><p>a value for a parameter or property or attribute, including a
value 
within a complex datatype</p></li>
<li><p>a value for the arguments of another function</p></li>
<li><p>other places such as in validation clauses, conditions,
etc.</p></li>
</ul>
<p>TOSCA parsers are expected to evaluate function values at runtime
based 
on the provided function arguments.</p>
<p>The following snippet shows an example of a node template that uses
a 
function to retrieve a security context at runtime:</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb158-1"><a aria-hidden="true" href="#cb158-1" tabindex="-1"></a><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb158-2"><a aria-hidden="true" href="#cb158-2" tabindex="-1"></a><span class="at">  </span><span class="fu">context</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_security_context</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">env</span><span class="kw">:</span><span class="at"> staging</span><span class="kw">,</span><span class="at"> </span><span class="fu">role</span><span class="kw">:</span><span class="at"> admin </span><span class="kw">}</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>Nested functions are supported, that is, functions can be used in
the 
arguments of another function. The result of the internal function
will 
be passed as an argument to the outer function:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb159-1"><a aria-hidden="true" href="#cb159-1" tabindex="-1"></a><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb159-2"><a aria-hidden="true" href="#cb159-2" tabindex="-1"></a><span class="at">  </span><span class="fu">nested</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$outer_func</span><span class="kw">:</span><span class="at"> </span><span class="kw">[{</span><span class="fu">$inner_func</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">iarg1</span><span class="kw">,</span><span class="at"> iarg2</span><span class="kw">]},</span><span class="at"> oarg2</span><span class="kw">]}</span></span></code></pre></div>
<p>The following snippet shows escaped strings in a map that 
do not represent function calls:</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb160-1"><a aria-hidden="true" href="#cb160-1" tabindex="-1"></a><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb160-2"><a aria-hidden="true" href="#cb160-2" tabindex="-1"></a><span class="at">  </span><span class="fu">prop1</span><span class="kw">:</span></span>
<span id="cb160-3"><a aria-hidden="true" href="#cb160-3" tabindex="-1"></a><span class="at">   </span><span class="fu">$$myid1</span><span class="kw">:</span><span class="at"> myval1</span></span>
<span id="cb160-4"><a aria-hidden="true" href="#cb160-4" tabindex="-1"></a><span class="at">   </span><span class="fu">myid2</span><span class="kw">:</span><span class="at"> $$myval2</span></span>
<span id="cb160-5"><a aria-hidden="true" href="#cb160-5" tabindex="-1"></a><span class="at">   </span><span class="fu">$$myid3</span><span class="kw">:</span><span class="at"> $$myval3</span></span></code></pre></div>
<p>The arguments to the functions can be arbitrary TOSCA data,
although 
TOSCA defines a number of built-in functions that define 
function-specific syntax for providing arguments. In addition,
service 
designers can optionally define custom function signatures
definitions 
for function arguments and function return values as specified in 
section 5.4.15.</p>
<p>When parsing TOSCA files, TOSCA parsers MUST identify functions
wherever 
values are specified using the following algorithm:</p>
<ul>
<li><p>Does the YAML string start with <code>$</code>?</p>
<ul>
<li><p>If yes, is the second character <code>$</code>?</p>
<ul>
<li><p>If yes, discard the first <code>$</code> and stop here
(escape).</p></li>
<li><p>If no, is this a key in a YAML map?</p>
<ul>
<li><p>If yes, is this the only key in a YAML map?</p>
<ul>
<li><p>If yes, this is a function call.</p></li>
<li><p>If no, emit a parsing syntax error (“malformed
function”).</p></li>
</ul></li>
<li><p>If no, this is a function call without arguments.</p></li>
</ul></li>
</ul></li>
</ul></li>
</ul>
<h2 id="tosca-built-in-functions">10.2 TOSCA Built-In Functions</h2>
<h3 id="representation-graph-query-functions">10.2.1 Representation
Graph Query Functions</h3>
<h4 id="get_input">10.2.1.1 get_input</h4>
<p>The <em>$get_input</em> function is used to retrieve the values of
parameters 
declared within the inputs section of a TOSCA service template. It uses
the following grammars</p>
<pre><code>$get_input: &lt;input_parameter_name&gt;</code></pre>
<p>or</p>
<pre><code>$get_input: [ &lt;input_parameter_name&gt;, &lt;nested_input_parameter_name_or_index_1&gt;, ..., &lt;nested_input_parameter_name_or_index_n&gt; ]</code></pre>
<p>Note that the signature shown in the first grammar does not conform
to 
the custom function definition, but it does not have to as it is a 
TOSCA built-in function.</p>
<p>The <em>$get_input</em> function takes the arguments shown in the
following 
table:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;input_parameter_name&gt;</td>
<td>yes</td>
<td>string</td>
<td>The name of the parameter as defined in the inputs section of the
service template.</td>
</tr>
<tr class="even">
<td>&lt;nested_input_parameter_name_or_index_*&gt;</td>
<td>no</td>
<td>string | integer</td>
<td>Some TOSCA input parameters are complex (i.e., composed as nested
structures). These parameters are used to dereference into the names of
these nested structures when needed. Some parameters represent list
types. In these cases, an index may be provided to reference a specific
entry in the list (as identified by the previous parameter) to return.
The index is a non-negative integer. If <code>$get_input</code>is used
within a node template definition the function <code>$node_index</code>
can retrieve the index of the current node representation among the
nodes created from the same template, and/or if
<code>$get_input</code>is used within a requirement definition the
function <code>$relationship_index</code> can retrieve the index of the
actual relationship among the relationships created from the same
requirement. More information on multiplicity and node and relationship
indexes can be found in <a href="#14-creating-multiple-representations-from-templates">Chapter
14</a>.</td>
</tr>
</tbody>
</table>
<p>The following snippet shows an example of the simple get_input
grammar:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb163-1"><a aria-hidden="true" href="#cb163-1" tabindex="-1"></a><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb163-2"><a aria-hidden="true" href="#cb163-2" tabindex="-1"></a><span class="at">  </span><span class="fu">cpus</span><span class="kw">:</span></span>
<span id="cb163-3"><a aria-hidden="true" href="#cb163-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb163-4"><a aria-hidden="true" href="#cb163-4" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb163-5"><a aria-hidden="true" href="#cb163-5" tabindex="-1"></a><span class="at">  </span><span class="fu">my_server</span><span class="kw">:</span></span>
<span id="cb163-6"><a aria-hidden="true" href="#cb163-6" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> tosca.nodes.Compute</span></span>
<span id="cb163-7"><a aria-hidden="true" href="#cb163-7" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb163-8"><a aria-hidden="true" href="#cb163-8" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb163-9"><a aria-hidden="true" href="#cb163-9" tabindex="-1"></a><span class="at">        </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb163-10"><a aria-hidden="true" href="#cb163-10" tabindex="-1"></a><span class="at">          </span><span class="fu">num_cpus</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> cpus </span><span class="kw">}</span></span></code></pre></div>
<p>The following template shows an example of the nested get_input
grammar. 
The template expects two input values, each of which has a complex
data 
type. The get_input function is used to retrieve individual fields
from 
the complex input data.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb164-1"><a aria-hidden="true" href="#cb164-1" tabindex="-1"></a><span class="fu">data_types</span><span class="kw">:</span></span>
<span id="cb164-2"><a aria-hidden="true" href="#cb164-2" tabindex="-1"></a><span class="at">  </span><span class="fu">NetworkInfo</span><span class="kw">:</span></span>
<span id="cb164-3"><a aria-hidden="true" href="#cb164-3" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> tosca.Data.Root</span></span>
<span id="cb164-4"><a aria-hidden="true" href="#cb164-4" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb164-5"><a aria-hidden="true" href="#cb164-5" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span></span>
<span id="cb164-6"><a aria-hidden="true" href="#cb164-6" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb164-7"><a aria-hidden="true" href="#cb164-7" tabindex="-1"></a><span class="at">      </span><span class="fu">gateway</span><span class="kw">:</span></span>
<span id="cb164-8"><a aria-hidden="true" href="#cb164-8" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb164-9"><a aria-hidden="true" href="#cb164-9" tabindex="-1"></a><span class="at">  </span><span class="fu">RouterInfo</span><span class="kw">:</span></span>
<span id="cb164-10"><a aria-hidden="true" href="#cb164-10" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> tosca.Data.Root</span></span>
<span id="cb164-11"><a aria-hidden="true" href="#cb164-11" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb164-12"><a aria-hidden="true" href="#cb164-12" tabindex="-1"></a><span class="at">      </span><span class="fu">ip</span><span class="kw">:</span></span>
<span id="cb164-13"><a aria-hidden="true" href="#cb164-13" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb164-14"><a aria-hidden="true" href="#cb164-14" tabindex="-1"></a><span class="at">      </span><span class="fu">external</span><span class="kw">:</span></span>
<span id="cb164-15"><a aria-hidden="true" href="#cb164-15" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb164-16"><a aria-hidden="true" href="#cb164-16" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb164-17"><a aria-hidden="true" href="#cb164-17" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb164-18"><a aria-hidden="true" href="#cb164-18" tabindex="-1"></a><span class="at">    </span><span class="fu">management_network</span><span class="kw">:</span></span>
<span id="cb164-19"><a aria-hidden="true" href="#cb164-19" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> NetworkInfo</span></span>
<span id="cb164-20"><a aria-hidden="true" href="#cb164-20" tabindex="-1"></a><span class="at">    </span><span class="fu">router</span><span class="kw">:</span></span>
<span id="cb164-21"><a aria-hidden="true" href="#cb164-21" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> RouterInfo</span></span>
<span id="cb164-22"><a aria-hidden="true" href="#cb164-22" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb164-23"><a aria-hidden="true" href="#cb164-23" tabindex="-1"></a><span class="at">    </span><span class="fu">Bono_Main</span><span class="kw">:</span></span>
<span id="cb164-24"><a aria-hidden="true" href="#cb164-24" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> vRouter.Cisco</span></span>
<span id="cb164-25"><a aria-hidden="true" href="#cb164-25" tabindex="-1"></a><span class="at">      </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> substitutable </span><span class="kw">]</span></span>
<span id="cb164-26"><a aria-hidden="true" href="#cb164-26" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb164-27"><a aria-hidden="true" href="#cb164-27" tabindex="-1"></a><span class="at">        </span><span class="fu">mgmt_net_name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">management_network</span><span class="kw">,</span><span class="at"> name</span><span class="kw">]}</span></span>
<span id="cb164-28"><a aria-hidden="true" href="#cb164-28" tabindex="-1"></a><span class="at">        </span><span class="fu">mgmt_cp_v4_fixed_ip</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">router</span><span class="kw">,</span><span class="at"> ip</span><span class="kw">]}</span></span>
<span id="cb164-29"><a aria-hidden="true" href="#cb164-29" tabindex="-1"></a><span class="at">        </span><span class="fu">mgmt_cp_gateway_ip</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">management_network</span><span class="kw">,</span><span class="at"> gateway</span><span class="kw">]}</span></span>
<span id="cb164-30"><a aria-hidden="true" href="#cb164-30" tabindex="-1"></a><span class="at">        </span><span class="fu">mgmt_cp_external_ip</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">router</span><span class="kw">,</span><span class="at"> external</span><span class="kw">]}</span></span>
<span id="cb164-31"><a aria-hidden="true" href="#cb164-31" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb164-32"><a aria-hidden="true" href="#cb164-32" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">lan_port</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb164-33"><a aria-hidden="true" href="#cb164-33" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> host_with_net</span></span>
<span id="cb164-34"><a aria-hidden="true" href="#cb164-34" tabindex="-1"></a><span class="at">            </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> virtualBind</span></span>
<span id="cb164-35"><a aria-hidden="true" href="#cb164-35" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">mgmt_net</span><span class="kw">:</span><span class="at"> mgmt_net</span></span></code></pre></div>
<h4 id="get_property">10.2.1.2 get_property</h4>
<p>The <em><span class="math inline"><em>g</em><em>e</em><em>t</em><sub><em>p</em></sub><em>r</em><em>o</em><em>p</em><em>e</em><em>r</em><em>t</em><em>y</em> * <em>f</em><em>u</em><em>n</em><em>c</em><em>t</em><em>i</em><em>o</em><em>n</em><em>i</em><em>s</em><em>u</em><em>s</em><em>e</em><em>d</em><em>t</em><em>o</em><em>r</em><em>e</em><em>t</em><em>r</em><em>i</em><em>e</em><em>v</em><em>e</em><em>p</em><em>r</em><em>o</em><em>p</em><em>e</em><em>r</em><em>t</em><em>y</em><em>v</em><em>a</em><em>l</em><em>u</em><em>e</em><em>s</em><em>o</em><em>f</em><em>m</em><em>o</em><em>d</em><em>e</em><em>l</em><em>a</em><em>b</em><em>l</em><em>e</em><em>e</em><em>n</em><em>t</em><em>i</em><em>t</em><em>i</em><em>e</em><em>s</em><em>i</em><em>n</em><em>t</em><em>h</em><em>e</em><em>r</em><em>e</em><em>p</em><em>r</em><em>e</em><em>s</em><em>e</em><em>n</em><em>t</em><em>a</em><em>t</em><em>i</em><em>o</em><em>n</em><em>g</em><em>r</em><em>a</em><em>p</em><em>h</em>.<em>N</em><em>o</em><em>t</em><em>e</em><em>t</em><em>h</em><em>a</em><em>t</em><em>t</em><em>h</em><em>e</em><em>g</em><em>e</em><em>t</em><sub><em>p</em></sub><em>r</em><em>o</em><em>p</em><em>e</em><em>r</em><em>t</em><em>y</em><em>f</em><em>u</em><em>n</em><em>c</em><em>t</em><em>i</em><em>o</em><em>n</em><em>m</em><em>a</em><em>y</em><em>o</em><em>n</em><em>l</em><em>y</em><em>r</em><em>e</em><em>t</em><em>r</em><em>i</em><em>e</em><em>v</em><em>e</em><em>t</em><em>h</em><em>e</em><em>s</em><em>t</em><em>a</em><em>t</em><em>i</em><em>c</em><em>v</em><em>a</em><em>l</em><em>u</em><em>e</em><em>s</em><em>o</em><em>f</em><em>p</em><em>a</em><em>r</em><em>a</em><em>m</em><em>e</em><em>t</em><em>e</em><em>r</em><em>o</em><em>r</em><em>p</em><em>r</em><em>o</em><em>p</em><em>e</em><em>r</em><em>t</em><em>y</em><em>d</em><em>e</em><em>f</em><em>i</em><em>n</em><em>i</em><em>t</em><em>i</em><em>o</em><em>n</em><em>s</em><em>o</em><em>f</em><em>a</em><em>T</em><em>O</em><em>S</em><em>C</em><em>A</em><em>a</em><em>p</em><em>p</em><em>l</em><em>i</em><em>c</em><em>a</em><em>t</em><em>i</em><em>o</em><em>n</em><em>a</em><em>s</em><em>d</em><em>e</em><em>f</em><em>i</em><em>n</em><em>e</em><em>d</em><em>i</em><em>n</em><em>t</em><em>h</em><em>e</em><em>T</em><em>O</em><em>S</em><em>C</em><em>A</em><em>s</em><em>e</em><em>r</em><em>v</em><em>i</em><em>c</em><em>e</em><em>t</em><em>e</em><em>m</em><em>p</em><em>l</em><em>a</em><em>t</em><em>e</em>.<em>T</em><em>h</em><em>e</em>*</span>get_attribute</em>
function should be used to 
retrieve values for attribute definitions (or property definitions 
reflected as attribute definitions) from the representation graph
of 
the TOSCA application (as realized by the TOSCA orchestrator).</p>
<p>The get_property function uses the following grammar:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb165-1"><a aria-hidden="true" href="#cb165-1" tabindex="-1"></a><span class="fu">$get_property</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;tosca_path&gt;</span><span class="kw">,</span><span class="at"> &lt;property_name&gt;</span><span class="kw">,</span><span class="at"> &lt;nested_property_name_or_index_1&gt;</span><span class="kw">,</span><span class="at"> ...</span><span class="kw">,</span><span class="at"> &lt;nested_property_name_or_index_n&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>The <em>$get_property</em> function takes the arguments shown in
the 
following table:</p>
<table>
<colgroup>
<col style="width: 29%"/>
<col style="width: 41%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Mandatory</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;tosca_path&gt;</td>
<td>yes</td>
<td>Using the &lt;tosca_path&gt; we can traverse the representation
graph to extract information from a certain node or relationship. We
start from a specific node or relationship identified by its symbolic
name (or by the SELF keyword representing the node or relationship
containing the definition) and then we may further traverse the
relationships and nodes of the representation graph (using a variable
number of steps) until reaching the desired node or relationship. The
syntax is described in a later subsection.</td>
</tr>
<tr class="even">
<td>&lt;property_name&gt;</td>
<td>yes</td>
<td>The name of the property definition from which the function will
return the value.</td>
</tr>
<tr class="odd">
<td>&lt;nested_property_name_or_index_*&gt;</td>
<td>no</td>
<td>Some TOSCA properties are complex (i.e., composed as nested
structures). These parameters are used to dereference into the names of
these nested structures when needed. Some properties represent list
types. In these cases, an index may be provided to reference a specific
entry in the list (as identified by the previous parameter) to
return.</td>
</tr>
</tbody>
</table>
<p>The following example shows how to use the get_property function with
an 
actual node template name:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb166-1"><a aria-hidden="true" href="#cb166-1" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb166-2"><a aria-hidden="true" href="#cb166-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mysql_database</span><span class="kw">:</span></span>
<span id="cb166-3"><a aria-hidden="true" href="#cb166-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Database</span></span>
<span id="cb166-4"><a aria-hidden="true" href="#cb166-4" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb166-5"><a aria-hidden="true" href="#cb166-5" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> sql_database1</span></span>
<span id="cb166-6"><a aria-hidden="true" href="#cb166-6" tabindex="-1"></a><span class="at">  </span><span class="fu">wordpress</span><span class="kw">:</span></span>
<span id="cb166-7"><a aria-hidden="true" href="#cb166-7" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> WordPress</span></span>
<span id="cb166-8"><a aria-hidden="true" href="#cb166-8" tabindex="-1"></a><span class="at">    ...</span></span>
<span id="cb166-9"><a aria-hidden="true" href="#cb166-9" tabindex="-1"></a><span class="at">    </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb166-10"><a aria-hidden="true" href="#cb166-10" tabindex="-1"></a><span class="at">      </span><span class="fu">Standard</span><span class="kw">:</span></span>
<span id="cb166-11"><a aria-hidden="true" href="#cb166-11" tabindex="-1"></a><span class="at">        </span><span class="fu">configure</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb166-12"><a aria-hidden="true" href="#cb166-12" tabindex="-1"></a><span class="at">          </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb166-13"><a aria-hidden="true" href="#cb166-13" tabindex="-1"></a><span class="at">            </span><span class="fu">wp_db_name</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_property</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> mysql_database</span><span class="kw">,</span><span class="at"> name </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>The following example shows how to use the get_property
function 
traversing from the relationship to its target node:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb167-1"><a aria-hidden="true" href="#cb167-1" tabindex="-1"></a><span class="fu">relationship_templates</span><span class="kw">:</span></span>
<span id="cb167-2"><a aria-hidden="true" href="#cb167-2" tabindex="-1"></a><span class="at">    </span><span class="fu">my_connection</span><span class="kw">:</span></span>
<span id="cb167-3"><a aria-hidden="true" href="#cb167-3" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ConnectsTo</span></span>
<span id="cb167-4"><a aria-hidden="true" href="#cb167-4" tabindex="-1"></a><span class="at">      </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb167-5"><a aria-hidden="true" href="#cb167-5" tabindex="-1"></a><span class="at">        </span><span class="fu">Configure</span><span class="kw">:</span></span>
<span id="cb167-6"><a aria-hidden="true" href="#cb167-6" tabindex="-1"></a><span class="at">          </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb167-7"><a aria-hidden="true" href="#cb167-7" tabindex="-1"></a><span class="at">            </span><span class="fu">targets_value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_property</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> SELF</span><span class="kw">,</span><span class="at"> TARGET</span><span class="kw">,</span><span class="at"> value </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div>
<p>The following example shows how to use the get_property function
using 
the SELF keyword, and traversing from a wordpress node (via the
first 
relationship of the database_endpoint requirement to the target 
capability in the target node) and accessing the port property of
that 
capability:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb168-1"><a aria-hidden="true" href="#cb168-1" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span><span class="at">  </span></span>
<span id="cb168-2"><a aria-hidden="true" href="#cb168-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mysql_database</span><span class="kw">:</span></span>
<span id="cb168-3"><a aria-hidden="true" href="#cb168-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Database</span></span>
<span id="cb168-4"><a aria-hidden="true" href="#cb168-4" tabindex="-1"></a><span class="at">    ...</span></span>
<span id="cb168-5"><a aria-hidden="true" href="#cb168-5" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb168-6"><a aria-hidden="true" href="#cb168-6" tabindex="-1"></a><span class="at">      </span><span class="fu">database_endpoint</span><span class="kw">:</span></span>
<span id="cb168-7"><a aria-hidden="true" href="#cb168-7" tabindex="-1"></a><span class="at">        </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb168-8"><a aria-hidden="true" href="#cb168-8" tabindex="-1"></a><span class="at">          </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">3306</span></span>
<span id="cb168-9"><a aria-hidden="true" href="#cb168-9" tabindex="-1"></a><span class="at">  </span><span class="fu">wordpress</span><span class="kw">:</span></span>
<span id="cb168-10"><a aria-hidden="true" href="#cb168-10" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> WordPress</span></span>
<span id="cb168-11"><a aria-hidden="true" href="#cb168-11" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb168-12"><a aria-hidden="true" href="#cb168-12" tabindex="-1"></a><span class="at">      ...</span></span>
<span id="cb168-13"><a aria-hidden="true" href="#cb168-13" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">database_endpoint</span><span class="kw">:</span><span class="at"> mysql_database</span></span>
<span id="cb168-14"><a aria-hidden="true" href="#cb168-14" tabindex="-1"></a><span class="at">    </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb168-15"><a aria-hidden="true" href="#cb168-15" tabindex="-1"></a><span class="at">      </span><span class="fu">Standard</span><span class="kw">:</span></span>
<span id="cb168-16"><a aria-hidden="true" href="#cb168-16" tabindex="-1"></a><span class="at">        </span><span class="fu">create</span><span class="kw">:</span><span class="at"> wordpress_install.sh</span></span>
<span id="cb168-17"><a aria-hidden="true" href="#cb168-17" tabindex="-1"></a><span class="at">        </span><span class="fu">configure</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb168-18"><a aria-hidden="true" href="#cb168-18" tabindex="-1"></a><span class="at">          </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> wordpress_configure.sh            </span></span>
<span id="cb168-19"><a aria-hidden="true" href="#cb168-19" tabindex="-1"></a><span class="at">          </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb168-20"><a aria-hidden="true" href="#cb168-20" tabindex="-1"></a><span class="at">            ...</span></span>
<span id="cb168-21"><a aria-hidden="true" href="#cb168-21" tabindex="-1"></a><span class="at">            </span><span class="fu">wp_db_port</span><span class="kw">:</span></span>
<span id="cb168-22"><a aria-hidden="true" href="#cb168-22" tabindex="-1"></a><span class="at">              </span><span class="fu">$get_property</span><span class="kw">:</span></span>
<span id="cb168-23"><a aria-hidden="true" href="#cb168-23" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> SELF</span></span>
<span id="cb168-24"><a aria-hidden="true" href="#cb168-24" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> RELATIONSHIP</span></span>
<span id="cb168-25"><a aria-hidden="true" href="#cb168-25" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> database_endpoint</span></span>
<span id="cb168-26"><a aria-hidden="true" href="#cb168-26" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb168-27"><a aria-hidden="true" href="#cb168-27" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> CAPABILITY</span></span>
<span id="cb168-28"><a aria-hidden="true" href="#cb168-28" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> port</span></span></code></pre></div>
<p>The following example shows how to use the get_property function
to 
traverse over two requirement relationships, from the wordpress node
to 
its database node and further to its DBMS host to get its 
admin_credential property:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb169-1"><a aria-hidden="true" href="#cb169-1" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span><span class="at">  </span></span>
<span id="cb169-2"><a aria-hidden="true" href="#cb169-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mysql_database</span><span class="kw">:</span></span>
<span id="cb169-3"><a aria-hidden="true" href="#cb169-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Database</span></span>
<span id="cb169-4"><a aria-hidden="true" href="#cb169-4" tabindex="-1"></a><span class="at">    ...</span></span>
<span id="cb169-5"><a aria-hidden="true" href="#cb169-5" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb169-6"><a aria-hidden="true" href="#cb169-6" tabindex="-1"></a><span class="at">      </span><span class="fu">database_endpoint</span><span class="kw">:</span></span>
<span id="cb169-7"><a aria-hidden="true" href="#cb169-7" tabindex="-1"></a><span class="at">        </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb169-8"><a aria-hidden="true" href="#cb169-8" tabindex="-1"></a><span class="at">          </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">3306</span></span>
<span id="cb169-9"><a aria-hidden="true" href="#cb169-9" tabindex="-1"></a><span class="at">  </span><span class="fu">wordpress</span><span class="kw">:</span></span>
<span id="cb169-10"><a aria-hidden="true" href="#cb169-10" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> WordPress</span></span>
<span id="cb169-11"><a aria-hidden="true" href="#cb169-11" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb169-12"><a aria-hidden="true" href="#cb169-12" tabindex="-1"></a><span class="at">      ...</span></span>
<span id="cb169-13"><a aria-hidden="true" href="#cb169-13" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">database_endpoint</span><span class="kw">:</span><span class="at"> mysql_database</span></span>
<span id="cb169-14"><a aria-hidden="true" href="#cb169-14" tabindex="-1"></a><span class="at">    </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb169-15"><a aria-hidden="true" href="#cb169-15" tabindex="-1"></a><span class="at">      </span><span class="fu">Standard</span><span class="kw">:</span></span>
<span id="cb169-16"><a aria-hidden="true" href="#cb169-16" tabindex="-1"></a><span class="at">        </span><span class="fu">create</span><span class="kw">:</span><span class="at"> wordpress_install.sh</span></span>
<span id="cb169-17"><a aria-hidden="true" href="#cb169-17" tabindex="-1"></a><span class="at">        </span><span class="fu">configure</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb169-18"><a aria-hidden="true" href="#cb169-18" tabindex="-1"></a><span class="at">          </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> wordpress_configure.sh            </span></span>
<span id="cb169-19"><a aria-hidden="true" href="#cb169-19" tabindex="-1"></a><span class="at">          </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb169-20"><a aria-hidden="true" href="#cb169-20" tabindex="-1"></a><span class="at">            ...</span></span>
<span id="cb169-21"><a aria-hidden="true" href="#cb169-21" tabindex="-1"></a><span class="at">            </span><span class="fu">host_dbms_admin_credential</span><span class="kw">:</span></span>
<span id="cb169-22"><a aria-hidden="true" href="#cb169-22" tabindex="-1"></a><span class="at">              </span><span class="fu">$get_property</span><span class="kw">:</span></span>
<span id="cb169-23"><a aria-hidden="true" href="#cb169-23" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> SELF</span></span>
<span id="cb169-24"><a aria-hidden="true" href="#cb169-24" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> RELATIONSHIP</span></span>
<span id="cb169-25"><a aria-hidden="true" href="#cb169-25" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> database_endpoint</span></span>
<span id="cb169-26"><a aria-hidden="true" href="#cb169-26" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> TARGET</span></span>
<span id="cb169-27"><a aria-hidden="true" href="#cb169-27" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> RELATIONSHIP</span></span>
<span id="cb169-28"><a aria-hidden="true" href="#cb169-28" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> host</span></span>
<span id="cb169-29"><a aria-hidden="true" href="#cb169-29" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> TARGET</span></span>
<span id="cb169-30"><a aria-hidden="true" href="#cb169-30" tabindex="-1"></a><span class="at">               </span><span class="kw">-</span><span class="at"> admin_credential</span></span></code></pre></div>
<blockquote>
<p>TODO: An example of second index (i.e. 1) and index ALL !!!</p>
</blockquote>
<h4 id="get_attribute">10.2.1.3 get_attribute</h4>
<p>The <strong>get_attribute</strong> function is used within a
representation graph to 
obtain attribute values from nodes and relationships that have
been 
created from an application model described in a service template.
The 
nodes or relationships can be referenced by their name as assigned
in 
the service template or relative to the context where they are
being 
invoked.</p>
<p>The get_attribute function uses the following grammar:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb170-1"><a aria-hidden="true" href="#cb170-1" tabindex="-1"></a><span class="fu">$get_attribute</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">&lt;tosca_path</span><span class="kw">,</span><span class="at"> &lt;attribute_name&gt;</span><span class="kw">,</span><span class="at"> &lt;nested_attribute_name_or_index_1&gt;</span><span class="kw">,</span><span class="at"> ...</span><span class="kw">,</span><span class="at"> &lt;nested_attribute_name_or_index_n&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>The <em>$get_attribute</em> function takes the arguments shown in
the 
following table:</p>
<table>
<colgroup>
<col style="width: 29%"/>
<col style="width: 41%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Mandatory</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;tosca_path&gt;</td>
<td>yes</td>
<td>Using the &lt;tosca_path&gt; we can traverse the representation
graph to extract information from a certain node or relationship. The
syntax is described in a later subsection.</td>
</tr>
<tr class="even">
<td>&lt;attribute_name&gt;</td>
<td>yes</td>
<td>The name of the attribute definition the function will return the
value from.</td>
</tr>
<tr class="odd">
<td>&lt;nested_attribute_name_or_index_*&gt;</td>
<td>no</td>
<td>Some TOSCA attributes are complex (i.e., composed as nested
structures). These parameters are used to dereference into the names of
these nested structures when needed. Some attributes represent list
types. In these cases, an index may be provided to reference a specific
entry in the list (as identified by the previous parameter) to
return.</td>
</tr>
</tbody>
</table>
<p>The <span class="math inline"><em>g</em><em>e</em><em>t</em><sub><em>a</em></sub><em>t</em><em>t</em><em>r</em><em>i</em><em>b</em><em>u</em><em>t</em><em>e</em><em>f</em><em>u</em><em>n</em><em>c</em><em>t</em><em>i</em><em>o</em><em>n</em><em>i</em><em>s</em><em>u</em><em>s</em><em>e</em><em>d</em><em>i</em><em>n</em><em>t</em><em>h</em><em>e</em><em>s</em><em>a</em><em>m</em><em>e</em><em>w</em><em>a</em><em>y</em><em>a</em><em>s</em><em>t</em><em>h</em><em>e</em><em>e</em><em>q</em><em>u</em><em>i</em><em>v</em><em>a</em><em>l</em><em>e</em><em>n</em><em>t</em></span>get_property
functions described above. Please see their examples and 
replace <em><span class="math inline"><em>g</em><em>e</em><em>t</em><sub><em>p</em></sub><em>r</em><em>o</em><em>p</em><em>e</em><em>r</em><em>t</em><em>y</em> * <em>w</em><em>i</em><em>t</em><em>h</em><em>t</em><em>h</em><em>e</em>*</span>get_attribute</em>
function name.</p>
<h4 id="get_artifact">10.2.1.4 get_artifact</h4>
<p>The <em>$get_artifact</em> function is used to retrieve the location
of 
artifacts defined by modelable entities in a service template. It
uses 
the following grammar:</p>
<pre><code>$get_artifact: [ &lt;tosca_path, &lt;artifact_name&gt; ]</code></pre>
<p>The <em>$get_artifact</em> function takes the arguments shown in
the 
following table:</p>
<table>
<colgroup>
<col style="width: 22%"/>
<col style="width: 31%"/>
<col style="width: 22%"/>
<col style="width: 22%"/>
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;tosca_path&gt;</td>
<td>yes</td>
<td>string</td>
<td>Using the &lt;tosca_path a TOSCA processor can traverse the
representation graph to the node that contains the artifact. The syntax
is described in a later subsection.</td>
</tr>
<tr class="even">
<td>&lt;artifact_name&gt;</td>
<td>yes</td>
<td>string</td>
<td>The name of the artifact definition for which the function will
return the location.</td>
</tr>
</tbody>
</table>
<p>The following example uses a snippet of a WordPress 
[<a href="#CIT_WORDPRESS">WordPress</a>] web application to show how to
use the 
get_artifact function with an actual node template name:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb172-1"><a aria-hidden="true" href="#cb172-1" tabindex="-1"></a><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb172-2"><a aria-hidden="true" href="#cb172-2" tabindex="-1"></a><span class="at">  </span><span class="fu">wordpress</span><span class="kw">:</span></span>
<span id="cb172-3"><a aria-hidden="true" href="#cb172-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> WordPress</span></span>
<span id="cb172-4"><a aria-hidden="true" href="#cb172-4" tabindex="-1"></a><span class="at">    ...</span></span>
<span id="cb172-5"><a aria-hidden="true" href="#cb172-5" tabindex="-1"></a><span class="at">    </span><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb172-6"><a aria-hidden="true" href="#cb172-6" tabindex="-1"></a><span class="at">      </span><span class="fu">Standard</span><span class="kw">:</span></span>
<span id="cb172-7"><a aria-hidden="true" href="#cb172-7" tabindex="-1"></a><span class="at">        </span><span class="fu">configure</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb172-8"><a aria-hidden="true" href="#cb172-8" tabindex="-1"></a><span class="at">          </span><span class="fu">create</span><span class="kw">:</span></span>
<span id="cb172-9"><a aria-hidden="true" href="#cb172-9" tabindex="-1"></a><span class="at">            </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> wordpress_install.sh</span></span>
<span id="cb172-10"><a aria-hidden="true" href="#cb172-10" tabindex="-1"></a><span class="at">            inputs</span></span>
<span id="cb172-11"><a aria-hidden="true" href="#cb172-11" tabindex="-1"></a><span class="at">              </span><span class="fu">wp_zip</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_artifact</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> SELF</span><span class="kw">,</span><span class="at"> zip </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb172-12"><a aria-hidden="true" href="#cb172-12" tabindex="-1"></a><span class="at">    </span><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb172-13"><a aria-hidden="true" href="#cb172-13" tabindex="-1"></a><span class="at">      </span><span class="fu">zip</span><span class="kw">:</span><span class="at"> /data/wordpress.zip</span></span></code></pre></div>
<p>In such implementation the TOSCA orchestrator may provide the 
wordpress.zip archive as</p>
<ul>
<li><p>a local URL (example: 
<a href="file:///\home\user\wordpress.zip">file://home/user/wordpress.zip</a>) 
or</p></li>
<li><p>a remote one (example: <a class="uri" href="http://cloudrepo:80/files/wordpress.zip">http://cloudrepo:80/files/wordpress.zip</a>) <br/> 
where some orchestrator may indeed provide some global artifact 
repository management features.</p></li>
</ul>
<h4 id="value">10.2.1.5 value</h4>
<p>This function is used as an argument inside validation functions.
It 
returns the value of the property, attribute, or parameter for which
the 
validation clause is defined. The *<span class="math inline">$value*
function uses the following grammar:
```yaml$</span>value: [<nested_value_name_or_index>, … ]</nested_value_name_or_index></p>
<pre><code>It takes the arguments shown in the following table:

|Argument|Mandatory|Description|
| ----- | ------- | ----- | 
|&lt;nested_value_name_or_index\&gt; |no|Some TOSCA data are complex (i.e., composed as nested structures).  These parameters are used to dereference into the names of these nested structures when needed.    Some data represent lists. In these cases, an index may be provided to reference a specific entry in the list (as identified by the previous parameter) to return. |

#### 10.2.1.6 node_index

This function is used to return the runtime index of the current node 
representation in the list of node representations created from the same 
node template. The first index is 0, which is also what *$* 
will return when a single node representation is created from a node 
template (i.e. where the default count is 1). The function should not
be used outside a valid node context. The *$* function 
uses the following grammar:
```yaml
$node_index</code></pre>
<h4 id="relationship_index">10.2.1.7 relationship_index</h4>
<p>This function is used to return the runtime index of the current
relationship 
in the list of relationships created from the same requirement. The
first 
index is 0. The function should not be used outside a valid
relationship 
context (i.e. a relationship type definitiom, or a requirement
definition 
or assignment). The *<span class="math inline">$relationship_index*
function uses the following grammar:
```yaml$</span>relationship_index</p>
<pre><code>
#### 10.2.1.8 available_allocation

The *$available_allocation* function is used to retrieve the available
allocation for capablity properties that can be target to an allocation
semantic when a relationship is established to the capability.
The main intended usage is to use this function within the conditon clause
in a *node_filter* of a node with a *select* directive; this allows to 
accept only nodes that have a certain available capacity that for 
example can accomodate the expected allocations when used as a target
for a relationship. The *$available_allocation* function uses the following 
grammar:
```yaml
$available_allocation: [ &lt;tosca_path&gt;, &lt;property_name&gt; ]</code></pre>
<p>The <em>$available_allocation</em> function takes the arguments shown
in the 
following table:</p>
<table>
<colgroup>
<col style="width: 29%"/>
<col style="width: 41%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Mandatory</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;tosca_path&gt;</td>
<td>yes</td>
<td>Using the &lt;tosca_path&gt; we can traverse the representation
graph to extract information from a certain node or relationship. In
this case the &lt;tosca_path&gt; must lead to a capability context.</td>
</tr>
<tr class="even">
<td>&lt;property_name&gt;</td>
<td>yes</td>
<td>The name of the capability property definition from which the
function will return the value. In this case it must be a allocatable
property (i.e. of integer, float, or scalar property types).</td>
</tr>
</tbody>
</table>
<p>Usage example:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb175-1"><a aria-hidden="true" href="#cb175-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb175-2"><a aria-hidden="true" href="#cb175-2" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb175-3"><a aria-hidden="true" href="#cb175-3" tabindex="-1"></a><span class="at">    </span><span class="fu">my_node_template</span><span class="kw">:</span></span>
<span id="cb175-4"><a aria-hidden="true" href="#cb175-4" tabindex="-1"></a><span class="at">      </span><span class="fu">directive</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">select</span><span class="kw">]</span></span>
<span id="cb175-5"><a aria-hidden="true" href="#cb175-5" tabindex="-1"></a><span class="at">      </span><span class="fu">node_filter</span><span class="kw">:</span></span>
<span id="cb175-6"><a aria-hidden="true" href="#cb175-6" tabindex="-1"></a><span class="at">        </span><span class="fu">$and</span><span class="kw">:</span></span>
<span id="cb175-7"><a aria-hidden="true" href="#cb175-7" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span></span>
<span id="cb175-8"><a aria-hidden="true" href="#cb175-8" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">$available_allocation</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> SELF</span><span class="kw">,</span><span class="at"> CAPABILITY</span><span class="kw">,</span><span class="at"> host</span><span class="kw">,</span><span class="at"> num_cpus </span><span class="kw">]</span></span>
<span id="cb175-9"><a aria-hidden="true" href="#cb175-9" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb175-10"><a aria-hidden="true" href="#cb175-10" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span></span>
<span id="cb175-11"><a aria-hidden="true" href="#cb175-11" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> </span><span class="fu">$available_allocation</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> SELF</span><span class="kw">,</span><span class="at"> CAPABILITY</span><span class="kw">,</span><span class="at"> host</span><span class="kw">,</span><span class="at"> mem_size </span><span class="kw">]</span></span>
<span id="cb175-12"><a aria-hidden="true" href="#cb175-12" tabindex="-1"></a><span class="at">            </span><span class="kw">-</span><span class="at"> 256 MB</span></span></code></pre></div>
<h3 id="boolean-functions">10.2.2 Boolean Functions</h3>
<p>TOSCA includes a number of functions that return Boolean values.
These 
functions are used in validation expressions and in condition clauses
in 
workflow definitions and policy definitions. They are also used as
node 
filters in requirement definitions and requirement templates and
as 
substitution filters in substitution mappings.</p>
<h4 id="boolean-logic-functions">10.2.2.1 Boolean Logic Functions</h4>
<h5 id="and">10.2.2.1.1 and</h5>
<p>The <em>$and</em> function takes two or more Boolean arguments. It
evaluates to 
true if all its arguments evaluate to true. It evaluates to false in
all 
other cases. The <span class="math inline">$and function uses the
following grammar:
```yaml$</span>and: [ <boolean_arg1>, <boolean_arg2>, …
<boolean_argn>]</boolean_argn></boolean_arg2></boolean_arg1></p>
<pre><code>Note that the evaluation of the arguments in the $and function may stop
as soon as a false argument is encountered, and the function may return
immediately without evaluating the rest of the arguments.

##### 10.2.2.1.2 or

The *$or* function takes two or more Boolean arguments. It evaluates to
false if all of its arguments evaluate to false. It evaluates to true in
all other cases. The $or function uses the following grammar:
```yaml
$or: [ &lt;boolean_arg1&gt;, &lt;boolean_arg2&gt;, ... &lt;boolean_argn&gt;]</code></pre>
<p>Note that the evaluation of the arguments in the $or function may
stop 
as soon as a true argument is encountered, and the function may
return 
immediately without evaluating the rest of the arguments.</p>
<h5 id="not">10.2.2.1.3 not</h5>
<p>The <em>$not</em> function takes one Boolean argument. It evaluates
to true if 
its argument evaluates to false and evaluates to false if its
argument 
evaluates to true. The <span class="math inline">$not function uses the
following grammar:
```yaml$</span>not: [ <boolean_arg> ]</boolean_arg></p>
<pre><code>##### 10.2.2.1.4 xor

The *$xor* function takes two Boolean arguments. It evaluates to false
if both arguments either evaluate to true or both arguments evaluate
to false, and evaluates to true otherwise. The $xor function uses the
following grammar:
```yaml
$xor: [ &lt;boolean_arg1&gt;, &lt;boolean_arg2&gt; ]</code></pre>
<h4 id="comparison-functions">10.2.2.2 Comparison Functions</h4>
<p>This section documents the list of built-in comparison functions.</p>
<ul>
<li><p>Note that some implementations may fail the evaluation if
the 
arguments are not of the same type.</p></li>
<li><p>Also note that Unicode string comparisons are implementation
specific.</p></li>
<li><p>TODO explanation on how versions are compared</p></li>
</ul>
<!----
{"id": "807", "author": "Chris Lauwers", "date": "2020-08-18T23:01:00Z", "comment": "(From Tal): Do we want the comparison constraints to work for strings? E.g. should \"greater_than\" do a sorting-based comparison? I'll just point that it is non-trivial to sort Unicode strings. The most common way is to use the Unicode Collation Algorithm, which involves a database of information. There is a reference implementation in [ICU](webSettings.xml). Good and proper Unicode libraries will support it (e.g. [here is Go's](footnotes.xml)), but I do imagine it may be a burden for some implementations. I suggest we discuss this in the ad hoc and consider the pros and cons.", "target": "Notes"}-->
<h5 id="equal">10.2.2.2.1 equal</h5>
<p>The <em>$equal</em> function takes two arguments that have the same
type. It 
evaluates to true if the arguments are equal. An <span class="math inline"><em>e</em><em>q</em><em>u</em><em>a</em><em>l</em><em>f</em><em>u</em><em>n</em><em>c</em><em>t</em><em>i</em><em>o</em><em>n</em><em>t</em><em>h</em><em>a</em><em>t</em><em>u</em><em>s</em><em>e</em><em>s</em><em>a</em><em>r</em><em>g</em><em>u</em><em>m</em><em>e</em><em>n</em><em>t</em><em>s</em><em>o</em><em>f</em><em>d</em><em>i</em><em>f</em><em>f</em><em>e</em><em>r</em><em>e</em><em>n</em><em>t</em><em>t</em><em>y</em><em>p</em><em>e</em><em>s</em><em>S</em><em>H</em><em>O</em><em>U</em><em>L</em><em>D</em><em>b</em><em>e</em><em>f</em><em>l</em><em>a</em><em>g</em><em>g</em><em>e</em><em>d</em><em>a</em><em>s</em><em>a</em><em>n</em><em>e</em><em>r</em><em>r</em><em>o</em><em>r</em>.<em>T</em><em>h</em><em>e</em></span>equal
function uses the following grammar:</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb178-1"><a aria-hidden="true" href="#cb178-1" tabindex="-1"></a><span class="fu">$equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;any_type_arg1&gt;</span><span class="kw">,</span><span class="at"> &lt;any_type_arg2&gt; </span><span class="kw">]</span></span></code></pre></div>
<h5 id="greater_than">10.2.2.2.2 greater_than</h5>
<p>The <em>$greater_than</em> function takes two arguments of integer,
float, 
string, timestamp, version, any scalar type, or their derivations.
It 
evaluates to true if both arguments are of the same type, and if
the 
first argument is greater than the second argument and evaluates
to 
false otherwise. The <span class="math inline">$greater_than function
uses the following
grammar:
```yaml$</span>greater_than: [ <comparable_type_arg1>,
<comparable_type_arg2> ]</comparable_type_arg2></comparable_type_arg1></p>
<pre><code>##### 10.2.2.2.3  greater_or_equal

The *$greater_or_equal* function takes two arguments of integer,
float, string, timestamp, version, any scalar type, or their
derivations. It evaluates to true if both arguments are of the same
type, and if the first argument is greater than or equal to the second
argument and evaluates to false otherwise. The $greater_or_equal
function uses the following grammar:
```yaml
$greater_or_equal: [ &lt;comparable_type_arg1&gt;, &lt;comparable_type_arg2&gt; ]</code></pre>
<h5 id="less_than">10.2.2.2.4 less_than</h5>
<p>The <em>$less_than</em> function takes two arguments of integer,
float, 
string, timestamp, version, any scalar type, or their derivations.
It 
evaluates to true if both arguments are of the same type, and if
the 
first argument is less than the second argument and evaluates to
false 
otherwise. The <span class="math inline">$less_than function uses the
following grammar:
```yaml$</span>less_than: [ <comparable_type_arg1>,
<comparable_type_arg2> ]</comparable_type_arg2></comparable_type_arg1></p>
<pre><code>##### 10.2.2.2.5 less_or_equal

The *$less_or_equal* function takes two arguments of integer, float,
string, timestamp, version, any scalar type, or their derivations. It
evaluates to true if both arguments are of the same type, and if the
first argument is less than or equal to the second argument and
evaluates to false otherwise. The $less_or_equal function uses the
following grammar:
```yaml
$less_or_equal: [ &lt;comparable_type_arg1&gt;, &lt;comparable_type_arg2&gt; ]</code></pre>
<h5 id="valid_values">10.2.2.2.6 valid_values</h5>
<p>The <em>$valid_values</em> function takes two arguments. The first
argument 
is of any type and the second argument is a list with any number
of 
values of the same type as the first argument. It evaluates to true
if 
the first argument is equal to a value in the second argument list
and 
false otherwise. The <span class="math inline">$valid_values function
uses the following
grammar:
```yaml$</span>valid_values: [ <any_type_arg1>, <any_type_list_arg2>
]</any_type_list_arg2></any_type_arg1></p>
<pre><code>
Note that the $valid_values function is equivalent to the $has_entry
function, except with reversed arguments.

##### 10.2.2.2.7 matches

The *$matches* function takes two arguments. The first argument is a
general string, and the second argument is a string that encodes a
regular expression pattern. It evaluates to true if the first argument
matches the regular expression pattern represented by the second
argument and false otherwise. The $matches function uses the following
grammar:
```yaml
$matches: [ &lt;string_type_arg1&gt;, &lt;regex_pattern_arg2&gt; ]</code></pre>
<p>Future drafts of this specification will detail the use of
regular 
expressions and reference an appropriate standardized grammar.</p>
<p>Note also that if ones means that the whole string is to be matched,
the 
regular expression must start with a caret ^ and end with a $.</p>
<blockquote>
<p>Check for new lines and maybe add a third argument – e.g. as in <a class="uri" href="https://www.pcre.org/">https://www.pcre.org/</a> !!! <br/></p>
</blockquote>
<h4 id="boolean-list-map-and-string-functions">10.2.2.3 Boolean List,
Map and String Functions</h4>
<h5 id="has_suffix">10.2.2.3.1 has_suffix</h5>
<p>The <em>$has_suffix</em> function takes two arguments. Both arguments
are 
either of type string or of type list. It evaluates to true if the 
second argument is a suffix of the first argument. For lists this 
means that the values of the second list are the last values of
the 
first list in the same order. The <span class="math inline">$has_suffix
function uses the
following grammar:
```yaml$</span>has_suffix: [ <string_or_list_type_arg1>,
<string_or_list_type_arg2> ]</string_or_list_type_arg2></string_or_list_type_arg1></p>
<pre><code>##### 10.2.2.3.2 has_prefix

The *$has_prefix* function takes two arguments. Both arguments are
either of type string or of tpe list. It evaluates to true if the
second argument is a prefix of the first argument. For lists this
means that the values of the second list are the first values of the
first list in the same order. The $has_prefix function uses the
following grammar:
```yaml
$has_prefix: [ &lt;string_or_list_type_arg1&gt;, &lt;string_or_list_type_arg2&gt; ]</code></pre>
<h5 id="contains">10.2.2.3.3 contains</h5>
<p>The <em>$contains</em> function takes two arguments. Both arguments
are 
either of type string or of type list. It evaluates to true if the 
second argument is contained in the first argument. For strings
that 
means that the second argument is a substring of the first 
argument. For lists this means that the values of the second list
are 
contained in the first list in an uninterrupted sequence and in
the 
same order. The <span class="math inline">$contains function uses the
following grammar:
```yaml$</span>contains: [ <string_or_list_type_arg1>,
<string_or_list_type_arg2> ]</string_or_list_type_arg2></string_or_list_type_arg1></p>
<pre><code>##### 10.2.2.3.4 has_entry

The *$has_entry* function takes two arguments. The first argument is a
list or a map.  The second argument is of the type matching the
entry_schema of the first argument. It evaluates to true if the second
argument is an entry in the first argument. For lists this means that
the second argument is a value in the first argument list. For maps
this means that the second argument is a value in any of the key-value
pairs in the first argument map. The $has_entry function uses the
following grammar:
```yaml
$has_entry: [ &lt;list_or_map_type_arg1&gt;, &lt;any_type_arg2&gt; ]</code></pre>
<h5 id="has_key">10.2.2.3.5 has_key</h5>
<p>The <em>$has_key</em> function takes two arguments. The first
argument is a 
map. The second argument is of the type matching the key_schema of
the 
first argument. It evaluates to true if the second argument is a
key 
in any of the key-value pairs in the first argument map. The <span class="math inline">$has_key
function uses the following grammar:
```yaml$</span>has_key: [ <map_type_arg1>, <any_type_arg2> ]</any_type_arg2></map_type_arg1></p>
<pre><code>##### 10.2.2.3.6 has_all_entries

The *$has_all_entries* function takes two arguments. The first
argument is a list or a map.  The second argument is a list with the
entry_schema matching the entry_schema of the first argument. It
evaluates to true if for all entries in the second argument there is
an equal value entry in the first argument. The $has_all_entries
function uses the following grammar:
```yaml
$has_all_entries: [ &lt;list_or_map_type_arg1&gt;, &lt;list_type_arg2&gt; ]</code></pre>
<h5 id="has_all_keys">10.2.2.3.7 has_all_keys</h5>
<p>The <em>$has_all_keys</em> function takes two arguments. The first
argument 
is a map. The second argument is a list with the entry_schema
matching 
the key_schema of the first argument. It evaluates to true if for
all 
entries in the second argument there is an equal value key in the 
first argument. The <span class="math inline">$has_all_keys function
uses the following grammar:
```yaml$</span>has_all_keys: [ <map_type_arg1>, <list_type_arg2> ]</list_type_arg2></map_type_arg1></p>
<pre><code>##### 10.2.2.3.8 has_any_entry

The *$has_any_entry* function takes two arguments. The first argument
is a list or a map.  The second argument is a list with the
entry_schema matching the entry_schema of the first argument. It
evaluates to true if there is an entry in the second argument that is
equal to an entry in the first argument. The $has_any_entry function
uses the following grammar:
```yaml
$has_any_entry: [ &lt;list_or_map_type_arg1&gt;, &lt;list_type_arg2&gt; ]</code></pre>
<h5 id="has_any_key">10.2.2.3.9 has_any_key</h5>
<p>The <em>$has_any_key</em> function takes two arguments. The first
argument is 
a map. The second argument is a list with the entry_schema
matching 
the key_schema of the first argument. It evaluates to true if there
is 
an entry in the second argument which is equal to a key in the
first 
argument. The <span class="math inline">$has_any_key function uses the
following grammar:
```yaml$</span>has_any_key: [ <map_type_arg1>, <list_type_arg2> ]</list_type_arg2></map_type_arg1></p>
<pre><code>### 10.2.3 String, List, and Map Functions

#### 10.2.3.1 length

The *$length* function takes an argument of type string, list, or
map. It returns the number of nicode characters in the string, or the
numbers of values in the list, or the number of key-values pairs in
the map. The $length function uses the following grammar:
```yaml
$length: [ &lt;string_list_or_map_type_arg&gt; ]</code></pre>
<h4 id="concat">10.2.3.2 concat</h4>
<p>The <em>$concat</em> function takes one or more arguments of either
the type 
string or the type list with the same type of their entry_schema.
In 
the case of strings, it returns a string which is the concatenation
of 
the argument strings. In the case of lists, it returns a list that 
contains all the entries of all the argument lists. Order is
preserved 
both for strings and lists. This function does not recurse into
the 
entries of the lists. The <span class="math inline">$concat function
uses the following grammar:
```yaml$</span>concat: [<string_or_list_type_arg1>, … ]</string_or_list_type_arg1></p>
<pre><code>The following code snippet shows an example of a $concat function:</code></pre>
<p>outputs: 
description: Concatenate the URL for a server from other template
values 
server_url: value: { $concat: [ ‘<a class="uri" href="http://">http://</a>’, <br/> 
$get_attribute: [ server, public_address ], 
‘:’, 
$get_attribute: [ server, port ] ] }</p>
<pre><code>#### 10.2.3.3 join

The *$join* function takes either one or two arguments where the first
one is of type list of strings and the second (optional) argument is
of type string. It returns a string that is the joining of the entries
in the first argument while adding an optional delimiter between the
strings. The $join function uses the following grammar:
```yaml
$join: [&lt;list_of_strings&gt; ]
$join: [&lt;list of strings&gt;, &lt;delimiter&gt; ]</code></pre>
<p>It takes the arguments shown in the following table:</p>
<table>
<colgroup>
<col style="width: 22%"/>
<col style="width: 31%"/>
<col style="width: 22%"/>
<col style="width: 22%"/>
</colgroup>
<thead>
<tr class="header">
<th>Argument</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;list of strings&gt;</td>
<td>yes</td>
<td>list of string or string value expressions</td>
<td>A list of one or more strings (or expressions that result in a list
of string values) which can be joined together into a single
string.</td>
</tr>
<tr class="even">
<td>&lt;delimiter&gt;</td>
<td>no</td>
<td>string</td>
<td>An optional delimiter used to join the string in the provided
list.</td>
</tr>
</tbody>
</table>
<p>The following code snippet shows example $join functions:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb189-1"><a aria-hidden="true" href="#cb189-1" tabindex="-1"></a><span class="fu">outputs</span><span class="kw">:</span></span>
<span id="cb189-2"><a aria-hidden="true" href="#cb189-2" tabindex="-1"></a><span class="at">   </span><span class="fu">example1</span><span class="kw">:</span></span>
<span id="cb189-3"><a aria-hidden="true" href="#cb189-3" tabindex="-1"></a><span class="co">       # Result: prefix_1111_suffix</span></span>
<span id="cb189-4"><a aria-hidden="true" href="#cb189-4" tabindex="-1"></a><span class="at">       </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$join</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="kw">[</span><span class="st">"prefix"</span><span class="kw">,</span><span class="at"> </span><span class="dv">1111</span><span class="kw">,</span><span class="at"> </span><span class="st">"suffix"</span><span class="at"> </span><span class="kw">],</span><span class="at"> </span><span class="st">"_"</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb189-5"><a aria-hidden="true" href="#cb189-5" tabindex="-1"></a><span class="at">   </span><span class="fu">example2</span><span class="kw">:</span></span>
<span id="cb189-6"><a aria-hidden="true" href="#cb189-6" tabindex="-1"></a><span class="co">       # Result: 9.12.1.10,9.12.1.20</span></span>
<span id="cb189-7"><a aria-hidden="true" href="#cb189-7" tabindex="-1"></a><span class="at">       </span><span class="fu">value</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$join</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> my_IPs </span><span class="kw">},</span><span class="at"> “</span><span class="kw">,</span><span class="at">” </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span><span class="at"> </span></span></code></pre></div>
<!----
{"id": "1336", "author": "Calin Curescu", "date": "2023-01-17T17:54:00Z", "comment": "Make a better example.", "target": "!!! Make an\nexample for concat and join where the differences are\nclear!!\\!"}-->
<h4 id="token">10.2.3.4 token</h4>
<p>The <em>$token</em> function is used within a TOSCA service template
on a 
string to parse out (tokenize) substrings separated by one or more 
token characters within a larger string. The <span class="math inline">$token function uses the
following grammar:
```yaml$</span>token: [ <string_with_tokens>, <string_of_token_chars>,
<substring_index> ]</substring_index></string_of_token_chars></string_with_tokens></p>
<pre><code>It takes the arguments shown in the following table:

Argument|Mandatory|Type|Description
| ----- | ------- | ----- | ----- |
|string_with_tokens|yes|string|The composite string that contains one or more substrings separated by token characters.|
|string_of_token_chars|yes|string|The string that contains one or more token characters that separate substrings within the composite string.|
|substring_index|yes|integer| The integer indicates the index of the substring to return from the composite string. Note that the first substring is denoted by using the ‘0’ (zero) integer value.|

The following code snippet shows an example use of the $token function:
```yaml
outputs:
   webserver_port:
     description: the port provided at the end of my server’s endpoint’s IP address
     value: { token: [ $get_attribute: [ my_server, data_endpoint, ip_address ], 
                       ‘:’,
                       1 ] }</code></pre>
<h3 id="set-functions">10.2.4 Set Functions</h3>
<blockquote>
<p>Note: We should discuss order</p>
</blockquote>
<h4 id="union">10.2.4.1 union</h4>
<p>The <em>$union</em> function takes one or more list arguments, all
having the 
entry schema of the same type. The result is a list that contains
all 
non-duplicate entries from all the argument lists. By non-duplicate
is 
meant that no two entries in the result list are equal. The <span class="math inline">$union
function uses the following grammar:
```yaml$</span>union: [ <list_arg1>, … ]</list_arg1></p>
<pre><code>
The $union function applied to only one list will return a result
where all the duplicate entries of the argument list are
eliminated. Note also that the order of the elements in the result
list is not specified.

#### 10.2.4.2 intersection

The *$intersection* function takes one or more list arguments, all
having the entry schema of the same type. The result is a list that
contains all entries that can be found in each of the argument
lists. The $intersection function uses the following grammar:
</code></pre>
<p>$intersection: [ <list_arg1>, … ]</list_arg1></p>
<pre><code>The $intersection function applied to only one list will return a
result where all the duplicate entries of the argument list are
eliminated. Note also that the order of the elements in the result
list is not specified.

### 10.2.5 Arithmetic Functions

#### 10.2.5.1 sum

The *$sum* function takes one or more arguments of either integer,
float, or scalar type. The result is of the same type as the arguments
and its value is the arithmetic sum of the arguments’ values. The $sum
function uses the following grammar:
</code></pre>
<p>$sum: [ <int_float_or_scalar_type_arg1>, &lt;
int_float_or_scalar_type_arg2&gt;, … ]</int_float_or_scalar_type_arg1></p>
<pre><code>
#### 10.2.5.2 difference

The *$difference* function takes two arguments of either integer,
float, or scalar type. The result is of the same type as the arguments
and its value is the arithmetic subtraction of the second argument
value from the first argument value. The $difference function uses the
following grammar:
</code></pre>
<p>$difference: [ <int_float_scalar_type_arg1>, &lt;
int_float_scalar_type_arg2&gt; ]</int_float_scalar_type_arg1></p>
<pre><code>
#### 10.2.5.3 product

The *$product* function takes either:

- Two arguments where the first argument is of a scalar type and the
  second argument is of an integer or float type. The result is of the
  same type as the first argument and its value is the arithmetic
  product of the first argument value and the second argument value.

- Any number of arguments of type integer or float. If all inputs are of
  type integer, then the result is of type integer, otherwise it is of
  type float. The result value is the arithmetic product of all the
  arguments values.

The $product function uses the following grammars:
```yaml
$product: [ &lt;scalar_type_arg1&gt;, &lt; int_or_float_type_arg2&gt; ]
$product: [ &lt;int_or_float_type_arg1&gt;, &lt; int_or_float_type_arg2&gt;, … ]</code></pre>
<h4 id="quotient">10.2.5.4 quotient</h4>
<p>The <em>$quotient</em> function takes two arguments where the first
argument 
is of an integer, float, or scalar type and the second argument is
of 
an integer or float type. The result is of</p>
<ul>
<li><p>A scalar type if the first argument is a scalar, and its value is
the 
arithmetic division of the first argument value by the second
argument 
value. If necessary, the result might be truncated, as decided by
the 
implementation.</p></li>
<li><p>A float if the first argument is an integer or a float. Note that
to 
transform the float to an integer a round or ceil or floor
function 
must be used.</p></li>
</ul>
<p>The <span class="math inline">$quotient function uses the following
grammar:
```yaml$</span>quotient: [ <int_float_or_scalar_type_arg1>, &lt;
int_or_float_type_arg2&gt; ]</int_float_or_scalar_type_arg1></p>
<pre><code>
#### 10.2.5.5 remainder

The *$remainder* function takes two arguments where the first argument
is of an integer, or scalar type and the second argument is of an
integer. The result is of the same type as the first argument and its
value is the remainder of the division to the second argument. The
$remainder function uses the following grammar:
</code></pre>
<p>$remainder: [ <int_or_scalar_type_arg1>, &lt; int_type_arg2&gt; ]</int_or_scalar_type_arg1></p>
<pre><code>#### 10.2.5.6 round

The *$round* function takes a float argument. The result is an integer
with the closest value to the float argument. Equal value distance is
rounded down (e.g. 3.5 is rounded down to 3, while 3.53 is rounded up
to 4). The $round function uses the following grammar:
```yaml
$round: [ &lt;float_type_arg&gt; ]</code></pre>
<h4 id="floor">10.2.5.7 floor</h4>
<p>The <em>$floor</em> function takes a float argument. The result is an
integer 
with the closest value that is less or equal to the value of the
float 
argument. The $floor function uses the following grammar:</p>
<pre><code>$floor: [ &lt;float_type_arg&gt; ]</code></pre>
<h4 id="ceil">10.2.5.8 ceil</h4>
<p>The <em>$ceil</em> function takes a float argument. The result is an
integer 
with the closest value that is greater or equal to the value of
the 
float argument. The <span class="math inline">$ceil function uses the
following grammar:
```yaml$</span>ceil: [ <float_type_arg> ]</float_type_arg></p>
<pre><code>## 10.3 TOSCA Path
The following shows the TOSCA Path syntax in BNF format:
```bnf
&lt;tosca_path&gt; ::=         &lt;node_symbolic_name&gt;, &lt;idx&gt;, &lt;node_context&gt; |
                         SELF, &lt;node_context&gt; |
                         &lt;relationship_symbolic_name&gt;, &lt;rel_context&gt; |
                         SELF, &lt;rel_context&gt;
&lt;node_context&gt; ::=       RELATIONSHIP, &lt;requirement_name&gt;, &lt;idx&gt;, &lt;rel_context&gt; |
                         CAPABILITY, &lt;capability_name&gt;, RELATIONSHIP, &lt;idx&gt;, &lt;rel_context&gt; |
                         CAPABILITY, &lt;capability_name&gt; |
                         &lt;empty&gt;
&lt;rel_context&gt; ::=        SOURCE, &lt;node_context&gt; | 
                         TARGET, &lt;node_context&gt; |
                         CAPABILITY, RELATIONSHIP &lt;idx&gt;, &lt;rel_context&gt; | 
                         CAPABILITY |
                         &lt;empty&gt;
&lt;idx&gt; ::=                &lt;integer_index&gt; | 
                         ALL | 
                         &lt;empty&gt;</code></pre>
<p>The initial context can refer to either a node or a relationship
context: 
- Since several node representations can be created from the same node
template, the <em>&lt;idx&gt;</em> after the initial
<em>&lt;node_symbolic_name&gt;</em> selects one (or all) of them. 
- If <em>SELF</em> is used, and if the tosca_path is used within a
requirement definition, <em>SELF</em> refers to the current relationship
context, otherwise it refers to the current node context. 
- A <em>&lt;node_context&gt;</em> can further resolve to a
<em>&lt;rel_context&gt;</em> and so on, adding more traversal steps. In
the end we reach a final node, relationship, or capability context.</p>
<p>A <em>&lt;node_context&gt;</em> can further: 
- lead to the outgoing relationship with index <em>&lt;idx&gt;</em> out
of the relationship defined by the requirement with symbolic name
<em>&lt;requirement_name&gt;</em> of the current node 
- lead to the relationship with index <em>&lt;idx&gt;</em> out of the
incoming relationships that target the capability with symbolic name
<em>&lt;capability_name&gt;</em> of the current node 
- end within the capability with symbolic name
<em>&lt;capability_name&gt;</em> in the current node 
- end within the current node via the <em>&lt;empty&gt;</em>
resolution</p>
<p>A <em>&lt;rel_context&gt;</em> can further: 
- lead to the <em>SOURCE</em> node of the current relationship 
- lead to the <em>TARGET</em> node of the current relationship 
- lead to a relationship with index <em>&lt;idx&gt;</em> out of the
relationships defined by the same requirement as the current
relationship 
- end within the target capability of the current relationship 
- end within the current relationship via the <em>&lt;empty&gt;</em>
resolution</p>
<p>Note that the <em>&lt;idx&gt;</em> can either be a non-negative
integer, thekeyword ALL, or missing: 
- If it is a non-negative integer, 0 represents the first index and so
on incrementally. 
- If the index is missing, the semantic meaning is that the first index
(index with value 0) is used. 
- If it is the keyword ALL, then we return the result for all possible
indices (further resolved separately) as a list. If the there are
multiple ALL keywords in the definition, then all the results shall be
merged into a single list.</p>
<p>We further list the changes from the get_property and
get_attribute 
expression from v1.3 to v2.0:</p>
<ul>
<li>Added multi-step traversal of the representation graph</li>
<li>Added the backward traversal from capabilities to incoming<br/>
relationships</li>
<li>Added the target capability of a relationship as a possible
traversal</li>
<li>Added the specification of indexes and allowing traversal of<br/>
multi-count requirements</li>
<li>Changed the following syntax to work better in multi-step traversal:
<ul>
<li>The initial SOURCE, … becomes SELF, SOURCE, …</li>
<li>The initial TARGET, … becomes SELF, TARGET, …</li>
</ul></li>
</ul>
<h2 id="function-definitions-1">10.4 Function Definitions</h2>
<p>TOSCA allows for the use of <em>custom functions</em> that extend the
set of 
built-in functions documented in the previous section. TOSCA 
Processors use standard function parsing rules to detect the
presence 
of a custom function.</p>
<p>In addition, TOSCA also includes grammar for defining function 
signatures and associated implementation artifacts in TOSCA
profiles 
or in TOSCA service templates. This allows for validation of
function 
return values and function arguments at design time, and the 
possibility to provide function implementation artifacts within 
CSARs. Note that the use of custom function definitions is
entirely 
optional. Service designers can use custom functions without
defining 
associated function signatures and instead rely on support for
those 
functions directly in the TOSCA orchestrator that will be used to 
process the TOSCA files. Of course, TOSCA processors may support 
custom functions that are not user-defined.</p>
<p>The following is the list of recognized keynames for a TOSCA
function 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">signatures</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">map of signature definitions</td>
<td style="text-align: left;">The map of signature definitions.</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The description of the function.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of metadata</td>
<td style="text-align: left;">Defines additional metadata
information.</td>
</tr>
</tbody>
</table>
<p>The following is the list of recognized keynames for a TOSCA
function 
signature definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">arguments</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of schema definitions</td>
<td style="text-align: left;">All defined arguments must be used in the
function invocation (and in the order defined here). If no arguments are
defined, the signature either accepts no argumats or any arguments of
any form (depending on if the variadic keyname is false or true).</td>
</tr>
<tr class="even">
<td style="text-align: left;">optional_arguments</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of schema definitions</td>
<td style="text-align: left;">Optional arguments may be used in the
function invocation after the regular arguments. Still the order defined
here must be respected.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">variadic</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">boolean</td>
<td style="text-align: left;">Specifies if the last defined argument (or
optional_argument if defined) may be repeated any number of times in the
function invocation. If this keyword is not specified, a default of
False is assumed.</td>
</tr>
<tr class="even">
<td style="text-align: left;">result</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">schema definition</td>
<td style="text-align: left;">Defines the type of the function result.
If no result keyname is defined, then the function may return any
result</td>
</tr>
<tr class="odd">
<td style="text-align: left;">implementation</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">implementation definition</td>
<td style="text-align: left;">Defines the implementation (e.g.,
artifact) for the function. The same definition as for
operation/notification implementation is used.</td>
</tr>
</tbody>
</table>
<p>Function signatures can be defined in TOSCA profiles or TOSCA
service 
templates using a YAML map under the functions keyname using the 
grammar specified below. Note that this grammar allows the
definition 
of functions that have arguments expressed within a YAML seq,
however 
intrinsic functions may accept other argument definition syntaxes.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb199-1"><a aria-hidden="true" href="#cb199-1" tabindex="-1"></a><span class="fu">functions</span><span class="kw">:</span></span>
<span id="cb199-2"><a aria-hidden="true" href="#cb199-2" tabindex="-1"></a><span class="at">  &lt;function_def&gt;</span></span>
<span id="cb199-3"><a aria-hidden="true" href="#cb199-3" tabindex="-1"></a><span class="at">  &lt;function_def&gt;</span></span>
<span id="cb199-4"><a aria-hidden="true" href="#cb199-4" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb199-5"><a aria-hidden="true" href="#cb199-5" tabindex="-1"></a><span class="at">  &lt;function_def&gt;</span></span></code></pre></div>
<p>Each &lt;function_def&gt; defines the name of a function with an
associated 
list of signature definitions as follows:</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb200-1"><a aria-hidden="true" href="#cb200-1" tabindex="-1"></a><span class="at">  </span><span class="fu">&lt;function_name&gt;</span><span class="kw">:</span></span>
<span id="cb200-2"><a aria-hidden="true" href="#cb200-2" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb200-3"><a aria-hidden="true" href="#cb200-3" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> &lt;signature_def&gt;</span></span>
<span id="cb200-4"><a aria-hidden="true" href="#cb200-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> &lt;signature_def&gt;</span></span>
<span id="cb200-5"><a aria-hidden="true" href="#cb200-5" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> &lt;signature_def&gt;</span></span>
<span id="cb200-6"><a aria-hidden="true" href="#cb200-6" tabindex="-1"></a><span class="at">      ...</span></span>
<span id="cb200-7"><a aria-hidden="true" href="#cb200-7" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> &lt;signature_def&gt;</span></span>
<span id="cb200-8"><a aria-hidden="true" href="#cb200-8" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;string&gt;</span></span>
<span id="cb200-9"><a aria-hidden="true" href="#cb200-9" tabindex="-1"></a><span class="at">    </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map_of_metadata&gt;</span></span></code></pre></div>
<p>Only the signatures keyname is mandatory and must provide at least
one 
signature definition. Note that the signatures are tested in the
order 
of their definition. The first matching implementation is used.</p>
<!----
{"id": "1055", "author": "Calin Curescu", "date": "2022-09-20T16:21:00Z", "comment": "Put an example of an empty signature that\nmeans the function takes no parameters and my return any result. Put\nalso of this example with variadic: true.", "target": "signature\ndefinition"}-->
<p>Each &lt;signature_def&gt; uses the following grammar:</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb201-1"><a aria-hidden="true" href="#cb201-1" tabindex="-1"></a><span class="fu">arguments</span><span class="kw">:</span></span>
<span id="cb201-2"><a aria-hidden="true" href="#cb201-2" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;schema_def&gt;</span></span>
<span id="cb201-3"><a aria-hidden="true" href="#cb201-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;schema_def&gt;</span></span>
<span id="cb201-4"><a aria-hidden="true" href="#cb201-4" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb201-5"><a aria-hidden="true" href="#cb201-5" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;schema_def&gt;</span></span>
<span id="cb201-6"><a aria-hidden="true" href="#cb201-6" tabindex="-1"></a><span class="fu">optional_arguments</span><span class="kw">:</span></span>
<span id="cb201-7"><a aria-hidden="true" href="#cb201-7" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;schema_def&gt;</span></span>
<span id="cb201-8"><a aria-hidden="true" href="#cb201-8" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;schema_def&gt;</span></span>
<span id="cb201-9"><a aria-hidden="true" href="#cb201-9" tabindex="-1"></a><span class="at">  ...</span></span>
<span id="cb201-10"><a aria-hidden="true" href="#cb201-10" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;schema_def&gt;</span></span>
<span id="cb201-11"><a aria-hidden="true" href="#cb201-11" tabindex="-1"></a><span class="fu">variadic</span><span class="kw">:</span><span class="at"> &lt;boolean&gt;</span></span>
<span id="cb201-12"><a aria-hidden="true" href="#cb201-12" tabindex="-1"></a><span class="fu">result</span><span class="kw">:</span><span class="at"> &lt;schema_def&gt;</span></span>
<span id="cb201-13"><a aria-hidden="true" href="#cb201-13" tabindex="-1"></a><span class="fu">implementation</span><span class="kw">:</span><span class="at"> &lt;implementation_def&gt;</span></span></code></pre></div>
<p>None of the keynames in the signature definition are mandatory.</p>
<p>The keynames have the following meaning:</p>
<ul>
<li><p>The arguments keyname defines the type and the position of
the 
function arguments. All defined arguments must be used in the
function 
invocation (and in the order defined here).</p>
<ul>
<li>The full flexibility of the schema definition for types can be
used.</li>
</ul></li>
<li><p>The optional_arguments keyname defines the type and the position
of 
the function arguments. Optional arguments may be used in the
function 
invocation after the regular arguments. Still the order defined
here 
must be respected (that is, if m out of n of the optional
arguments 
are used, they will correspond to the first m &lt;schema_def&gt;).</p>
<ul>
<li>The full flexibility of the schema definition for types can be
used.</li>
</ul></li>
<li><p>The result keyname defines the type of the function result.</p>
<ul>
<li><p>Again, the full flexibility of the schema definition for types
can 
be used.</p></li>
<li><p>If no result keyname is defined, then the function may return
any 
result.</p></li>
</ul></li>
<li><p>The variadic keyname defines if the last defined argument may
be 
repeated any number of times in the function invocation.</p>
<ul>
<li><p>If variadic is true, the last defined argument may be repeated
any 
number of times in the function invocation (on the last positions).</p>
<ul>
<li><p>If optional_arguments is defined, then the last defined
argument 
is the last defined optional_argument. Note that in this case we 
have a 0+ usage of the last argument.</p></li>
<li><p>If optional_arguments is not defined, then the last defined 
argument is the last defined regular argument. Note that in this 
case we have a 1+ usage of the last argument.</p></li>
</ul></li>
<li><p>If variadic is false, the last argument definition has no
special 
semantics.</p></li>
<li><p>If the arguments list is empty or not defined:</p>
<ul>
<li><p>If variadic is false, the function is not accepting any
arguments.</p></li>
<li><p>If variadic is true, the function is considered to accept
any 
numbers of arguments of any type or form.</p></li>
</ul></li>
<li><p>Default value of variadic is false.</p></li>
</ul></li>
<li><p>The implementation keyname defines the implementation (e.g.,
artifact) 
for the function.</p>
<ul>
<li><p>The same definition as for operation/notification implementation
is 
used.</p></li>
<li><p>If no implementation is specified, then it’s assumed that the
TOSCA 
processor is preconfigured to handle the function call.</p></li>
<li><p>Note that several signatures of a function (or even of
several 
functions) may refer to the same implementation in the 
implementation definition.</p></li>
</ul></li>
</ul>
<p>The functions section can be defined both outside and/or inside
a 
service_template section:</p>
<ul>
<li><p>Function definitions outside a service_template can be within
a 
profile TOSCA file or imported TOSCA file</p>
<ul>
<li><p>Namespacing works as for types. Overlapping definitions under
the 
same &lt;function_name&gt; are not allowed.</p></li>
<li><p>Note that in that case the $ (dollar sign) character will be put
in 
front of the namespace name. For example:</p></li>
</ul>
<div class="sourceCode" id="cb202"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb202-1"><a aria-hidden="true" href="#cb202-1" tabindex="-1"></a><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb202-2"><a aria-hidden="true" href="#cb202-2" tabindex="-1"></a><span class="fu">rnd_nr</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> $namespace1</span><span class="fu">:random_generator</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> seed </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span></code></pre></div></li>
<li><p>Function definitions inside a service_template that have
the 
same &lt;function_name&gt; are considered a refinement of the
homonymous 
definition outside the service_template, see refinement rules
below.</p></li>
<li><p>For example, this would allow for two separated design moments
in 
function design:</p>
<ul>
<li><p>At profile design time (outside the service_template), when
e.g. the 
arguments and the result is defined and thus the function can be 
correctly used in the node type definitions.</p></li>
<li><p>At service template design time (inside the service_template),
when 
function implementation references within a current CSAR can be 
decided, and thus the implementation or the description may be
added 
or changed.</p></li>
<li><p>Note also that we could have the whole definition in the
service 
template or outside the service template, in the latter case 
defining a global implementation.</p></li>
</ul></li>
</ul>
<p>Function definitions inside a service_template that have the 
same &lt;function_name&gt; are considered a refinement of the
homonymous 
definition outside the service_template. They use the following 
refinement rules:</p>
<ul>
<li><p>signatures: as a general function refinement rule, for an
already 
defined signature only the implementation may be changed.</p>
<ul>
<li><p>New function signatures may be added to the signatures list,
but 
only after the refinements of the existing signatures.</p></li>
<li><p>If an existing signature is not refined, an empty element must
be 
used at the relevant location in the list.</p></li>
</ul></li>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the function definition outside the 
service_template.</p></li>
<li><p>metadata: a new definition is unrestricted and will overwrite the
one 
inherited from the function definition outside the
service_template.</p></li>
</ul>
<p>The following example shows the definition of a square root
function:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb203-1"><a aria-hidden="true" href="#cb203-1" tabindex="-1"></a><span class="fu">functions</span><span class="kw">:</span></span>
<span id="cb203-2"><a aria-hidden="true" href="#cb203-2" tabindex="-1"></a><span class="at">  </span><span class="fu">sqrt</span><span class="kw">:</span></span>
<span id="cb203-3"><a aria-hidden="true" href="#cb203-3" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb203-4"><a aria-hidden="true" href="#cb203-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span></span>
<span id="cb203-5"><a aria-hidden="true" href="#cb203-5" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb203-6"><a aria-hidden="true" href="#cb203-6" tabindex="-1"></a><span class="at">          </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="dv">0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb203-7"><a aria-hidden="true" href="#cb203-7" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span></span>
<span id="cb203-8"><a aria-hidden="true" href="#cb203-8" tabindex="-1"></a><span class="at">          </span><span class="fu">type</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb203-9"><a aria-hidden="true" href="#cb203-9" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/sqrt.py</span></span>
<span id="cb203-10"><a aria-hidden="true" href="#cb203-10" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span></span>
<span id="cb203-11"><a aria-hidden="true" href="#cb203-11" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb203-12"><a aria-hidden="true" href="#cb203-12" tabindex="-1"></a><span class="at">          </span><span class="fu">validation</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$greater_or_equal</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> $value</span><span class="kw">,</span><span class="at"> </span><span class="fl">0.0</span><span class="at"> </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb203-13"><a aria-hidden="true" href="#cb203-13" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span></span>
<span id="cb203-14"><a aria-hidden="true" href="#cb203-14" tabindex="-1"></a><span class="at">          </span><span class="fu">type</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb203-15"><a aria-hidden="true" href="#cb203-15" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/sqrt.py</span></span>
<span id="cb203-16"><a aria-hidden="true" href="#cb203-16" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;</span></span>
<span id="cb203-17"><a aria-hidden="true" href="#cb203-17" tabindex="-1"></a>      This is a square root function that defines two signatures:</span>
<span id="cb203-18"><a aria-hidden="true" href="#cb203-18" tabindex="-1"></a>      the argument is either integer or float and the function</span>
<span id="cb203-19"><a aria-hidden="true" href="#cb203-19" tabindex="-1"></a>      returns the square root as a float.</span></code></pre></div>
<p>The next sqrt is similar to above, but uses a simplified type
notation 
(in this short form no validation clause can be expressed):</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb204-1"><a aria-hidden="true" href="#cb204-1" tabindex="-1"></a><span class="fu">functions</span><span class="kw">:</span></span>
<span id="cb204-2"><a aria-hidden="true" href="#cb204-2" tabindex="-1"></a><span class="at">  </span><span class="fu">sqrt</span><span class="kw">:</span></span>
<span id="cb204-3"><a aria-hidden="true" href="#cb204-3" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb204-4"><a aria-hidden="true" href="#cb204-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> integer </span><span class="kw">]</span></span>
<span id="cb204-5"><a aria-hidden="true" href="#cb204-5" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb204-6"><a aria-hidden="true" href="#cb204-6" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/sqrt.py</span></span>
<span id="cb204-7"><a aria-hidden="true" href="#cb204-7" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> float </span><span class="kw">]</span></span>
<span id="cb204-8"><a aria-hidden="true" href="#cb204-8" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb204-9"><a aria-hidden="true" href="#cb204-9" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/sqrt.py</span></span>
<span id="cb204-10"><a aria-hidden="true" href="#cb204-10" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;</span></span>
<span id="cb204-11"><a aria-hidden="true" href="#cb204-11" tabindex="-1"></a>      This is a square root function that defines two signatures:</span>
<span id="cb204-12"><a aria-hidden="true" href="#cb204-12" tabindex="-1"></a>      the argument is either integer or float and the function</span>
<span id="cb204-13"><a aria-hidden="true" href="#cb204-13" tabindex="-1"></a>      returns the suare root as a float</span></code></pre></div>
<p>The following example shows a function that takes a list of
arguments 
with different types:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb205-1"><a aria-hidden="true" href="#cb205-1" tabindex="-1"></a><span class="at">  </span><span class="fu">my_func_with_different_argument_types</span><span class="kw">:</span></span>
<span id="cb205-2"><a aria-hidden="true" href="#cb205-2" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb205-3"><a aria-hidden="true" href="#cb205-3" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span></span>
<span id="cb205-4"><a aria-hidden="true" href="#cb205-4" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> MyType1</span></span>
<span id="cb205-5"><a aria-hidden="true" href="#cb205-5" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">"this is the first argument ..."</span></span>
<span id="cb205-6"><a aria-hidden="true" href="#cb205-6" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb205-7"><a aria-hidden="true" href="#cb205-7" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">"this is the second argument ..."</span></span>
<span id="cb205-8"><a aria-hidden="true" href="#cb205-8" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb205-9"><a aria-hidden="true" href="#cb205-9" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">"this is the third argument ..."</span></span>
<span id="cb205-10"><a aria-hidden="true" href="#cb205-10" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> MyType2</span></span>
<span id="cb205-11"><a aria-hidden="true" href="#cb205-11" tabindex="-1"></a><span class="at">          </span><span class="fu">description</span><span class="kw">:</span><span class="at"> </span><span class="st">"this is the argument that can be repeated ..."</span></span>
<span id="cb205-12"><a aria-hidden="true" href="#cb205-12" tabindex="-1"></a><span class="at">        </span><span class="fu">variadic</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb205-13"><a aria-hidden="true" href="#cb205-13" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb205-14"><a aria-hidden="true" href="#cb205-14" tabindex="-1"></a><span class="at">          </span><span class="fu">type</span><span class="kw">:</span><span class="at"> MyTypeRez</span></span>
<span id="cb205-15"><a aria-hidden="true" href="#cb205-15" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/my.py</span></span></code></pre></div>
<p>The following snippet defines the same function as the example
above, 
but in compact notation:</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb206-1"><a aria-hidden="true" href="#cb206-1" tabindex="-1"></a><span class="fu">functions</span><span class="kw">:</span></span>
<span id="cb206-2"><a aria-hidden="true" href="#cb206-2" tabindex="-1"></a><span class="at">  </span><span class="fu">my_func_with_different_argument_types</span><span class="kw">:</span></span>
<span id="cb206-3"><a aria-hidden="true" href="#cb206-3" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb206-4"><a aria-hidden="true" href="#cb206-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">MyType1</span><span class="kw">,</span><span class="at"> string</span><span class="kw">,</span><span class="at"> string</span><span class="kw">,</span><span class="at"> MyType2</span><span class="kw">]</span></span>
<span id="cb206-5"><a aria-hidden="true" href="#cb206-5" tabindex="-1"></a><span class="at">        </span><span class="fu">variadic</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb206-6"><a aria-hidden="true" href="#cb206-6" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span><span class="at"> MyTypeRez</span></span>
<span id="cb206-7"><a aria-hidden="true" href="#cb206-7" tabindex="-1"></a><span class="at">      </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/my.py</span></span></code></pre></div>
<p>The arguments list can be empty or completely missing. In such a
case, 
when using the function the arguments will be an empty list:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb207-1"><a aria-hidden="true" href="#cb207-1" tabindex="-1"></a><span class="at">  </span><span class="fu">get_random_nr</span><span class="kw">:</span></span>
<span id="cb207-2"><a aria-hidden="true" href="#cb207-2" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb207-3"><a aria-hidden="true" href="#cb207-3" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">result</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb207-4"><a aria-hidden="true" href="#cb207-4" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/myrnd.py</span></span></code></pre></div>
<p>The following shows function signatures with polymorphic arguments
and 
result lists:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb208-1"><a aria-hidden="true" href="#cb208-1" tabindex="-1"></a><span class="fu">functions</span><span class="kw">:</span></span>
<span id="cb208-2"><a aria-hidden="true" href="#cb208-2" tabindex="-1"></a><span class="at">  </span><span class="fu">union</span><span class="kw">:</span></span>
<span id="cb208-3"><a aria-hidden="true" href="#cb208-3" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb208-4"><a aria-hidden="true" href="#cb208-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span></span>
<span id="cb208-5"><a aria-hidden="true" href="#cb208-5" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> list</span></span>
<span id="cb208-6"><a aria-hidden="true" href="#cb208-6" tabindex="-1"></a><span class="at">          </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb208-7"><a aria-hidden="true" href="#cb208-7" tabindex="-1"></a><span class="at">        </span><span class="fu">variadic</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb208-8"><a aria-hidden="true" href="#cb208-8" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span></span>
<span id="cb208-9"><a aria-hidden="true" href="#cb208-9" tabindex="-1"></a><span class="at">          </span><span class="fu">type</span><span class="kw">:</span><span class="at"> list</span></span>
<span id="cb208-10"><a aria-hidden="true" href="#cb208-10" tabindex="-1"></a><span class="at">          </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb208-11"><a aria-hidden="true" href="#cb208-11" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/libpi.py</span></span>
<span id="cb208-12"><a aria-hidden="true" href="#cb208-12" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span></span>
<span id="cb208-13"><a aria-hidden="true" href="#cb208-13" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> list</span></span>
<span id="cb208-14"><a aria-hidden="true" href="#cb208-14" tabindex="-1"></a><span class="at">          </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb208-15"><a aria-hidden="true" href="#cb208-15" tabindex="-1"></a><span class="at">        </span><span class="fu">variadic</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb208-16"><a aria-hidden="true" href="#cb208-16" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span></span>
<span id="cb208-17"><a aria-hidden="true" href="#cb208-17" tabindex="-1"></a><span class="at">          </span><span class="fu">type</span><span class="kw">:</span><span class="at"> list</span></span>
<span id="cb208-18"><a aria-hidden="true" href="#cb208-18" tabindex="-1"></a><span class="at">          </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> float</span></span>
<span id="cb208-19"><a aria-hidden="true" href="#cb208-19" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/libpi.py</span></span></code></pre></div>
<p>The following shows the use of an argument that is a map of lists
of 
MyType:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb209-1"><a aria-hidden="true" href="#cb209-1" tabindex="-1"></a><span class="fu">functions</span><span class="kw">:</span></span>
<span id="cb209-2"><a aria-hidden="true" href="#cb209-2" tabindex="-1"></a><span class="at">  </span><span class="fu">complex_arg_function</span><span class="kw">:</span></span>
<span id="cb209-3"><a aria-hidden="true" href="#cb209-3" tabindex="-1"></a><span class="at">    </span><span class="fu">signatures</span><span class="kw">:</span></span>
<span id="cb209-4"><a aria-hidden="true" href="#cb209-4" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">arguments</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb209-5"><a aria-hidden="true" href="#cb209-5" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">type</span><span class="kw">:</span><span class="at"> map</span></span>
<span id="cb209-6"><a aria-hidden="true" href="#cb209-6" tabindex="-1"></a><span class="at">          </span><span class="fu">key_schema</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb209-7"><a aria-hidden="true" href="#cb209-7" tabindex="-1"></a><span class="at">          </span><span class="fu">entry_schema</span><span class="kw">:</span></span>
<span id="cb209-8"><a aria-hidden="true" href="#cb209-8" tabindex="-1"></a><span class="at">            </span><span class="fu">type</span><span class="kw">:</span><span class="at"> list</span></span>
<span id="cb209-9"><a aria-hidden="true" href="#cb209-9" tabindex="-1"></a><span class="at">            </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> MyType</span></span>
<span id="cb209-10"><a aria-hidden="true" href="#cb209-10" tabindex="-1"></a><span class="at">        </span><span class="fu">result</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb209-11"><a aria-hidden="true" href="#cb209-11" tabindex="-1"></a><span class="at">        </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> scripts/complex.py</span></span></code></pre></div>
<p>The following shows more examples of function usage. Note that in
the 
usage of the polymorphic union function, the TOSCA parser knows to 
identify the right signature via the types of the function
arguments. 
Also note the usage of a user-defined function with no parameters;
an 
empty list is used for the arguments.</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb210-1"><a aria-hidden="true" href="#cb210-1" tabindex="-1"></a><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb210-2"><a aria-hidden="true" href="#cb210-2" tabindex="-1"></a><span class="at">  </span><span class="fu">integer_union</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$union</span><span class="kw">:</span><span class="at"> </span><span class="kw">[[</span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">7</span><span class="kw">],</span><span class="at"> </span><span class="kw">[</span><span class="dv">3</span><span class="kw">,</span><span class="at"> </span><span class="dv">4</span><span class="kw">,</span><span class="at"> </span><span class="dv">9</span><span class="kw">],</span><span class="at"> </span><span class="kw">[</span><span class="dv">15</span><span class="kw">,</span><span class="at"> </span><span class="dv">16</span><span class="kw">]]}</span></span>
<span id="cb210-3"><a aria-hidden="true" href="#cb210-3" tabindex="-1"></a><span class="at">  </span><span class="fu">float_union</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$union</span><span class="kw">:</span><span class="at"> </span><span class="kw">[[</span><span class="fl">3.5</span><span class="kw">,</span><span class="at"> </span><span class="fl">8.8</span><span class="kw">],</span><span class="at"> </span><span class="kw">[</span><span class="fl">1.3</span><span class="kw">]]}</span></span>
<span id="cb210-4"><a aria-hidden="true" href="#cb210-4" tabindex="-1"></a><span class="at">  </span><span class="fu">rnd</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_random_nr</span><span class="kw">:</span><span class="at"> </span><span class="kw">[]}</span></span></code></pre></div>
<hr/>
<h1 id="interfaces-operations-and-notifications">11 Interfaces,
Operations, and Notifications</h1>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative. 
## 11.1 Interface Type</p>
<p>An <em>interface type</em> is a reusable entity that describes a set
of 
operations and notifications that can be used to interact with or
to 
manage a node or relationship in a TOSCA topology as well as the
input 
and output parameters used by those operations and notifications.</p>
<p>An interface type definition is a type of TOSCA type definition and
as 
a result supports the common keynames listed in <a href="#641-common-keynames-in-type-definitions">Section 
6.4.1</a>. In addition, the 
interface type definition has the following recognized keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">inputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter definitions</td>
<td style="text-align: left;">The optional map of input parameter
definitions available to all operations defined for this interface.</td>
</tr>
<tr class="even">
<td style="text-align: left;">operations</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of operation definitions</td>
<td style="text-align: left;">The optional map of operations defined for
this interface.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">notifications</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of notification definitions</td>
<td style="text-align: left;">The optional map of notifications defined
for this interface.</td>
</tr>
</tbody>
</table>
<p>These keynames can be used according to the following grammar:</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb211-1"><a aria-hidden="true" href="#cb211-1" tabindex="-1"></a><span class="fu">&lt;interface_type_name&gt;</span><span class="kw">:</span></span>
<span id="cb211-2"><a aria-hidden="true" href="#cb211-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;parent_interface_type_name&gt;</span></span>
<span id="cb211-3"><a aria-hidden="true" href="#cb211-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb211-4"><a aria-hidden="true" href="#cb211-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map of yaml values&gt;</span></span>
<span id="cb211-5"><a aria-hidden="true" href="#cb211-5" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;interface_description&gt;</span></span>
<span id="cb211-6"><a aria-hidden="true" href="#cb211-6" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_definitions&gt;</span></span>
<span id="cb211-7"><a aria-hidden="true" href="#cb211-7" tabindex="-1"></a><span class="at">  </span><span class="fu">operations</span><span class="kw">:</span><span class="at"> &lt;operation_definitions&gt;</span></span>
<span id="cb211-8"><a aria-hidden="true" href="#cb211-8" tabindex="-1"></a><span class="at">  </span><span class="fu">notifications</span><span class="kw">:</span><span class="at"> &lt;notification definition&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>interface_type_name: represents the mandatory name of the
interface as 
a string.</p></li>
<li><p>parent_interface_type_name: represents the name of the
interface 
type from which this interface type definition derives (i.e. its 
“parent” type).</p></li>
<li><p>parameter_definitions: represents the optional map of
parameter 
definitions which the TOSCA orchestrator will make available (i.e.,
or 
pass) to all implementation artifacts for operations declared on
the 
interface during their execution.</p></li>
<li><p>operation_definitions: represents the optional map of one or
more 
operation definitions.</p></li>
<li><p>notification_definitions: represents the optional map of one or
more 
notification definitions.</p></li>
</ul>
<p>During interface type derivation the keyname definitions follow
these 
rules:</p>
<ul>
<li><p>inputs: existing parameter definitions may be refined; new
parameter 
definitions may be added.</p></li>
<li><p>operations: existing operation definitions may be refined;
new 
operation definitions may be added.</p></li>
<li><p>notifications: existing notification definitions may be refined;
new 
notification definitions may be added.</p></li>
</ul>
<p>Note that interface types definitions <strong>MUST NOT</strong>
include any 
implementations for defined operations or notifications; that is,
the 
implementation keyname is invalid in this context.</p>
<p>The following example shows a custom interface used to define
multiple 
configure operations.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb212-1"><a aria-hidden="true" href="#cb212-1" tabindex="-1"></a><span class="fu">MyConfigure</span><span class="kw">:</span></span>
<span id="cb212-2"><a aria-hidden="true" href="#cb212-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> My custom configure interface type</span></span>
<span id="cb212-3"><a aria-hidden="true" href="#cb212-3" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb212-4"><a aria-hidden="true" href="#cb212-4" tabindex="-1"></a><span class="at">    </span><span class="fu">mode</span><span class="kw">:</span></span>
<span id="cb212-5"><a aria-hidden="true" href="#cb212-5" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb212-6"><a aria-hidden="true" href="#cb212-6" tabindex="-1"></a><span class="at">  </span><span class="fu">operations</span><span class="kw">:</span></span>
<span id="cb212-7"><a aria-hidden="true" href="#cb212-7" tabindex="-1"></a><span class="at">    </span><span class="fu">pre_configure_service</span><span class="kw">:</span></span>
<span id="cb212-8"><a aria-hidden="true" href="#cb212-8" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> pre-configure operation for my service</span></span>
<span id="cb212-9"><a aria-hidden="true" href="#cb212-9" tabindex="-1"></a><span class="at">    </span><span class="fu">post_configure_service</span><span class="kw">:</span></span>
<span id="cb212-10"><a aria-hidden="true" href="#cb212-10" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> post-configure operation for my service</span></span></code></pre></div>
<h2 id="interface-definition">11.2 Interface Definition</h2>
<p>An interface definition defines an interface (containing
operations 
and notifications definitions) that can be associated with 
(i.e. defined within) a node or relationship type definition. An 
interface definition may be refined in subsequent node or
relationship 
type derivations.</p>
<p>The following is the list of recognized keynames for a TOSCA
interface 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The mandatory name of the interface type
on which this interface definition is based.</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional description for this
interface definition.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of metadata</td>
<td style="text-align: left;">Defines additional metadata
information.</td>
</tr>
<tr class="even">
<td style="text-align: left;">inputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter definitions and
refinements</td>
<td style="text-align: left;">The optional map of input parameter
refinements and new input parameter definitions available to all
operations defined for this interface (the input parameters to be
refined have been defined in the interface type definition).</td>
</tr>
<tr class="odd">
<td style="text-align: left;">operations</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of operation refinements</td>
<td style="text-align: left;">The optional map of operations refinements
for this interface. The referred operations must have been defined in
the interface type definition.</td>
</tr>
<tr class="even">
<td style="text-align: left;">notifications</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of notification refinements</td>
<td style="text-align: left;">The optional map of notifications
refinements for this interface. The referred operations must have been
defined in the interface type definition.</td>
</tr>
</tbody>
</table>
<p>Interface definitions in node or relationship type definitions have
the 
following grammar:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb213-1"><a aria-hidden="true" href="#cb213-1" tabindex="-1"></a><span class="fu">&lt;interface_definition_name&gt;</span><span class="kw">:</span></span>
<span id="cb213-2"><a aria-hidden="true" href="#cb213-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;interface_type_name&gt;</span></span>
<span id="cb213-3"><a aria-hidden="true" href="#cb213-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;interface_description&gt;</span></span>
<span id="cb213-4"><a aria-hidden="true" href="#cb213-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map of yaml values&gt;</span></span>
<span id="cb213-5"><a aria-hidden="true" href="#cb213-5" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_definitions_and_refinements&gt;</span></span>
<span id="cb213-6"><a aria-hidden="true" href="#cb213-6" tabindex="-1"></a><span class="at">  </span><span class="fu">operations</span><span class="kw">:</span><span class="at"> &lt;operation_refinements&gt;</span></span>
<span id="cb213-7"><a aria-hidden="true" href="#cb213-7" tabindex="-1"></a><span class="at">  </span><span class="fu">notifications</span><span class="kw">:</span><span class="at"> &lt;notification definition&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>interface_definition_name: represents the mandatory symbolic name
of 
the interface as a string.</p></li>
<li><p>interface_type_name: represents the mandatory name of the
interface 
type for the interface definition.</p></li>
<li><p>parameter_definitions_and_refinements: represents the optional
map of 
input parameters which the TOSCA orchestrator will make available 
(i.e. pass) to all defined operations. This means these parameters
and 
their values will be accessible to the implementation artifacts
(e.g., 
scripts) associated to each operation during their execution</p>
<ul>
<li><p>the map represents a mix of parameter refinements (for
parameters 
already defined in the interface type) and new parameter 
definitions.</p></li>
<li><p>with the new parameter definitions, we can flexibly add new
parameters 
when changing the implementation of operations and notifications 
during refinements or assignments.</p></li>
</ul></li>
<li><p>operation_refinements: represents the optional map of
operation 
definition refinements for this interface; the referred operations 
must have been previously defined in the interface type.</p></li>
<li><p>notification_refinements: represents the optional map of
notification 
definition refinements for this interface; the referred
notifications 
must have been previously defined in the interface type.</p></li>
</ul>
<p>An interface definition within a node or relationship type
(including 
interface definitions in requirements definitions) uses the
following 
definition refinement rules when the containing entity type is
derived:</p>
<ul>
<li><p>type: must be derived from (or the same as) the type in the
interface 
definition in the parent entity type definition.</p></li>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the interface definition in the parent entity
type 
definition.</p></li>
<li><p>inputs: not applicable to the definitions in the parent entity
type 
but to the definitions in the interface type referred by the type 
keyname (see grammar above for the rules).</p></li>
<li><p>operations: not applicable to the definitions in the parent
entity 
type but to the definitions in the interface type referred by the
type 
keyname (see grammar above for the rules).</p></li>
<li><p>notifications: not applicable to the definitions in the parent
entity 
type but to the definitions in the interface type referred by the
type 
keyname (see grammar above for the rules).</p></li>
</ul>
<h2 id="interface-assignment">11.3 Interface Assignment</h2>
<p>An interface assignment is used to specify assignments for the
inputs, 
operations and notifications defined in the interface. Interface 
assignments may be used within a node or relationship template 
definition (including when interface assignments are referenced as
part 
of a requirement assignment in a node template).</p>
<p>The following is the list of recognized keynames for a TOSCA
interface 
assignment:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">inputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter value assignments</td>
<td style="text-align: left;">The optional map of input parameter
assignments. Template authors MAY provide parameter assignments for
interface inputs that are not defined in their corresponding interface
type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">operations</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of operation assignments</td>
<td style="text-align: left;">The optional map of operations assignments
specified for this interface.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">notifications</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of notification assignments</td>
<td style="text-align: left;">The optional map of notifications
assignments specified for this interface.</td>
</tr>
</tbody>
</table>
<p>Interface assignments have the following grammar:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb214-1"><a aria-hidden="true" href="#cb214-1" tabindex="-1"></a><span class="fu">&lt;interface_definition_name&gt;</span><span class="kw">:</span></span>
<span id="cb214-2"><a aria-hidden="true" href="#cb214-2" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_value_assignments&gt;</span></span>
<span id="cb214-3"><a aria-hidden="true" href="#cb214-3" tabindex="-1"></a><span class="at">  </span><span class="fu">operations</span><span class="kw">:</span><span class="at">  &lt;operation_assignments&gt;</span></span>
<span id="cb214-4"><a aria-hidden="true" href="#cb214-4" tabindex="-1"></a><span class="at">  </span><span class="fu">notifications</span><span class="kw">:</span><span class="at"> &lt;notification_assignments&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>interface_definition_name: represents the mandatory symbolic name
of 
the interface as a string.</p></li>
<li><p>parameter_value_assignments: represents the optional map of
parameter 
value assignments for passing input parameter values to all
interface 
operations</p>
<ul>
<li>template authors MAY provide new parameter assignments for
interface<br/>
inputs that are not defined in the interface definition.</li>
</ul></li>
<li><p>operation_assignments: represents the optional map of
operation 
assignments for operations defined in the interface definition.</p></li>
<li><p>notification_assignments: represents the optional map of
notification 
assignments for notifications defined in the interface
definition.</p></li>
</ul>
<h2 id="operation-definition">11.4 Operation Definition</h2>
<p>An operation definition defines a function or procedure to which
an 
operation implementation can be bound.</p>
<p>A new operation definition may be declared only inside interface
type 
definitions (this is the only place where new operations can be 
defined). In interface type, node type, or relationship type
definitions 
(including operation definitions as part of a requirement definition)
we 
may further refine operations already defined in an interface type.</p>
<p>An operation definition or refinement inside an interface type 
definition may not contain an operation implementation definition and
it 
may not contain an attribute mapping as part of its output
definition 
(as both these keynames are node/relationship specific).</p>
<p>The following is the list of recognized keynames for a TOSCA
operation 
definition (including definition refinement)</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional description string for the
associated operation.</td>
</tr>
<tr class="even">
<td style="text-align: left;">implementation</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">operation implementation definition</td>
<td style="text-align: left;">The optional definition of the operation
implementation. May not be used in an interface type definition
(i.e. where an operation is initially defined), but only during
refinements.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter definitions</td>
<td style="text-align: left;">The optional map of parameter definitions
for operation input values.</td>
</tr>
<tr class="even">
<td style="text-align: left;">outputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter definitions</td>
<td style="text-align: left;">The optional map of parameter definitions
for operation output values. Only as part of node and relationship type
definitions, the output definitions may include mappings onto attributes
of the node or relationship type that contains the definition.</td>
</tr>
</tbody>
</table>
<p>Operation definitions have the following grammar:</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb215-1"><a aria-hidden="true" href="#cb215-1" tabindex="-1"></a><span class="fu">&lt;operation_name&gt;</span><span class="kw">:</span></span>
<span id="cb215-2"><a aria-hidden="true" href="#cb215-2" tabindex="-1"></a><span class="at">   </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;operation_description&gt;</span></span>
<span id="cb215-3"><a aria-hidden="true" href="#cb215-3" tabindex="-1"></a><span class="at">   </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> &lt;operation_implementation_definition&gt;</span></span>
<span id="cb215-4"><a aria-hidden="true" href="#cb215-4" tabindex="-1"></a><span class="at">   </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_definitions&gt;</span></span>
<span id="cb215-5"><a aria-hidden="true" href="#cb215-5" tabindex="-1"></a><span class="at">   </span><span class="fu">outputs</span><span class="kw">:</span><span class="at"> &lt;parameter_definitions&gt;</span></span></code></pre></div>
<p>The following single-line grammar may be used when the
operation’s 
implementation definition is the only keyname that is needed, and
when 
the operation implementation definition itself can be specified using
a 
single line grammar:</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb216-1"><a aria-hidden="true" href="#cb216-1" tabindex="-1"></a><span class="fu">&lt;operation_name&gt;</span><span class="kw">:</span><span class="at"> &lt;operation_implementation_definition&gt;</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>operation_name: represents the mandatory symbolic name of the
operation as a string.</p></li>
<li><p>operation_description: represents the optional description string
for the operation.</p></li>
<li><p>operation_implementation_definition: represents the optional
specification of the operation’s implementation).</p></li>
<li><p>parameter_definitions: represents the optional map of
parameter 
definitions which the TOSCA orchestrator will make available as inputs
to or receive as outputs from the corresponding implementation artifact
during its execution.</p></li>
</ul>
<p>An operation definition within an interface, node, or relationship
type 
(including interface definitions in requirements definitions) uses
the 
following refinement rules when the containing entity type is
derived:</p>
<ul>
<li><p>description: a new definition is unrestricted and will overwrite
the one inherited from the operation definition in the parent entity
type definition.</p></li>
<li><p>implementation: a new definition is unrestricted and will
overwrite 
the one inherited from the operation definition in the parent
entity 
type definition.</p></li>
<li><p>inputs: parameter definitions inherited from the parent entity
type 
may be refined; new parameter definitions may be added.</p></li>
<li><p>outputs: parameter definitions inherited from the parent entity
type 
may be refined; new parameter definitions may be added.</p></li>
</ul>
<p>The following additional requirements apply:</p>
<ul>
<li><p>The definition of implementation is not allowed in interface
type 
definitions (as a node or node type context is missing at that
point). 
Thus, it can be part only of an operation refinement and not of
the 
original operation definition.</p></li>
<li><p>The default refinement behavior for implementations SHALL
be 
overwrite. That is, implementation definitions in a derived type 
overwrite any defined in its parent type.</p></li>
<li><p>Defining a fixed value for an input parameter (as part of
its 
definition) may only use a parameter_value_expression that is 
meaningful in the scope of the context. For example, within the 
context of an interface type definition functions such as
get_propery 
or get_attribute cannot be used. Within the context of Node or 
relationship type definitions, these functions may only reference 
properties and attributes accessible starting from SELF (i.e. 
accessing a node by symbolic name is not meaningful).</p></li>
<li><p>Defining attribute mapping as part of the output parameter
definition 
is not allowed in interface type definitions (i.e. as part of 
operation definitions). It is allowed only in node and
relationship 
type definitions (as part of operation refinements) and has to be 
meaningful in the scope of the context (e.g. SELF).</p></li>
<li><p>Implementation artifact file names (e.g., script filenames)
may 
include file directory path names that are relative to the TOSCA
file 
file itself when packaged within a TOSCA Cloud Service Archive
(CSAR) 
file.</p></li>
</ul>
<p>The following code snippet shows an example operation definition:</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb217-1"><a aria-hidden="true" href="#cb217-1" tabindex="-1"></a><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb217-2"><a aria-hidden="true" href="#cb217-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Configure</span><span class="kw">:</span></span>
<span id="cb217-3"><a aria-hidden="true" href="#cb217-3" tabindex="-1"></a><span class="at">    </span><span class="fu">pre_configure_source</span><span class="kw">:</span></span>
<span id="cb217-4"><a aria-hidden="true" href="#cb217-4" tabindex="-1"></a><span class="at">      </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb217-5"><a aria-hidden="true" href="#cb217-5" tabindex="-1"></a><span class="at">        </span><span class="fu">primary</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb217-6"><a aria-hidden="true" href="#cb217-6" tabindex="-1"></a><span class="at">          </span><span class="fu">file</span><span class="kw">:</span><span class="at"> scripts/pre_configure_source.sh</span></span>
<span id="cb217-7"><a aria-hidden="true" href="#cb217-7" tabindex="-1"></a><span class="at">          </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Bash</span></span>
<span id="cb217-8"><a aria-hidden="true" href="#cb217-8" tabindex="-1"></a><span class="at">          </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> my_service_catalog</span></span>
<span id="cb217-9"><a aria-hidden="true" href="#cb217-9" tabindex="-1"></a><span class="at">        </span><span class="fu">dependencies</span><span class="kw">:</span></span>
<span id="cb217-10"><a aria-hidden="true" href="#cb217-10" tabindex="-1"></a><span class="at">           </span><span class="kw">-</span><span class="at"> </span><span class="fu">file </span><span class="kw">:</span><span class="at"> scripts/setup.sh</span></span>
<span id="cb217-11"><a aria-hidden="true" href="#cb217-11" tabindex="-1"></a><span class="at">             </span><span class="fu">type </span><span class="kw">:</span><span class="at"> Bash</span></span>
<span id="cb217-12"><a aria-hidden="true" href="#cb217-12" tabindex="-1"></a><span class="at">             </span><span class="fu">repository </span><span class="kw">:</span><span class="at"> my_service_catalog</span></span></code></pre></div>
<p>The next example shows single-line grammar for the operation
implementation:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb218-1"><a aria-hidden="true" href="#cb218-1" tabindex="-1"></a><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb218-2"><a aria-hidden="true" href="#cb218-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Configure</span><span class="kw">:</span></span>
<span id="cb218-3"><a aria-hidden="true" href="#cb218-3" tabindex="-1"></a><span class="at">    </span><span class="fu">pre_configure_source</span><span class="kw">:</span></span>
<span id="cb218-4"><a aria-hidden="true" href="#cb218-4" tabindex="-1"></a><span class="at">      </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb218-5"><a aria-hidden="true" href="#cb218-5" tabindex="-1"></a><span class="at">        </span><span class="fu">primary</span><span class="kw">:</span><span class="at"> scripts/pre_configure_source.sh</span></span>
<span id="cb218-6"><a aria-hidden="true" href="#cb218-6" tabindex="-1"></a><span class="at">        </span><span class="fu">dependencies</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb218-7"><a aria-hidden="true" href="#cb218-7" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> scripts/setup.sh</span></span>
<span id="cb218-8"><a aria-hidden="true" href="#cb218-8" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> binaries/library.rpm</span></span>
<span id="cb218-9"><a aria-hidden="true" href="#cb218-9" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> scripts/register.py</span></span></code></pre></div>
<p>The following code snippet shows an example of the single-line
grammar 
for the entire operation definitions:</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb219-1"><a aria-hidden="true" href="#cb219-1" tabindex="-1"></a><span class="fu">interfaces</span><span class="kw">:</span></span>
<span id="cb219-2"><a aria-hidden="true" href="#cb219-2" tabindex="-1"></a><span class="at">  </span><span class="fu">Standard</span><span class="kw">:</span></span>
<span id="cb219-3"><a aria-hidden="true" href="#cb219-3" tabindex="-1"></a><span class="at">    </span><span class="fu">start</span><span class="kw">:</span><span class="at"> scripts/start_server.sh</span></span></code></pre></div>
<h2 id="operation-assignment">11.5 Operation Assignment</h2>
<p>An operation assignment may be used to assign values for input 
parameters, specify attribute mappings for output parameters, and 
define/redefine the implementation definition of an already
defined 
operation in the interface definition. An operation assignment may
be 
used inside interface assignments inside node template or
relationship 
template definitions (this includes when operation assignments are
part 
of a requirement assignment in a node template).</p>
<p>An operation assignment may add or change the implementation
and 
description definition of the operation. Assigning a value to an
input 
parameter that had a fixed value specified during operation
definition 
or refinement is not allowed. Providing an attribute mapping for
an 
output parameter that was mapped during an operation refinement is
also 
not allowed.</p>
<p>Note also that in the operation assignment we can use inputs and
outputs 
that have not been previously defined in the operation definition.
This 
is equivalent to an ad-hoc definition of a parameter, where the type
is 
inferred from the assigned value (for input parameters) or from
the 
attribute to map to (for output parameters).</p>
<p>The following is the list of recognized keynames for an
operation 
assignment:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">implementation</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">operation implementation definition</td>
<td style="text-align: left;">The optional definition of the operation
implementation. Overrides implementation provided at operation
definition.</td>
</tr>
<tr class="even">
<td style="text-align: left;">inputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter value assignments</td>
<td style="text-align: left;">The optional map of parameter value
assignments for assigning values to operation inputs.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">outputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter mapping assignments</td>
<td style="text-align: left;">The optional map of parameter mapping
assignments that specify how operation outputs are mapped onto
attributes of the node or relationship that contains the operation
definition.</td>
</tr>
</tbody>
</table>
<p>Operation assignments have the following grammar:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb220-1"><a aria-hidden="true" href="#cb220-1" tabindex="-1"></a><span class="fu">&lt;operation_name&gt;</span><span class="kw">:</span></span>
<span id="cb220-2"><a aria-hidden="true" href="#cb220-2" tabindex="-1"></a><span class="at">   </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> &lt;operation_implementation_definition&gt;</span></span>
<span id="cb220-3"><a aria-hidden="true" href="#cb220-3" tabindex="-1"></a><span class="at">   </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_value_assignments&gt;</span></span>
<span id="cb220-4"><a aria-hidden="true" href="#cb220-4" tabindex="-1"></a><span class="at">   </span><span class="fu">outputs</span><span class="kw">:</span><span class="at"> &lt;parameter_mapping_assignments&gt;</span></span></code></pre></div>
<p>The following single-line grammar may be used when the
operation’s 
implementation definition is the only keyname that is needed, and
when 
the operation implementation definition itself can be specified using
a 
single line grammar:</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb221-1"><a aria-hidden="true" href="#cb221-1" tabindex="-1"></a><span class="fu">&lt;operation_name&gt;</span><span class="kw">:</span><span class="at"> &lt;operation_implementation_definition&gt;</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>operation_name: represents the mandatory symbolic name of
the 
operation as a string.</p></li>
<li><p>operation_implementation_definition: represents the
optional 
specification of the operation’s implementation</p>
<ul>
<li>the implementation declared here overrides the implementation
provided<br/>
at operation definition.</li>
</ul></li>
<li><p>parameter_value_assignments: represents the optional map of
parameter 
value assignments for passing input parameter values to operations.</p>
<ul>
<li>assignments for operation inputs that are not defined in the
operation<br/>
definition may be provided</li>
</ul></li>
<li><p>parameter_mapping_assignments: represents the optional map
of 
parameter mapping assignments that consists of named output values 
returned by operation implementations (i.e. artifacts) and
associated 
attributes into which this output value must be stored</p>
<ul>
<li>assignments for operation outputs that are not defined in the<br/>
operation definition may be provided.</li>
</ul></li>
</ul>
<p>The following additional requirements apply:</p>
<ul>
<li><p>The behavior for implementation of operations SHALL be override.
That 
is, implementation definitions assigned in an operation assignment 
override any defined in the operation definition.</p></li>
<li><p>Template authors MAY provide parameter assignments for
operation 
inputs that are not defined in the operation definition.</p></li>
<li><p>Template authors MAY provide attribute mappings for operation
outputs 
that are not defined in the operation definition.</p></li>
<li><p>Implementation artifact file names (e.g., script filenames)
may 
include file directory path names that are relative to the TOSCA
file 
file itself when packaged within a TOSCA Cloud Service Archive
(CSAR) 
file.</p></li>
</ul>
<h2 id="notification-definition">11.6 Notification Definition</h2>
<p>A notification definition defines an asynchronous notification
or 
incoming message that can be associated with an interface. The 
notification is a way for events generated by external 
implementations to be transmitted to the TOSCA orchestrator.
Values 
can be sent with a notification as notification outputs and can be 
mapped to node/relationship attributes similarly to the way
operation 
outputs are mapped to attributes. The artifact that the
orchestrator 
is registering with in order to receive the notification is
specified 
using the implementation keyname in a similar way to 
operations. Artifacts registered to recieve events may be configured by
means of parameters provided under the inputs keyword of the
notification definition.</p>
<p>When the notification is received an event is generated within
the 
orchestrator that can be associated to triggers in policies to
call 
other internal operations and workflows. The notification name
(using 
the &lt;interface_name&gt;.&lt;notification_name&gt; notation) itself
identifies 
the event type that is generated and can be textually used when
defining 
the associated triggers.</p>
<p>A notification definition may be used only inside interface
type 
definitions (this is the only place where new notifications can be 
defined). Inside interface type, node type, or relationship type 
definitions (including notifications definitions as part of a 
requirement definition) we may further refine a notification
already 
defined in the interface type.</p>
<p>A notification definition or refinement inside an interface
type 
definition may not contain a notification implementation definition
and 
it may not contain an attribute mapping as part of its output
definition 
(as both these keynames are node/relationship specific).</p>
<p>The following is the list of recognized keynames for a TOSCA 
notification definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional description string for the
associated notification.</td>
</tr>
<tr class="even">
<td style="text-align: left;">implementation</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">notification implementation
definition</td>
<td style="text-align: left;">The optional definition of the
notification implementation.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">inputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter definitions</td>
<td style="text-align: left;">The optional map of parameter definitions
for notification input values.</td>
</tr>
<tr class="even">
<td style="text-align: left;">outputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter definitions</td>
<td style="text-align: left;">The optional map of parameter definitions
that specify notification output values. Only as part of node and
relationship type definitions, the output definitions may include their
mappings onto attributes of the node type or relationship type that
contains the definition.</td>
</tr>
</tbody>
</table>
<p>Notification definitions have the following grammar:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb222-1"><a aria-hidden="true" href="#cb222-1" tabindex="-1"></a><span class="fu">&lt;notification_name&gt;</span><span class="kw">:</span></span>
<span id="cb222-2"><a aria-hidden="true" href="#cb222-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;notification_description&gt;</span></span>
<span id="cb222-3"><a aria-hidden="true" href="#cb222-3" tabindex="-1"></a><span class="at">  </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> &lt;notification_implementation_definition&gt;</span></span>
<span id="cb222-4"><a aria-hidden="true" href="#cb222-4" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_definitions&gt;</span></span>
<span id="cb222-5"><a aria-hidden="true" href="#cb222-5" tabindex="-1"></a><span class="at">  </span><span class="fu">outputs</span><span class="kw">:</span><span class="at"> &lt;parameter_definitions&gt;</span></span></code></pre></div>
<p>The following single-line grammar may be used when the
notification’s 
implementation definition is the only keyname that is needed and
when 
the notification implementation definition itself can be specified
using 
a single line grammar:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb223-1"><a aria-hidden="true" href="#cb223-1" tabindex="-1"></a><span class="fu">&lt;notification_name&gt;</span><span class="kw">:</span><span class="at"> &lt;notification_implementation_definition&gt; </span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>notification_name: represents the mandatory symbolic name of
the 
notification as a string.</p></li>
<li><p>notification_description: represents the optional description
string 
for the notification.</p></li>
<li><p>notification_implementation_definition: represents the
optional 
specification of the notification implementation (i.e. the
external 
artifact that may send notifications)</p></li>
<li><p>parameter_definitions: represents the optional map of
parameter 
definitions for parameters that the orchestrator will make
available 
as inputs or receive as outputs from the corresponding 
implementation artifact during its execution.</p></li>
</ul>
<p>A notification definition within an interface, node, or
relationship 
type (including interface definitions in requirements definitions)
uses 
the following refinement rules when the containing entity type is 
derived:</p>
<ul>
<li><p>description: a new definition is unrestricted and will overwrite
the 
one inherited from the notification definition in the parent
entity 
type definition.</p></li>
<li><p>implementation: a new definition is unrestricted and will
overwrite 
the one inherited from the notification definition in the parent 
entity type definition.</p></li>
<li><p>inputs: parameter definitions inherited from the parent entity
type 
may be refined; new parameter definitions may be added.</p></li>
<li><p>outputs: parameter definitions inherited from the parent entity
type 
may be refined; new parameter definitions may be added.</p></li>
</ul>
<p>The following additional requirements apply:</p>
<ul>
<li><p>The definition of implementation is not allowed in interface
type 
definitions (as a node or node type context is missing at that
point). 
Thus, it can be part only of a notification refinement and not of
the 
original notification definition.</p></li>
<li><p>The default sub-classing (i.e. refinement) behavior for 
implementations of notifications SHALL be overwrite. That is, 
implementation artifacts definitions in a derived type overwrite
any 
defined in its parent type.</p></li>
<li><p>Defining attribute mapping as part of the output parameter
definition 
is not allowed in interface type definitions (i.e. as part of 
operation definitions). It is allowed only in node and
relationship 
type definitions (as part of operation refinements).</p></li>
<li><p>Defining a mapping in an output parameter definition may use
an 
attribute target that is meaningful in the scope of the context. 
Within the context of Node or relationship type definitions these 
functions may only reference attributes starting from the same
node 
(i.e. SELF).</p></li>
<li><p>Implementation artifact file names (e.g., script filenames)
may 
include file directory path names that are relative to the TOSCA
file 
file itself when packaged within a TOSCA Cloud Service Archive
(CSAR) 
file.</p></li>
</ul>
<h2 id="notification-assignment">11.7 Notification Assignment</h2>
<p>A notification assignment may be used to specify attribute mappings
for 
output parameters and to define/redefine the implementation
definition 
and description definition of an already defined notification in
the 
interface definition. A notification assignment may be used inside 
interface assignments which are themselves inside node or relationship
template definitions 
(this includes when notification assignments are part of a
requirement 
assignment in a node template).</p>
<p>Providing an attribute mapping for an output parameter that was
mapped 
during a previous refinement is not allowed. Note also that in the 
notification assignment we can use outputs that have not been
previously 
defined in the operation definition. This is equivalent to an
ad-hoc 
definition of an output parameter, where the type is inferred from
the 
attribute to map to.</p>
<p>The following is the list of recognized keynames for a TOSCA 
notification assignment:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">implementation</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">notification implementation
definition</td>
<td style="text-align: left;">The optional definition of the
notification implementation. Overrides implementation provided at
notification definition.</td>
</tr>
<tr class="even">
<td style="text-align: left;">inputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter value assignments</td>
<td style="text-align: left;">The optional map of parameter value
assignments for assigning values to notification inputs.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">outputs</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of parameter mapping assignments</td>
<td style="text-align: left;">The optional map of parameter mapping
assignments that specify how notification outputs values are mapped onto
attributes of the node or relationship type that contains the
notification definition.</td>
</tr>
</tbody>
</table>
<p>Notification assignments have the following grammar:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb224-1"><a aria-hidden="true" href="#cb224-1" tabindex="-1"></a><span class="fu">&lt;notification_name&gt;</span><span class="kw">:</span></span>
<span id="cb224-2"><a aria-hidden="true" href="#cb224-2" tabindex="-1"></a><span class="at">  </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> &lt;notification_implementation_definition&gt;</span></span>
<span id="cb224-3"><a aria-hidden="true" href="#cb224-3" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_value_assignments&gt;</span></span>
<span id="cb224-4"><a aria-hidden="true" href="#cb224-4" tabindex="-1"></a><span class="at">  </span><span class="fu">outputs</span><span class="kw">:</span><span class="at"> &lt;parameter_mapping_assignments&gt;</span></span></code></pre></div>
<p>The following single-line grammar may be used when the
notification’s 
implementation definition is the only keyname that is needed, and
when 
the notification implementation definition itself can be specified
using 
a single line grammar:</p>
<div class="sourceCode" id="cb225"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb225-1"><a aria-hidden="true" href="#cb225-1" tabindex="-1"></a><span class="fu">&lt;notification_name&gt;</span><span class="kw">:</span><span class="at"> &lt;notification_implementation_definition&gt; </span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>notification_name: represents the mandatory symbolic name of
the 
notification as a string.</p></li>
<li><p>notification_implementation_definition: represents the
optional 
specification of the notification implementation (i.e. the
external 
artifact that is may send notifications)</p>
<ul>
<li>the implementation declared here overrides the implementation
provided<br/>
at notification definition.</li>
</ul></li>
<li><p>parameter_value_assignments: represents the optional map of
parameter 
value assignments for passing input parameter values to
notifications.</p>
<ul>
<li>assignments for notification inputs that are not defined in the
notification<br/>
definition may be provided</li>
</ul></li>
<li><p>parameter_mapping_assignments: represents the optional map
of 
parameter_mapping_assignments that consists of named output values 
returned by notification implementations (i.e. artifacts) and
associated 
attributes into which this output value must be stored</p>
<ul>
<li>assignments for notification outputs that are not defined in
the<br/>
notification definition may be provided.</li>
</ul></li>
</ul>
<p>The following additional requirements apply:</p>
<ul>
<li><p>The behavior for implementation of notifications SHALL be
override. 
That is, implementation definitions assigned in a notification 
assignment override any defined in the notification definition.</p></li>
<li><p>Template authors MAY provide attribute mappings for
notification 
outputs that are not defined in the corresponding notification 
definition.</p></li>
<li><p>Implementation artifact file names (e.g., script filenames)
may 
include file directory path names that are relative to the TOSCA
file 
file itself when packaged within a TOSCA Cloud Service Archive
(CSAR) 
file.</p></li>
</ul>
<h2 id="operation-and-notification-implementations">11.8 Operation and
Notification Implementations</h2>
<p>An operation implementation definition specifies one or more
artifacts 
(e.g. scripts) to be used as the implementation for an operation in
an 
interface.</p>
<p>A notification implementation definition specifies one or more
artifacts 
to be used by the orchestrator to subscribe and receive a
particular 
notification (i.e. the artifact implements the notification).</p>
<p>The operation implementation definition and the notification 
implementation definition share the same keynames and grammar, with
the 
exception of the timeout keyname that has no meaning in the context of
a 
notification implementation definition and should not be used in
such.</p>
<p>The following is the list of recognized keynames for an
operation 
implementation definition or a notification implementation
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">primary</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">artifact definition</td>
<td style="text-align: left;">The optional implementation artifact
(i.e., the primary script file within a TOSCA CSAR file).</td>
</tr>
<tr class="even">
<td style="text-align: left;">dependencies</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of artifact definitions</td>
<td style="text-align: left;">The optional list of one or more dependent
or secondary implementation artifacts which are referenced by the
primary implementation artifact (e.g., a library the script installs or
a secondary script).</td>
</tr>
</tbody>
</table>
<p>Operation implementation definitions and notification
implementation 
definitions have the following grammar:</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb226-1"><a aria-hidden="true" href="#cb226-1" tabindex="-1"></a><span class="fu">implementation</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb226-2"><a aria-hidden="true" href="#cb226-2" tabindex="-1"></a><span class="at">  </span><span class="fu">primary</span><span class="kw">:</span><span class="at"> &lt;primary_artifact_definition&gt; | &lt;primary_artifact_name&gt;</span></span>
<span id="cb226-3"><a aria-hidden="true" href="#cb226-3" tabindex="-1"></a><span class="at">  </span><span class="fu">dependencies</span><span class="kw">:</span><span class="at"> &lt;list_of_dependent_artifacts&gt;</span></span></code></pre></div>
<p>The following single-line grammar may be used when only a
primary 
implementation artifact name is needed:</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb227-1"><a aria-hidden="true" href="#cb227-1" tabindex="-1"></a><span class="fu">implementation</span><span class="kw">:</span><span class="at"> &lt;primary_artifact_name&gt; </span></span></code></pre></div>
<p>This notation can be used when the primary artifact name
uniquely 
identifies the artifact because it refers to an artifact 
specified in the artifacts section of a type or template.</p>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>primary_artifact_definition: represents a full inline definition
of 
an artifact that can be used as an implementation of an operation
or 
notification.</p></li>
<li><p>primary_artifact_name: represents the symbolic name of an
artifact 
defined in the node type or node template that contains the 
interface operation or notification for which the implementation
is 
defined.</p></li>
<li><p>list_of_dependent_artifacts: represents the optional ordered list
of 
one or more dependent or secondary implementation artifacts. Each
of 
these artifacts can be defined using an inline artifact definition 
or using a symbolic name of an artifact that is defined in the
node 
type or node template that contains the interface operation or 
notification for which the implementation is defined.</p></li>
</ul>
<hr/>
<h1 id="artifacts">12 Artifacts</h1>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative. 
## 12.1 Artifact Type</p>
<p>An <em>artifact type</em> is a reusable entity that defines the type
of one or 
more files that are used to define implementation or deployment 
artifacts that are referenced by nodes or relationships.</p>
<p>An artifact type definition is a type of TOSCA type definition and
as 
a result supports the common keynames listed in <a href="#641-common-keynames-in-type-definitions">Section 
6.4.1</a>. In addition, the 
artifact type definition has the following recognized keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mime_type</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional mime type property for the
artifact type.</td>
</tr>
<tr class="even">
<td style="text-align: left;">file_ext</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">list of string</td>
<td style="text-align: left;">The optional file extension property for
the artifact type.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property definitions</td>
<td style="text-align: left;">An optional map of property definitions
for the artifact type.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb228"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb228-1"><a aria-hidden="true" href="#cb228-1" tabindex="-1"></a><span class="fu">&lt;artifact_type_name&gt;</span><span class="kw">:</span></span>
<span id="cb228-2"><a aria-hidden="true" href="#cb228-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;parent_artifact_type_name&gt;</span></span>
<span id="cb228-3"><a aria-hidden="true" href="#cb228-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb228-4"><a aria-hidden="true" href="#cb228-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at">  &lt;map of string&gt;</span></span>
<span id="cb228-5"><a aria-hidden="true" href="#cb228-5" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;artifact_description&gt;</span></span>
<span id="cb228-6"><a aria-hidden="true" href="#cb228-6" tabindex="-1"></a><span class="at">  </span><span class="fu">mime_type</span><span class="kw">:</span><span class="at"> &lt;mime_type_string&gt;</span></span>
<span id="cb228-7"><a aria-hidden="true" href="#cb228-7" tabindex="-1"></a><span class="at">  </span><span class="fu">file_ext</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;file_extensions&gt; </span><span class="kw">]</span></span>
<span id="cb228-8"><a aria-hidden="true" href="#cb228-8" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_definitions&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>artifact_type_name: represents the name of the artifact type
being 
declared as a string.</p></li>
<li><p>parent_artifact_type_name: represents the name of the artifact
type 
this artifact type definition derives from (i.e., its “parent”
type).</p></li>
<li><p>mime_type_string: represents the optional Multipurpose Internet
Mail 
Extensions (MIME) standard string value that describes the file 
contents for this type of artifact type as a string. The mime_type 
keyname is meant to have values that are Apache mime types such as 
those defined here: <a class="uri" href="http://svn.apache.org/repos/asf/httpd/httpd/trunk/docs/conf/mime.types">http://svn.apache.org/repos/asf/httpd/httpd/trunk/docs/conf/mime.types</a> <br/></p></li>
<li><p>file_extensions: represents the optional list of one or
more 
recognized file extensions for this type of artifact type as
strings.</p></li>
<li><p>property_definitions: represents the optional map of
property 
definitions for the artifact type.</p></li>
</ul>
<p>During artifact type derivation the keyname definitions follow
these 
rules:</p>
<ul>
<li><p>mime_type: a new definition is unrestricted and will overwrite
the one 
inherited from the parent type.</p></li>
<li><p>file_ext: a new definition is unrestricted and will overwrite the
one 
inherited from the parent type.</p></li>
<li><p>properties: existing property definitions may be refined; new
property 
definitions may be added.</p></li>
</ul>
<p>The following shows an example artifact type definition:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb229-1"><a aria-hidden="true" href="#cb229-1" tabindex="-1"></a><span class="fu">my_artifact_type</span><span class="kw">:</span></span>
<span id="cb229-2"><a aria-hidden="true" href="#cb229-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Java Archive artifact type</span></span>
<span id="cb229-3"><a aria-hidden="true" href="#cb229-3" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> Root</span></span>
<span id="cb229-4"><a aria-hidden="true" href="#cb229-4" tabindex="-1"></a><span class="at">  </span><span class="fu">mime_type</span><span class="kw">:</span><span class="at"> application/java-archive</span></span>
<span id="cb229-5"><a aria-hidden="true" href="#cb229-5" tabindex="-1"></a><span class="at">  </span><span class="fu">file_ext</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> jar </span><span class="kw">]</span></span>
<span id="cb229-6"><a aria-hidden="true" href="#cb229-6" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb229-7"><a aria-hidden="true" href="#cb229-7" tabindex="-1"></a><span class="at">    </span><span class="fu">id</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb229-8"><a aria-hidden="true" href="#cb229-8" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Identifier of the jar</span></span>
<span id="cb229-9"><a aria-hidden="true" href="#cb229-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb229-10"><a aria-hidden="true" href="#cb229-10" tabindex="-1"></a><span class="at">      </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb229-11"><a aria-hidden="true" href="#cb229-11" tabindex="-1"></a><span class="at">    </span><span class="fu">creator</span><span class="kw">:</span></span>
<span id="cb229-12"><a aria-hidden="true" href="#cb229-12" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Vendor of the java implementation on which the jar is based</span></span>
<span id="cb229-13"><a aria-hidden="true" href="#cb229-13" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> string</span></span>
<span id="cb229-14"><a aria-hidden="true" href="#cb229-14" tabindex="-1"></a><span class="at">      </span><span class="fu">required</span><span class="kw">:</span><span class="at"> </span><span class="ch">false</span></span></code></pre></div>
<p>Information about artifacts can be broadly classified in two
categories 
that serve different purposes:</p>
<ul>
<li><p>Selection of artifact processor. This category includes
informational 
elements such as artifact version, checksum, checksum algorithm
etc. 
and is used by TOSCA Orchestrator to select the correct artifact 
processor for the artifact. These informational elements are
captured 
in TOSCA as keywords for the artifact.</p></li>
<li><p>Properties processed by artifact processor. Some properties are
not 
processed by the Orchestrator but passed on to the artifact
processor 
to assist with proper processing of the artifact. These
informational 
elements are described through artifact properties.</p></li>
</ul>
<h2 id="artifact-definition">12.2 Artifact definition</h2>
<p>An artifact definition defines a named, typed file that can be 
associated with a node type or node template and used by a TOSCA 
Orchestrator to facilitate deployment and implementation of
interface 
operations.</p>
<p>The following is the list of recognized keynames for a TOSCA
artifact 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">type</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The mandatory artifact type for the
artifact definition.</td>
</tr>
<tr class="even">
<td style="text-align: left;">file</td>
<td style="text-align: left;">yes</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The mandatory URI string (relative or
absolute) that can be used to locate the artifact’s file.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">repository</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional name of the repository
definition that contains the location of the external repository that
contains the artifact. The artifact is expected to be referenceable by
its file URI within the repository.</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The optional description for the artifact
definition.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">metadata</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of metadata</td>
<td style="text-align: left;">Defines additional metadata
information.</td>
</tr>
<tr class="even">
<td style="text-align: left;">artifact_version</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The version of this artifact. One use of
this artifact_version is to declare the particular version of this
artifact type, in addition to its mime_type (that is declared in the
artifact type definition). Together with the mime_type it may be used to
select a particular artifact processor for this artifact. For example, a
python interpreter that can interpret python version 2.7.0.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">checksum</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">The checksum used to validate the
integrity of the artifact.</td>
</tr>
<tr class="even">
<td style="text-align: left;">checksum_algorithm</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">string</td>
<td style="text-align: left;">Algorithm used to calculate the artifact
checksum (e.g. MD5, SHA [Ref]). Shall be specified if checksum is
specified for an artifact.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">properties</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">map of property assignments</td>
<td style="text-align: left;">The optional map of property assignments
associated with the artifact.</td>
</tr>
</tbody>
</table>
<p>Artifact definitions have the following grammar:</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb230-1"><a aria-hidden="true" href="#cb230-1" tabindex="-1"></a><span class="fu">&lt;artifact_name&gt;</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb230-2"><a aria-hidden="true" href="#cb230-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;artifact_description&gt;</span></span>
<span id="cb230-3"><a aria-hidden="true" href="#cb230-3" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map_of_metadata&gt;</span></span>
<span id="cb230-4"><a aria-hidden="true" href="#cb230-4" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;artifact_type_name&gt;</span></span>
<span id="cb230-5"><a aria-hidden="true" href="#cb230-5" tabindex="-1"></a><span class="at">  </span><span class="fu">file</span><span class="kw">:</span><span class="at"> &lt;artifact_file_uri&gt;</span></span>
<span id="cb230-6"><a aria-hidden="true" href="#cb230-6" tabindex="-1"></a><span class="at">  </span><span class="fu">repository</span><span class="kw">:</span><span class="at"> &lt;artifact_repository_name&gt;</span></span>
<span id="cb230-7"><a aria-hidden="true" href="#cb230-7" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;artifact _version&gt;</span></span>
<span id="cb230-8"><a aria-hidden="true" href="#cb230-8" tabindex="-1"></a><span class="at">  </span><span class="fu">checksum</span><span class="kw">:</span><span class="at"> &lt;artifact_checksum&gt;</span></span>
<span id="cb230-9"><a aria-hidden="true" href="#cb230-9" tabindex="-1"></a><span class="at">  </span><span class="fu">checksum_algorithm</span><span class="kw">:</span><span class="at"> &lt;artifact_checksum_algorithm&gt;</span></span>
<span id="cb230-10"><a aria-hidden="true" href="#cb230-10" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property assignments&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>artifact_name: represents the mandatory symbolic name of the
artifact 
as a string.</p></li>
<li><p>artifact_type_name: represents the mandatory artifact type
the 
artifact definition is based upon.</p></li>
<li><p>artifact_file_uri: represents the mandatory URI string (relative
or 
absolute) which can be used to locate the artifact’s file.</p></li>
<li><p>artifact_repository_name: represents the optional name of
the 
repository definition to use to retrieve the associated artifact 
(file) from.</p></li>
<li><p>artifact_version: represents the version of artifact</p></li>
<li><p>artifact_checksum: represents the checksum of the
Artifact</p></li>
<li><p>artifact_checksum_algorithm:represents the algorithm for
verifying the 
checksum. Shall be specified if checksum is specified</p></li>
<li><p>properties: represents an optional map of property
assignments 
associated with the artifact</p></li>
</ul>
<p>Artifact definitions represent specific external entities. If a
certain 
artifact definition cannot be reused as is, then it may be
completely 
redefined.</p>
<ul>
<li><p>If an artifact is redefined, the symbolic name from the
definition in 
the parent node type is reused, but no keyname definitions are 
inherited from the definition in the parent node type, and the new 
definition completely overwrites the definition in the parent.</p></li>
<li><p>If the artifact is not redefined the complete definition is
inherited 
from the parent node type.</p></li>
</ul>
<p>The following example represents an artifact definition with
property 
assignments:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb231-1"><a aria-hidden="true" href="#cb231-1" tabindex="-1"></a><span class="fu">artifacts</span><span class="kw">:</span></span>
<span id="cb231-2"><a aria-hidden="true" href="#cb231-2" tabindex="-1"></a><span class="at">  </span><span class="fu">sw_image</span><span class="kw">:</span></span>
<span id="cb231-3"><a aria-hidden="true" href="#cb231-3" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Image for virtual machine</span></span>
<span id="cb231-4"><a aria-hidden="true" href="#cb231-4" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> tosca.artifacts.Deployment.Image.VM</span></span>
<span id="cb231-5"><a aria-hidden="true" href="#cb231-5" tabindex="-1"></a><span class="at">    </span><span class="fu">file</span><span class="kw">:</span><span class="at"> http://10.10.86.141/images/Juniper_vSRX_15.1x49_D80_preconfigured.qcow2</span></span>
<span id="cb231-6"><a aria-hidden="true" href="#cb231-6" tabindex="-1"></a><span class="at">    </span><span class="fu">checksum</span><span class="kw">:</span><span class="at"> ba411cafee2f0f702572369da0b765e2</span></span>
<span id="cb231-7"><a aria-hidden="true" href="#cb231-7" tabindex="-1"></a><span class="at">    </span><span class="fu">version</span><span class="kw">:</span><span class="at"> </span><span class="fl">3.2</span></span>
<span id="cb231-8"><a aria-hidden="true" href="#cb231-8" tabindex="-1"></a><span class="at">    </span><span class="fu">checksum_algorithm</span><span class="kw">:</span><span class="at"> MD5</span></span>
<span id="cb231-9"><a aria-hidden="true" href="#cb231-9" tabindex="-1"></a><span class="at">    </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb231-10"><a aria-hidden="true" href="#cb231-10" tabindex="-1"></a><span class="at">      </span><span class="fu">name</span><span class="kw">:</span><span class="at"> vSRX</span></span>
<span id="cb231-11"><a aria-hidden="true" href="#cb231-11" tabindex="-1"></a><span class="at">      </span><span class="fu">container_format</span><span class="kw">:</span><span class="at"> BARE</span></span>
<span id="cb231-12"><a aria-hidden="true" href="#cb231-12" tabindex="-1"></a><span class="at">      </span><span class="fu">disk_format</span><span class="kw">:</span><span class="at"> QCOW2</span></span>
<span id="cb231-13"><a aria-hidden="true" href="#cb231-13" tabindex="-1"></a><span class="at">      </span><span class="fu">min_disk</span><span class="kw">:</span><span class="at"> 1 GB</span></span>
<span id="cb231-14"><a aria-hidden="true" href="#cb231-14" tabindex="-1"></a><span class="at">      </span><span class="fu">size</span><span class="kw">:</span><span class="at"> 649 MB</span></span></code></pre></div>
<hr/>
<h1 id="workflows-1">13 Workflows</h1>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative. 
## 13.1 Declarative Workflows</p>
<blockquote>
<p>State that declarative workflows are automatically 
generated. Specific steps for how to do this is profile 
specific. Orchestrators that support certain profiles are expected 
to know how to create declarative workflows for those profiles.</p>
</blockquote>
<h2 id="imperative-workflows">13.2 Imperative Workflows</h2>
<p>A workflow definition defines an imperative workflow that is
associated 
with a TOSCA service. A workflow definition can either include the
steps 
that make up the workflow, or it can refer to an artifact that
expresses 
the workflow using an external workflow language.</p>
<p>The following is the list of recognized keynames for a TOSCA
workflow 
definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>description</td>
<td>no</td>
<td>string</td>
<td>The optional description for the workflow definition.</td>
</tr>
<tr class="even">
<td>metadata</td>
<td>no</td>
<td>map of string</td>
<td>Defines a section used to declare additional metadata
information.</td>
</tr>
<tr class="odd">
<td>inputs</td>
<td>no</td>
<td>map of parameter definitions</td>
<td>The optional map of input parameter definitions.</td>
</tr>
<tr class="even">
<td>precondition</td>
<td>no</td>
<td>condition clause</td>
<td>Condition clause that must evaluate to true before the workflow can
be processed.</td>
</tr>
<tr class="odd">
<td>steps</td>
<td>no</td>
<td>map of step definitions</td>
<td>An optional map of valid imperative workflow step definitions.</td>
</tr>
<tr class="even">
<td>implementation</td>
<td>no</td>
<td>operation implementation definition</td>
<td>The optional definition of an external workflow definition. This
keyname is mutually exclusive with the steps keyname above.</td>
</tr>
<tr class="odd">
<td>outputs</td>
<td>no</td>
<td>map of attribute mappings</td>
<td>The optional map of attribute mappings that specify workflow output
values and their mappings onto attributes of a node or relationship
defined in the service.</td>
</tr>
</tbody>
</table>
<p>Imperative workflow definitions have the following grammar:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb232-1"><a aria-hidden="true" href="#cb232-1" tabindex="-1"></a><span class="fu">&lt;workflow_name&gt;</span><span class="kw">:</span></span>
<span id="cb232-2"><a aria-hidden="true" href="#cb232-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;workflow_description&gt;</span></span>
<span id="cb232-3"><a aria-hidden="true" href="#cb232-3" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map of YAML values&gt;</span></span>
<span id="cb232-4"><a aria-hidden="true" href="#cb232-4" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_definitions&gt;</span></span>
<span id="cb232-5"><a aria-hidden="true" href="#cb232-5" tabindex="-1"></a><span class="at">  </span><span class="fu">precondition</span><span class="kw">:</span><span class="at"> &lt;condition_clause&gt;</span></span>
<span id="cb232-6"><a aria-hidden="true" href="#cb232-6" tabindex="-1"></a><span class="at">  </span><span class="fu">steps</span><span class="kw">:</span><span class="at"> &lt;workflow_steps&gt;</span></span>
<span id="cb232-7"><a aria-hidden="true" href="#cb232-7" tabindex="-1"></a><span class="at">  </span><span class="fu">implementation</span><span class="kw">:</span><span class="at"> &lt;operation_implementation_definitions&gt;</span></span>
<span id="cb232-8"><a aria-hidden="true" href="#cb232-8" tabindex="-1"></a><span class="at">  </span><span class="fu">outputs</span><span class="kw">:</span><span class="at"> &lt;attribute_mappings&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>workflow_name:</p></li>
<li><p>workflow_description:</p></li>
<li><p>parameter_definitions:</p></li>
<li><p>condition_clause:</p></li>
<li><p>workflow_steps:</p></li>
<li><p>operation_implementation_definition: represents a full
inline 
definition of an implementation artifact</p></li>
<li><p>attribute_mappings: represents the optional map of
attribute_mappings 
that consists of named output values returned by operation 
implementations (i.e. artifacts) and associated mappings that
specify 
the attribute into which this output value must be stored.</p></li>
</ul>
<h3 id="workflow-precondition-definition">13.2.1 Workflow Precondition
Definition</h3>
<p>A workflow precondition defines a condition clause that checks if
a 
workflow can be processed or not based on the state of the instances
of 
a TOSCA service deployment. If the condition is not met, the
workflow 
will not be triggered.</p>
<blockquote>
<p>Examples TO BE PROVIDED</p>
</blockquote>
<h3 id="workflow-step-definition">13.2.2 Workflow Step Definition</h3>
<p>A workflow step allows to define one or multiple sequenced activities
in 
a workflow and how they are connected to other steps in the
workflow. 
They are the building blocks of a declarative workflow.</p>
<p>The following is the list of recognized keynames for a TOSCA
workflow 
step definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>target</td>
<td>yes</td>
<td>string</td>
<td>The target of the step (this can be a node template name, a group
name)</td>
</tr>
<tr class="even">
<td>target_relationship</td>
<td>no</td>
<td>string</td>
<td>The optional name of a requirement of the target in case the step
refers to a relationship rather than a node or group. Note that this is
applicable only if the target is a node.</td>
</tr>
<tr class="odd">
<td>filter</td>
<td>no</td>
<td>list of validation clauses</td>
<td>Filter is a list of validation clauses that allows to provide a
filtering logic.</td>
</tr>
<tr class="even">
<td>activities</td>
<td>yes</td>
<td>list of activity definition</td>
<td>The list of sequential activities to be performed in this step.</td>
</tr>
<tr class="odd">
<td>on_success</td>
<td>no</td>
<td>list of string</td>
<td>The optional list of step names to be performed after this one has
been completed with success (all activities has been correctly
processed).</td>
</tr>
<tr class="even">
<td>on_failure</td>
<td>no</td>
<td>list of string</td>
<td>The optional list of step names to be called after this one in case
one of the step activity failed.</td>
</tr>
</tbody>
</table>
<p>Workflow step definitions have the following grammars:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb233-1"><a aria-hidden="true" href="#cb233-1" tabindex="-1"></a><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb233-2"><a aria-hidden="true" href="#cb233-2" tabindex="-1"></a><span class="at">  &lt;step_name&gt;</span></span>
<span id="cb233-3"><a aria-hidden="true" href="#cb233-3" tabindex="-1"></a><span class="at">    </span><span class="fu">target</span><span class="kw">:</span><span class="at"> &lt;target_name&gt;</span></span>
<span id="cb233-4"><a aria-hidden="true" href="#cb233-4" tabindex="-1"></a><span class="at">    </span><span class="fu">target_relationship</span><span class="kw">:</span><span class="at"> &lt;target_requirement_name&gt;</span></span>
<span id="cb233-5"><a aria-hidden="true" href="#cb233-5" tabindex="-1"></a><span class="at">    </span><span class="fu">filter</span><span class="kw">:</span><span class="at"> &lt;list_of_condition_clause_definition&gt;</span></span>
<span id="cb233-6"><a aria-hidden="true" href="#cb233-6" tabindex="-1"></a><span class="at">    </span><span class="fu">activities</span><span class="kw">:</span><span class="at"> &lt;list_of_activity_definition&gt;</span></span>
<span id="cb233-7"><a aria-hidden="true" href="#cb233-7" tabindex="-1"></a><span class="at">    </span><span class="fu">on_success</span><span class="kw">:</span><span class="at"> &lt;target_step_name&gt;</span></span>
<span id="cb233-8"><a aria-hidden="true" href="#cb233-8" tabindex="-1"></a><span class="at">    </span><span class="fu">on_failure</span><span class="kw">:</span><span class="at"> &lt;target_step_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>target_name: represents the name of a node template or group in
the 
service.</p></li>
<li><p>target_requirement_name: represents the name of a requirement of
the 
node template (in case target_name refers to a node template.</p></li>
<li><p>list_of_condition_clause_definition: represents a list of 
condition clause definitions.</p></li>
<li><p>list_of_activity_definition: represents a list of activity 
definitions.</p></li>
<li><p>target_step_name: represents the name of another step of
the 
workflow.</p></li>
</ul>
<h3 id="activity-definition">13.2.3 Activity Definition</h3>
<p>An activity defines an operation to be performed in a TOSCA
workflow 
step or in an action body of a policy trigger. Activity definitions
can 
be of the following types:</p>
<ul>
<li><p>Delegate workflow activity definition:</p>
<ul>
<li>Defines the name of the delegate workflow and optional input<br/>
assignments. This activity requires the target to be provided by
the<br/>
orchestrator (no-op node or relationship).</li>
</ul></li>
<li><p>Set state activity definition:</p>
<ul>
<li>Sets the state of a node.</li>
</ul></li>
<li><p>Call operation activity definition:</p>
<ul>
<li>Calls an operation defined on a TOSCA interface of a node,<br/>
relationship or group. The operation name uses the<br/>
&lt;interface_name&gt;.&lt;operation_name&gt; notation.
Optionally,<br/>
assignments for the operation inputs can also be provided. If<br/>
provided, they will override for this operation call the operation<br/>
inputs assignment in the node template.</li>
</ul></li>
<li><p>Inline workflow activity definition:</p>
<ul>
<li>Inlines another workflow defined in the service (allowing<br/>
reusability). The definition includes the name of a workflow to be<br/>
inlined and optional workflow input assignments.</li>
</ul></li>
</ul>
<h4 id="delegate-workflow-activity-definition">13.2.3.1 Delegate
Workflow Activity Definition</h4>
<p>The following is a list of recognized keynames for a delegate
activity 
definition.</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>delegate</td>
<td>yes</td>
<td>string or empty (see grammar below)</td>
<td>Defines the name of the delegate workflow and optional input
assignments. This activity requires the target to be provided by the
orchestrator (no-op node or relationship).</td>
</tr>
<tr class="even">
<td>workflow</td>
<td>no</td>
<td>string</td>
<td>The name of the delegate workflow. Mandatory in the extended
notation.</td>
</tr>
<tr class="odd">
<td>inputs</td>
<td>no</td>
<td>map of parameter assignments</td>
<td>The optional map of input parameter assignments for the delegate
workflow.</td>
</tr>
</tbody>
</table>
<p>A delegate activity definition has the following grammar.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb234-1"><a aria-hidden="true" href="#cb234-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">delegate</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb234-2"><a aria-hidden="true" href="#cb234-2" tabindex="-1"></a><span class="at">   </span><span class="fu">workflow</span><span class="kw">:</span><span class="at"> &lt;delegate_workflow_name&gt;</span></span>
<span id="cb234-3"><a aria-hidden="true" href="#cb234-3" tabindex="-1"></a><span class="at">   </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_assignments&gt;</span></span></code></pre></div>
<p>As an optimizaton, the following short notation can be used if
no 
input assignments are provided.</p>
<div class="sourceCode" id="cb235"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb235-1"><a aria-hidden="true" href="#cb235-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">delegate</span><span class="kw">:</span><span class="at"> &lt;delegate_workflow_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>delegate_workflow_name: represents the name of the workflow of
the 
node provided by the TOSCA orchestrator.</p></li>
<li><p>parameter_assignments: represents the optional map of
parameter 
assignments for passing parameters as inputs to this workflow 
delegation.</p></li>
</ul>
<h4 id="set-state-activity-definition">13.2.3.2 Set State Activity
Definition</h4>
<p>This activity sets the state of the target node.</p>
<p>The following is a list of recognized keynames for a set state
activity 
definition.</p>
<table>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>set_state</td>
<td>yes</td>
<td>string</td>
<td>Value of the node state.</td>
</tr>
</tbody>
</table>
<p>A set state activity definition has the following grammar.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb236-1"><a aria-hidden="true" href="#cb236-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">set_state</span><span class="kw">:</span><span class="at"> &lt;new_node_state&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li>new_node_state: represents the state that will be affected to the
node<br/>
once the activity is performed.</li>
</ul>
<h4 id="call-operation-activity-definition">13.2.3.3 Call Operation
Activity Definition</h4>
<p>This activity is used to call an operation on the target node.
Operation 
input assignments can be optionally provided.</p>
<p>The following is a list of recognized keynames for a call
operation 
activity definition.</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>call_operation</td>
<td>yes</td>
<td>string or empty (see grammar below)</td>
<td>Defines the opration call. The operation name uses the
&lt;interface_name&gt;.&lt;operation_name&gt; notation. Optionally,
assignments for the operation inputs can also be provided. If provided,
they will override for this operation call the operation inputs
assignment in the node template.</td>
</tr>
<tr class="even">
<td>operation</td>
<td>no</td>
<td>string</td>
<td>The name of the operation to call, using the
&lt;interface_name&gt;.&lt;operation_name&gt; notation. Mandatory in the
extended notation.</td>
</tr>
<tr class="odd">
<td>inputs</td>
<td>no</td>
<td>map of parameter assignments</td>
<td>The optional map of input parameter assignments for the called
operation. Any provided input assignments will override the operation
input assignment in the target node template for this operation
call.</td>
</tr>
</tbody>
</table>
<p>A call operation activity definition has the following grammar.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb237-1"><a aria-hidden="true" href="#cb237-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">call_operation</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb237-2"><a aria-hidden="true" href="#cb237-2" tabindex="-1"></a><span class="at">   </span><span class="fu">operation</span><span class="kw">:</span><span class="at"> &lt;operation_name&gt;</span></span>
<span id="cb237-3"><a aria-hidden="true" href="#cb237-3" tabindex="-1"></a><span class="at">   </span><span class="fu">inputs</span><span class="kw">:</span><span class="at"> &lt;parameter_assignments&gt;</span></span></code></pre></div>
<p>As an optimization, the following short notation can be used if
no 
input assignments are provided:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb238-1"><a aria-hidden="true" href="#cb238-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">call_operation</span><span class="kw">:</span><span class="at"> &lt;operation_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>operation_name: represents the name of the operation that will
be 
called during the workflow execution. The notation used is 
&lt;interface_sub_name&gt;.&lt;operation_sub_name&gt;, where 
interface_sub_name is the interface name and the operation_sub_name
is 
the name of the operation within this interface.</p></li>
<li><p>parameter_assignments: represents the optional map of
parameter 
assignments for passing parameters as inputs to this workflow 
delegation.</p></li>
</ul>
<h4 id="inline-workflow-activity-definition">13.2.3.4 Inline Workflow
Activity Definition</h4>
<p>This activity is used to inline a workflow in the activities
sequence. 
The definition includes the name of the inlined workflow and
optional 
input assignments.</p>
<p>The following is a list of recognized keynames for an inline
workflow 
activity definition.</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>inline</td>
<td>yes</td>
<td>string or empty (see grammar below)</td>
<td>The definition includes the name of a workflow to be inlined and
optional workflow input assignments.</td>
</tr>
<tr class="even">
<td>workflow</td>
<td>no</td>
<td>string</td>
<td>The name of the inlined workflow. Mandatory in the extended
notation.</td>
</tr>
<tr class="odd">
<td>inputs</td>
<td>no</td>
<td>map of parameter assignments</td>
<td>The optional map of input parameter assignments for the inlined
workflow.</td>
</tr>
</tbody>
</table>
<p>An inline workflow activity definition has the following grammar.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb239-1"><a aria-hidden="true" href="#cb239-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">inline</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb239-2"><a aria-hidden="true" href="#cb239-2" tabindex="-1"></a><span class="at">   </span><span class="fu">workflow</span><span class="kw">:</span><span class="at"> &lt;inlined_workflow_name&gt;</span></span>
<span id="cb239-3"><a aria-hidden="true" href="#cb239-3" tabindex="-1"></a><span class="at">   </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb239-4"><a aria-hidden="true" href="#cb239-4" tabindex="-1"></a><span class="at">     &lt;parameter_assignments&gt;</span></span></code></pre></div>
<p>As an optimization, the following short notation can be used if
no 
input assignments are provided.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb240-1"><a aria-hidden="true" href="#cb240-1" tabindex="-1"></a><span class="kw">-</span><span class="at"> </span><span class="fu">inline</span><span class="kw">:</span><span class="at"> &lt;inlined_workflow_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>inlined_workflow_name: represents the name of the workflow to
inline.</p></li>
<li><p>parameter_assignments: represents the optional map of
parameter 
assignments for passing parameters as inputs to this workflow 
delegation.</p></li>
</ul>
<p>The following represents a list of activity definitions (using the
short 
notation):</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb241-1"><a aria-hidden="true" href="#cb241-1" tabindex="-1"></a><span class="at"> </span><span class="kw">-</span><span class="at"> </span><span class="fu">delegate</span><span class="kw">:</span><span class="at"> deploy</span></span>
<span id="cb241-2"><a aria-hidden="true" href="#cb241-2" tabindex="-1"></a><span class="at"> </span><span class="kw">-</span><span class="at"> </span><span class="fu">set_state</span><span class="kw">:</span><span class="at"> started</span></span>
<span id="cb241-3"><a aria-hidden="true" href="#cb241-3" tabindex="-1"></a><span class="at"> </span><span class="kw">-</span><span class="at"> </span><span class="fu">call_operation</span><span class="kw">:</span><span class="at"> Standard.start</span></span>
<span id="cb241-4"><a aria-hidden="true" href="#cb241-4" tabindex="-1"></a><span class="at"> </span><span class="kw">-</span><span class="at"> </span><span class="fu">inline</span><span class="kw">:</span><span class="at"> my_workflow</span></span></code></pre></div>
<hr/>
<h1 id="creating-multiple-representations-from-templates">14 Creating
Multiple Representations from Templates</h1>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative.</p>
<p>TOSCA service templates specify a set of nodes that need to be 
<em>instantiated</em> at service deployment time. As discussed in <a href="#4-tosca-operational-model">Chapter 
4</a> this occurs in two separate steps:</p>
<ol type="1">
<li><p>A TOSCA Processor first creates a <em>service representation</em>
based on 
a service template. This representation is a graph that contains 
node representations and relationship representations.</p></li>
<li><p>An Orchestrator then creates <em>external implementations</em>
based on 
the information stored in the representation graph (e.g., by 
running workflows that call interface operations on each of the 
nodes and relationships in the graph).</p></li>
</ol>
<p><a href="#4-tosca-operational-model">Chapter 4</a> discusses how node
and 
relationship representations are created by matching a service 
template with deployment-specific input values. This chapter
discusses 
issues of <em>cardinality</em> that determine how many node
representations 
are created from each node template and how relationships are 
established between these multiple node represenations.</p>
<h2 id="specifying-number-of-node-representations">14.1 Specifying
Number of Node Representations</h2>
<p>Some service templates may include multiple nodes that perform
the 
same role. For example, a template that models an SD-WAN service
might 
contain multiple VPN Site nodes, one for each location that
connects 
to the SD-WAN. Rather than having to create a separate service 
template for each possible number of VPN sites, it is preferable
to 
create a single service template that allows the number of VPN
sites 
to be specified at deployment time as an input to the template.
This 
section documents TOSCA language support for this functionality.</p>
<p>The discussion in this section uses an example SD-WAN with three
sites 
as shown in the following figure:</p>
<pre class="mermaid"><code>flowchart
    SiteA(Austin)
    SiteB(Boston)
    SiteC(Chicago)
    VPN(VPN)
    subgraph W [SD-WAN Deployment]
        SiteA --&gt; VPN
        SiteB --&gt; VPN
        SiteC --&gt; VPN
    end</code></pre>
<p>The following code snippet shows a possible TOSCA service template
from which 
this service could be deployed:</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb243-1"><a aria-hidden="true" href="#cb243-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb243-2"><a aria-hidden="true" href="#cb243-2" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> Template for deploying SD-WAN with three sites.</span></span>
<span id="cb243-3"><a aria-hidden="true" href="#cb243-3" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb243-4"><a aria-hidden="true" href="#cb243-4" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb243-5"><a aria-hidden="true" href="#cb243-5" tabindex="-1"></a><span class="at">    </span><span class="fu">location1</span><span class="kw">:</span></span>
<span id="cb243-6"><a aria-hidden="true" href="#cb243-6" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Location</span></span>
<span id="cb243-7"><a aria-hidden="true" href="#cb243-7" tabindex="-1"></a><span class="at">    </span><span class="fu">location2</span><span class="kw">:</span></span>
<span id="cb243-8"><a aria-hidden="true" href="#cb243-8" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Location</span></span>
<span id="cb243-9"><a aria-hidden="true" href="#cb243-9" tabindex="-1"></a><span class="at">    </span><span class="fu">location3</span><span class="kw">:</span></span>
<span id="cb243-10"><a aria-hidden="true" href="#cb243-10" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Location</span></span>
<span id="cb243-11"><a aria-hidden="true" href="#cb243-11" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb243-12"><a aria-hidden="true" href="#cb243-12" tabindex="-1"></a><span class="at">    </span><span class="fu">sdwan</span><span class="kw">:</span></span>
<span id="cb243-13"><a aria-hidden="true" href="#cb243-13" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> VPN</span></span>
<span id="cb243-14"><a aria-hidden="true" href="#cb243-14" tabindex="-1"></a><span class="at">    </span><span class="fu">site1</span><span class="kw">:</span></span>
<span id="cb243-15"><a aria-hidden="true" href="#cb243-15" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> VPNSite</span></span>
<span id="cb243-16"><a aria-hidden="true" href="#cb243-16" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb243-17"><a aria-hidden="true" href="#cb243-17" tabindex="-1"></a><span class="at">        </span><span class="fu">location</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> location1 </span><span class="kw">}</span></span>
<span id="cb243-18"><a aria-hidden="true" href="#cb243-18" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb243-19"><a aria-hidden="true" href="#cb243-19" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">vpn</span><span class="kw">:</span><span class="at"> sdwan</span></span>
<span id="cb243-20"><a aria-hidden="true" href="#cb243-20" tabindex="-1"></a><span class="at">    </span><span class="fu">site2</span><span class="kw">:</span></span>
<span id="cb243-21"><a aria-hidden="true" href="#cb243-21" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> VPNSite</span></span>
<span id="cb243-22"><a aria-hidden="true" href="#cb243-22" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb243-23"><a aria-hidden="true" href="#cb243-23" tabindex="-1"></a><span class="at">        </span><span class="fu">location</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> location2 </span><span class="kw">}</span></span>
<span id="cb243-24"><a aria-hidden="true" href="#cb243-24" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb243-25"><a aria-hidden="true" href="#cb243-25" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">vpn</span><span class="kw">:</span><span class="at"> sdwan</span></span>
<span id="cb243-26"><a aria-hidden="true" href="#cb243-26" tabindex="-1"></a><span class="at">    </span><span class="fu">site3</span><span class="kw">:</span></span>
<span id="cb243-27"><a aria-hidden="true" href="#cb243-27" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> VPNSite</span></span>
<span id="cb243-28"><a aria-hidden="true" href="#cb243-28" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb243-29"><a aria-hidden="true" href="#cb243-29" tabindex="-1"></a><span class="at">        </span><span class="fu">location</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> location3 </span><span class="kw">}</span></span>
<span id="cb243-30"><a aria-hidden="true" href="#cb243-30" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb243-31"><a aria-hidden="true" href="#cb243-31" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">vpn</span><span class="kw">:</span><span class="at"> sdwan</span></span></code></pre></div>
<p>As defined here, this template can only be used to deploy an
SD-WAN 
with three sites. To deploy a different number of sites,
additional 
service templates must be created, one for each possible number of 
SD-WAN sites. This leads to undesirable template proliferation.
The 
next section presents an alternative.</p>
<p>To avoid the need for multiple service templates, TOSCA allows all
VPN 
Site nodes to be created from the same Site node template in the 
service template. The TOSCA node template definition grammar uses
a 
<code>count</code> keyword that specifies the requested number of
runtime 
representations for this node template. This <code>count</code> keyword
is 
similar to the <code>count</code> keyword in requirement
definitions.</p>
<p>The grammar for the <code>count</code> keyword is as follows:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Keyname</th>
<th style="text-align: left;">Mandatory</th>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">count</td>
<td style="text-align: left;">no</td>
<td style="text-align: left;">integer</td>
<td style="text-align: left;">The optional number of nodes in the
representation graph that will be created from this node template. If
not specified, one single node is created.</td>
</tr>
</tbody>
</table>
<p>It is expected that the value of the <code>count</code> is provided
as an input 
to the service template. This enables the creation of a simplified 
SD-WAN service template that contains only one single VPN Site node
as 
shown in the following figure:</p>
<pre class="mermaid"><code>---
title: Example SD-WAN Service Deployment
---
flowchart
    Site(Site)
    VPN(VPN)
    subgraph W [SD-WAN Deployment]
        Site --&gt; VPN
    end</code></pre>
<p>An implementation of such a service template is shown in the
following 
code snippet:</p>
<div class="sourceCode" id="cb245"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb245-1"><a aria-hidden="true" href="#cb245-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb245-2"><a aria-hidden="true" href="#cb245-2" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> Template for deploying SD-WAN with a variable number of sites.</span></span>
<span id="cb245-3"><a aria-hidden="true" href="#cb245-3" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb245-4"><a aria-hidden="true" href="#cb245-4" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb245-5"><a aria-hidden="true" href="#cb245-5" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_sites</span><span class="kw">:</span></span>
<span id="cb245-6"><a aria-hidden="true" href="#cb245-6" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb245-7"><a aria-hidden="true" href="#cb245-7" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb245-8"><a aria-hidden="true" href="#cb245-8" tabindex="-1"></a><span class="at">    </span><span class="fu">sdwan</span><span class="kw">:</span></span>
<span id="cb245-9"><a aria-hidden="true" href="#cb245-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> VPN</span></span>
<span id="cb245-10"><a aria-hidden="true" href="#cb245-10" tabindex="-1"></a><span class="at">    </span><span class="fu">site</span><span class="kw">:</span></span>
<span id="cb245-11"><a aria-hidden="true" href="#cb245-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> VPNSite</span></span>
<span id="cb245-12"><a aria-hidden="true" href="#cb245-12" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_sites </span><span class="kw">}</span></span>
<span id="cb245-13"><a aria-hidden="true" href="#cb245-13" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb245-14"><a aria-hidden="true" href="#cb245-14" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">vpn</span><span class="kw">:</span><span class="at"> sdwan</span></span></code></pre></div>
<h2 id="node-specific-input-values">14.2 Node-Specific Input Values</h2>
<p>The service template in the previous section conveniently ignores
the 
location property of the Site node. As shown earlier, the location 
property is expected to be provided as an input value. If Site
node 
templates can be instantiated multiple times, then it follows that 
multiple input values are required to initialize the location
property 
for each of the Site node representations.</p>
<p>To allow specific input values to be matched with specific node 
representations, each node representation is assigned a unique
index 
to differentiate it from other nodes representations created from
the 
same node template. This index is accessed using the
<code>$node_index</code> 
function that retrieves the index of the node in the context 
of which <code>$node_index</code> is used. This can then 
be used to index the list of input values.</p>
<p>The node index for a node representation is immutable: it never 
changes during the lifetime of that node representation, even if
node 
representations are added or deleted after the service has been 
deployed.</p>
<p>The following service template shows how the <code>$node_index</code>
function is 
used to retrieve specific values from a list of input values in a 
service template:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb246-1"><a aria-hidden="true" href="#cb246-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb246-2"><a aria-hidden="true" href="#cb246-2" tabindex="-1"></a><span class="fu">description</span><span class="kw">:</span><span class="at"> Template for deploying SD-WAN with a variable number of sites.</span></span>
<span id="cb246-3"><a aria-hidden="true" href="#cb246-3" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb246-4"><a aria-hidden="true" href="#cb246-4" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb246-5"><a aria-hidden="true" href="#cb246-5" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_sites</span><span class="kw">:</span></span>
<span id="cb246-6"><a aria-hidden="true" href="#cb246-6" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb246-7"><a aria-hidden="true" href="#cb246-7" tabindex="-1"></a><span class="at">    </span><span class="fu">location</span><span class="kw">:</span></span>
<span id="cb246-8"><a aria-hidden="true" href="#cb246-8" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> list</span></span>
<span id="cb246-9"><a aria-hidden="true" href="#cb246-9" tabindex="-1"></a><span class="at">      </span><span class="fu">entry_schema</span><span class="kw">:</span><span class="at"> Location</span></span>
<span id="cb246-10"><a aria-hidden="true" href="#cb246-10" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb246-11"><a aria-hidden="true" href="#cb246-11" tabindex="-1"></a><span class="at">    </span><span class="fu">sdwan</span><span class="kw">:</span></span>
<span id="cb246-12"><a aria-hidden="true" href="#cb246-12" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> VPN</span></span>
<span id="cb246-13"><a aria-hidden="true" href="#cb246-13" tabindex="-1"></a><span class="at">    </span><span class="fu">site</span><span class="kw">:</span></span>
<span id="cb246-14"><a aria-hidden="true" href="#cb246-14" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> VPNSite</span></span>
<span id="cb246-15"><a aria-hidden="true" href="#cb246-15" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_sites </span><span class="kw">}</span></span>
<span id="cb246-16"><a aria-hidden="true" href="#cb246-16" tabindex="-1"></a><span class="at">      </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb246-17"><a aria-hidden="true" href="#cb246-17" tabindex="-1"></a><span class="at">        </span><span class="fu">location</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="at"> </span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> location</span><span class="kw">,</span><span class="at"> $node_index </span><span class="kw">]</span><span class="at"> </span><span class="kw">}</span></span>
<span id="cb246-18"><a aria-hidden="true" href="#cb246-18" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb246-19"><a aria-hidden="true" href="#cb246-19" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">vpn</span><span class="kw">:</span><span class="at"> sdwan</span></span></code></pre></div>
<blockquote>
<p>This approach requires that inputs are provided as lists, even
if 
only one representation will be created. Should we allow a single value
as 
well as a list of values?</p>
</blockquote>
<blockquote>
<p>[Calin] This is as we see fit, not a problem. If a node is 
supposed to have one “occurrence” in a topology template (which
for 
the majority will do), then we use the single value input. If the 
occurrences are more, then we use lists.</p>
</blockquote>
<h2 id="cardinality-of-relationships">14.3 Cardinality of
Relationships</h2>
<p>We may also need to accommodate scenarios where a node template
with 
multiple representations defines a requirement to another node 
template that also has multiple representations. This section 
introduces grammar for specifying the cardinality of such 
requirements. Specific mechanisms depend on the type of the 
relationships to be established.</p>
<h3 id="many-to-one-relationships">14.3.1 Many-to-One Relationships</h3>
<p>In the SD-WAN service template above, each of the site node 
representations has a relationship to a VPN node that can only be 
instantiated once. This is an example of a <em>many-to-one</em>
relationship 
which is shown in the following figure:</p>
<pre class="mermaid"><code>flowchart LR
    subgraph Left
        A1((1))
        A2((2))
        A3((3))
        A4((4))
    end
    subgraph Right
        B1((1))
    end
    A1 --&gt; B1
    A2 --&gt; B1
    A3 --&gt; B1
    A4 --&gt; B1</code></pre>
<p>This scenario is supported using existing relationship syntax
as 
shown in the following code snippet:</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb248-1"><a aria-hidden="true" href="#cb248-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb248-2"><a aria-hidden="true" href="#cb248-2" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb248-3"><a aria-hidden="true" href="#cb248-3" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_left</span><span class="kw">:</span></span>
<span id="cb248-4"><a aria-hidden="true" href="#cb248-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb248-5"><a aria-hidden="true" href="#cb248-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb248-6"><a aria-hidden="true" href="#cb248-6" tabindex="-1"></a><span class="at">    </span><span class="fu">right</span><span class="kw">:</span></span>
<span id="cb248-7"><a aria-hidden="true" href="#cb248-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Right</span></span>
<span id="cb248-8"><a aria-hidden="true" href="#cb248-8" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb248-9"><a aria-hidden="true" href="#cb248-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Left</span></span>
<span id="cb248-10"><a aria-hidden="true" href="#cb248-10" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_left</span><span class="kw">}</span></span>
<span id="cb248-11"><a aria-hidden="true" href="#cb248-11" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb248-12"><a aria-hidden="true" href="#cb248-12" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> right</span></span></code></pre></div>
<p>This template specifies that all four node representations
created 
from the <code>left</code> node template must use the one node
representation 
created from the<code>right</code> node template as their target
node.</p>
<h3 id="one-to-many-relationships">14.3.2 One-to-Many Relationships</h3>
<p>An example of a <em>one-to-many</em> relationship is shown in the
following 
figure:</p>
<pre class="mermaid"><code>flowchart LR
    subgraph Left
        A1((1))
    end
    subgraph Right
        B1((1))
        B2((2))
        B3((3))
        B4((4))
    end
    A1 --&gt; B1
    A1 --&gt; B2
    A1 --&gt; B3
    A1 --&gt; B4</code></pre>
<p><em>One-to-many</em> relationships are less common, but they can just
as 
easily be accommodated using existing TOSCA grammar, as long as
the 
requirement in the single node specifies the appropriate
<code>count</code> 
value. This is shown in the following code snippet:</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb250-1"><a aria-hidden="true" href="#cb250-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb250-2"><a aria-hidden="true" href="#cb250-2" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb250-3"><a aria-hidden="true" href="#cb250-3" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_right</span><span class="kw">:</span></span>
<span id="cb250-4"><a aria-hidden="true" href="#cb250-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb250-5"><a aria-hidden="true" href="#cb250-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb250-6"><a aria-hidden="true" href="#cb250-6" tabindex="-1"></a><span class="at">    </span><span class="fu">right</span><span class="kw">:</span></span>
<span id="cb250-7"><a aria-hidden="true" href="#cb250-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Right</span></span>
<span id="cb250-8"><a aria-hidden="true" href="#cb250-8" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_right</span><span class="kw">}</span></span>
<span id="cb250-9"><a aria-hidden="true" href="#cb250-9" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb250-10"><a aria-hidden="true" href="#cb250-10" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Left</span></span>
<span id="cb250-11"><a aria-hidden="true" href="#cb250-11" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb250-12"><a aria-hidden="true" href="#cb250-12" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span></span>
<span id="cb250-13"><a aria-hidden="true" href="#cb250-13" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> right</span></span>
<span id="cb250-14"><a aria-hidden="true" href="#cb250-14" tabindex="-1"></a><span class="at">            </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_right</span><span class="kw">}</span></span></code></pre></div>
<p>In this example, a total number of <code>count</code> relationships
will be 
created from the single <code>left</code> node to the group of
<code>right</code> nodes. The 
orchestrator must select a different <code>right</code> node for
each 
relationship. If the <code>count</code> value is not specified in the
<code>uses</code> 
requirement, it defaults to 1 and the orchestrator will only
establish 
one single relationship to one of the <code>right</code> nodes. The
choice of which one of the several 
<code>right</code> nodes is selected is implementation-specific.</p>
<h3 id="full-mesh">14.3.3 Full mesh</h3>
<p>In a <em>full mesh</em> scenario, all nodes on the left
establish 
relationships to all of the nodes on the right as shown in the 
following figure:</p>
<pre class="mermaid"><code>flowchart LR
    subgraph Left
        A1((1))
        A2((2))
    end
    subgraph Right
        B1((1))
        B2((2))
        B3((3))
    end
    A1 --&gt; B1
    A1 --&gt; B2
    A1 --&gt; B3
    A2 --&gt; B1
    A2 --&gt; B2
    A2 --&gt; B3</code></pre>
<p>Note that the many-to-one and one to-many pattern are just
special 
cases of a full-mesh when either the number of nodes on the left
or 
the number of nodes on the right side is 1.</p>
<p>As before, the full mesh scenario can easily be defined using
existing 
requirement syntax as shown in the following code snippet:</p>
<div class="sourceCode" id="cb252"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb252-1"><a aria-hidden="true" href="#cb252-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb252-2"><a aria-hidden="true" href="#cb252-2" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb252-3"><a aria-hidden="true" href="#cb252-3" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_left</span><span class="kw">:</span></span>
<span id="cb252-4"><a aria-hidden="true" href="#cb252-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb252-5"><a aria-hidden="true" href="#cb252-5" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_right</span><span class="kw">:</span></span>
<span id="cb252-6"><a aria-hidden="true" href="#cb252-6" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb252-7"><a aria-hidden="true" href="#cb252-7" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb252-8"><a aria-hidden="true" href="#cb252-8" tabindex="-1"></a><span class="at">    </span><span class="fu">right</span><span class="kw">:</span></span>
<span id="cb252-9"><a aria-hidden="true" href="#cb252-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Right</span></span>
<span id="cb252-10"><a aria-hidden="true" href="#cb252-10" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_right</span><span class="kw">}</span></span>
<span id="cb252-11"><a aria-hidden="true" href="#cb252-11" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb252-12"><a aria-hidden="true" href="#cb252-12" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Left</span></span>
<span id="cb252-13"><a aria-hidden="true" href="#cb252-13" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_left</span><span class="kw">}</span></span>
<span id="cb252-14"><a aria-hidden="true" href="#cb252-14" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb252-15"><a aria-hidden="true" href="#cb252-15" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span></span>
<span id="cb252-16"><a aria-hidden="true" href="#cb252-16" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> right</span></span>
<span id="cb252-17"><a aria-hidden="true" href="#cb252-17" tabindex="-1"></a><span class="at">            </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_right</span><span class="kw">}</span></span></code></pre></div>
<h3 id="matched-pairs">14.3.4 Matched Pairs</h3>
<p>For some services, representations created from different node 
templates must remain matched up in pairs. For example, let’s
extend 
the SD-WAN service above with a third node template that represents
a 
virtual PE router that must be used at each site. Let’s assume that Site
nodes establish a 
HostedOn relationship to the vPE nodes. The extended service
topology 
is shown in the following figure:</p>
<pre class="mermaid"><code>flowchart LR
    A((Site)) --&gt; B((VPN))
    A((Site)) --&gt; c((vPE))</code></pre>
<p>In this example, the intent is for each site node to remain
paired 
with its own vPE node for that site. A generic illustration of the 
<em>matched pairs</em> scenario is shown in the following figure:</p>
<pre class="mermaid"><code>flowchart LR
    subgraph Left
        A1((1))
        A2((2))
        A3((3))
        A4((4))
    end
    subgraph Right
        B1((1))
        B2((2))
        B3((3))
        B4((4))
    end
    A1 --&gt; B1
    A2 --&gt; B2
    A3 --&gt; B3
    A4 --&gt; B4</code></pre>
<p>To create matched pairs, the service template designer must first
make 
sure that the number of nodes on the left matches the number of
nodes 
on the right by using the same input value for the <code>count</code>
keynames in 
both the <code>left</code> and <code>right</code> node templates. In
addition, each 
requirement must correctly match source nodes and target nodes are 
matched correctly, which can be accomplished by making sure that a 
target node of each relationship has the same node index value as 
its source node. This following code snippet shows requirement 
definition grammar that uses the <code>$node_index</code> function to
uniquely 
identify target nodes:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb255-1"><a aria-hidden="true" href="#cb255-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb255-2"><a aria-hidden="true" href="#cb255-2" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb255-3"><a aria-hidden="true" href="#cb255-3" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_nodes</span><span class="kw">:</span></span>
<span id="cb255-4"><a aria-hidden="true" href="#cb255-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb255-5"><a aria-hidden="true" href="#cb255-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb255-6"><a aria-hidden="true" href="#cb255-6" tabindex="-1"></a><span class="at">    </span><span class="fu">right</span><span class="kw">:</span></span>
<span id="cb255-7"><a aria-hidden="true" href="#cb255-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Right</span></span>
<span id="cb255-8"><a aria-hidden="true" href="#cb255-8" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_nodes</span><span class="kw">}</span></span>
<span id="cb255-9"><a aria-hidden="true" href="#cb255-9" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb255-10"><a aria-hidden="true" href="#cb255-10" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Left</span></span>
<span id="cb255-11"><a aria-hidden="true" href="#cb255-11" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_nodes</span><span class="kw">}</span></span>
<span id="cb255-12"><a aria-hidden="true" href="#cb255-12" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb255-13"><a aria-hidden="true" href="#cb255-13" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">right</span><span class="kw">,</span><span class="at"> $node_index</span><span class="kw">]</span></span></code></pre></div>
<h3 id="random-pairs">14.3.5 Random Pairs</h3>
<p>Some scenarios require nodes to be organized in pairs, but the 
ordering of the nodes is not important. The following figure shows
and 
such a <em>random pairs</em> example:</p>
<pre class="mermaid"><code>flowchart LR
    subgraph Left
        A2((2))
        A3((3))
        A1((1))
        A4((4))
    end
    subgraph Right
        B1((1))
        B2((2))
        B3((3))
        B4((4))
    end
    A1 --&gt; B3
    A2 --&gt; B1
    A3 --&gt; B2
    A4 --&gt; B4</code></pre>
<p>In this scenario, it is not important how target nodes are paired
with 
source nodes, as long as each target node is only used once. To
make 
sure each target node is only used once, the <code>allocations</code>
keyword in 
the requirement can be used as shown in the following code snippet:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb257-1"><a aria-hidden="true" href="#cb257-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb257-2"><a aria-hidden="true" href="#cb257-2" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb257-3"><a aria-hidden="true" href="#cb257-3" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_nodes</span><span class="kw">:</span></span>
<span id="cb257-4"><a aria-hidden="true" href="#cb257-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb257-5"><a aria-hidden="true" href="#cb257-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb257-6"><a aria-hidden="true" href="#cb257-6" tabindex="-1"></a><span class="at">    </span><span class="fu">right</span><span class="kw">:</span></span>
<span id="cb257-7"><a aria-hidden="true" href="#cb257-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Right</span></span>
<span id="cb257-8"><a aria-hidden="true" href="#cb257-8" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_nodes</span><span class="kw">}</span></span>
<span id="cb257-9"><a aria-hidden="true" href="#cb257-9" tabindex="-1"></a><span class="at">      </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb257-10"><a aria-hidden="true" href="#cb257-10" tabindex="-1"></a><span class="at">        </span><span class="fu">feature</span><span class="kw">:</span></span>
<span id="cb257-11"><a aria-hidden="true" href="#cb257-11" tabindex="-1"></a><span class="at">          </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb257-12"><a aria-hidden="true" href="#cb257-12" tabindex="-1"></a><span class="at">            </span><span class="fu">target_count</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb257-13"><a aria-hidden="true" href="#cb257-13" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb257-14"><a aria-hidden="true" href="#cb257-14" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Left</span></span>
<span id="cb257-15"><a aria-hidden="true" href="#cb257-15" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_nodes</span><span class="kw">}</span></span>
<span id="cb257-16"><a aria-hidden="true" href="#cb257-16" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb257-17"><a aria-hidden="true" href="#cb257-17" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span></span>
<span id="cb257-18"><a aria-hidden="true" href="#cb257-18" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> right</span></span>
<span id="cb257-19"><a aria-hidden="true" href="#cb257-19" tabindex="-1"></a><span class="at">            </span><span class="fu">allocations</span><span class="kw">:</span></span>
<span id="cb257-20"><a aria-hidden="true" href="#cb257-20" tabindex="-1"></a><span class="at">              </span><span class="fu">target_count</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span></code></pre></div>
<p>This scenario works as follows:</p>
<ul>
<li>The target capability in each target node defines a property that
is<br/>
intended to restrict how many times that capability can be<br/>
targeted. In the example above, the <code>right</code> nodes are the
target<br/>
nodes. These nodes define a <code>feature</code> capability that in
turn<br/>
defines a <code>target_count</code> property. The value of this property
is set<br/>
to 1 to only allow one single incoming relationship.</li>
<li>The requirement in each source node includes an
<code>allocations</code><br/>
section that allocates a single unit from the target capability.
In<br/>
the example above, the <code>left</code> nodes define a
<code>uses</code> requirement that<br/>
allocates a single unit from the <code>target_count</code> property in
the<br/>
target capability.</li>
<li>When a relationship is established to a target node, that
target<br/>
node’s <code>target_count</code> property is exhausted and no
additional<br/>
incoming relationships will be established. This ensures that each<br/>
target node is only allocated once.</li>
</ul>
<h3 id="many-to-many-relationships">14.3.6 Many-to-Many
Relationships</h3>
<p>The mechanisms introduced above can also be used to define more 
complex <em>many-to-many</em> scenarios. For example, a 1:2 pattern is
shown 
in the following figure:</p>
<pre class="mermaid"><code>flowchart LR
    subgraph Left
        A1((1))
        A2((2))
        A3((3))
    end
    subgraph Right
        B1((1))
        B2((2))
        B3((3))
        B4((4))
        B5((5))
        B6((6))
    end
    A1 --&gt; B1
    A1 --&gt; B2
    A2 --&gt; B3
    A2 --&gt; B4
    A3 --&gt; B5
    A3 --&gt; B6</code></pre>
<p>This pattern can be accomplished using the following code
snippet:</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb259-1"><a aria-hidden="true" href="#cb259-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb259-2"><a aria-hidden="true" href="#cb259-2" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb259-3"><a aria-hidden="true" href="#cb259-3" tabindex="-1"></a><span class="at">    </span><span class="fu">right</span><span class="kw">:</span></span>
<span id="cb259-4"><a aria-hidden="true" href="#cb259-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Right</span></span>
<span id="cb259-5"><a aria-hidden="true" href="#cb259-5" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="dv">6</span></span>
<span id="cb259-6"><a aria-hidden="true" href="#cb259-6" tabindex="-1"></a><span class="at">      </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb259-7"><a aria-hidden="true" href="#cb259-7" tabindex="-1"></a><span class="at">        </span><span class="fu">feature</span><span class="kw">:</span></span>
<span id="cb259-8"><a aria-hidden="true" href="#cb259-8" tabindex="-1"></a><span class="at">          </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb259-9"><a aria-hidden="true" href="#cb259-9" tabindex="-1"></a><span class="at">            </span><span class="fu">target_count</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span>
<span id="cb259-10"><a aria-hidden="true" href="#cb259-10" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb259-11"><a aria-hidden="true" href="#cb259-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Left</span></span>
<span id="cb259-12"><a aria-hidden="true" href="#cb259-12" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="dv">6</span></span>
<span id="cb259-13"><a aria-hidden="true" href="#cb259-13" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb259-14"><a aria-hidden="true" href="#cb259-14" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span></span>
<span id="cb259-15"><a aria-hidden="true" href="#cb259-15" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> right</span></span>
<span id="cb259-16"><a aria-hidden="true" href="#cb259-16" tabindex="-1"></a><span class="at">            </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb259-17"><a aria-hidden="true" href="#cb259-17" tabindex="-1"></a><span class="at">            </span><span class="fu">allocations</span><span class="kw">:</span></span>
<span id="cb259-18"><a aria-hidden="true" href="#cb259-18" tabindex="-1"></a><span class="at">              </span><span class="fu">target_count</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span></code></pre></div>
<p>The following figure shows a 3:2 pattern:</p>
<pre class="mermaid"><code>flowchart LR
    subgraph Left
        A1((1))
        A2((2))
        A3((3))
        A4((4))
        A5((5))
        A6((6))
    end
    subgraph Right
        B1((1))
        B2((2))
        B3((3))
        B4((4))
    end
    A1 --&gt; B1
    A1 --&gt; B2
    A2 --&gt; B1
    A2 --&gt; B2
    A3 --&gt; B1
    A3 --&gt; B2
    A4 --&gt; B3
    A4 --&gt; B4
    A5 --&gt; B3
    A5 --&gt; B4
    A6 --&gt; B3
    A6 --&gt; B4</code></pre>
<p>This pattern can be implemented using the following code snippet:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb261-1"><a aria-hidden="true" href="#cb261-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb261-2"><a aria-hidden="true" href="#cb261-2" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb261-3"><a aria-hidden="true" href="#cb261-3" tabindex="-1"></a><span class="at">    </span><span class="fu">right</span><span class="kw">:</span></span>
<span id="cb261-4"><a aria-hidden="true" href="#cb261-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Right</span></span>
<span id="cb261-5"><a aria-hidden="true" href="#cb261-5" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="dv">6</span></span>
<span id="cb261-6"><a aria-hidden="true" href="#cb261-6" tabindex="-1"></a><span class="at">      </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb261-7"><a aria-hidden="true" href="#cb261-7" tabindex="-1"></a><span class="at">        </span><span class="fu">feature</span><span class="kw">:</span></span>
<span id="cb261-8"><a aria-hidden="true" href="#cb261-8" tabindex="-1"></a><span class="at">          </span><span class="fu">properties</span><span class="kw">:</span></span>
<span id="cb261-9"><a aria-hidden="true" href="#cb261-9" tabindex="-1"></a><span class="at">            </span><span class="fu">target_count</span><span class="kw">:</span><span class="at"> </span><span class="dv">3</span></span>
<span id="cb261-10"><a aria-hidden="true" href="#cb261-10" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb261-11"><a aria-hidden="true" href="#cb261-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Left</span></span>
<span id="cb261-12"><a aria-hidden="true" href="#cb261-12" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="dv">6</span></span>
<span id="cb261-13"><a aria-hidden="true" href="#cb261-13" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb261-14"><a aria-hidden="true" href="#cb261-14" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span></span>
<span id="cb261-15"><a aria-hidden="true" href="#cb261-15" tabindex="-1"></a><span class="at">            </span><span class="fu">node</span><span class="kw">:</span><span class="at"> right</span></span>
<span id="cb261-16"><a aria-hidden="true" href="#cb261-16" tabindex="-1"></a><span class="at">            </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="dv">2</span></span>
<span id="cb261-17"><a aria-hidden="true" href="#cb261-17" tabindex="-1"></a><span class="at">            </span><span class="fu">allocations</span><span class="kw">:</span></span>
<span id="cb261-18"><a aria-hidden="true" href="#cb261-18" tabindex="-1"></a><span class="at">              </span><span class="fu">target_count</span><span class="kw">:</span><span class="at"> </span><span class="dv">1</span></span></code></pre></div>
<p>Finally, there may be scenarios where the multiplicity of the
left 
nodes and the multiplicity of the right nodes do not allow clean 
pairing scenarios. In that case, more complicated expressions might
be 
needed to specify target node indices or to restrict capacity. For 
example, if nodes are expected to be paired but there are more
nodes 
on the left than on the right. The following code snippet 
shows a <em>mismatched pairs</em> example where the orchestrator may
have to 
cycle through the target nodes multiple times:</p>
<div class="sourceCode" id="cb262"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb262-1"><a aria-hidden="true" href="#cb262-1" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb262-2"><a aria-hidden="true" href="#cb262-2" tabindex="-1"></a><span class="at">  </span><span class="fu">inputs</span><span class="kw">:</span></span>
<span id="cb262-3"><a aria-hidden="true" href="#cb262-3" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_right</span><span class="kw">:</span></span>
<span id="cb262-4"><a aria-hidden="true" href="#cb262-4" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb262-5"><a aria-hidden="true" href="#cb262-5" tabindex="-1"></a><span class="at">    </span><span class="fu">number_of_left</span><span class="kw">:</span></span>
<span id="cb262-6"><a aria-hidden="true" href="#cb262-6" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> integer</span></span>
<span id="cb262-7"><a aria-hidden="true" href="#cb262-7" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb262-8"><a aria-hidden="true" href="#cb262-8" tabindex="-1"></a><span class="at">    </span><span class="fu">right</span><span class="kw">:</span></span>
<span id="cb262-9"><a aria-hidden="true" href="#cb262-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Right</span></span>
<span id="cb262-10"><a aria-hidden="true" href="#cb262-10" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_right</span><span class="kw">}</span></span>
<span id="cb262-11"><a aria-hidden="true" href="#cb262-11" tabindex="-1"></a><span class="at">    </span><span class="fu">left</span><span class="kw">:</span></span>
<span id="cb262-12"><a aria-hidden="true" href="#cb262-12" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Left</span></span>
<span id="cb262-13"><a aria-hidden="true" href="#cb262-13" tabindex="-1"></a><span class="at">      </span><span class="fu">count</span><span class="kw">:</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_left</span><span class="kw">}</span></span>
<span id="cb262-14"><a aria-hidden="true" href="#cb262-14" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb262-15"><a aria-hidden="true" href="#cb262-15" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">right</span><span class="kw">,</span><span class="at"> </span><span class="kw">{</span><span class="fu">$remainder</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">$node_index</span><span class="kw">,</span><span class="at"> </span><span class="kw">{</span><span class="fu">$get_input</span><span class="kw">:</span><span class="at"> number_of_right</span><span class="kw">}]}]</span></span></code></pre></div>
<h2 id="relationship-specific-input-values">14.4 Relationship-Specific
Input Values</h2>
<p>To allow specific input values to be matched with specific 
relationship representations, each relationship representation is 
assigned a unique index to differentiate it from other
relationship 
representations created from the same requirement definition. 
This index is accessed using the <code>$relationship_index</code>
function that 
references the index of the relationship in the context of its
requirement. 
This can then can be used to index the list of input values.</p>
<hr/>
<h1 id="substitution">15 Substitution</h1>
<p>The TOSCA <em>substitution</em> feature allows nodes in a service
topology to 
be <em>decomposed</em> using <em>substituting services</em> that
describe the 
internals of those nodes. Substitution provides a
<em>declarative</em> 
mechanism for implementing TOSCA nodes that can be used as an 
alternative to <em>implementation artifacts</em>. Substitution allows
for 
simplified representations of complex systems that <em>abstract
away</em> 
technology or vendor-specific implementation details. Abstract
nodes 
that expect to be <em>substituted</em> are based on node templates that
are 
annotated with the <code>substitute</code> directive. Service templates
advertize 
their ability to provide substituting implementations using the 
<code>substitution_mapping</code> section in the service template
definition.</p>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative.</p>
<h2 id="substitution-mapping-1">15.1 Substitution Mapping</h2>
<p>The <code>substitution_mapping</code> section in a service template
serves four 
purposes: 
1. It identifies the nodes for which the service template is a 
substitution candidate by specifying a node type and an associated 
substitution filter. 
2. It defines how configuration and state values flow between the 
substituted node and the substituting template: property mappings 
specify how configuration values are propagated from the 
substituted node to the substituting service, and attribute 
mappings specify how runtime values are propagated back from the 
substituting service to the substituted node. 
3. It dictates how the topology graph of the substituting service
is 
<em>stitched in</em> to the top-level topology graph that contains
the 
substituted node (using requirement and capability mappings). 
4. It specifies how interface operations called on the substituted 
node are implemented using workflows on the substituting service, 
and how events generated in the substituting service are escalated 
to notifications on the substituted node.</p>
<p>Note that while capabilities and relationships may define
properties 
and attributes, capability mappings and requirement mappings do
not 
propagate these values. Capability and requirement mappings are
used 
exclusively to control service topology. If capability or
relationship 
values must be passed between an abstract node and its
substituting 
service, property and attribute mappings must be used to define
how 
these values are mapped.</p>
<blockquote>
<p>This <em>event escalation</em> mechanism needs to be better
defined.</p>
</blockquote>
<table>
<colgroup>
<col style="width: 25%"/>
<col style="width: 25%"/>
<col style="width: 25%"/>
<col style="width: 25%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>node_type</td>
<td>yes</td>
<td>string</td>
<td>The name of the node type of the nodes for which the service
template can provide an implementation.</td>
</tr>
<tr class="even">
<td>substitution_filter</td>
<td>no</td>
<td>condition clause</td>
<td>The filter that further constrains the abstract nodes for which this
service template can provide an implementation. For an abstract node
that needs to be substituted, the condition clause specified by the
substitution filter must evaluate to <code>True</code> for this template
to be a valid substitution candidate.</td>
</tr>
<tr class="odd">
<td>properties</td>
<td>no</td>
<td>map of property mappings</td>
<td>The map of property mappings that map properties of the substituted
node to inputs of the service template.</td>
</tr>
<tr class="even">
<td>attributes</td>
<td>no</td>
<td>map of attribute mappings</td>
<td>The map of attribute mappings that map outputs from the service
template to attributes of the substituted node.</td>
</tr>
<tr class="odd">
<td>capabilities</td>
<td>no</td>
<td>map of capability mappings</td>
<td>The map of capability mappings.</td>
</tr>
<tr class="even">
<td>requirements</td>
<td>no</td>
<td>list of requirement mappings</td>
<td>The list of requirement mappings.</td>
</tr>
<tr class="odd">
<td>interfaces</td>
<td>no</td>
<td>map of interfaces mappings</td>
<td>The map of interface mappings that map interface operations called
on the substituted node to implementations workflows on the substituting
service.</td>
</tr>
</tbody>
</table>
<p>The grammar of the substitution_mapping section is as follows:</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb263-1"><a aria-hidden="true" href="#cb263-1" tabindex="-1"></a><span class="fu">node_type</span><span class="kw">:</span><span class="at"> &lt;node_type_name&gt;</span></span>
<span id="cb263-2"><a aria-hidden="true" href="#cb263-2" tabindex="-1"></a><span class="fu">substitution_filter </span><span class="kw">:</span><span class="at"> &lt;substitution_filter&gt;</span></span>
<span id="cb263-3"><a aria-hidden="true" href="#cb263-3" tabindex="-1"></a><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_mappings&gt;</span></span>
<span id="cb263-4"><a aria-hidden="true" href="#cb263-4" tabindex="-1"></a><span class="fu">attributes</span><span class="kw">:</span><span class="at"> &lt;attribute_mappings&gt;</span></span>
<span id="cb263-5"><a aria-hidden="true" href="#cb263-5" tabindex="-1"></a><span class="fu">capabilities</span><span class="kw">:</span><span class="at"> &lt;capability_mappings&gt;</span></span>
<span id="cb263-6"><a aria-hidden="true" href="#cb263-6" tabindex="-1"></a><span class="fu">requirements</span><span class="kw">:</span><span class="at"> &lt;requirement_mappings&gt;</span></span>
<span id="cb263-7"><a aria-hidden="true" href="#cb263-7" tabindex="-1"></a><span class="fu">interfaces</span><span class="kw">:</span><span class="at"> &lt;interface_mappings&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning: 
- node_type_name: represents the node type name for which the 
service template can offer an implementation. 
- substitution_filter: represents a filter that reduces the set of 
abstract nodes for which this service template is an
implementation 
by only substituting for those nodes whose properties and 
capabilities satisfy the condition clause specified in the filter. 
- property_mappings: represents the map of <em>property to input</em>
mappings. 
- attribute_mappings: represents the map of <em>output to
attribute</em> 
mappings. 
- capability_mappings: represents the map of capability mappings. 
- requirement_mappings: represents the list of requirement 
mappings. 
- interface_mappings: represents the map of interface mappings.</p>
<blockquote>
<p>Examples to be provided</p>
</blockquote>
<p>Please note: 
<!---- Calin-2024-06-05: I think that this constraint should not exist.
  This will be evaluated from the directives. Could even have all
  3 directives [select, substitute, create]
  - If a node is select only the node_filter is relevat (rest might not be defined, it is ignored)
  - If a node is substitute then the implementations are irelevant, they are ignored
  - If a node is create, the node_filter is irelevant --> 
- A substituting service template MUST be a valid TOSCA template
in 
its own right (i.e., when not used as a substituting 
implementation). Specifically, all the required properties of all 
its node templates must have valid property assignments.</p>
<h2 id="property-mapping">15.2 Property mapping</h2>
<p>A property mapping allows a property value of a substituted node to
be 
mapped to an input value of the substituting service template.</p>
<p>The grammar of a property_mapping is as follows:</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb264-1"><a aria-hidden="true" href="#cb264-1" tabindex="-1"></a><span class="fu">&lt;property_name&gt;</span><span class="kw">:</span><span class="at"> &lt;input_name&gt; </span></span>
<span id="cb264-2"><a aria-hidden="true" href="#cb264-2" tabindex="-1"></a><span class="kw">[</span><span class="at"> CAPABILITY</span><span class="kw">,</span><span class="at"> &lt;capability_name&gt;</span><span class="kw">,</span><span class="at"> &lt;property_name&gt; </span><span class="kw">]:</span><span class="at"> &lt;input_name&gt;</span></span>
<span id="cb264-3"><a aria-hidden="true" href="#cb264-3" tabindex="-1"></a><span class="kw">[</span><span class="at"> RELATIONSHIP</span><span class="kw">,</span><span class="at"> &lt;requirement_name&gt;</span><span class="kw">,</span><span class="at"> &lt;idx&gt;</span><span class="kw">,</span><span class="at"> &lt;property_name&gt; </span><span class="kw">]:</span><span class="at"> &lt;input_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning: 
- input_name: represents the name of an input defined for the 
substituting service template. 
- property_name: represents the name of a property of the 
substituted node (defined using a corresponding property
definition 
in the specified node type), or a property of a capability, or a 
property of a relationship created by a requirement of the 
substituted node. 
- capability_name: represents the name of the capability as it
appears 
in the node type definition for the substituted node 
- requirement_name: represents the name of the requirement as it
appears 
in the node type definition for the substituted node 
- idx: index of the relationship defined from that requirement (0 is
the 
first index); if the index is missing, index 0 is assumed; 
if the keyword ALL is used by as index, the corresponding 
input will be assigned a list of all values of properties with 
<property_name> from all relationships created from the
requirement 
with <requirement_name>.</requirement_name></property_name></p>
<p>The following additional requirements apply: 
- Mappings must be type-compatible (i.e., properties mapped to
input 
must have the type specified in the corresponding input
definition). 
- Property mappings must be defined for all <em>mandatory</em>
service 
template inputs that do not define a <code>default</code> value.</p>
<h2 id="attribute-mapping">15.3 Attribute Mapping</h2>
<p>An attribute mapping allows an output value of the substituting 
service template to be mapped to an attribute of the substituted
node.</p>
<p>The grammar of an attribute_mapping is as follows:</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb265-1"><a aria-hidden="true" href="#cb265-1" tabindex="-1"></a><span class="fu">&lt;attribute_name&gt;</span><span class="kw">:</span><span class="at"> &lt;output_name&gt; </span></span>
<span id="cb265-2"><a aria-hidden="true" href="#cb265-2" tabindex="-1"></a><span class="kw">[</span><span class="at"> CAPABILITY</span><span class="kw">,</span><span class="at"> &lt;capability_name&gt;</span><span class="kw">,</span><span class="at"> &lt;attribute_name&gt; </span><span class="kw">]:</span><span class="at"> &lt;output_name&gt;</span></span>
<span id="cb265-3"><a aria-hidden="true" href="#cb265-3" tabindex="-1"></a><span class="kw">[</span><span class="at"> RELATIONSHIP</span><span class="kw">,</span><span class="at"> &lt;requirement_name&gt;</span><span class="kw">,</span><span class="at"> &lt;idx&gt;</span><span class="kw">,</span><span class="at"> &lt;attribute_name&gt; </span><span class="kw">]:</span><span class="at"> &lt;output_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning: 
- output_name: represents the name of an output defined in the 
substituting service template. 
- attribute_name: represents the name of an attribute of the 
substituted node (defined using a corresponding attribute
definition 
in the specified node type) or an attribute of a capability, or an 
attribute of a relationship created by a requirement of the 
substituted node. 
- capability_name: represents the name of the capability as it
appears 
in the node type definition for the substituted node 
- requirement_name: represents the name of the requirement as it
appears 
in the node type definition for the substituted node 
- idx: index of the relationship defined from that requirement (0 is
the 
first index); if the index is missing, index 0 is assumed; 
if the keyword ALL is used by as index, all attributes 
with <attribute_name> from all relationships created from the
requirement 
with <requirement_name> will be assigned a coresponding value from
the 
output which is of a list type.</requirement_name></attribute_name></p>
<p>The following additional requirements apply: 
- Mappings must be type-compatible (i.e., outputs mapped to
attributes 
must have the type specified in the corresponding attribute 
definition).</p>
<h2 id="capability-mapping">15.4 Capability Mapping</h2>
<p>A capability mapping allows a capability of one of the nodes in
the 
substituting service template to be mapped to a capability of the 
substituted node.</p>
<p>The grammar of a capability_mapping is as follows:</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb266-1"><a aria-hidden="true" href="#cb266-1" tabindex="-1"></a><span class="fu">&lt;capability_name&gt;</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;node_template_name&gt;</span><span class="kw">,</span><span class="at"> &lt;node_template_capability_name&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning: 
- capability_name: represents the name of the capability as it
appears 
in the node type definition for the substituted node. 
- node_template_name: represents a valid name of a node template 
definition within the substituting service template. 
- node_template_capability_name: represents a valid name of a 
capability definition within the 
&lt;node_template_name&gt; declared in this mapping.</p>
<h2 id="requirement-mapping">15.5 Requirement Mapping</h2>
<p>A requirement mapping defines how requirements of the substituted
node 
are mapped to one or more requirements of nodes in the
substituting 
service. The term <em>requirement mapping</em> is somewhat of a
misnomer, 
since mapping a requirement results in the target node of that 
requirement also being used as the target node for the
<em>mapped</em> 
requirement. As a result, requirement mappings are a mechanism for 
passing nodes between templates.</p>
<p>The grammar for requirement mapping differs slightly from other 
substitution mapping grammars for the following two reasons: 
1. It is possible for a substituted node to have multiple
requirement 
assignments (up to the upper bound of the
<code>count_range</code>), 
each of which may need to be mapped separately. 
3. It is possible for the same requirement in a substituted node to
be 
mapped multiple times.</p>
<p>To accommodate these use cases, requirement mappings are defined
using 
YAML <em>lists</em> rather than <em>maps</em>. In addition, each of the
mappings in 
the list may in turn identify a <em>list</em> of requirements.</p>
<p>The grammar for requirement mappings is as follows:</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb267-1"><a aria-hidden="true" href="#cb267-1" tabindex="-1"></a><span class="fu">&lt;requirement_name&gt;</span><span class="kw">:</span></span>
<span id="cb267-2"><a aria-hidden="true" href="#cb267-2" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;node_template_name_1&gt;</span><span class="kw">,</span><span class="at"> &lt;node_template_requirement_name_1&gt; </span><span class="kw">]</span></span>
<span id="cb267-3"><a aria-hidden="true" href="#cb267-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> ...</span></span>
<span id="cb267-4"><a aria-hidden="true" href="#cb267-4" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;node_template_name_n&gt;</span><span class="kw">,</span><span class="at"> &lt;node_template_requirement_name_n&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>If the substituting template uses <em>selectable</em> nodes to
define 
requirements, then the following alternative syntax can be used:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb268-1"><a aria-hidden="true" href="#cb268-1" tabindex="-1"></a><span class="fu">&lt;requirement_name&gt;</span><span class="kw">:</span></span>
<span id="cb268-2"><a aria-hidden="true" href="#cb268-2" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;selectable_node_template_name_1&gt;</span></span>
<span id="cb268-3"><a aria-hidden="true" href="#cb268-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> ...</span></span>
<span id="cb268-4"><a aria-hidden="true" href="#cb268-4" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> &lt;selectable_node_template_name_n&gt;</span></span></code></pre></div>
<p>The TOSCA grammar allows mixing and matching these two
alternative 
syntaxes within the same requirement mappings list.</p>
<p>As an optimization, if the requirement mapping defines a
<em>one-to-one</em> 
mapping (i.e., a mapping of a requirement onto a single requirement
of 
a single node in the substituting template or a mapping to a
single 
selectable node), the following single-line grammar may be used:</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb269-1"><a aria-hidden="true" href="#cb269-1" tabindex="-1"></a><span class="fu">&lt;requirement_name&gt;</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;node_template_name&gt;</span><span class="kw">,</span><span class="at"> &lt;node_template_requirement_name&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb270-1"><a aria-hidden="true" href="#cb270-1" tabindex="-1"></a><span class="fu">&lt;requirement_name&gt;</span><span class="kw">:</span><span class="at"> &lt;selectable_node_template_name&gt;</span></span></code></pre></div>
<p>If we have several requirement mappings with the same requirement
name (i.e.  
as the key of the requirement mapping) that means that each
requirement 
assignment is mapped separately (in the order they appear in the
list). 
If there is only one requirement mapping with a certain requirement
name 
(i.e. as the key of the requirement mapping) then it means that
all 
requirements assignments of that requirement are mapped to the
same 
target requirement(s).</p>
<p>If we have several requirement mappings with the same requirement
name, 
and a consecutive subset of them have the same target reqirement(s),
instead 
of repeating the mapping we can use the following grammar:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb271-1"><a aria-hidden="true" href="#cb271-1" tabindex="-1"></a><span class="kw">[</span><span class="at"> &lt;requirement_name&gt;</span><span class="kw">,</span><span class="at"> &lt;count&gt; </span><span class="kw">]:</span><span class="at"> </span><span class="kw">[</span><span class="at"> &lt;node_template_name&gt;</span><span class="kw">,</span><span class="at"> &lt;node_template_requirement_name&gt; </span><span class="kw">]</span></span></code></pre></div>
<p>In the above grammars, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li>requirement_name: represents the name of the requirement as it<br/>
appears in the type definition for the node type name that is<br/>
declared as the value for on the substitution_mappings’
<code>node_type</code><br/>
key.</li>
<li>node_template_name: represents a valid name of a node template<br/>
definition within the same substituting service template</li>
<li>selectable_node_template_name: represents a valid name of a<br/>
selectable node template definition within the same substituting<br/>
service template</li>
<li>node_template_requirement_name: represents a valid name of a<br/>
requirement definition within the &lt;node_template_name&gt; declared
in<br/>
this mapping.</li>
<li>count: is the number of assignments of a requirement mapped to
the<br/>
same target requirement(s). It can be either a non-negetive integer
or<br/>
the keyword <code>UNBOUNDED</code>, which represents all the remaining
assignments.<br/>
Note that mappings with count can interspread mappings without
count<br/>
for the same requirement_name, however no other assignment for the<br/>
same requirement_name should not be used after one containing an<br/>
<code>UNBOUNDED</code> count.</li>
</ul>
<p>The following subsections illustrate this grammar in the context
of 
various use cases.</p>
<h3 id="mapping-multiple-requirements-with-the-same-name">15.5.1 Mapping
Multiple Requirements with the Same Name</h3>
<p>The following example shows a <code>Client</code> node type that
defines a 
<code>service</code> requirement with a <code>count_range</code> of
<code>[2, 2]</code>, which means 
that nodes of type <code>Client</code> need exactly two
<code>service</code> relationships 
to nodes of type <code>Server</code>.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb272-1"><a aria-hidden="true" href="#cb272-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb272-2"><a aria-hidden="true" href="#cb272-2" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb272-3"><a aria-hidden="true" href="#cb272-3" tabindex="-1"></a><span class="at">  </span><span class="fu">Service</span><span class="kw">:</span></span>
<span id="cb272-4"><a aria-hidden="true" href="#cb272-4" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb272-5"><a aria-hidden="true" href="#cb272-5" tabindex="-1"></a>      Ability to provide service.</span>
<span id="cb272-6"><a aria-hidden="true" href="#cb272-6" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb272-7"><a aria-hidden="true" href="#cb272-7" tabindex="-1"></a><span class="at">  </span><span class="fu">ServedBy</span><span class="kw">:</span></span>
<span id="cb272-8"><a aria-hidden="true" href="#cb272-8" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb272-9"><a aria-hidden="true" href="#cb272-9" tabindex="-1"></a>      Connection to a service.</span>
<span id="cb272-10"><a aria-hidden="true" href="#cb272-10" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb272-11"><a aria-hidden="true" href="#cb272-11" tabindex="-1"></a><span class="at">  </span><span class="fu">Client</span><span class="kw">:</span></span>
<span id="cb272-12"><a aria-hidden="true" href="#cb272-12" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb272-13"><a aria-hidden="true" href="#cb272-13" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb272-14"><a aria-hidden="true" href="#cb272-14" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb272-15"><a aria-hidden="true" href="#cb272-15" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb272-16"><a aria-hidden="true" href="#cb272-16" tabindex="-1"></a><span class="at">          </span><span class="fu">node</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb272-17"><a aria-hidden="true" href="#cb272-17" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">2</span><span class="kw">,</span><span class="at"> </span><span class="dv">2</span><span class="kw">]</span></span>
<span id="cb272-18"><a aria-hidden="true" href="#cb272-18" tabindex="-1"></a><span class="at">  </span><span class="fu">Server</span><span class="kw">:</span></span>
<span id="cb272-19"><a aria-hidden="true" href="#cb272-19" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb272-20"><a aria-hidden="true" href="#cb272-20" tabindex="-1"></a><span class="at">      </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb272-21"><a aria-hidden="true" href="#cb272-21" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Service</span></span></code></pre></div>
<p>This following figure shows a service that consists of one such
client 
node connected to two server nodes.</p>
<pre class="mermaid"><code>graph BT;
dummy((.)) ~~~  client
    subgraph T [Simple Service]
      client --&gt; |service| server1 
      client --&gt; |service| server2
    end</code></pre>
<p>This service can be implemented using the following TOSCA
service 
template:</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb274-1"><a aria-hidden="true" href="#cb274-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb274-2"><a aria-hidden="true" href="#cb274-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb274-3"><a aria-hidden="true" href="#cb274-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb274-4"><a aria-hidden="true" href="#cb274-4" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb274-5"><a aria-hidden="true" href="#cb274-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb274-6"><a aria-hidden="true" href="#cb274-6" tabindex="-1"></a><span class="at">    </span><span class="fu">server1</span><span class="kw">:</span></span>
<span id="cb274-7"><a aria-hidden="true" href="#cb274-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb274-8"><a aria-hidden="true" href="#cb274-8" tabindex="-1"></a><span class="at">    </span><span class="fu">server2</span><span class="kw">:</span></span>
<span id="cb274-9"><a aria-hidden="true" href="#cb274-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb274-10"><a aria-hidden="true" href="#cb274-10" tabindex="-1"></a><span class="at">    </span><span class="fu">client</span><span class="kw">:</span></span>
<span id="cb274-11"><a aria-hidden="true" href="#cb274-11" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb274-12"><a aria-hidden="true" href="#cb274-12" tabindex="-1"></a><span class="at">      </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> substitute </span><span class="kw">]</span></span>
<span id="cb274-13"><a aria-hidden="true" href="#cb274-13" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb274-14"><a aria-hidden="true" href="#cb274-14" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> server1</span></span>
<span id="cb274-15"><a aria-hidden="true" href="#cb274-15" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> server2</span></span></code></pre></div>
<p>In this template, the <code>client</code> node is annotated with
the 
<code>substitute</code> directive, which means that a substituting
template must 
be found to instantiate this node. The following figure shows one 
possible substitution.</p>
<pre class="mermaid"><code>graph BT
    S --&gt; |substitutes| client

    subgraph T [Top-Level Topology]
        client --&gt; |service| server1 
        client --&gt; |service| server2
    end
    
    subgraph S [Substituting Topology]
        direction BT
        software1 --&gt; |host| compute
        software2 --&gt; |host| compute
        software1 -.-&gt; |mapped&lt;br/&gt;service&lt;br/&gt;requirement| server1
        software2 -.-&gt; |mapped&lt;br/&gt;service&lt;br/&gt;requirement| server2
   end</code></pre>
<p>This substitution decomposes the <code>client</code> node into two
different 
<code>software</code> nodes, each with exactly one <code>service</code>
requirement. The 
requirement mapping syntax must <em>distribute</em> the two
<code>service</code> 
requirements from the substituted <code>client</code> node between the
<code>service</code> 
requirements of the two software nodes in the substituting 
template. The substitution mapping code in the following
substituting 
service template shows how this is accomplished:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb276-1"><a aria-hidden="true" href="#cb276-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb276-2"><a aria-hidden="true" href="#cb276-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb276-3"><a aria-hidden="true" href="#cb276-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb276-4"><a aria-hidden="true" href="#cb276-4" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb276-5"><a aria-hidden="true" href="#cb276-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb276-6"><a aria-hidden="true" href="#cb276-6" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb276-7"><a aria-hidden="true" href="#cb276-7" tabindex="-1"></a>      Ability to host software.</span>
<span id="cb276-8"><a aria-hidden="true" href="#cb276-8" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb276-9"><a aria-hidden="true" href="#cb276-9" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb276-10"><a aria-hidden="true" href="#cb276-10" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb276-11"><a aria-hidden="true" href="#cb276-11" tabindex="-1"></a>      Relationship to a host.</span>
<span id="cb276-12"><a aria-hidden="true" href="#cb276-12" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb276-13"><a aria-hidden="true" href="#cb276-13" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb276-14"><a aria-hidden="true" href="#cb276-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb276-15"><a aria-hidden="true" href="#cb276-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb276-16"><a aria-hidden="true" href="#cb276-16" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb276-17"><a aria-hidden="true" href="#cb276-17" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb276-18"><a aria-hidden="true" href="#cb276-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb276-19"><a aria-hidden="true" href="#cb276-19" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb276-20"><a aria-hidden="true" href="#cb276-20" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb276-21"><a aria-hidden="true" href="#cb276-21" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">1</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb276-22"><a aria-hidden="true" href="#cb276-22" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb276-23"><a aria-hidden="true" href="#cb276-23" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb276-24"><a aria-hidden="true" href="#cb276-24" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb276-25"><a aria-hidden="true" href="#cb276-25" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb276-26"><a aria-hidden="true" href="#cb276-26" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb276-27"><a aria-hidden="true" href="#cb276-27" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb276-28"><a aria-hidden="true" href="#cb276-28" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb276-29"><a aria-hidden="true" href="#cb276-29" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb276-30"><a aria-hidden="true" href="#cb276-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software1</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb276-31"><a aria-hidden="true" href="#cb276-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software2</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb276-32"><a aria-hidden="true" href="#cb276-32" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb276-33"><a aria-hidden="true" href="#cb276-33" tabindex="-1"></a><span class="at">    </span><span class="fu">software1</span><span class="kw">:</span></span>
<span id="cb276-34"><a aria-hidden="true" href="#cb276-34" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb276-35"><a aria-hidden="true" href="#cb276-35" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb276-36"><a aria-hidden="true" href="#cb276-36" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute1</span></span>
<span id="cb276-37"><a aria-hidden="true" href="#cb276-37" tabindex="-1"></a><span class="at">    </span><span class="fu">software2</span><span class="kw">:</span></span>
<span id="cb276-38"><a aria-hidden="true" href="#cb276-38" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb276-39"><a aria-hidden="true" href="#cb276-39" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb276-40"><a aria-hidden="true" href="#cb276-40" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute2</span></span>
<span id="cb276-41"><a aria-hidden="true" href="#cb276-41" tabindex="-1"></a><span class="at">    </span><span class="fu">compute1</span><span class="kw">:</span></span>
<span id="cb276-42"><a aria-hidden="true" href="#cb276-42" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb276-43"><a aria-hidden="true" href="#cb276-43" tabindex="-1"></a><span class="at">    </span><span class="fu">compute2</span><span class="kw">:</span></span>
<span id="cb276-44"><a aria-hidden="true" href="#cb276-44" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<p>The following figure shows an alternative substitution where
both 
<code>service</code> requirements of the substituted <code>client</code>
node are mapped to 
corresponding requirements of a single <code>software</code> node in
the 
substituting topology:</p>
<pre class="mermaid"><code>flowchart RL
    S --&gt; |substitutes| client

    subgraph T [Top-Level Topology]
        direction RL
        client --&gt; |service| server1 
        client --&gt; |service| server2
    end
    
    subgraph S [Substituting Topology]
        direction LR
        software --&gt; |host| compute
        software -.-&gt; |mapped&lt;br/&gt;service&lt;br/&gt;requirement| server1
        software -.-&gt; |mapped&lt;br/&gt;service&lt;br/&gt;requirement| server2
   end</code></pre>
<p>The requirement mapping syntax for this template distributes the
two 
<code>service</code> requirements from the substituted
<code>client</code> node to <em>the 
same</em> software node in the substituting template using two
identical 
mappings for the two <code>service</code> requirements as follows:</p>
<div class="sourceCode" id="cb278"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb278-1"><a aria-hidden="true" href="#cb278-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb278-2"><a aria-hidden="true" href="#cb278-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb278-3"><a aria-hidden="true" href="#cb278-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb278-4"><a aria-hidden="true" href="#cb278-4" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb278-5"><a aria-hidden="true" href="#cb278-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb278-6"><a aria-hidden="true" href="#cb278-6" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb278-7"><a aria-hidden="true" href="#cb278-7" tabindex="-1"></a>      Ability to host software.</span>
<span id="cb278-8"><a aria-hidden="true" href="#cb278-8" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb278-9"><a aria-hidden="true" href="#cb278-9" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb278-10"><a aria-hidden="true" href="#cb278-10" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb278-11"><a aria-hidden="true" href="#cb278-11" tabindex="-1"></a>      Relationship to a host.</span>
<span id="cb278-12"><a aria-hidden="true" href="#cb278-12" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb278-13"><a aria-hidden="true" href="#cb278-13" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb278-14"><a aria-hidden="true" href="#cb278-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb278-15"><a aria-hidden="true" href="#cb278-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb278-16"><a aria-hidden="true" href="#cb278-16" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb278-17"><a aria-hidden="true" href="#cb278-17" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb278-18"><a aria-hidden="true" href="#cb278-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb278-19"><a aria-hidden="true" href="#cb278-19" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb278-20"><a aria-hidden="true" href="#cb278-20" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb278-21"><a aria-hidden="true" href="#cb278-21" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">2</span><span class="kw">,</span><span class="at"> </span><span class="dv">2</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb278-22"><a aria-hidden="true" href="#cb278-22" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb278-23"><a aria-hidden="true" href="#cb278-23" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb278-24"><a aria-hidden="true" href="#cb278-24" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb278-25"><a aria-hidden="true" href="#cb278-25" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb278-26"><a aria-hidden="true" href="#cb278-26" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb278-27"><a aria-hidden="true" href="#cb278-27" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb278-28"><a aria-hidden="true" href="#cb278-28" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb278-29"><a aria-hidden="true" href="#cb278-29" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb278-30"><a aria-hidden="true" href="#cb278-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb278-31"><a aria-hidden="true" href="#cb278-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb278-32"><a aria-hidden="true" href="#cb278-32" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb278-33"><a aria-hidden="true" href="#cb278-33" tabindex="-1"></a><span class="at">    </span><span class="fu">software</span><span class="kw">:</span></span>
<span id="cb278-34"><a aria-hidden="true" href="#cb278-34" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb278-35"><a aria-hidden="true" href="#cb278-35" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb278-36"><a aria-hidden="true" href="#cb278-36" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb278-37"><a aria-hidden="true" href="#cb278-37" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb278-38"><a aria-hidden="true" href="#cb278-38" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<p>As a convenience feature, it is possible to <em>group</em> identical
mapping 
statements using the syntax in the following example. This syntax 
states that two <code>service</code> requirements of the substituted
node are 
mapped to two corresponding <code>service</code> requirements of the
<code>software</code> 
node in the substituting template.</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb279-1"><a aria-hidden="true" href="#cb279-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb279-2"><a aria-hidden="true" href="#cb279-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb279-3"><a aria-hidden="true" href="#cb279-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb279-4"><a aria-hidden="true" href="#cb279-4" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb279-5"><a aria-hidden="true" href="#cb279-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb279-6"><a aria-hidden="true" href="#cb279-6" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb279-7"><a aria-hidden="true" href="#cb279-7" tabindex="-1"></a>      Ability to host software.</span>
<span id="cb279-8"><a aria-hidden="true" href="#cb279-8" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb279-9"><a aria-hidden="true" href="#cb279-9" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb279-10"><a aria-hidden="true" href="#cb279-10" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb279-11"><a aria-hidden="true" href="#cb279-11" tabindex="-1"></a>      Relationship to a host.</span>
<span id="cb279-12"><a aria-hidden="true" href="#cb279-12" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb279-13"><a aria-hidden="true" href="#cb279-13" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb279-14"><a aria-hidden="true" href="#cb279-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb279-15"><a aria-hidden="true" href="#cb279-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb279-16"><a aria-hidden="true" href="#cb279-16" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb279-17"><a aria-hidden="true" href="#cb279-17" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb279-18"><a aria-hidden="true" href="#cb279-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb279-19"><a aria-hidden="true" href="#cb279-19" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb279-20"><a aria-hidden="true" href="#cb279-20" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb279-21"><a aria-hidden="true" href="#cb279-21" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">2</span><span class="kw">,</span><span class="at"> </span><span class="dv">2</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb279-22"><a aria-hidden="true" href="#cb279-22" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb279-23"><a aria-hidden="true" href="#cb279-23" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb279-24"><a aria-hidden="true" href="#cb279-24" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb279-25"><a aria-hidden="true" href="#cb279-25" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb279-26"><a aria-hidden="true" href="#cb279-26" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb279-27"><a aria-hidden="true" href="#cb279-27" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb279-28"><a aria-hidden="true" href="#cb279-28" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb279-29"><a aria-hidden="true" href="#cb279-29" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb279-30"><a aria-hidden="true" href="#cb279-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="at">service</span><span class="kw">,</span><span class="at"> </span><span class="dv">2</span><span class="at"> </span><span class="kw">]:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb279-31"><a aria-hidden="true" href="#cb279-31" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb279-32"><a aria-hidden="true" href="#cb279-32" tabindex="-1"></a><span class="at">    </span><span class="fu">software</span><span class="kw">:</span></span>
<span id="cb279-33"><a aria-hidden="true" href="#cb279-33" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb279-34"><a aria-hidden="true" href="#cb279-34" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb279-35"><a aria-hidden="true" href="#cb279-35" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb279-36"><a aria-hidden="true" href="#cb279-36" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb279-37"><a aria-hidden="true" href="#cb279-37" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<p>As a further convenience feature, if all of the requirement
assignments 
are mapped to the same target requirement(s) is possible to drop
the 
grammar using the count. This syntax states that all
<code>service</code> requirements 
of the substituted node are mapped to the corresponding
<code>service</code> 
requirements of the <code>software</code> node in the substituting
template.</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb280-1"><a aria-hidden="true" href="#cb280-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb280-2"><a aria-hidden="true" href="#cb280-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb280-3"><a aria-hidden="true" href="#cb280-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb280-4"><a aria-hidden="true" href="#cb280-4" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb280-5"><a aria-hidden="true" href="#cb280-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb280-6"><a aria-hidden="true" href="#cb280-6" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb280-7"><a aria-hidden="true" href="#cb280-7" tabindex="-1"></a>      Ability to host software.</span>
<span id="cb280-8"><a aria-hidden="true" href="#cb280-8" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb280-9"><a aria-hidden="true" href="#cb280-9" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb280-10"><a aria-hidden="true" href="#cb280-10" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb280-11"><a aria-hidden="true" href="#cb280-11" tabindex="-1"></a>      Relationship to a host.</span>
<span id="cb280-12"><a aria-hidden="true" href="#cb280-12" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb280-13"><a aria-hidden="true" href="#cb280-13" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb280-14"><a aria-hidden="true" href="#cb280-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb280-15"><a aria-hidden="true" href="#cb280-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb280-16"><a aria-hidden="true" href="#cb280-16" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb280-17"><a aria-hidden="true" href="#cb280-17" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb280-18"><a aria-hidden="true" href="#cb280-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb280-19"><a aria-hidden="true" href="#cb280-19" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb280-20"><a aria-hidden="true" href="#cb280-20" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb280-21"><a aria-hidden="true" href="#cb280-21" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">2</span><span class="kw">,</span><span class="at"> </span><span class="dv">2</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb280-22"><a aria-hidden="true" href="#cb280-22" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb280-23"><a aria-hidden="true" href="#cb280-23" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb280-24"><a aria-hidden="true" href="#cb280-24" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb280-25"><a aria-hidden="true" href="#cb280-25" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb280-26"><a aria-hidden="true" href="#cb280-26" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb280-27"><a aria-hidden="true" href="#cb280-27" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb280-28"><a aria-hidden="true" href="#cb280-28" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb280-29"><a aria-hidden="true" href="#cb280-29" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb280-30"><a aria-hidden="true" href="#cb280-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb280-31"><a aria-hidden="true" href="#cb280-31" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb280-32"><a aria-hidden="true" href="#cb280-32" tabindex="-1"></a><span class="at">    </span><span class="fu">software</span><span class="kw">:</span></span>
<span id="cb280-33"><a aria-hidden="true" href="#cb280-33" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb280-34"><a aria-hidden="true" href="#cb280-34" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb280-35"><a aria-hidden="true" href="#cb280-35" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb280-36"><a aria-hidden="true" href="#cb280-36" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb280-37"><a aria-hidden="true" href="#cb280-37" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<h3 id="mapping-a-requirement-multiple-times">15.5.2 Mapping a
Requirement Multiple Times</h3>
<p>Imagine a scenario where nodes of type <code>Client</code> need to be
hosted on 
nodes of type <code>Compute</code> as shown by the following type
definitions:</p>
<div class="sourceCode" id="cb281"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb281-1"><a aria-hidden="true" href="#cb281-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb281-2"><a aria-hidden="true" href="#cb281-2" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb281-3"><a aria-hidden="true" href="#cb281-3" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb281-4"><a aria-hidden="true" href="#cb281-4" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb281-5"><a aria-hidden="true" href="#cb281-5" tabindex="-1"></a>      Ability to host software.</span>
<span id="cb281-6"><a aria-hidden="true" href="#cb281-6" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb281-7"><a aria-hidden="true" href="#cb281-7" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb281-8"><a aria-hidden="true" href="#cb281-8" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb281-9"><a aria-hidden="true" href="#cb281-9" tabindex="-1"></a>      Relationship to a host.</span>
<span id="cb281-10"><a aria-hidden="true" href="#cb281-10" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb281-11"><a aria-hidden="true" href="#cb281-11" tabindex="-1"></a><span class="at">  </span><span class="fu">Client</span><span class="kw">:</span></span>
<span id="cb281-12"><a aria-hidden="true" href="#cb281-12" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb281-13"><a aria-hidden="true" href="#cb281-13" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb281-14"><a aria-hidden="true" href="#cb281-14" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb281-15"><a aria-hidden="true" href="#cb281-15" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb281-16"><a aria-hidden="true" href="#cb281-16" tabindex="-1"></a><span class="at">          </span><span class="fu">node</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb281-17"><a aria-hidden="true" href="#cb281-17" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">1</span><span class="kw">]</span></span>
<span id="cb281-18"><a aria-hidden="true" href="#cb281-18" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb281-19"><a aria-hidden="true" href="#cb281-19" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb281-20"><a aria-hidden="true" href="#cb281-20" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb281-21"><a aria-hidden="true" href="#cb281-21" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span></code></pre></div>
<p>The following figure shows a service that contains one node of
type 
<code>Client</code>, one node of type <code>Compute</code>, and the
<code>host</code> relationship 
between them:</p>
<pre class="mermaid"><code>flowchart RL
    subgraph T [Top-Level Topology]
        client --&gt; |host| compute
   end</code></pre>
<p>This example can be implemented using the following service
template:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb283-1"><a aria-hidden="true" href="#cb283-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb283-2"><a aria-hidden="true" href="#cb283-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb283-3"><a aria-hidden="true" href="#cb283-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb283-4"><a aria-hidden="true" href="#cb283-4" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb283-5"><a aria-hidden="true" href="#cb283-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb283-6"><a aria-hidden="true" href="#cb283-6" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb283-7"><a aria-hidden="true" href="#cb283-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb283-8"><a aria-hidden="true" href="#cb283-8" tabindex="-1"></a><span class="at">    </span><span class="fu">client</span><span class="kw">:</span></span>
<span id="cb283-9"><a aria-hidden="true" href="#cb283-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb283-10"><a aria-hidden="true" href="#cb283-10" tabindex="-1"></a><span class="at">      </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> substitute </span><span class="kw">]</span></span>
<span id="cb283-11"><a aria-hidden="true" href="#cb283-11" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb283-12"><a aria-hidden="true" href="#cb283-12" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span></code></pre></div>
<p>The following figure shows a substituting topology that
<em>decomposes</em> 
the node of type <code>Client</code> into two software components, each
of which 
needs to be hosted on the same <code>compute</code> node defined in the
top-level 
template that defines the <code>client</code> node.</p>
<pre class="mermaid"><code>flowchart RL
    S --&gt; |substitutes| client

    subgraph T [Top-Level Topology]
        client --&gt; |host| compute 
    end
    
    subgraph S [Substituting Topology]
        software1 -.-&gt; |mapped&lt;br/&gt;host&lt;br/&gt;requirement| compute
        software2 -.-&gt; |mapped&lt;br/&gt;host&lt;br/&gt;requirement| compute
   end</code></pre>
<p>The requirement mapping syntax must <em>replicate</em> the single
<code>host</code> 
requirements from the substituted <code>client</code> node to the two
software 
nodes in the subsituting template. The substitution mapping code
in 
the following substituting service template shows how this is 
accomplished by mapping the <code>host</code> requirement of the
<code>client</code> node 
twice, once to the <code>host</code> requirement of the
<code>software1</code> node and once 
to the <code>host</code> requirement of the <code>software2</code>
node.</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb285-1"><a aria-hidden="true" href="#cb285-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb285-2"><a aria-hidden="true" href="#cb285-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb285-3"><a aria-hidden="true" href="#cb285-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb285-4"><a aria-hidden="true" href="#cb285-4" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb285-5"><a aria-hidden="true" href="#cb285-5" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb285-6"><a aria-hidden="true" href="#cb285-6" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb285-7"><a aria-hidden="true" href="#cb285-7" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb285-8"><a aria-hidden="true" href="#cb285-8" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb285-9"><a aria-hidden="true" href="#cb285-9" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb285-10"><a aria-hidden="true" href="#cb285-10" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">1</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb285-11"><a aria-hidden="true" href="#cb285-11" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb285-12"><a aria-hidden="true" href="#cb285-12" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb285-13"><a aria-hidden="true" href="#cb285-13" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb285-14"><a aria-hidden="true" href="#cb285-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb285-15"><a aria-hidden="true" href="#cb285-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb285-16"><a aria-hidden="true" href="#cb285-16" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="at"> software1</span><span class="kw">,</span><span class="at"> host </span><span class="kw">]</span></span>
<span id="cb285-17"><a aria-hidden="true" href="#cb285-17" tabindex="-1"></a><span class="at">          </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="at"> software2</span><span class="kw">,</span><span class="at"> host </span><span class="kw">]</span></span>
<span id="cb285-18"><a aria-hidden="true" href="#cb285-18" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb285-19"><a aria-hidden="true" href="#cb285-19" tabindex="-1"></a><span class="at">    </span><span class="fu">software1</span><span class="kw">:</span></span>
<span id="cb285-20"><a aria-hidden="true" href="#cb285-20" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb285-21"><a aria-hidden="true" href="#cb285-21" tabindex="-1"></a><span class="at">    </span><span class="fu">software2</span><span class="kw">:</span></span>
<span id="cb285-22"><a aria-hidden="true" href="#cb285-22" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span></code></pre></div>
<p>Using this syntax, the target of the requirement mapping is a
<em>list</em> 
of target requirements rather than a single requirement.</p>
<h3 id="requirement-mapping-and-selectable-nodes">15.5.3 Requirement
Mapping and Selectable Nodes</h3>
<p>The previous section shows a use case where the target node of
a 
requirement of the substituted node is to be used multiple times
as 
the target node of <em>multiple different requirements</em> in a
subsituting 
template. The need for multiple requirements to be fulfilled by
the 
same target node is quite common and usually exists independently
of 
whether the service template is used as a substitution or as a 
stand-alone service. In fact, the TOSCA <em>selectable node</em> feature
was 
introduced specifically for scenarios where requirements of
different 
nodes need to be fulfilled by the same target node.</p>
<p>The requirement mapping examples presented so far only show how to
map 
requirements of a substituted node onto <em>dangling</em> requirements
of 
nodes in the substituting template. This section shows how
requirement 
mappings can also be used in conjunction with selectable nodes in 
substituting templates.</p>
<p>Let’s again consider the scenario from the previous section where
a 
node of type <code>Client</code> is hosted on a node of type
`Compute:</p>
<pre class="mermaid"><code>flowchart RL
    subgraph T [Top-Level Topology]
        client --&gt; |host| compute
   end</code></pre>
<p>The following service template shows an implementation of this
example:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb287-1"><a aria-hidden="true" href="#cb287-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb287-2"><a aria-hidden="true" href="#cb287-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb287-3"><a aria-hidden="true" href="#cb287-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb287-4"><a aria-hidden="true" href="#cb287-4" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb287-5"><a aria-hidden="true" href="#cb287-5" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb287-6"><a aria-hidden="true" href="#cb287-6" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb287-7"><a aria-hidden="true" href="#cb287-7" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb287-8"><a aria-hidden="true" href="#cb287-8" tabindex="-1"></a><span class="at">    </span><span class="fu">client</span><span class="kw">:</span></span>
<span id="cb287-9"><a aria-hidden="true" href="#cb287-9" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb287-10"><a aria-hidden="true" href="#cb287-10" tabindex="-1"></a><span class="at">      </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> substitute </span><span class="kw">]</span></span>
<span id="cb287-11"><a aria-hidden="true" href="#cb287-11" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb287-12"><a aria-hidden="true" href="#cb287-12" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span></code></pre></div>
<p>The following figure shows a substituting topology that
<em>decomposes</em> 
the node of type <code>Client</code> into two software components, each
of which 
needs to be hosted on the same <code>compute</code> node. Unlike in the
example 
in the previous section, a <em>selectable</em> node is used to express
the 
need for both software components to be hosted on the same
<code>compute</code> 
node:</p>
<pre class="mermaid"><code>flowchart RL
    subgraph S [Substituting Topology]
        host("compute&lt;br/&gt;[select]")
        software1 --&gt; |host| host 
        software2 --&gt; |host| host 
   end</code></pre>
<p>The requirement mappings defined in the corresponding service
template 
must express that the target node of the <code>host</code> requirement
of the 
substituted node is to be <em>selected</em> as the node represented by
the 
<em>selectable</em> <code>compute</code> node in the subsituting
template, as shown in 
the following Figure:</p>
<pre class="mermaid"><code>flowchart RL
    S --&gt; |substitutes| client
    subgraph T [Top-Level Topology]
        client --&gt; |host| compute 
    end 
    subgraph S [Substituting Topology]
        host("compute&lt;br/&gt;[select]")
        software1 --&gt; |host| host 
        software2 --&gt; |host| host 
        host -.-&gt; |mapped&lt;br/&gt;host&lt;br/&gt;requirement| compute
   end</code></pre>
<p>This can trivially be done using the syntax shown in the
following 
code snippet:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb290-1"><a aria-hidden="true" href="#cb290-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb290-2"><a aria-hidden="true" href="#cb290-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb290-3"><a aria-hidden="true" href="#cb290-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb290-4"><a aria-hidden="true" href="#cb290-4" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb290-5"><a aria-hidden="true" href="#cb290-5" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb290-6"><a aria-hidden="true" href="#cb290-6" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb290-7"><a aria-hidden="true" href="#cb290-7" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb290-8"><a aria-hidden="true" href="#cb290-8" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb290-9"><a aria-hidden="true" href="#cb290-9" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb290-10"><a aria-hidden="true" href="#cb290-10" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">1</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb290-11"><a aria-hidden="true" href="#cb290-11" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb290-12"><a aria-hidden="true" href="#cb290-12" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb290-13"><a aria-hidden="true" href="#cb290-13" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb290-14"><a aria-hidden="true" href="#cb290-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb290-15"><a aria-hidden="true" href="#cb290-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb290-16"><a aria-hidden="true" href="#cb290-16" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb290-17"><a aria-hidden="true" href="#cb290-17" tabindex="-1"></a><span class="at">    </span><span class="fu">software1</span><span class="kw">:</span></span>
<span id="cb290-18"><a aria-hidden="true" href="#cb290-18" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb290-19"><a aria-hidden="true" href="#cb290-19" tabindex="-1"></a><span class="at">    </span><span class="fu">software2</span><span class="kw">:</span></span>
<span id="cb290-20"><a aria-hidden="true" href="#cb290-20" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb290-21"><a aria-hidden="true" href="#cb290-21" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb290-22"><a aria-hidden="true" href="#cb290-22" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb290-23"><a aria-hidden="true" href="#cb290-23" tabindex="-1"></a><span class="at">      </span><span class="fu">directives</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">select</span><span class="kw">]</span></span></code></pre></div>
<p>The substitution mapping code in this service template provides
an 
elegant mechanism for expressing that the target node of the
<code>host</code> 
requirement of the <code>client</code> node is to be mapped directly to
the 
<em>selectable</em> <code>compute</code> node in the substituting
template.</p>
<h3 id="requirement-mapping-rules">15.5.4 Requirement Mapping Rules</h3>
<p>This section documents the rules for requirement mapping.</p>
<ol type="1">
<li>Requirements from a <em>substituted</em> node can only be mapped
onto<br/>
<em>dangling</em> requirements in the substituting template.</li>
<li>The total number of requirements mapped onto
<em>mandatory</em><br/>
requirements in the substituting template must not exceed the
lower<br/>
bound of the <code>count_range</code> in the corresponding
requirement<br/>
definition in the substituted node’s type.</li>
<li>The total number of requirement mappings must not exceed the
upper<br/>
bound of the <code>count_range</code> in the corresponding
requirement<br/>
definition in the substituted node’s type. Note that this is a<br/>
convenience rule only, since according to rule 2, any
<em>excess</em><br/>
mappings would have to map onto optional requirements, and as a<br/>
result can safely be ignored.</li>
</ol>
<p>Note that there are no constraints on the minimum number of 
requirement mappings. More specifically, the total number of 
requirement mappings is allowed to be smaller than the lower bound
of 
the <code>count_range</code> in the corresponding requirement
definition.</p>
<p>The types defined in the following code snippet are used to
illustrate 
these rules:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb291-1"><a aria-hidden="true" href="#cb291-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb291-2"><a aria-hidden="true" href="#cb291-2" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb291-3"><a aria-hidden="true" href="#cb291-3" tabindex="-1"></a><span class="at">  </span><span class="fu">Service</span><span class="kw">:</span></span>
<span id="cb291-4"><a aria-hidden="true" href="#cb291-4" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb291-5"><a aria-hidden="true" href="#cb291-5" tabindex="-1"></a>      Ability to provide service.</span>
<span id="cb291-6"><a aria-hidden="true" href="#cb291-6" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb291-7"><a aria-hidden="true" href="#cb291-7" tabindex="-1"></a><span class="at">  </span><span class="fu">ServedBy</span><span class="kw">:</span></span>
<span id="cb291-8"><a aria-hidden="true" href="#cb291-8" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb291-9"><a aria-hidden="true" href="#cb291-9" tabindex="-1"></a>      Connection to a service.</span>
<span id="cb291-10"><a aria-hidden="true" href="#cb291-10" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb291-11"><a aria-hidden="true" href="#cb291-11" tabindex="-1"></a><span class="at">  </span><span class="fu">Client</span><span class="kw">:</span></span>
<span id="cb291-12"><a aria-hidden="true" href="#cb291-12" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb291-13"><a aria-hidden="true" href="#cb291-13" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb291-14"><a aria-hidden="true" href="#cb291-14" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb291-15"><a aria-hidden="true" href="#cb291-15" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb291-16"><a aria-hidden="true" href="#cb291-16" tabindex="-1"></a><span class="at">          </span><span class="fu">node</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb291-17"><a aria-hidden="true" href="#cb291-17" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">4</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb291-18"><a aria-hidden="true" href="#cb291-18" tabindex="-1"></a><span class="at">  </span><span class="fu">Server</span><span class="kw">:</span></span>
<span id="cb291-19"><a aria-hidden="true" href="#cb291-19" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb291-20"><a aria-hidden="true" href="#cb291-20" tabindex="-1"></a><span class="at">      </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb291-21"><a aria-hidden="true" href="#cb291-21" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Service</span></span></code></pre></div>
<p>In this example, the <code>Client</code> node type defines a
<code>service</code> 
requirement with a <code>count_range</code> of <code>[1, 4]</code>. This
means that a client 
can have up to four <code>service</code> connections to a
<code>Server</code> node, but only 
one of those is mandatory.</p>
<p>The following code snippet shows a valid substituting template for
the 
<code>client</code> node in the template shown above:</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb292-1"><a aria-hidden="true" href="#cb292-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb292-2"><a aria-hidden="true" href="#cb292-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb292-3"><a aria-hidden="true" href="#cb292-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb292-4"><a aria-hidden="true" href="#cb292-4" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb292-5"><a aria-hidden="true" href="#cb292-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb292-6"><a aria-hidden="true" href="#cb292-6" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb292-7"><a aria-hidden="true" href="#cb292-7" tabindex="-1"></a>      Ability to host software.</span>
<span id="cb292-8"><a aria-hidden="true" href="#cb292-8" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb292-9"><a aria-hidden="true" href="#cb292-9" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb292-10"><a aria-hidden="true" href="#cb292-10" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb292-11"><a aria-hidden="true" href="#cb292-11" tabindex="-1"></a>      Relationship to a host.</span>
<span id="cb292-12"><a aria-hidden="true" href="#cb292-12" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb292-13"><a aria-hidden="true" href="#cb292-13" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb292-14"><a aria-hidden="true" href="#cb292-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb292-15"><a aria-hidden="true" href="#cb292-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb292-16"><a aria-hidden="true" href="#cb292-16" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb292-17"><a aria-hidden="true" href="#cb292-17" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb292-18"><a aria-hidden="true" href="#cb292-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb292-19"><a aria-hidden="true" href="#cb292-19" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb292-20"><a aria-hidden="true" href="#cb292-20" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb292-21"><a aria-hidden="true" href="#cb292-21" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">1</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb292-22"><a aria-hidden="true" href="#cb292-22" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb292-23"><a aria-hidden="true" href="#cb292-23" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb292-24"><a aria-hidden="true" href="#cb292-24" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb292-25"><a aria-hidden="true" href="#cb292-25" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb292-26"><a aria-hidden="true" href="#cb292-26" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb292-27"><a aria-hidden="true" href="#cb292-27" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb292-28"><a aria-hidden="true" href="#cb292-28" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb292-29"><a aria-hidden="true" href="#cb292-29" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb292-30"><a aria-hidden="true" href="#cb292-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb292-31"><a aria-hidden="true" href="#cb292-31" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb292-32"><a aria-hidden="true" href="#cb292-32" tabindex="-1"></a><span class="at">    </span><span class="fu">software</span><span class="kw">:</span></span>
<span id="cb292-33"><a aria-hidden="true" href="#cb292-33" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb292-34"><a aria-hidden="true" href="#cb292-34" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb292-35"><a aria-hidden="true" href="#cb292-35" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb292-36"><a aria-hidden="true" href="#cb292-36" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb292-37"><a aria-hidden="true" href="#cb292-37" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<p>While the substituted <code>client</code> node in the template above
has three 
requirement assigments with target nodes, only one of those 
requirements is mapped to a requirement in the substituting
template.</p>
<p>The next code snippet shows a slightly different substituting
template 
for the <code>client</code> node in the template shown above. This
template 
<em>decomposes</em> the <code>client</code> node into three different
software nodes, 
each with a single <code>service</code> requirement to its own server.
The 
substitution mapping defines three requirement mappings for the 
<code>service</code> requirement of the <code>client</code> node, one to
each of the 
<code>service</code> requirements of the <code>software</code> nodes in
the substituting 
template.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb293-1"><a aria-hidden="true" href="#cb293-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb293-2"><a aria-hidden="true" href="#cb293-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb293-3"><a aria-hidden="true" href="#cb293-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb293-4"><a aria-hidden="true" href="#cb293-4" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb293-5"><a aria-hidden="true" href="#cb293-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb293-6"><a aria-hidden="true" href="#cb293-6" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb293-7"><a aria-hidden="true" href="#cb293-7" tabindex="-1"></a>      Ability to host software.</span>
<span id="cb293-8"><a aria-hidden="true" href="#cb293-8" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb293-9"><a aria-hidden="true" href="#cb293-9" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb293-10"><a aria-hidden="true" href="#cb293-10" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb293-11"><a aria-hidden="true" href="#cb293-11" tabindex="-1"></a>      Relationship to a host.</span>
<span id="cb293-12"><a aria-hidden="true" href="#cb293-12" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb293-13"><a aria-hidden="true" href="#cb293-13" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb293-14"><a aria-hidden="true" href="#cb293-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb293-15"><a aria-hidden="true" href="#cb293-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb293-16"><a aria-hidden="true" href="#cb293-16" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb293-17"><a aria-hidden="true" href="#cb293-17" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb293-18"><a aria-hidden="true" href="#cb293-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb293-19"><a aria-hidden="true" href="#cb293-19" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb293-20"><a aria-hidden="true" href="#cb293-20" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb293-21"><a aria-hidden="true" href="#cb293-21" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">1</span><span class="kw">,</span><span class="at"> </span><span class="dv">1</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb293-22"><a aria-hidden="true" href="#cb293-22" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb293-23"><a aria-hidden="true" href="#cb293-23" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb293-24"><a aria-hidden="true" href="#cb293-24" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb293-25"><a aria-hidden="true" href="#cb293-25" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb293-26"><a aria-hidden="true" href="#cb293-26" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb293-27"><a aria-hidden="true" href="#cb293-27" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb293-28"><a aria-hidden="true" href="#cb293-28" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb293-29"><a aria-hidden="true" href="#cb293-29" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb293-30"><a aria-hidden="true" href="#cb293-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software1</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb293-31"><a aria-hidden="true" href="#cb293-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software2</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb293-32"><a aria-hidden="true" href="#cb293-32" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software3</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb293-33"><a aria-hidden="true" href="#cb293-33" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb293-34"><a aria-hidden="true" href="#cb293-34" tabindex="-1"></a><span class="at">    </span><span class="fu">software1</span><span class="kw">:</span></span>
<span id="cb293-35"><a aria-hidden="true" href="#cb293-35" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb293-36"><a aria-hidden="true" href="#cb293-36" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb293-37"><a aria-hidden="true" href="#cb293-37" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute1</span></span>
<span id="cb293-38"><a aria-hidden="true" href="#cb293-38" tabindex="-1"></a><span class="at">    </span><span class="fu">software2</span><span class="kw">:</span></span>
<span id="cb293-39"><a aria-hidden="true" href="#cb293-39" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb293-40"><a aria-hidden="true" href="#cb293-40" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb293-41"><a aria-hidden="true" href="#cb293-41" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute2</span></span>
<span id="cb293-42"><a aria-hidden="true" href="#cb293-42" tabindex="-1"></a><span class="at">    </span><span class="fu">software3</span><span class="kw">:</span></span>
<span id="cb293-43"><a aria-hidden="true" href="#cb293-43" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb293-44"><a aria-hidden="true" href="#cb293-44" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb293-45"><a aria-hidden="true" href="#cb293-45" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute3</span></span>
<span id="cb293-46"><a aria-hidden="true" href="#cb293-46" tabindex="-1"></a><span class="at">    </span><span class="fu">compute1</span><span class="kw">:</span></span>
<span id="cb293-47"><a aria-hidden="true" href="#cb293-47" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb293-48"><a aria-hidden="true" href="#cb293-48" tabindex="-1"></a><span class="at">    </span><span class="fu">compute2</span><span class="kw">:</span></span>
<span id="cb293-49"><a aria-hidden="true" href="#cb293-49" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb293-50"><a aria-hidden="true" href="#cb293-50" tabindex="-1"></a><span class="at">    </span><span class="fu">compute3</span><span class="kw">:</span></span>
<span id="cb293-51"><a aria-hidden="true" href="#cb293-51" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<p>Unfortunately, this substituting template is invalid. Since the 
<code>service</code> requirement of each <code>software</code> node is
mandatory, this 
template needs three different <code>service</code> requirements in any
node of 
type <code>Client</code> for which it is a substitution. This cannot
be 
guaranteed, since the <code>service</code> requirement definition in the
<code>Client</code> 
node type specifies a <code>count_range</code> with a lower bound of
one, which 
means that only such requirement is guaranteed to exist.</p>
<p>The following shows a corrected version of this substituting
template:</p>
<div class="sourceCode" id="cb294"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb294-1"><a aria-hidden="true" href="#cb294-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb294-2"><a aria-hidden="true" href="#cb294-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb294-3"><a aria-hidden="true" href="#cb294-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb294-4"><a aria-hidden="true" href="#cb294-4" tabindex="-1"></a><span class="fu">capability_types</span><span class="kw">:</span></span>
<span id="cb294-5"><a aria-hidden="true" href="#cb294-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Host</span><span class="kw">:</span></span>
<span id="cb294-6"><a aria-hidden="true" href="#cb294-6" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb294-7"><a aria-hidden="true" href="#cb294-7" tabindex="-1"></a>      Ability to host software.</span>
<span id="cb294-8"><a aria-hidden="true" href="#cb294-8" tabindex="-1"></a><span class="fu">relationship_types</span><span class="kw">:</span></span>
<span id="cb294-9"><a aria-hidden="true" href="#cb294-9" tabindex="-1"></a><span class="at">  </span><span class="fu">HostedOn</span><span class="kw">:</span></span>
<span id="cb294-10"><a aria-hidden="true" href="#cb294-10" tabindex="-1"></a><span class="fu">    description</span><span class="kw">: </span><span class="ch">&gt;-</span></span>
<span id="cb294-11"><a aria-hidden="true" href="#cb294-11" tabindex="-1"></a>      Relationship to a host.</span>
<span id="cb294-12"><a aria-hidden="true" href="#cb294-12" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb294-13"><a aria-hidden="true" href="#cb294-13" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb294-14"><a aria-hidden="true" href="#cb294-14" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb294-15"><a aria-hidden="true" href="#cb294-15" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb294-16"><a aria-hidden="true" href="#cb294-16" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb294-17"><a aria-hidden="true" href="#cb294-17" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb294-18"><a aria-hidden="true" href="#cb294-18" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb294-19"><a aria-hidden="true" href="#cb294-19" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb294-20"><a aria-hidden="true" href="#cb294-20" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb294-21"><a aria-hidden="true" href="#cb294-21" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> </span><span class="dv">1</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb294-22"><a aria-hidden="true" href="#cb294-22" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb294-23"><a aria-hidden="true" href="#cb294-23" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb294-24"><a aria-hidden="true" href="#cb294-24" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb294-25"><a aria-hidden="true" href="#cb294-25" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb294-26"><a aria-hidden="true" href="#cb294-26" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb294-27"><a aria-hidden="true" href="#cb294-27" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb294-28"><a aria-hidden="true" href="#cb294-28" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb294-29"><a aria-hidden="true" href="#cb294-29" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb294-30"><a aria-hidden="true" href="#cb294-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software1</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb294-31"><a aria-hidden="true" href="#cb294-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software2</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb294-32"><a aria-hidden="true" href="#cb294-32" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software3</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb294-33"><a aria-hidden="true" href="#cb294-33" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb294-34"><a aria-hidden="true" href="#cb294-34" tabindex="-1"></a><span class="at">    </span><span class="fu">software1</span><span class="kw">:</span></span>
<span id="cb294-35"><a aria-hidden="true" href="#cb294-35" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb294-36"><a aria-hidden="true" href="#cb294-36" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb294-37"><a aria-hidden="true" href="#cb294-37" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute1</span></span>
<span id="cb294-38"><a aria-hidden="true" href="#cb294-38" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb294-39"><a aria-hidden="true" href="#cb294-39" tabindex="-1"></a><span class="at">            </span><span class="fu">optional</span><span class="kw">:</span><span class="at"> </span><span class="ch">False</span></span>
<span id="cb294-40"><a aria-hidden="true" href="#cb294-40" tabindex="-1"></a><span class="at">    </span><span class="fu">software2</span><span class="kw">:</span></span>
<span id="cb294-41"><a aria-hidden="true" href="#cb294-41" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb294-42"><a aria-hidden="true" href="#cb294-42" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb294-43"><a aria-hidden="true" href="#cb294-43" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute2</span></span>
<span id="cb294-44"><a aria-hidden="true" href="#cb294-44" tabindex="-1"></a><span class="at">    </span><span class="fu">software3</span><span class="kw">:</span></span>
<span id="cb294-45"><a aria-hidden="true" href="#cb294-45" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb294-46"><a aria-hidden="true" href="#cb294-46" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb294-47"><a aria-hidden="true" href="#cb294-47" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute3</span></span>
<span id="cb294-48"><a aria-hidden="true" href="#cb294-48" tabindex="-1"></a><span class="at">    </span><span class="fu">compute1</span><span class="kw">:</span></span>
<span id="cb294-49"><a aria-hidden="true" href="#cb294-49" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb294-50"><a aria-hidden="true" href="#cb294-50" tabindex="-1"></a><span class="at">    </span><span class="fu">compute2</span><span class="kw">:</span></span>
<span id="cb294-51"><a aria-hidden="true" href="#cb294-51" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span>
<span id="cb294-52"><a aria-hidden="true" href="#cb294-52" tabindex="-1"></a><span class="at">    </span><span class="fu">compute3</span><span class="kw">:</span></span>
<span id="cb294-53"><a aria-hidden="true" href="#cb294-53" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<p>In this template, the <code>service</code> requirement of the
<code>ClientSoftware</code> 
node type is defined with a <code>count_range</code> of
<code>[0, 1]</code>, which means the 
requirement is no longer mandatory. Only the <code>software1</code> node
template 
annotates its <code>service</code> requirement as mandatory (using the
<code>optional: False</code> statement). The other two software nodes
leave their <code>service</code> 
requirement optional. As a result, this is now a valid
substituting 
template for nodes of type <code>Client</code> that define a
<code>service</code> 
requirement with <code>count_range</code> equal to
<code>[1, 4]</code>.</p>
<p>Requirement mapping must take one more rule into account: if
the 
number of requirement mappings is greater than the lower bound of
the 
<code>count_range</code>, the orchestrator must first perform those
mappings that 
map requirements onto <strong>mandatory</strong> requirements in the
substituting 
template, and then it will perform the remaining mappings (which 
presumably will map onto optional requirements in the substituting 
template). This is done independent of the order in which the 
requirement mappings are specified.</p>
<h3 id="handling-unbounded-requirement-count-ranges">15.5.5 Handling
<code>UNBOUNDED</code> Requirement Count Ranges</h3>
<p>In the case of <code>UNBOUNDED</code> count ranges, we must use
unbounded grammar 
forms.</p>
<p>In the following case all <code>service</code> requirements of the
substituted node 
are mapped to the corresponding <code>service</code> requirements of the
<code>software1</code> 
node in the substituting template. This allows for the follwing
compact 
syntax:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb295-1"><a aria-hidden="true" href="#cb295-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb295-2"><a aria-hidden="true" href="#cb295-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb295-3"><a aria-hidden="true" href="#cb295-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb295-4"><a aria-hidden="true" href="#cb295-4" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb295-5"><a aria-hidden="true" href="#cb295-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Client</span><span class="kw">:</span></span>
<span id="cb295-6"><a aria-hidden="true" href="#cb295-6" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb295-7"><a aria-hidden="true" href="#cb295-7" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb295-8"><a aria-hidden="true" href="#cb295-8" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb295-9"><a aria-hidden="true" href="#cb295-9" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb295-10"><a aria-hidden="true" href="#cb295-10" tabindex="-1"></a><span class="at">          </span><span class="fu">node</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb295-11"><a aria-hidden="true" href="#cb295-11" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">3</span><span class="kw">,</span><span class="at"> UNBOUNDED</span><span class="kw">]</span></span>
<span id="cb295-12"><a aria-hidden="true" href="#cb295-12" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb295-13"><a aria-hidden="true" href="#cb295-13" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb295-14"><a aria-hidden="true" href="#cb295-14" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb295-15"><a aria-hidden="true" href="#cb295-15" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb295-16"><a aria-hidden="true" href="#cb295-16" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb295-17"><a aria-hidden="true" href="#cb295-17" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb295-18"><a aria-hidden="true" href="#cb295-18" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb295-19"><a aria-hidden="true" href="#cb295-19" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb295-20"><a aria-hidden="true" href="#cb295-20" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> UNBOUNDED </span><span class="kw">]</span></span>
<span id="cb295-21"><a aria-hidden="true" href="#cb295-21" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb295-22"><a aria-hidden="true" href="#cb295-22" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb295-23"><a aria-hidden="true" href="#cb295-23" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb295-24"><a aria-hidden="true" href="#cb295-24" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb295-25"><a aria-hidden="true" href="#cb295-25" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb295-26"><a aria-hidden="true" href="#cb295-26" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb295-27"><a aria-hidden="true" href="#cb295-27" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb295-28"><a aria-hidden="true" href="#cb295-28" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb295-29"><a aria-hidden="true" href="#cb295-29" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software1</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb295-30"><a aria-hidden="true" href="#cb295-30" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb295-31"><a aria-hidden="true" href="#cb295-31" tabindex="-1"></a><span class="at">    </span><span class="fu">software1</span><span class="kw">:</span></span>
<span id="cb295-32"><a aria-hidden="true" href="#cb295-32" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb295-33"><a aria-hidden="true" href="#cb295-33" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb295-34"><a aria-hidden="true" href="#cb295-34" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb295-35"><a aria-hidden="true" href="#cb295-35" tabindex="-1"></a><span class="at">    </span><span class="fu">software2</span><span class="kw">:</span></span>
<span id="cb295-36"><a aria-hidden="true" href="#cb295-36" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb295-37"><a aria-hidden="true" href="#cb295-37" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb295-38"><a aria-hidden="true" href="#cb295-38" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb295-39"><a aria-hidden="true" href="#cb295-39" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb295-40"><a aria-hidden="true" href="#cb295-40" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<p>In the next case the <code>service</code> requirements of the
substituted node 
are mapped to the corresponding <code>service</code> requirements of
both the 
<code>software1</code> and <code>software2</code> nodes in the
substituting template 
as follows: the first requirement assignment is mapped to the 
<code>service</code> requirement of the <code>software1</code> node, the
second requirement 
assignment is mapped to the <code>service</code> requirement of the
<code>software2</code> 
node, then the rest of the <code>service</code> requirements of the
substituted 
node are mapped again to the <code>service</code> requirement of the
<code>software1</code> 
node:</p>
<div class="sourceCode" id="cb296"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb296-1"><a aria-hidden="true" href="#cb296-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb296-2"><a aria-hidden="true" href="#cb296-2" tabindex="-1"></a><span class="fu">imports</span><span class="kw">:</span></span>
<span id="cb296-3"><a aria-hidden="true" href="#cb296-3" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> types.yaml</span></span>
<span id="cb296-4"><a aria-hidden="true" href="#cb296-4" tabindex="-1"></a><span class="fu">node_types</span><span class="kw">:</span></span>
<span id="cb296-5"><a aria-hidden="true" href="#cb296-5" tabindex="-1"></a><span class="at">  </span><span class="fu">Client</span><span class="kw">:</span></span>
<span id="cb296-6"><a aria-hidden="true" href="#cb296-6" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb296-7"><a aria-hidden="true" href="#cb296-7" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb296-8"><a aria-hidden="true" href="#cb296-8" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb296-9"><a aria-hidden="true" href="#cb296-9" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb296-10"><a aria-hidden="true" href="#cb296-10" tabindex="-1"></a><span class="at">          </span><span class="fu">node</span><span class="kw">:</span><span class="at"> Server</span></span>
<span id="cb296-11"><a aria-hidden="true" href="#cb296-11" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">3</span><span class="kw">,</span><span class="at"> UNBOUNDED</span><span class="kw">]</span></span>
<span id="cb296-12"><a aria-hidden="true" href="#cb296-12" tabindex="-1"></a><span class="at">  </span><span class="fu">ClientSoftware</span><span class="kw">:</span></span>
<span id="cb296-13"><a aria-hidden="true" href="#cb296-13" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb296-14"><a aria-hidden="true" href="#cb296-14" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb296-15"><a aria-hidden="true" href="#cb296-15" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb296-16"><a aria-hidden="true" href="#cb296-16" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> HostedOn</span></span>
<span id="cb296-17"><a aria-hidden="true" href="#cb296-17" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span></span>
<span id="cb296-18"><a aria-hidden="true" href="#cb296-18" tabindex="-1"></a><span class="at">          </span><span class="fu">capability</span><span class="kw">:</span><span class="at"> Service</span></span>
<span id="cb296-19"><a aria-hidden="true" href="#cb296-19" tabindex="-1"></a><span class="at">          </span><span class="fu">relationship</span><span class="kw">:</span><span class="at"> ServedBy</span></span>
<span id="cb296-20"><a aria-hidden="true" href="#cb296-20" tabindex="-1"></a><span class="at">          </span><span class="fu">count_range</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> </span><span class="dv">0</span><span class="kw">,</span><span class="at"> UNBOUNDED </span><span class="kw">]</span></span>
<span id="cb296-21"><a aria-hidden="true" href="#cb296-21" tabindex="-1"></a><span class="at">  </span><span class="fu">Compute</span><span class="kw">:</span></span>
<span id="cb296-22"><a aria-hidden="true" href="#cb296-22" tabindex="-1"></a><span class="at">    </span><span class="fu">capabilities</span><span class="kw">:</span></span>
<span id="cb296-23"><a aria-hidden="true" href="#cb296-23" tabindex="-1"></a><span class="at">      </span><span class="fu">host</span><span class="kw">:</span></span>
<span id="cb296-24"><a aria-hidden="true" href="#cb296-24" tabindex="-1"></a><span class="at">        </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Host</span></span>
<span id="cb296-25"><a aria-hidden="true" href="#cb296-25" tabindex="-1"></a><span class="fu">service_template</span><span class="kw">:</span></span>
<span id="cb296-26"><a aria-hidden="true" href="#cb296-26" tabindex="-1"></a><span class="at">  </span><span class="fu">substitution_mappings</span><span class="kw">:</span></span>
<span id="cb296-27"><a aria-hidden="true" href="#cb296-27" tabindex="-1"></a><span class="at">    </span><span class="fu">node_type</span><span class="kw">:</span><span class="at"> Client</span></span>
<span id="cb296-28"><a aria-hidden="true" href="#cb296-28" tabindex="-1"></a><span class="at">    </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb296-29"><a aria-hidden="true" href="#cb296-29" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software1</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb296-30"><a aria-hidden="true" href="#cb296-30" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">service</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software2</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb296-31"><a aria-hidden="true" href="#cb296-31" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="kw">[</span><span class="at"> service</span><span class="kw">,</span><span class="at"> UNBOUNDED </span><span class="kw">]:</span><span class="at"> </span><span class="kw">[</span><span class="at"> software1</span><span class="kw">,</span><span class="at"> service </span><span class="kw">]</span></span>
<span id="cb296-32"><a aria-hidden="true" href="#cb296-32" tabindex="-1"></a><span class="at">  </span><span class="fu">node_templates</span><span class="kw">:</span></span>
<span id="cb296-33"><a aria-hidden="true" href="#cb296-33" tabindex="-1"></a><span class="at">    </span><span class="fu">software1</span><span class="kw">:</span></span>
<span id="cb296-34"><a aria-hidden="true" href="#cb296-34" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb296-35"><a aria-hidden="true" href="#cb296-35" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb296-36"><a aria-hidden="true" href="#cb296-36" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb296-37"><a aria-hidden="true" href="#cb296-37" tabindex="-1"></a><span class="at">    </span><span class="fu">software2</span><span class="kw">:</span></span>
<span id="cb296-38"><a aria-hidden="true" href="#cb296-38" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> ClientSoftware</span></span>
<span id="cb296-39"><a aria-hidden="true" href="#cb296-39" tabindex="-1"></a><span class="at">      </span><span class="fu">requirements</span><span class="kw">:</span></span>
<span id="cb296-40"><a aria-hidden="true" href="#cb296-40" tabindex="-1"></a><span class="at">        </span><span class="kw">-</span><span class="at"> </span><span class="fu">host</span><span class="kw">:</span><span class="at"> compute</span></span>
<span id="cb296-41"><a aria-hidden="true" href="#cb296-41" tabindex="-1"></a><span class="at">    </span><span class="fu">compute</span><span class="kw">:</span></span>
<span id="cb296-42"><a aria-hidden="true" href="#cb296-42" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Compute</span></span></code></pre></div>
<h2 id="interface-mapping">15.6 Interface Mapping</h2>
<p>An interface mapping allows an interface operation on the
substituted 
node to be mapped to workflow in the substituting service template.</p>
<!----
{"id": "1110", "author": "Calin Curescu [2]", "date": "2018-08-23T08:33:00Z", "comment": "This could change if we introduce the operations keyname in the interface definitions", "target": "Grammar"}-->
<!----
{"id": "1111", "author": "Chris Lauwers", "date": "2020-08-03T18:40:00Z", "comment": "What about\nnotification mappings?", "target": "follows"}-->
<p>The grammar of an interface_mapping is as follows:</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb297-1"><a aria-hidden="true" href="#cb297-1" tabindex="-1"></a><span class="fu">&lt;interface_name&gt;</span><span class="kw">:</span></span>
<span id="cb297-2"><a aria-hidden="true" href="#cb297-2" tabindex="-1"></a><span class="at">  </span><span class="fu">&lt;operation_name&gt;</span><span class="kw">:</span><span class="at"> &lt;workflow_name&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning: 
- interface_name: represents the name of the interface as it
appears 
in the node type definition for the node type (name) that is
declared 
as the value for on the substitution_mappings’ <code>node_type</code>
key. 
- operation_name: represents the name of the operation as it
appears 
in the interface type definition for <interface_name>. 
- workflow_name: represents the name of a workflow defined in the 
substituting service template to which to map the specified 
interface operation.</interface_name></p>
<hr/>
<h1 id="groups-and-policies">16 Groups and Policies</h1>
<p>A <em>TOSCA group</em> is a logical grouping of nodes for purposes of
uniform 
application of <em>policies</em> to collections of nodes. Conceptually,
group 
definitions allow the creation of logical <em>membership</em>
relationships 
to nodes in a service template that are not a part of the 
application’s explicit requirement dependencies in the topology 
template (i.e. those required to actually get the application
deployed 
and running).</p>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative. 
## 16.1 Group Type 
<!----
{"id": "1121", "author": "Chris Lauwers", "date": "2020-08-03T18:44:00Z", "comment": "Edit to remove the implication that these\nare similar to \u201cTOSCA relationships\u201d", "target": "creation of logical\n\u201cmembership\u201d relationships "}--></p>
<!----
{"id": "1123", "author": "Jordan,PM,Paul,TNK6 R", "date": "2020-11-09T08:56:00Z", "comment": "I don\u2019t think\nthe text definitions of group and group type are sufficiently different.\nSo I\u2019ve added some suggested new text but will leave it to the editors\nto consider how much of the existing text can be\nremoved.", "target": ""}-->
<p>As with most TOSCA entities, groups are typed. A group type
definition 
is a type of TOSCA type definition and as a result supports the
common 
keynames listed in <a href="#641-common-keynames-in-type-definitions">Section 
6.4.1</a>. In addition, the 
group type definition has the following recognized keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>properties</td>
<td>no</td>
<td>map of property definitions</td>
<td>An optional map of property definitions for the group type.</td>
</tr>
<tr class="even">
<td>attributes</td>
<td>no</td>
<td>map of attribute definitions</td>
<td>An optional map of attribute definitions for the group type.</td>
</tr>
<tr class="odd">
<td>members</td>
<td>no</td>
<td>list of string</td>
<td>An optional list of one or more names of node types that are valid
(allowed) as members of the group type.</td>
</tr>
</tbody>
</table>
<blockquote>
<p>What are group properties used for? 
How can group attributes possibly be set, and what would they be used
for?</p>
</blockquote>
<p>Group types have the following grammar:</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb298-1"><a aria-hidden="true" href="#cb298-1" tabindex="-1"></a><span class="fu">&lt;group_type_name&gt;</span><span class="kw">:</span></span>
<span id="cb298-2"><a aria-hidden="true" href="#cb298-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;parent_group_type_name&gt;</span></span>
<span id="cb298-3"><a aria-hidden="true" href="#cb298-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb298-4"><a aria-hidden="true" href="#cb298-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map of YAML data&gt;</span></span>
<span id="cb298-5"><a aria-hidden="true" href="#cb298-5" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;group_description&gt;</span></span>
<span id="cb298-6"><a aria-hidden="true" href="#cb298-6" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_definitions&gt;</span></span>
<span id="cb298-7"><a aria-hidden="true" href="#cb298-7" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span><span class="at"> &lt;attribute_definitions&gt;</span></span>
<span id="cb298-8"><a aria-hidden="true" href="#cb298-8" tabindex="-1"></a><span class="at">  </span><span class="fu">members</span><span class="kw">:</span><span class="at">  &lt;list_of_valid_member_types&gt; </span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>group_type_name: represents the mandatory symbolic name of the
Group 
Type being declared as a string.</p></li>
<li><p>parent_group_type_name: represents the name (string) of the group
type 
this group type definition derives from (i.e. its “parent”
type).</p></li>
<li><p>attribute_definitions: represents the optional map of
attribute 
definitions for the group type.</p></li>
<li><p>property_definitions: represents the optional map of
property 
definitions for the group type.</p></li>
<li><p>list_of_valid_member_types: represents the optional list of TOSCA
Node 
Types that are valid member types for being added to (i.e. members
of) 
the group type; if the members keyname is not defined then there
are 
no restrictions to the member types;</p>
<ul>
<li><p>note that the members of a group ultimately resolve to nodes,
the 
types here just restrict which nodes can be defined as members in
a 
group definition.</p></li>
<li><p>A node type is matched if it is the specified type or is derived
from 
the node type</p></li>
</ul></li>
</ul>
<p>During group type derivation the keyname definitions follow these
rules:</p>
<ul>
<li><p>properties: existing property definitions may be refined; new
property 
definitions may be added.</p></li>
<li><p>attributes: existing attribute definitions may be refined;
new 
attribute definitions may be added.</p></li>
<li><p>members: if the members keyname is defined in the parent type,
each 
element in this list must either be in the parent type list or
derived 
from an element in the parent type list; if the members keyname is
not 
defined in the parent type then no restrictions are applied to the 
definition.</p></li>
</ul>
<p>The following represents an example group type definition:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb299-1"><a aria-hidden="true" href="#cb299-1" tabindex="-1"></a><span class="fu">group_types</span><span class="kw">:</span></span>
<span id="cb299-2"><a aria-hidden="true" href="#cb299-2" tabindex="-1"></a><span class="at">  </span><span class="fu">mycompany.placement</span><span class="kw">:</span></span>
<span id="cb299-3"><a aria-hidden="true" href="#cb299-3" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> My company’s group type for placing nodes of type Software</span></span>
<span id="cb299-4"><a aria-hidden="true" href="#cb299-4" tabindex="-1"></a><span class="at">    </span><span class="fu">members</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> Software </span><span class="kw">]</span></span></code></pre></div>
<h2 id="group-definition">16.2 Group Definition</h2>
<p>Collections of nodes in a service template may be grouped
together 
using a <em>group definition</em> in that same service template. A
group 
definition defines a logical grouping of node templates for
purposes 
of uniform application of policies.</p>
<p>The following is the list of recognized keynames for a 
TOSCA group definition:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>type</td>
<td>yes</td>
<td>string</td>
<td>The mandatory name of the group type the group definition is based
upon.</td>
</tr>
<tr class="even">
<td>description</td>
<td>no</td>
<td>string</td>
<td>The optional description for the group definition.</td>
</tr>
<tr class="odd">
<td>metadata</td>
<td>no</td>
<td>map of YAML data</td>
<td>Defines a section used to declare additional metadata
information.</td>
</tr>
<tr class="even">
<td>properties</td>
<td>no</td>
<td>map of property assignments</td>
<td>An optional map of property value assignments for the group
definition.</td>
</tr>
<tr class="odd">
<td>attributes</td>
<td>no</td>
<td>map of attribute assignments</td>
<td>An optional map of attribute value assignments for the group
definition.</td>
</tr>
<tr class="even">
<td>members</td>
<td>no</td>
<td>list of string</td>
<td>The optional list of one or more node template names that are
members of this group definition.</td>
</tr>
</tbody>
</table>
<p>Group definitions have one the following grammars:</p>
<div class="sourceCode" id="cb300"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb300-1"><a aria-hidden="true" href="#cb300-1" tabindex="-1"></a><span class="fu">&lt;group_name&gt;</span><span class="kw">:</span></span>
<span id="cb300-2"><a aria-hidden="true" href="#cb300-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;group_type_name&gt;</span></span>
<span id="cb300-3"><a aria-hidden="true" href="#cb300-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;group_description&gt;</span></span>
<span id="cb300-4"><a aria-hidden="true" href="#cb300-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map of YAML data&gt;</span></span>
<span id="cb300-5"><a aria-hidden="true" href="#cb300-5" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_assignments&gt;</span></span>
<span id="cb300-6"><a aria-hidden="true" href="#cb300-6" tabindex="-1"></a><span class="at">  </span><span class="fu">attributes</span><span class="kw">:</span><span class="at"> &lt;attribute_assignments&gt;</span></span>
<span id="cb300-7"><a aria-hidden="true" href="#cb300-7" tabindex="-1"></a><span class="at">  </span><span class="fu">members</span><span class="kw">:</span><span class="at">  &lt;list_of_node_templates&gt; </span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>group_name: represents the mandatory symbolic name of the group
as a 
string.</p></li>
<li><p>group_type_name: represents the name of the group type the
definition 
is based upon.</p></li>
<li><p>property_assignments: represents the optional map of
property 
assignments for the group definition that provide values for 
properties defined in its declared group type.</p></li>
<li><p>attribute_assigments: represents the optional map of
attribute 
assignments for the group definition that provide values for 
attributes defined in its declared group type.</p></li>
<li><p>list_of_node_templates: contains the mandatory list of one or
more 
node template names or group symbolic names (within the same
service 
template) that are members of this logical group</p>
<ul>
<li>if the members keyname was defined (by specifying a<br/>
list_of_valid_member_types) in the group type of this group then
the<br/>
nodes listed here must be compatible (i.e. be of that type or of
type<br/>
that is derived from) with the node types in the<br/>
list_of_valid_member_types</li>
</ul></li>
</ul>
<p>The following represents a group definition:</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb301-1"><a aria-hidden="true" href="#cb301-1" tabindex="-1"></a><span class="fu">groups</span><span class="kw">:</span></span>
<span id="cb301-2"><a aria-hidden="true" href="#cb301-2" tabindex="-1"></a><span class="at">  </span><span class="fu">my_app_placement_group</span><span class="kw">:</span></span>
<span id="cb301-3"><a aria-hidden="true" href="#cb301-3" tabindex="-1"></a><span class="at">    </span><span class="fu">type</span><span class="kw">:</span><span class="at"> Root</span></span>
<span id="cb301-4"><a aria-hidden="true" href="#cb301-4" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> My application’s logical component grouping for placement</span></span>
<span id="cb301-5"><a aria-hidden="true" href="#cb301-5" tabindex="-1"></a><span class="at">    </span><span class="fu">members</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> my_web_server</span><span class="kw">,</span><span class="at"> my_sql_database </span><span class="kw">]</span></span></code></pre></div>
<h2 id="policy-type">16.3 Policy Type</h2>
<p>A <em>policy type</em> defines a type of a policy that affects or
governs an 
application or service’s topology at some stage of its lifecycle
but 
is not explicitly part of the topology itself (i.e., it does not 
prevent the application or service from being deployed or run if
it 
did not exist).</p>
<p>A policy type definition is a type of TOSCA type definition and as
a 
result supports the common keynames listed in <a href="#641-common-keynames-in-type-definitions">Section 
6.4.1</a>. In addition, the 
policy type definition has the following recognized keynames:</p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>properties</td>
<td>no</td>
<td>map of property definitions</td>
<td>An optional map of property definitions for the policy type.</td>
</tr>
<tr class="even">
<td>targets</td>
<td>no</td>
<td>list of string</td>
<td>An optional list of valid node types or group types the policy type
can be applied to.</td>
</tr>
<tr class="odd">
<td>triggers</td>
<td>no</td>
<td>map of trigger definitions</td>
<td>An optional map of policy triggers for the policy type.</td>
</tr>
</tbody>
</table>
<p>Policy types have the following grammar:</p>
<div class="sourceCode" id="cb302"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb302-1"><a aria-hidden="true" href="#cb302-1" tabindex="-1"></a><span class="fu">&lt;policy_type_name&gt;</span><span class="kw">:</span></span>
<span id="cb302-2"><a aria-hidden="true" href="#cb302-2" tabindex="-1"></a><span class="at">  </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> &lt;parent_policy_type_name&gt;</span></span>
<span id="cb302-3"><a aria-hidden="true" href="#cb302-3" tabindex="-1"></a><span class="at">  </span><span class="fu">version</span><span class="kw">:</span><span class="at"> &lt;version_number&gt;</span></span>
<span id="cb302-4"><a aria-hidden="true" href="#cb302-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map of YAML data&gt;</span></span>
<span id="cb302-5"><a aria-hidden="true" href="#cb302-5" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;policy_description&gt;</span></span>
<span id="cb302-6"><a aria-hidden="true" href="#cb302-6" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_definitions&gt; </span></span>
<span id="cb302-7"><a aria-hidden="true" href="#cb302-7" tabindex="-1"></a><span class="at">  </span><span class="fu">targets</span><span class="kw">:</span><span class="at">  &lt;list_of_valid_target_types&gt; </span></span>
<span id="cb302-8"><a aria-hidden="true" href="#cb302-8" tabindex="-1"></a><span class="at">  </span><span class="fu">triggers</span><span class="kw">:</span><span class="at"> &lt;trigger_definitions&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>policy_type_name: represents the mandatory symbolic name of the
policy 
type being declared as a string.</p></li>
<li><p>parent_policy_type_name: represents the name (string) of the
policy 
type this policy type definition derives from (i.e., its “parent” 
type).</p></li>
<li><p>property_definitions: represents the optional map of
property 
definitions for the policy type.</p></li>
<li><p>list_of_valid_target_types: represents the optional list of
TOSCA 
types (i.e. group or node types) that are valid targets for this 
policy type; if the targets keyname is not defined then there are
no 
restrictions to the targets’ types.</p></li>
<li><p>trigger_definitions: represents the optional map of trigger 
definitions for the policy.</p></li>
</ul>
<p>During policy type derivation the keyname definitions follow
these 
rules:</p>
<ul>
<li><p>properties: existing property definitions may be refined; new
property 
definitions may be added.</p></li>
<li><p>targets: if the targets keyname is defined in the parent type,
each 
element in this list must either be in the parent type list or
derived 
from an element in the parent type list; if the targets keyname is
not 
defined in the parent type then no restrictions are applied to
this 
definition.</p></li>
<li><p>triggers: existing trigger definitions may not be changed; new
trigger 
definitions may be added.</p></li>
</ul>
<p>The following represents a policy type definition:</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb303-1"><a aria-hidden="true" href="#cb303-1" tabindex="-1"></a><span class="fu">policy_types</span><span class="kw">:</span></span>
<span id="cb303-2"><a aria-hidden="true" href="#cb303-2" tabindex="-1"></a><span class="at">  </span><span class="fu">placement.Container.Linux</span><span class="kw">:</span></span>
<span id="cb303-3"><a aria-hidden="true" href="#cb303-3" tabindex="-1"></a><span class="at">    </span><span class="fu">description</span><span class="kw">:</span><span class="at"> My company’s placement policy for linux </span></span>
<span id="cb303-4"><a aria-hidden="true" href="#cb303-4" tabindex="-1"></a><span class="at">    </span><span class="fu">derived_from</span><span class="kw">:</span><span class="at"> Root</span></span></code></pre></div>
<h2 id="policy-definition">16.4 Policy Definition</h2>
<p>A policy definition defines a policy that can be associated with a
TOSCA 
service or top-level entity definition (e.g., group definition,
node 
template, etc.).</p>
<p>The following is the list of recognized keynames for a TOSCA
policy 
definition: 
<!----
{"id": "1167", "author": "Chris Lauwers", "date": "2022-10-03T19:59:00Z", "comment": "Policies apply to entire service templates,\nnot to individual node templates. What was the intended use of targets\nin policy definitions?", "target": "definition"}--></p>
<table>
<colgroup>
<col style="width: 20%"/>
<col style="width: 29%"/>
<col style="width: 20%"/>
<col style="width: 29%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>type</td>
<td>yes</td>
<td>string</td>
<td>The mandatory name of the policy type the policy definition is based
upon.</td>
</tr>
<tr class="even">
<td>description</td>
<td>no</td>
<td>string</td>
<td>The optional description for the policy definition.</td>
</tr>
<tr class="odd">
<td>metadata</td>
<td>no</td>
<td>map of string</td>
<td>Defines a section used to declare additional metadata
information.</td>
</tr>
<tr class="even">
<td>properties</td>
<td>no</td>
<td>map of property assignments</td>
<td>An optional map of property value assignments for the policy
definition.</td>
</tr>
<tr class="odd">
<td>targets</td>
<td>no</td>
<td>list of string</td>
<td>An optional list of valid node templates or Groups the Policy can be
applied to.</td>
</tr>
<tr class="even">
<td>triggers</td>
<td>no</td>
<td>map of trigger definitions</td>
<td>An optional map of trigger definitions to invoke when the policy is
applied by an orchestrator against the associated TOSCA entity. These
triggers apply in addition to the triggers defined in the policy
type.</td>
</tr>
</tbody>
</table>
<p>Policy definitions have the following grammar:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb304-1"><a aria-hidden="true" href="#cb304-1" tabindex="-1"></a><span class="fu">&lt;policy_name&gt;</span><span class="kw">:</span></span>
<span id="cb304-2"><a aria-hidden="true" href="#cb304-2" tabindex="-1"></a><span class="at">  </span><span class="fu">type</span><span class="kw">:</span><span class="at"> &lt;policy_type_name&gt;</span></span>
<span id="cb304-3"><a aria-hidden="true" href="#cb304-3" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;policy_description&gt;</span></span>
<span id="cb304-4"><a aria-hidden="true" href="#cb304-4" tabindex="-1"></a><span class="at">  </span><span class="fu">metadata</span><span class="kw">:</span><span class="at"> &lt;map of YAML data&gt;</span></span>
<span id="cb304-5"><a aria-hidden="true" href="#cb304-5" tabindex="-1"></a><span class="at">  </span><span class="fu">properties</span><span class="kw">:</span><span class="at"> &lt;property_assignments&gt;</span></span>
<span id="cb304-6"><a aria-hidden="true" href="#cb304-6" tabindex="-1"></a><span class="at">  </span><span class="fu">targets</span><span class="kw">:</span><span class="at"> &lt;list_of_policy_targets&gt;</span></span>
<span id="cb304-7"><a aria-hidden="true" href="#cb304-7" tabindex="-1"></a><span class="at">  </span><span class="fu">triggers</span><span class="kw">:</span><span class="at"> &lt;trigger_definitions&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>policy_name: represents the mandatory symbolic name of the policy
as a 
string.</p></li>
<li><p>policy_type_name: represents the name of the policy the
definition is 
based upon.</p></li>
<li><p>property_assignments: represents the optional map of
property 
assignments for the policy definition that provide values for 
properties defined in its declared policy type.</p></li>
<li><p>list_of_policy_targets: represents the optional list of names of
node 
templates or groups that the policy is to applied to.</p>
<ul>
<li>if the targets keyname was defined (by specifying a<br/>
list_of_valid_target_types) in the policy type of this policy then
the<br/>
targets listed here must be compatible (i.e. be of that type or of<br/>
type that is derived from) with the types (of nodes or groups) in
the<br/>
list_of_valid_target_types.</li>
</ul></li>
<li><p>trigger_definitions: represents the optional map of trigger 
definitions) for the policy; these triggers apply in addition to
the 
triggers defined in the policy type.</p></li>
</ul>
<!----
{"id": "1173", "author": "Calin Curescu", "date": "2020-05-06T10:56:00Z", "comment": "!!! What is the meaning of these triggers\n  here w.r.t. the triggers defined in the policy type?  \n  I assume we should allow the definition of new triggers, that are used\n  in addition to the triggers defined in the policy type.  \n  But, in interface we did not allow to add new operations or\n  notifications.", "target": "trigger_definitions: represents the optional map\n  of [trigger definitions](#trigger-definition) for the policy; these\n  triggers apply in addition to the triggers defined in the policy\n  type."}-->
<p>The following represents a policy definition:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb305-1"><a aria-hidden="true" href="#cb305-1" tabindex="-1"></a><span class="at">  </span><span class="kw">-</span><span class="at"> </span><span class="fu">my_compute_placement_policy</span><span class="kw">:</span></span>
<span id="cb305-2"><a aria-hidden="true" href="#cb305-2" tabindex="-1"></a><span class="at">      </span><span class="fu">type</span><span class="kw">:</span><span class="at"> placement</span></span>
<span id="cb305-3"><a aria-hidden="true" href="#cb305-3" tabindex="-1"></a><span class="at">      </span><span class="fu">description</span><span class="kw">:</span><span class="at"> Apply my placement policy to my application’s servers</span></span>
<span id="cb305-4"><a aria-hidden="true" href="#cb305-4" tabindex="-1"></a><span class="at">      </span><span class="fu">targets</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at"> my_server_</span><span class="dv">1</span><span class="kw">,</span><span class="at"> my_server_</span><span class="dv">2</span><span class="at"> </span><span class="kw">]</span></span>
<span id="cb305-5"><a aria-hidden="true" href="#cb305-5" tabindex="-1"></a><span class="co">      # remainder of policy definition omitted for brevity</span></span></code></pre></div>
<h2 id="trigger-definition">16.5 Trigger Definition</h2>
<p>A trigger definition defines an <em>event, condition, action</em>
tuple 
associated with a policy.</p>
<!----
{"id": "1181", "author": "Matt Rutkowski", "date": "2017-09-26T11:38:00Z", "comment": "RECALL; Policy type defn were to be consumed by a \u201cPolicy Engine\u201d that would create events on a known event monitoring service. We need to create diagram and explain the event-condition-action flow of policy (defn.)", "target": "Keynames"}-->
<p>The following is the list of recognized keynames for a TOSCA
trigger 
definition:</p>
<table>
<colgroup>
<col style="width: 25%"/>
<col style="width: 25%"/>
<col style="width: 25%"/>
<col style="width: 25%"/>
</colgroup>
<thead>
<tr class="header">
<th>Keyname</th>
<th>Mandatory</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>description no</td>
<td>string</td>
<td>The optional description string for the trigger.</td>
<td></td>
</tr>
<tr class="even">
<td>event</td>
<td>yes</td>
<td>string</td>
<td>The mandatory name of the event that activates the trigger’s
action.</td>
</tr>
<tr class="odd">
<td>condition</td>
<td>no</td>
<td>condition clause</td>
<td>The optional condition that must evaluate to true in order for the
trigger’s action to be performed. Note: this is optional since sometimes
the event occurrence itself is enough to trigger the action.</td>
</tr>
<tr class="even">
<td>action</td>
<td>yes</td>
<td>list of activity definition</td>
<td>The list of sequential activities to be performed when the event is
triggered, and the condition is met (i.e., evaluates to true).</td>
</tr>
</tbody>
</table>
<!----
{"id": "1182", "author": "Chris Lauwers", "date": "2022-10-03T20:01:00Z", "comment": "We need to clarify the context in which event names can be interpreted. Are they globally scoped?", "target": "name"}-->
<!----
{"id": "1185", "author": "Calin Curescu", "date": "2020-05-06T11:29:00Z", "comment": "This does not make any sense. Needs to be deleted.", "target": ""}-->
<p>Trigger definitions have the following grammars:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb306-1"><a aria-hidden="true" href="#cb306-1" tabindex="-1"></a><span class="fu">&lt;trigger_name&gt;</span><span class="kw">:</span></span>
<span id="cb306-2"><a aria-hidden="true" href="#cb306-2" tabindex="-1"></a><span class="at">  </span><span class="fu">description</span><span class="kw">:</span><span class="at"> &lt;trigger_description&gt;</span></span>
<span id="cb306-3"><a aria-hidden="true" href="#cb306-3" tabindex="-1"></a><span class="at">  </span><span class="fu">event</span><span class="kw">:</span><span class="at"> &lt;event_name&gt;</span></span>
<span id="cb306-4"><a aria-hidden="true" href="#cb306-4" tabindex="-1"></a><span class="at">  </span><span class="fu">condition</span><span class="kw">:</span><span class="at"> &lt;condition_clause&gt;</span></span>
<span id="cb306-5"><a aria-hidden="true" href="#cb306-5" tabindex="-1"></a><span class="at">  </span><span class="fu">action</span><span class="kw">:</span><span class="at"> &lt;list_of_activity_definition&gt;</span></span></code></pre></div>
<p>In the above grammar, the pseudo values that appear in angle
brackets 
have the following meaning:</p>
<ul>
<li><p>trigger_name: represents the mandatory symbolic name of the
trigger as 
a string.</p></li>
<li><p>event_name: represents the mandatory name of an event associated
with 
an interface notification on the identified resource (node).</p></li>
<li><p>condition_clause: an optional Boolean expression that can be
evaluated 
within the context of the service with which the policy is
associated 
and that must evaluate to true in order for the trigger’s action to
be 
performed. Note that the arguments to the condition clause
function 
can in turn be other TOSCA functions. If no condition clause is 
specified, the trigger event will always result in the trigger’s 
action being taken.</p></li>
<li><p>list_of_activity_definition: represents the list of activities
that 
are performed in response to the event if the (optional) condition
is 
met.</p></li>
</ul>
<hr/>
<h1 id="cloud-service-archive-csar-format">17 Cloud Service Archive
(CSAR) Format</h1>
<p>This section defines the metadata of a cloud service archive as well
as 
its overall structure.</p>
<p>The content in this section is normative unless otherwise labeled
except: 
- the examples 
- references unless labelled as normative.</p>
<h2 id="overall-structure-of-a-csar">17.1 Overall Structure of a
CSAR</h2>
<!----
{"id": "1367", "author": "Calin Curescu", "date": "2020-06-09T17:00:00Z", "comment": "Thinh would like to have this resolved\nbefore publishing TOSCA v2.0. What is zip? We need to give a clearer\ndefinition of the zip format. What version. Thinh will get back with a\nmore specific definition.  \nTal: look at java **jar specification**? It is zip...", "target": "A CSAR is a\nzip file "}-->
<p>A CSAR is a package of files containing at least TOSCA definitions
as 
well as accompanying artifacts (e.g. scripts, binaries, configuration
files) 
that can be delivered together as a single unit.</p>
<p>CSARs can be used to package service templates and/or profiles.</p>
<p>The service template or profile root TOSCA YAML file can be
specified 
in one of two ways:</p>
<ul>
<li><p>If a <code>TOSCA.meta</code> file is present (see below) it may
specify the root 
TOSCA YAML file. The <code>TOSCA.meta</code> file may be located either
at the 
root of the archive or inside a <code>TOSCA-Metadata</code> directory.
The CSAR 
may contain only one <code>TOSCA.meta</code> file.</p></li>
<li><p>Otherwise, if a single valid TOSCA YAML file (named with a
<code>.yaml</code> or 
<code>.yml</code> extension) is located at the root of the archive, it
will be used 
as the root TOSCA YAML file.</p></li>
</ul>
<!----
{"id": "1368", "author": "Calin Curescu", "date": "2019-01-30T15:18:00Z", "comment": "Why keep a mandatory directory for only\n  one file. I think we should allow to have the TOSCA.meta file also in\n  the root of the archive.  \n  Then the processor should do the following:  \n  Look for the TOSCA-Metadata directory. If found, look for the\n  TOSCA.meta inside. If latter not found give an error.  \n  Else look for the TOSCA.meta file in the root of the archive  \n  Look for the a .yml or . yaml file in the root directory", "target": "\n  **TOSCA.meta** metadata file that provides entry information for a\n  TOSCA orchestrator processing the CSAR file."}-->
<p>The CSAR file may contain other directories and files with
arbitrary 
names and content.</p>
<h3 id="csar-archiving-formats">17.1.1 CSAR Archiving Formats</h3>
<p>While any archiving method that maintains a file and directory
structure 
can be used, two formats are specifically supported, tarballs and Zip
files.</p>
<h4 id="tarballs">17.1.1.1 Tarballs</h4>
<p>These are optionally compressed streams generated by the
<code>tar</code> (tape archive) 
command available on most operating systems. TOSCA at minimum
supports 
uncompressed tarballs (named with a <code>.tar</code> extension) as well
tarballs 
compressed with Gzip (named with a <code>.tar.gz</code> or
<code>.tgz</code> extension). Other 
compression algorithms may also be optional supported.</p>
<p>Because tarballs are organized sequentially, their contents can be
efficiently 
streamed from a filesystem or a network server with minimal buffering
and no 
need to store data local storage. For example, if only a single file in
the 
tarball is needed, a client can skip other entries and read only that
file.</p>
<p>The supported tar format is UStar, as specified in <a href="https://archive.org/details/mac_Internet_File_Formats_1995/page/n201/mode/2up">POSIX IEEE P1003.1</a>. <br/> Gzip 4.3 is specified in <a href="https://datatracker.ietf.org/doc/html/rfc1952">IETF RFC-1952</a>. <br/></p>
<h4 id="zip-files">17.1.1.2 Zip Files</h4>
<p>These are optionally compressed files relying on random access to
entries. 
Files should be named with a <code>.zip</code> or a <code>.csar</code>
extension.</p>
<p>Note that the <code>.csar</code> extension has been used in previous
versions of 
TOSCA to refer <em>exclusively</em> to Zip files. It is recommended to
use the 
<code>.zip</code> extension instead in order to clarify and
differentiate the archiving 
formats.</p>
<p>Because Zip files require random access, the archive must be
accessible in 
its entirety by clients, usually in a local file system. If it necessary
to 
support clients with no access to local storage, tarballs may be
preferred 
instead.</p>
<p>The Zip format supported by TOSCA is specified in <a href="https://www.iso.org/standard/60101.html">ISO/IEC 21320-1 “Document Container File — Part 1: Core”</a>. <br/></p>
<h2 id="tosca-meta-file">17.2 TOSCA Meta File</h2>
<p>A TOSCA meta file consists of name/value pairs. The name-part of
a 
name/value pair is followed by a colon, followed by a blank, followed
by 
the value-part of the name/value pair. The name MUST NOT contain a 
colon. Values that represent binary data MUST be base64 encoded.
Values 
that extend beyond one line can be spread over multiple lines if
each 
subsequent line starts with at least one space. Such spaces are
then 
collapsed when the value string is read.</p>
<pre><code>&lt;name&gt;: &lt;value&gt;</code></pre>
<p>Each name/value pair is in a separate line. A list of related
name/value 
pairs, i.e. a list of consecutive name/value pairs is called a
block. 
Blocks are separated by an empty line. The first block, called
block_0, 
contains metadata about the CSAR itself and is further defined
below. 
Other blocks may be used to represent custom generic metadata or 
metadata pertaining to files in the CSAR. A <code>TOSCA.meta</code> file
is only 
required to include block_0.</p>
<h3 id="block-0-keynames-in-the-tosca.meta-file">17.2.1 Block 0 Keynames
in the TOSCA.meta File</h3>
<p>The structure of block_0 in the <code>TOSCA.meta</code> file is as
follows:</p>
<pre><code>CSAR-Version: digit.digit
Created-By: string
Entry-Definitions: string
Other-Definitions: string</code></pre>
<p>The name/value pairs are as follows:</p>
<ul>
<li><p><strong>CSAR-Version</strong>: This is the version number of the
CSAR 
specification. It defines the structure of the CSAR and the format
of 
the <code>TOSCA.meta</code> file. The value MUST be “2.0” for this
version of 
the CSAR specification.</p></li>
<li><p><strong>Created-By</strong>: The person or organization that
created the CSAR.</p></li>
<li><p><strong>Entry-Definitions</strong>: This references the TOSCA
definitions file that 
SHOULD be used as entry point for processing the contents of the
CSAR 
(e.g. the main TOSCA service template).</p></li>
<li><p><strong>Other-Definitions</strong>: This references an
unambiguous set of files 
containing substitution templates that can be used to implement
nodes 
defined in the main template (i.e. the file declared in 
<strong>Entry-Definitions</strong>). Thus, all the service templates
defined in 
files listed under the <strong>Other-Definitions</strong> key are to be
used only 
as substitution templates, and not as standalone services. If such
a 
service template cannot act as a substitution template, it will be 
ignored by the orchestrator. The value of the
<strong>Other-Definitions</strong> 
key is a string containing a list of filenames (relative to the
root 
of the CSAR archive) delimited by a blank space. If the filenames 
contain blank spaces, the filename should be enclosed by double 
quotation marks (“).</p></li>
</ul>
<p>Note that any further TOSCA definitions files required by the 
definitions specified by <strong>Entry-Definitions</strong> or
<strong>Other-Definitions</strong> 
can be found by a TOSCA orchestrator by processing respective 
<strong>imports</strong> statements. Note also that artifact files
(e.g. scripts, 
binaries, configuration files) used by the TOSCA definitions and 
included in the CSAR are fully described and referred via relative
path 
names in artifact definitions in the respective TOSCA definitions
files 
contained in the CSAR.</p>
<!----
{"id": "1382", "author": "Calin Curescu", "date": "2019-01-30T16:36:00Z", "comment": "MustFix.  \nIn version 1.0 (pre YAML) the subsequent blocks that contained\ndefinitions were used to provide definitions for types imported in the\nservice template, that is these files were parsed instead of taking the\ndefinitions from external repositoris.  \nSince 1.0 yaml, the files are specified explicitly in the imports\nstatements.  \nNevertheless, by allowing the other definition blocks (as per this\nparagraph formulation) we allow also the old style of imports by the\ndefinitions in the other blocks.  \nI think this puts a burden on the implementation of orchestrators and\nquite confusing. So we should deprecate the usage of definitions in the\nother blocks.  \nMoreover, the other blocks can contain other file type decriptions (for\nartifacts) in the other blocks. E.g:  \nName: Plans/AddUser.bpmn  \nContent-Type: application/vnd.oasis.bpmn  \nThese also seem obsolete and useless.  \nI think we should deprecate the other blocks in the TOSCA.meta\nfile", "target": "Note that any further TOSCA definitions files required by the\ndefinitions specified by **Entry-Definitions** or **Other-Definitions**\ncan be found by a TOSCA orchestrator by processing respective\n**imports** statements. Note also that artifact files (e.g. scripts,\nbinaries, configuration files) used by the TOSCA definitions and\nincluded in the CSAR are fully described and referred via relative path\nnames in artifact definitions in the respective TOSCA definitions files\ncontained in the CSAR."}-->
<p>The following listing represents a valid <code>TOSCA.meta</code> file
according 
to this TOSCA specification.</p>
<pre><code>CSAR-Version: 2.0
Created-By: OASIS TOSCA TC
Entry-Definitions: tosca_elk.yaml 
Other-Definitions: definitions/tosca_moose.yaml definitions/tosca_deer.yaml</code></pre>
<p>This <code>TOSCA.meta</code> file indicates its structure (as well as
the overall 
CSAR structure) by means of the <strong>CSAR-Version</strong> keyname
with value 
<strong>2.0</strong>. The <strong>Entry-Definitions</strong> keyname
points to a TOSCA definitions 
YAML file with the name <code>tosca_elk.yaml</code> which is contained
in the 
root of the CSAR file. Additionally, it specifies that
substitution 
templates can be found in the files <code>tosca_moose.yaml</code>
and 
<code>tosca_deer.yaml</code> found in the directory called
<strong>definitions</strong> in the 
root of the CSAR file.</p>
<h3 id="custom-keynames-in-the-tosca.meta-file">17.2.2 Custom Keynames
in the TOSCA.meta File</h3>
<p>Users can populate other blocks than block_0 in the TOSCA.meta file
with 
custom name/value pairs that follow the entry syntax defined above
and 
have names that are different from the normative keynames (e.g. 
CSAR-Version, Created-By, Entry-Definitions, Other-Definitions).
These 
custom name/value pairs are outside the scope of the TOSCA 
specification.Nevertheless, future versions of the TOSCA
specification 
may add definitions of new keynames to be used in the
<code>TOSCA.meta</code> 
file. In case of a keyname collision (with a custom keyname) the
TOSCA 
specification definitions take precedence.</p>
<p>To minimize such keyname collisions the specification reserves the
use 
of keynames starting with TOSCA and tosca. It is recommended as a
good 
practice to use a specific prefix (e.g. identifying the
organization, 
scope, etc.) when using custom keynames.</p>
<h2 id="csar-without-tosca.meta">17.3 CSAR Without TOSCA.meta</h2>
<p>In case the archive doesn’t contains a <code>TOSCA.meta</code> file
the archive 
is required to contains a single YAML file at the root of the
archive 
(other templates may exist in sub-directories).</p>
<p>TOSCA processors should recognize this file as being the CSAR 
Entry-Definitions file. The CSAR-Version is inferred from the 
tosca_definitions_version keyname in the Entry-Definitions file.
For 
tosca_definitions_version: tosca_2_0 and onwards, the
corresponding 
CSAR-version is 2.0 unless further defined.</p>
<p>Note that in a CSAR without TOSCA-metadata it is not possible
to 
unambiguously include definitions for substitution templates as we
can 
have only one service template defined in a YAML file.</p>
<p>The following represents a valid TOSCA template file acting as the
CSAR 
Entry-Definitions file in an archive without <code>TOSCA-Metadata</code>
directory.</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb310-1"><a aria-hidden="true" href="#cb310-1" tabindex="-1"></a><span class="fu">tosca_definitions_version</span><span class="kw">:</span><span class="at"> tosca_2_0</span></span>
<span id="cb310-2"><a aria-hidden="true" href="#cb310-2" tabindex="-1"></a></span>
<span id="cb310-3"><a aria-hidden="true" href="#cb310-3" tabindex="-1"></a><span class="fu">metadata</span><span class="kw">:</span></span>
<span id="cb310-4"><a aria-hidden="true" href="#cb310-4" tabindex="-1"></a><span class="at">  </span><span class="fu">template_name</span><span class="kw">:</span><span class="at"> my_template</span></span>
<span id="cb310-5"><a aria-hidden="true" href="#cb310-5" tabindex="-1"></a><span class="at">  </span><span class="fu">template_author</span><span class="kw">:</span><span class="at"> OASIS TOSCA TC</span></span>
<span id="cb310-6"><a aria-hidden="true" href="#cb310-6" tabindex="-1"></a><span class="at">  </span><span class="fu">template_version</span><span class="kw">:</span><span class="at"> </span><span class="fl">1.0</span></span></code></pre></div>
<table style="width:11%;">
<colgroup>
<col style="width: 11%"/>
</colgroup>
<tbody>
<tr class="odd">
<td># 18 Conformance<br/>
<!-- Required section --><br/>
The content in this section is normative unless otherwise labeled
except:<br/>
- the examples<br/>
- references unless labelled as normative.</td>
</tr>
<tr class="even">
<td>&gt; (Note: The <a href="https://www.oasis-open.org/policies-guidelines/tc-process-2017-05-26/#wpComponentsConfClause">OASIS
TC<br/>
&gt; Process</a><br/>
&gt; requires that a specification approved by the TC at the
Committee<br/>
&gt; Specification Public Review Draft, Committee Specification or
OASIS<br/>
&gt; Standard level must include a separate section, listing a set
of<br/>
&gt; numbered conformance clauses, to which any implementation of
the<br/>
&gt; specification must adhere in order to claim conformance to
the<br/>
&gt; specification (or any optional portion thereof). This is done
by<br/>
&gt; listing the conformance clauses here. For the definition of<br/>
&gt; “conformance clause,” see <a href="https://www.oasis-open.org/policies-guidelines/oasis-defined-terms-2018-05-22/#dConformanceClause">OASIS
Defined<br/>
&gt; Terms</a>.</td>
</tr>
<tr class="odd">
<td>&gt; See “Guidelines to Writing Conformance Clauses”:<br/>
&gt; <a class="uri" href="https://docs.oasis-open.org/templates/TCHandbook/ConformanceGuidelines.html">https://docs.oasis-open.org/templates/TCHandbook/ConformanceGuidelines.html</a>.</td>
</tr>
<tr class="even">
<td>&gt; Remove this note before submitting for publication.)</td>
</tr>
<tr class="odd">
<td>## 18.1 Conformance Targets</td>
</tr>
<tr class="even">
<td>The implementations subject to conformance are those introduced
in<br/>
Section 11.3 “Implementations”. They are listed here for
convenience:</td>
</tr>
<tr class="odd">
<td>- TOSCA YAML service template</td>
</tr>
<tr class="even">
<td>- TOSCA processor</td>
</tr>
<tr class="odd">
<td>- TOSCA orchestrator (also called orchestration engine)</td>
</tr>
<tr class="even">
<td>- TOSCA generator</td>
</tr>
<tr class="odd">
<td>- TOSCA archive</td>
</tr>
<tr class="even">
<td>## 18.2 Conformance Clause 1: TOSCA YAML Service Template</td>
</tr>
<tr class="odd">
<td>A document conforms to this specification as TOSCA YAML service
template<br/>
if it satisfies all the statements below:</td>
</tr>
<tr class="even">
<td>1. It is valid according to the grammar, rules and requirements
defined<br/>
in section 3 “TOSCA definitions in YAML”.</td>
</tr>
<tr class="odd">
<td>2. When using functions defined in section 4 “TOSCA functions”, it
is<br/>
valid according to the grammar specified for these functions.</td>
</tr>
<tr class="even">
<td>3. When using or referring to data types, artifact types,
capability<br/>
types, interface types, node types, relationship types, group
types,<br/>
policy types defined in section 5 “TOSCA normative type<br/>
definitions”, it is valid according to the definitions given in<br/>
section 5.</td>
</tr>
<tr class="odd">
<td>## 18.3 Conformance Clause 2: TOSCA Processor</td>
</tr>
<tr class="even">
<td>A processor or program conforms to this specification as TOSCA
processor<br/>
if it satisfies all the statements below:</td>
</tr>
<tr class="odd">
<td>1. It can parse and recognize the elements of any conforming TOSCA
YAML<br/>
service template, and generates errors for those documents that
fail<br/>
to conform as TOSCA YAML service template while clearly intending<br/>
to.</td>
</tr>
<tr class="even">
<td>2. It implements the requirements and semantics associated with
the<br/>
definitions and grammar in section 3 “TOSCA definitions in YAML”,<br/>
including those listed in the “additional requirements”
subsections.</td>
</tr>
<tr class="odd">
<td>3. It resolves the imports, either explicit or implicit, as
described<br/>
in section 3 “TOSCA definitions in YAML”.</td>
</tr>
<tr class="even">
<td>4. It generates errors as required in error cases described in
sections<br/>
3.1 (TOSCA Namespace URI and alias), 3.2 (Parameter and property<br/>
type) and 3.6 (Type-specific definitions).</td>
</tr>
<tr class="odd">
<td>5. It normalizes string values as described in section 5.4.9.3<br/>
(Additional Requirements)</td>
</tr>
<tr class="even">
<td>## 18.4 Conformance Clause 3: TOSCA Orchestrator</td>
</tr>
<tr class="odd">
<td>A processor or program conforms to this specification as TOSCA<br/>
orchestrator if it satisfies all the statements below:</td>
</tr>
<tr class="even">
<td>1. It is conforming as a TOSCA Processor as defined in
conformance<br/>
clause 2: TOSCA Processor.</td>
</tr>
<tr class="odd">
<td>2. It can process all types of artifact described in section
5.3<br/>
“Artifact types” according to the rules and grammars in this<br/>
section.</td>
</tr>
<tr class="even">
<td>3. It can process TOSCA archives as intended in section 6 “TOSCA
Cloud<br/>
Service Archive (CSAR) format” and other related normative
sections.</td>
</tr>
<tr class="odd">
<td>4. It can understand and process the functions defined in section
4<br/>
“TOSCA functions” according to their rules and semantics.</td>
</tr>
<tr class="even">
<td>5. It can understand and process the normative type
definitions<br/>
according to their semantics and requirements as described in<br/>
section 5 “TOSCA normative type definitions”.</td>
</tr>
<tr class="odd">
<td>6. It can understand and process the networking types and
semantics<br/>
defined in section 7 “TOSCA Networking”.</td>
</tr>
<tr class="even">
<td>7. It generates errors as required in error cases described in
sections<br/>
2.10 (Using node template substitution for chaining subsystems),
5.4<br/>
(Capabilities Types) and 5.7 (Interface Types).).</td>
</tr>
<tr class="odd">
<td>## 18.5 Conformance Clause 4: TOSCA Generator</td>
</tr>
<tr class="even">
<td>A processor or program conforms to this specification as TOSCA
generator<br/>
if it satisfies at least one of the statements below:</td>
</tr>
<tr class="odd">
<td>1. When requested to generate a TOSCA service template, it
always<br/>
produces a conforming TOSCA service template, as defined in Clause<br/>
1: TOSCA YAML service template,</td>
</tr>
<tr class="even">
<td>2. When requested to generate a TOSCA archive, it always produces
a<br/>
conforming TOSCA archive, as defined in Clause 5: TOSCA archive.</td>
</tr>
<tr class="odd">
<td>## 18.6 Conformance Clause 5: TOSCA Archive</td>
</tr>
<tr class="even">
<td>A package artifact conforms to this specification as TOSCA archive
if it<br/>
satisfies all the statements below:</td>
</tr>
<tr class="odd">
<td>1. It is valid according to the structure and rules defined in
section<br/>
6 “TOSCA Cloud Service Archive (CSAR) format”.</td>
</tr>
</tbody>
</table>
<h1 id="appendix-a.-references">Appendix A. References</h1>
<!-- Required section -->
<p>This appendix contains the normative and informative references that
are used in this document.</p>
<p>While any hyperlinks included in this appendix were valid at the time
of publication, OASIS cannot guarantee their long-term validity.</p>
<h2 id="a.1-normative-references">A.1 Normative References</h2>
<p>The following documents are referenced in such a way that some or all
of their content constitutes requirements of this document.</p>
<blockquote>
<p>(Reference sources: For references to IETF RFCs, use the
approved 
citation formats at: <a class="uri" href="https://docs.oasis-open.org/templates/ietf-rfc-list/ietf-rfc-list.html">https://docs.oasis-open.org/templates/ietf-rfc-list/ietf-rfc-list.html</a>. <br/> 
For references to W3C Recommendations, use the approved citation 
formats at: <a class="uri" href="https://docs.oasis-open.org/templates/w3c-recommendations-list/w3c-recommendations-list.html">https://docs.oasis-open.org/templates/w3c-recommendations-list/w3c-recommendations-list.html</a>. <br/> 
Remove this note before submitting for publication.)</p>
</blockquote>
<h6 id="rfc2119">[RFC2119]</h6>
<p>Bradner, S., “Key words for use in RFCs to Indicate Requirement Levels”, BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997, <a class="uri" href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>. <br/> 
###### [RFC8174] Leiba, B., “Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words”, BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017, <a class="uri" href="http://www.rfc-editor.org/info/rfc8174">http://www.rfc-editor.org/info/rfc8174</a>. <br/> 
###### [YAML-1.2] 
YAML, Version 1.2, 3rd Edition, Patched at 2009-10-01, Oren 
Ben-Kiki, Clark Evans, Ingy döt Net</p>
<h2 id="a.2-informative-references">A.2 Informative References</h2>
<h6 id="maven-version">[Maven-Version]</h6>
<p>Apache Maven version policy draft: <a class="uri" href="https://cwiki.apache.org/confluence/display/MAVEN/Version+number+policy">https://cwiki.apache.org/confluence/display/MAVEN/Version+number+policy</a> <br/> 
###### [RFC3552] Rescorla, E. and B. Korver, “Guidelines for Writing RFC Text on Security Considerations”, BCP 72, RFC 3552, DOI 10.17487/RFC3552, July 2003, <a class="uri" href="https://www.rfc-editor.org/info/rfc3552">https://www.rfc-editor.org/info/rfc3552</a>. <br/></p>
<h6 id="file-extensions-for-media-types">[File extensions for media
types]</h6>
<p>File extensions for media types some registered as described in RFC 4288 <a class="uri" href="http://svn.apache.org/repos/asf/httpd/httpd/trunk/docs/conf/mime.types">http://svn.apache.org/repos/asf/httpd/httpd/trunk/docs/conf/mime.types</a> <br/></p>
<h6 id="tosca-discussion">[TOSCA discussion]</h6>
<p>tosca-community-contributions github repository. <a class="uri" href="https://github.com/oasis-open/tosca-community-contributions">https://github.com/oasis-open/tosca-community-contributions</a> <br/></p>
<h6 id="rfc3339">[RFC3339]</h6>
<p>G. Klyne and C, Newman “Date and Time on the Internet: Timestamps” July 2002, <a class="uri" href="https://tools.ietf.org/html/rfc3339">https://tools.ietf.org/html/rfc3339</a> <br/></p>
<h6 id="si-units">[SI Units]</h6>
<p>“<em>SI Brochure: The International System of Units (SI) [8th 
edition, 2006; updated in 2014]</em>”, <a class="uri" href="http://www.bipm.org/en/publications/si-brochure/">http://www.bipm.org/en/publications/si-brochure/</a> <br/></p>
<h1 id="appendix-b.-safety-security-and-privacy-considerations">Appendix
B. Safety, Security and Privacy Considerations</h1>
<!-- Optional section -->
<p>(Note: OASIS strongly recommends that Technical Committees consider
issues that might affect safety, security, privacy, and/or data
protection in implementations of their specification and document them
for implementers and adopters. For some purposes, you may find it
required, e.g. if you apply for IANA registration.</p>
<p>While it may not be immediately obvious how your specification might
make systems vulnerable to attack, most specifications, because they
involve communications between systems, message formats, or system
settings, open potential channels for exploit. For example, IETF [<a href="#rfc3552">RFC3552</a>] lists “eavesdropping, replay, message
insertion, deletion, modification, and man-in-the-middle” as well as
potential denial of service attacks as threats that must be considered
and, if appropriate, addressed in IETF RFCs.</p>
<p>In addition to considering and describing foreseeable risks, this
section should include guidance on how implementers and adopters can
protect against these risks.</p>
<p>We encourage editors and TC members concerned with this subject to
read <em>Guidelines for Writing RFC Text on Security
Considerations</em>, IETF [<a href="#rfc3552">RFC3552</a>], for more
information.</p>
<p>Remove this note before submitting for publication.)</p>
<hr/>
<h1 id="appendix-c.-acknowledgments">Appendix C. Acknowledgments</h1>
<!-- Required section -->
<p>Note: A Work Product approved by the TC must include a list of people
who participated in the development of the Work Product. This is
generally done by collecting the list of names in this appendix. This
list shall be initially compiled by the Chair, and any Member of the TC
may add or remove their names from the list by request. Remove this note
before submitting for publication.</p>
<h2 id="c.1-special-thanks">C.1 Special Thanks</h2>
<!-- This is an optional subsection to call out contributions from TC members. If a TC wants to thank non-TC members then they should avoid using the term "contribution" and instead thank them for their "expertise" or "assistance". -->
<p>Substantial contributions to this document from the following
individuals are gratefully acknowledged:</p>
<p>Participant Name, Affiliation or “Individual Member”</p>
<h2 id="c.2-participants">C.2 Participants</h2>
<!-- A TC can determine who they list here, however, TC Observers must not be listed. It is common practice for TCs to list everyone that was part of the TC during the creation of the document, but this is ultimately a TC decision on who they want to list and not list, and in what order. -->
<p>The following individuals have participated in the creation of
this 
specification and are gratefully acknowledged:</p>
<p><strong>TOSCA TC Members:</strong></p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">First Name</th>
<th style="text-align: left;">Last Name</th>
<th style="text-align: left;">Company</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Calin</td>
<td style="text-align: left;">Curescu</td>
<td style="text-align: left;">Ericsson</td>
</tr>
<tr class="even">
<td style="text-align: left;">Chris</td>
<td style="text-align: left;">Lauwers</td>
<td style="text-align: left;">Individual Member</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Paul</td>
<td style="text-align: left;">Jordan</td>
<td style="text-align: left;">Individual Member</td>
</tr>
<tr class="even">
<td style="text-align: left;">Peter</td>
<td style="text-align: left;">Bruun</td>
<td style="text-align: left;">Hewlett Packard Enterprise</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tal</td>
<td style="text-align: left;">Liron</td>
<td style="text-align: left;">Google</td>
</tr>
</tbody>
</table>
<blockquote>
<p>The following list needs to be cleaned up in accordance with
OASIS 
guidelines:</p>
</blockquote>
<p>Adam Souzis (<a class="email" href="mailto:adam@souzis.com">adam@souzis.com</a>)</p>
<p>Alex Vul (<a class="email" href="mailto:alex.vul@intel.com">alex.vul@intel.com</a>), Intel</p>
<p>Anatoly Katzman (<a class="email" href="mailto:anatoly.katzman@att.com">anatoly.katzman@att.com</a>), AT&amp;T</p>
<p>Arturo Martin De Nicolas (<a class="email" href="mailto:arturo.martin-de-nicolas@ericsson.com">arturo.martin-de-nicolas@ericsson.com</a>), 
Ericsson</p>
<p>Avi Vachnis (<a class="email" href="mailto:avi.vachnis@alcatel-lucent.com">avi.vachnis@alcatel-lucent.com</a>), Alcatel-Lucent</p>
<p>Calin Curescu (<a class="email" href="mailto:calin.curescu@ericsson.com">calin.curescu@ericsson.com</a>), Ericsson</p>
<p>Chris Lauwers (<a class="email" href="mailto:lauwers@ubicity.com)">lauwers@ubicity.com)</a></p>
<p>Claude Noshpitz (<a class="email" href="mailto:claude.noshpitz@att.com">claude.noshpitz@att.com</a>), AT&amp;T</p>
<p>Derek Palma (<a class="email" href="mailto:dpalma@vnomic.com">dpalma@vnomic.com</a>), Vnomic</p>
<p>Dmytro Gassanov (<a class="email" href="mailto:dmytro.gassanov@netcracker.com">dmytro.gassanov@netcracker.com</a>), NetCracker</p>
<p>Frank Leymann (<a class="email" href="mailto:Frank.Leymann@informatik.uni-stuttgart.de">Frank.Leymann@informatik.uni-stuttgart.de</a>), Univ.
of 
Stuttgart</p>
<p>Gábor Marton (<a class="email" href="mailto:gabor.marton@nokia.com">gabor.marton@nokia.com</a>), Nokia</p>
<p>Gerd Breiter (<a class="email" href="mailto:gbreiter@de.ibm.com">gbreiter@de.ibm.com</a>), IBM</p>
<p>Hemal Surti (<a class="email" href="mailto:hsurti@cisco.com">hsurti@cisco.com</a>), Cisco</p>
<p>Ifat Afek (<a class="email" href="mailto:ifat.afek@alcatel-lucent.com">ifat.afek@alcatel-lucent.com</a>), Alcatel-Lucent</p>
<p>Idan Moyal, (<a class="email" href="mailto:idan@gigaspaces.com">idan@gigaspaces.com</a>), Gigaspaces</p>
<p>Jacques Durand (<a class="email" href="mailto:jdurand@us.fujitsu.com">jdurand@us.fujitsu.com</a>), Fujitsu</p>
<p>Jin Qin, (<a class="email" href="mailto:chin.qinjin@huawei.com">chin.qinjin@huawei.com</a>), Huawei</p>
<p>Jeremy Hess, (<a class="email" href="mailto:jeremy@gigaspaces.com">jeremy@gigaspaces.com</a>), Gigaspaces</p>
<p>John Crandall, 
(<a href="mailto:jcrandal@brocade.com">mailto:jcrandal@brocade.com</a>),
Brocade</p>
<p>Juergen Meynert (<a class="email" href="mailto:juergen.meynert@ts.fujitsu.com">juergen.meynert@ts.fujitsu.com</a>), Fujitsu</p>
<p>Kapil Thangavelu (<a class="email" href="mailto:kapil.thangavelu@canonical.com">kapil.thangavelu@canonical.com</a>), Canonical</p>
<p>Karsten Beins (<a class="email" href="mailto:karsten.beins@ts.fujitsu.com">karsten.beins@ts.fujitsu.com</a>), Fujitsu</p>
<p>Kevin Wilson (<a class="email" href="mailto:kevin.l.wilson@hp.com">kevin.l.wilson@hp.com</a>), HP</p>
<p>Krishna Raman (<a class="email" href="mailto:kraman@redhat.com">kraman@redhat.com</a>), Red Hat</p>
<p>Luc Boutier (<a class="email" href="mailto:luc.boutier@fastconnect.fr">luc.boutier@fastconnect.fr</a>), FastConnect</p>
<p>Luca Gioppo, (<a class="email" href="mailto:luca.gioppo@csi.it">luca.gioppo@csi.it</a>), CSI-Piemonte</p>
<p>Matej Artač, (<a class="email" href="mailto:matej.artac@xlab.si">matej.artac@xlab.si</a>), XLAB</p>
<p>Matt Rutkowski (<a class="email" href="mailto:mrutkows@us.ibm.com">mrutkows@us.ibm.com</a>), IBM</p>
<p>Moshe Elisha (<a class="email" href="mailto:moshe.elisha@alcatel-lucent.com">moshe.elisha@alcatel-lucent.com</a>), Alcatel-Lucent</p>
<p>Nate Finch (<a class="email" href="mailto:nate.finch@canonical.com">nate.finch@canonical.com</a>), Canonical</p>
<p>Nikunj Nemani (<a class="email" href="mailto:nnemani@vmware.com">nnemani@vmware.com</a>), Wmware</p>
<p>Paul Jordan (<a class="email" href="mailto:paul.m.jordan@outlook.com">paul.m.jordan@outlook.com</a>), Individual Member</p>
<p>Peter Bruun (<a class="email" href="mailto:peter-michael.bruun@hpe.com">peter-michael.bruun@hpe.com</a>), Hewlett Packard
Enterprise</p>
<p>Philippe Merle (<a class="email" href="mailto:philippe.merle@inria.fr">philippe.merle@inria.fr</a>), Inria</p>
<p>Priya TG (<a class="email" href="mailto:priya.g@netcracker.com)">priya.g@netcracker.com)</a> NetCracker</p>
<p>Richard Probst (<a class="email" href="mailto:richard.probst@sap.com">richard.probst@sap.com</a>), SAP AG</p>
<p>Sahdev Zala (<a class="email" href="mailto:spzala@us.ibm.com">spzala@us.ibm.com</a>), IBM</p>
<p>Shitao li (<a class="email" href="mailto:lishitao@huawei.com">lishitao@huawei.com</a>), Huawei</p>
<p>Simeon Monov (<a class="email" href="mailto:sdmonov@us.ibm.com">sdmonov@us.ibm.com</a>), IBM</p>
<p>Sivan Barzily (<a class="email" href="mailto:sivan@gigaspaces.com">sivan@gigaspaces.com</a>), Gigaspaces</p>
<p>Sridhar Ramaswamy (<a class="email" href="mailto:sramasw@brocade.com">sramasw@brocade.com</a>), Brocade</p>
<p>Stephane Maes (<a class="email" href="mailto:stephane.maes@hp.com">stephane.maes@hp.com</a>), HP</p>
<p>Steve Baillargeon (<a class="email" href="mailto:steve.baillargeon@ericsson.com">steve.baillargeon@ericsson.com</a>), Ericsson</p>
<p>Tal Liron (<a class="email" href="mailto:tliron@redhat.com">tliron@redhat.com</a>)</p>
<p>Thinh Nguyenphu (<a class="email" href="mailto:thinh.nguyenphu@nokia.com">thinh.nguyenphu@nokia.com</a>), Nokia</p>
<p>Thomas Spatzier (<a class="email" href="mailto:thomas.spatzier@de.ibm.com">thomas.spatzier@de.ibm.com</a>), IBM</p>
<p>Ton Ngo (<a class="email" href="mailto:ton@us.ibm.com">ton@us.ibm.com</a>), IBM</p>
<p>Travis Tripp (<a class="email" href="mailto:travis.tripp@hp.com">travis.tripp@hp.com</a>), HP</p>
<p>Vahid Hashemian (<a class="email" href="mailto:vahidhashemian@us.ibm.com">vahidhashemian@us.ibm.com</a>), IBM</p>
<p>Wayne Witzel (<a class="email" href="mailto:wayne.witzel@canonical.com">wayne.witzel@canonical.com</a>), Canonical</p>
<p>Yaron Parasol (<a class="email" href="mailto:yaronpa@gigaspaces.com">yaronpa@gigaspaces.com</a>), Gigaspaces</p>
<hr/>
<h1 id="appendix-d.-revision-history">Appendix D. Revision History</h1>
<!-- Optional section -->
<table>
<colgroup>
<col style="width: 25%"/>
<col style="width: 25%"/>
<col style="width: 25%"/>
<col style="width: 25%"/>
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Revision</th>
<th style="text-align: left;">Date</th>
<th style="text-align: left;">Editor</th>
<th style="text-align: left;">Changes Made</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">specname-v1.0-wd01</td>
<td style="text-align: left;">yyyy-mm-dd</td>
<td style="text-align: left;">Editor Name</td>
<td style="text-align: left;">Initial working draft</td>
</tr>
</tbody>
</table>
<blockquote>
<p>The following table needs to be formatted according to the
above 
guidelines.</p>
</blockquote>
<table>
<colgroup>
<col style="width: 14%"/>
<col style="width: 13%"/>
<col style="width: 14%"/>
<col style="width: 56%"/>
</colgroup>
<thead>
<tr class="header">
<th>
<strong>Revision</strong>
</th>
<th>
<strong>Date</strong>
</th>
<th>
<strong>Editor</strong>
</th>
<th>
<strong>Changes Made</strong>
</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>
WD01, Rev01
</td>
<td>
2019-04-01
</td>
<td>
Chris Lauwers
</td>
<td>
Initial WD01, Revision 01 baseline for TOSCA v2.0
</td>
</tr>
<tr class="even">
<td>
WD01, Rev02
</td>
<td>
2019-04-22
</td>
<td>
Chris Lauwers
</td>
<td>
Split of introductory chapters into the <em>Introduction to TOSCA<br/>
Version 2.0</em> document.
</td>
</tr>
<tr class="odd">
<td>
WD01, Rev03
</td>
<td>
2019-05-08
</td>
<td>
Calin Curescu
</td>
<td>
Incorporate fixes from latest v1.3 specification
</td>
</tr>
<tr class="even">
<td>
WD01, Rev04
</td>
<td>
2019-05-10
</td>
<td>
Chris Lauwers
</td>
<td>
Fix syntax of schema constraint examples (Sections 5.3.2 and<br/>
5.3.4)
</td>
</tr>
<tr class="odd">
<td>
WD01, Rev05
</td>
<td>
2019-08-30
</td>
<td>
Chris Lauwers
</td>
<td>
Cleanup formatting. No content changes.
</td>
</tr>
<tr class="even">
<td>
WD01, Rev06
</td>
<td>
2019-08-30
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Remove 3.6.20.3 since it is no longer relevant.
</p>
</li>
<li>
<p>
Separate out new Operation Assignment section 3.8.3 from the 
original Operation Definition section 3.6.17
</p>
</li>
<li>
<p>
Separate out new Notification Assignment section 3.8.4 from the 
original Notification Definition section 3.6.19
</p>
</li>
<li>
<p>
Separate out new Interface Assignment section 3.8.5 from the 
original Interface Definition section 3.6.20
</p>
</li>
<li>
<p>
Update the Interface Type definitions in section 5.8 to show the 
(now mandatory) ‘operations’ keyname.
</p>
</li>
<li>
<p>
Remove erroneous interface definition in tosca.groups.Root type 
(section 5.10.1)
</p>
</li>
<li>
<p>
Added ‘description’ keyname to Requirement definition (section 
3.7.3)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD01, Rev07
</td>
<td>
2019-09-08
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Added the “value” keyname to property definition (Section 3.6.10 
Property Definition),
</p>
</li>
<li>
<p>
Made the difference between outgoing and incoming parameters in 
the parameter definition (Section 3.6.14 Parameter definition)
</p>
</li>
<li>
<p>
Added the “mapping” keyname to the parameter definition, for 
mapping the incoming parameter to an attribute (Section 3.6.14
Parameter 
definition)
</p>
</li>
<li>
<p>
Changed the wrong usage of “property definitions” and “property 
assignments” instead of “parameter definitions” and “parameter 
assignments” throughout the document. For example, a larger impact
can 
be seen in the definition of the get_input function (Section 4.4.1 
get_input).
</p>
</li>
<li>
<p>
Changed Section “3.6.16 Operation implementation definition” to 
include notification implementation definition (Section 3.6.16
Operation 
implementation definition and notification implementation 
definition).
</p>
</li>
<li>
<p>
Deleted Section “3.6.18 Notification implementation definition” 
since it was redundant and all relevant information has been
transferred 
to Section “3.6.16 Operation implementation definition and
notification 
implementation definition”. The “Notification definition” section 
becomes the new Section 3.6.18.
</p>
</li>
<li>
<p>
Added operation assignment rules to the operation assignment 
section (Section 3.8.3 Operation Assignment).
</p>
</li>
<li>
<p>
Added notification assignment rules to the notification 
assignment section (Section 3.8.4 Notification assignment).
</p>
</li>
<li>
<p>
Added interface assignment rules to the interface assignment 
section (Section 3.8.5 Interface assignment).
</p>
</li>
<li>
<p>
Changed “interface definitions” with “interface assignments” in 
the node template specification, given that we have split
interface 
assignments from interface definitions (Section 3.8.6 Node 
Template)
</p>
</li>
<li>
<p>
Changed “interface definitions” with “interface assignments” in 
the relationship template specification, given that we have split 
interface assignments from interface definitions (Section 3.8.7 
relationship template)
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD01, Rev08
</td>
<td>
2019-09-30
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Fix error in TimeInterval example (Section 5.3.7.3.1)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD01, Rev09
</td>
<td>
2020-02-20
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Move normative type definitions to the “Intro to TOSCA” 
document
</p>
</li>
<li>
<p>
Move non-normative type definitions to the “Intro to TOSCA” 
document
</p>
</li>
<li>
<p>
Move “CSAR” specification from the “intro to TOSCA” document into 
this document
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD01, Rev10
</td>
<td>
2020-04-15
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Reorganized sections into a new layout (starting with the main 
concepts):
</p>
</li>
<li>
<p>
3.5 -&gt; 3.1; 3.10 -&gt; 3.2.1; 3.1 -&gt; 3.2.2.1; 3.2 -&gt; 
3.2.2.2; 3.6.8 -&gt; 3.2.3.1; 3.6.6 -&gt; 3.2.3.2; 3.6.1 -&gt;
3.2.4.1; 
3.6.2 -&gt; 3.2.4.2; 3.7.1 -&gt; 3.2.5.2; 3.9 -&gt; 3.2.6; 3.7.9
-&gt; 
3.3.1; 3.8.6 -&gt; 3.3.2; 3.7.10 -&gt; 3.3.3; 3.8.7 -&gt; 3.3.4;
3.7.7 
-&gt; 3.3.5.1; 3.7.2 -&gt; 3.3.5.2; 3.8.1 -&gt; 3.3.5.3; 3.7.8
-&gt; 
3.3.5.4; 3.7.3 -&gt; 3.3.5.5; 3.8.2 -&gt; 3.3.5.6; 3.6.5 -&gt;
3.3.5.7; 
3.6.4 -&gt; 3.3.5.8; 3.7.5 -&gt; 3.3.6.1; 3.6.19 -&gt; 3.3.6.2;
3.8.5 
-&gt; 3.3.6.3; 3.6.17 -&gt; 3.3.6.4; 3.8.3 -&gt; 3.3.6.5; 3.6.18
-&gt; 
3.3.6.6; 3.8.4 -&gt; 3.3.6.7; 3.6.16 -&gt; 3.3.6.8; 3.7.4 -&gt;
3.3.7.1; 
3.6.7 -&gt; 3.3.7.2; 3.3 -&gt; 3.4.1; 3.7.6 -&gt; 3.4.2; 3.6.9
-&gt; 
3.4.3; 3.6.3 -&gt; 3.4.4; 3.6.10 -&gt; 3.4.5; 3.6.11 -&gt; 3.4.6;
3.6.12 
-&gt; 3.4.7; 3.6.13 -&gt; 3.4.8; 3.6.14 -&gt; 3.4.9; 3.8.16 -&gt;
3.5.1; 
3.8.11 -&gt; 3.5.2; 3.8.12 -&gt; 3.5.3; 3.8.13 -&gt; 3.5.4; 3.8.14
-&gt; 
3.5.5; 3.8.15 -&gt; 3.5.6; 3.7.11 -&gt; 3.6.1; 3.8.8 -&gt; 3.6.2;
3.7.12 
-&gt; 3.6.3; 3.8.9 -&gt; 3.6.4; 3.6.21 -&gt; 3.6.5; 3.6.20 -&gt;
3.6.6; 
3.6.24 -&gt; 3.6.7; 3.6.23 -&gt; 3.6.8; 3.6.22 -&gt; 3.6.9; 3.8.10
-&gt; 
3.7.1; 3.6.25 -&gt; 3.7.2; 3.6.26 -&gt; 3.7.3
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD02, Rev01
</td>
<td>
2020-04-23
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Added Section 3.1.2 Modeling definitions and reuse
</p>
</li>
<li>
<p>
Added Section 3.1.3 Goal of the derivation and refinement 
rules
</p>
</li>
<li>
<p>
Added Section 3.2.5 Type definitions
</p>
</li>
<li>
<p>
Added Section 3.2.5.1 General derivation and refinement 
rules
</p>
</li>
<li>
<p>
Reworked and simplified Section 3.2.5.2 as describing common 
keynames that apply to all TOSCA entity types. Added derivation
rules 
for the common keynames in TOSCA entity types (Section 3.2.5.2.3 
Derivation rules).
</p>
</li>
<li>
<p>
Added derivation rules for the following TOSCA entity types: 
node, relationship, capability, interface, and data types in their 
specific sections. The new sub-sections are named “Derivation 
rules”.
</p>
</li>
<li>
<p>
Added refinement rules for entitiy definitions contained in types 
undergoing derivations. Refinement rules for the following entity 
definitions: capability, requirement, interface, operation, 
notification, schema, property, attribute, and parameter
definitions 
have been added in their specific sections. The new sub-sections
are 
named “Refinement rules”.
</p>
</li>
<li>
<p>
Explained that definitions for the properties, attributes and 
valid_source_types in a capability definition are refinements of
the 
definitions in the capability type (Section 3.3.5.2. Capability 
definition).
</p>
</li>
<li>
<p>
Changed the occurrences keyname in a capability assignment from a 
range of integer to an integer, to correct the wrong specification
in 
TOSCA v1.3 (Section 3.3.5.3. Capability assignment).
</p>
</li>
<li>
<p>
Added the possibility to have provide a symbolic name of a 
Capability definition within a target node type that can fulfill
the 
requirement in the Requirement definition (in addition to the
Capability 
Type) (Section 3.3.5.5. Requirement definition).
</p>
</li>
<li>
<p>
Added the possibility to provide a node_filter also in the 
Requirement definition (this node filter is applied in addition to
the 
node filter defined in the Requirement assignment) (Section
3.3.5.5. 
Requirement definition).
</p>
</li>
<li>
<p>
Explained that the specification supports providing several 
requirement assignments with the same symbolic name that represent 
subsets of the occurrences specified in the Requirement definition 
(Section 3.3.5.6. Requirement assignment).
</p>
</li>
<li>
<p>
Changed the occurrences keyname in a requirement assignment from 
a range of integer to an integer, to correct the wrong specification
in 
TOSCA v1.3 (Section 3.3.5.6. Requirement assignment).
</p>
</li>
<li>
<p>
Explained that property definitions may not be added to data 
types derived_from TOSCA primitive types (Section 3.4.2 Data 
Type).
</p>
</li>
<li>
<p>
Added the rule for a map key definition that its type must be 
originally derived from string. This is due to fact that in many 
YAML/TOSCA parsers it is hard to process keys that are not strings,
and 
the added benefit of non-string keys is minimal (Section 3.4.3
Schema 
definition).
</p>
</li>
<li>
<p>
Explained that the default value is irrelevant for properties and 
parameters that are not required (i.e. where the keyname required
is 
“false”) as they will stay undefined (Section 3.4.5 Property
definition 
and Section 3.4.9 Parameter definition).
</p>
</li>
<li>
<p>
A value definition “fixes” the property, that is it cannot be 
further refined (in a type) or even assigned in (in a template)
(Section 
3.4.5 Property definition and Section 3.4.6 Property 
assignment).
</p>
</li>
<li>
<p>
Added metadata keyname to attribute definitions (Section 3.4.7 
Attribute definition).
</p>
</li>
<li>
<p>
Explained that parameter can be of two different kinds: outgoing 
parameters and incoming parameters, and this depends on the context
they 
are defined in, and steers if these parameters will have a value 
assigned or will have a mapping to an attribute assigned (Section
3.4.9 
Parameter definition).
</p>
</li>
<li>
<p>
A value or mapping definition “fixes” the parameter, that is it 
cannot be further refined (in a type) or even assigned in (in a 
template) (Section 3.4.9 Parameter definition and 3.4.10 Parameter 
assignment).
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD02, Rev02
</td>
<td>
2020-05-07
</td>
<td>
</td>
<td>
<ul>
<li>
<p>
Added derivation rules for the following TOSCA entity types: 
artifact, group, and policy types) in their specific sections; the
new 
sub-sections are named “Derivation rules”.
</p>
</li>
<li>
<p>
Added refinement rules for Artifact definitions (contained in 
node types undergoing derivations). The new sub-section is named 
“Refinement rules”.
</p>
</li>
<li>
<p>
Added a single-line grammar for defining a value for a property 
to simplify the value definition for a property (Section 3.4.5
Property 
definition).
</p>
</li>
<li>
<p>
Added the constraints keyname to attribute definitions (Section 
3.4.7 Attribute definition).
</p>
</li>
<li>
<p>
Added a single-line grammar for parameter definitions when only a 
parameter to attribute mapping needs to be provided to an incoming 
parameter (Section 3.4.9 Parameter definition).
</p>
</li>
<li>
<p>
Added explanation that triggers defined in the policy definition 
are applied in addition to the triggers defined in the policy type 
(Section 3.6.4 Policy definition).
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD02, Rev03
</td>
<td>
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Incorporate introductory content from the TOSCA v1.0 document 
with the goal of removing references to the XML version of the
standard 
and making this a stand-alone document.
</p>
</li>
<li>
<p>
Explicitly stated that the default keyname SHALL NOT be defined 
for properties and parameters that are not required (i.e. where
the 
keyname required is “false”) as they will stay undefined (Section
4.4.5 
Property definition and Section 4.4.9 Parameter definition).
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD02, Rev04
</td>
<td>
2020-06-09
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Eliminated some comments that were addressed already.
</p>
</li>
<li>
<p>
Eliminated the namespace_uri that was already deprecated in TOSCA 
v1.3
</p>
</li>
<li>
<p>
Eliminated the credential keyname from the repository definition 
(Section 4.2.3.2 Repository definition) since it was not very useful
in 
the context and also to eliminate the dependency on an external
type 
simple (Credential – in the simple profile)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD02, Rev05
</td>
<td>
2020-06-18
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Eliminated the schedule keyname in trigger definitions, it was 
not relevant and used a complex type from the simple profile
(Section 
4.6.5 Trigger definition).
</p>
</li>
<li>
<p>
Deleted the operation_host keyword from the operation 
implementation definition since it was connected to a hostedOn 
relationship type, and this is a type feature and not a grammar
feature 
(Section 4.3.6.8 Operation and notification implementation 
definition).
</p>
</li>
<li>
<p>
Eliminated the HOST from the reserved function keywords since it 
was connected to a hostedOn relationship type, and this is a type 
feature and not a grammar feature (Section 5 TOSCA functions).
</p>
</li>
<li>
<p>
Eliminated some comments that were addressed already.
</p>
</li>
<li>
<p>
Changed the type of description to string in the keyname tables 
throughout the specification.
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD02, Rev06
</td>
<td>
2020-06-20
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Update the TOSCA overview diagram to include workflows and 
policies (Section 3.1)
</p>
</li>
<li>
<p>
Update the diagram that explains requirements and capabilities 
(Section 3.4)
</p>
</li>
<li>
<p>
Update the diagram that explains substitution (Section 
3.5)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD02, Rev07
</td>
<td>
2020-06-22
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Edit the “TOSCA core concepts” section to reflect current status 
of TOSCA (Section 3)
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD02, Rev08
</td>
<td>
2020-06-24
</td>
<td>
Thinh Nguyenphu
</td>
<td>
<ul>
<li>
<p>
Provide additional detail about the required ZIP format and 
standards in the CSAR definition (Section 6.1)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD03, Rev01
</td>
<td>
2020-07-22
</td>
<td>
Calin Curescu Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Remove numerous comments that have been resolved since they were 
first introduced.
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD03, Rev02
</td>
<td>
2020-07-26
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Mark keywords as “mandatory” rather than “required” (to avoid 
confusion with the “required” keyword in property definitions
</p>
</li>
<li>
<p>
Introduce “conditional” as an alternative to “yes” or “no” in the 
“mandatory” columns of the grammar definition.
</p>
</li>
<li>
<p>
Remove “Constraints” columns in grammar definitions.
</p>
</li>
<li>
<p>
Clarify that entry_schema is mandatory for collection 
types.
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD03, Rev03
</td>
<td>
2020-07-28
</td>
<td>
Tal Liron
</td>
<td>
<ul>
<li>
<p>
Introduce clear specification of TOSCA built-in types (Sections 
4.4.1, 4.4.2, and 4.4.3)
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD03, Rev04
</td>
<td>
2020-08-03
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Fix typos
</p>
</li>
<li>
<p>
Minor formatting fixes
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD03, Rev05
</td>
<td>
2020-08-18
</td>
<td>
Tal Liron Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Add description of timestamp type
</p>
</li>
<li>
<p>
Move scalar-unit types into the Special Types section 
(4.4.2)
</p>
</li>
<li>
<p>
Remove multiples of “bytes per second” from scalar-unit.bitrate 
to make all scalar units case insensitive
</p>
</li>
<li>
<p>
Remove references to the <strong>tosca</strong> namespace prefix 
from the built-in type definitions.
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD03, Rev06
</td>
<td>
2020-08-31
</td>
<td>
Tal Liron Chris lauwers
</td>
<td>
<ul>
<li>
<p>
Introduce the notion of “profiles”
</p>
</li>
<li>
<p>
Support “import by profile name”
</p>
</li>
<li>
<p>
Simplify “namespaces”
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD03, Rev07
</td>
<td>
2020-09-06
</td>
<td>
Chris Lauwers Tal Liron
</td>
<td>
<ul>
<li>
<p>
Remove obsolete prose about namespace URIs (4.2)
</p>
</li>
<li>
<p>
Update the section about “import processing rules” 
(4.2.3.1)
</p>
</li>
<li>
<p>
Introduce new prose about support for namespaces 
(4.2.3.2)
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD03, Rev08
</td>
<td>
2020-09-07
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Clarify discussion of custom keynames in CSAR (6.2.1)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD03, Rev09
</td>
<td>
2020-10-26
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Additional discussion of TOSCA Profiles (section 4.2.2)
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD03, Rev10
</td>
<td>
2020-10-27
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Clarified throughout the specification that the key_schema 
keyname for maps has the default value as “string”, and that the 
entry_schema keyname definition is mandatory for lists and maps 
(sections 4.4.5 Schema definition, 4.4.7 Property definition,
4.4.9 
Attribute definition, 4.4.11 Parameter definition, 4.4.4. Data 
type)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD04, Rev01
</td>
<td>
2020-11-19
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
New OASIS Logo
</p>
</li>
<li>
<p>
Correct broken cross reference (Section 4.3.5.8)
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD04, Rev02
</td>
<td>
2021-01-25
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Incorporate comments provided as part of external review by Paul 
Jordan (BT) and Mike Rehder (Amdocs)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD04, Rev03
</td>
<td>
2021-05-03
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Introduce new Chapter 4 that describes Operational 
Model.
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD04, Rev04
</td>
<td>
2021-06-28
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Slight reorganization of the Operation Model chapter (Chapter 
4)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD04, Rev05
</td>
<td>
2022-02-15
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Modified the capability definition (Section 5.3.5.2 ) and 
assignment (Section 5.3.5.3) removing the occurrences keyname We
also 
added the scope of relationships to the capability assignment (via 
directives).
</p>
</li>
<li>
<p>
Modified the requirement definition (Section 5.3.5.5 ) and 
assignment (Section 5.3.5.6) replacing the occurrences keyname with
the 
count_range keyname in the requirements definition, and how the 
assignment must respect the definition and how an automated
assignment 
is assumed to exist if no assignment is specified. The keyname
count 
replaces the keyname occurrences in the assignment to remove any 
confusion between their slightly different semantics. We also added
the 
scope of relationships to the requirement assignment (via
directives). 
Finally, we added the optional keyname for a requirement assignment
to 
designate if the assignment is optional or not.
</p>
</li>
<li>
<p>
We also added the possibility to specify capacity allocation in a 
requirement assignment (Section 5.3.5.6) where the target
capability 
properties can act as capacity.
</p>
</li>
<li>
<p>
Made the relationship definition conditional, it must be present 
either in the requirement definition (Section 5.3.5.5 ) or in the 
requirement assignment (Section 5.3.5.5 ).
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD04, Rev06
</td>
<td>
2022-06-08
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Increased the expressivity of accessing properties and attributes 
in the representation graph by improving the navigation expression
in 
the get_property and get_attribute functions. The representation
graph 
traversal is handled via a new definition (tosca path), that is
common 
to both and is described in section 6.4.2.2.1 The simplified
TOSCA_PATH 
definition in BNF format.
</p>
</li>
<li>
<p>
Added multi-step traversal of the representation graph
</p>
</li>
<li>
<p>
Added the backward traversal from capabilities to incoming 
relationships
</p>
</li>
<li>
<p>
Added the target capability of a relationship as a possible 
traversal
</p>
</li>
<li>
<p>
Added the specification of indexes and allowing traversal of 
multi-count requirements
</p>
</li>
<li>
<p>
Examples for get_property have been corrected and 
extended.
</p>
</li>
<li>
<p>
Removed the deprecated get_operation_output function
</p>
</li>
<li>
<p>
In relationship types (section 5.3.3) following keynames 
changed/added:
</p>
</li>
<li>
<p>
valid_capability_types replaces valid_target_types
</p>
</li>
<li>
<p>
valid_target_node_types - new
</p>
</li>
<li>
<p>
valid_source_node_types - new
</p>
</li>
<li>
<p>
In capability type (section 5.3.5.1) and definition (section 
5.3.5.2) following keynames changed/added:
</p>
</li>
<li>
<p>
valid_source_node_types - replaces valid_source_types
</p>
</li>
<li>
<p>
valid_relationship_types - new
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD05, Rev01
</td>
<td>
2022-06-14
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Fix formatting errors and typos.
</p>
</li>
<li>
<p>
Remove Section 6.1 about reserved function keywords (replaced 
with TOSCA Path discussion)
</p>
</li>
<li>
<p>
Remove Section 6.2 about reserved environment variables.
</p>
</li>
<li>
<p>
Rename topology_template keyword to service_template
</p>
</li>
<li>
<p>
Remove reference to TOSCA v1.0 specification (Section 
5.2.6.2.8)
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD05, Rev02
</td>
<td>
2022-06-14
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Remove ‘get_nodes_of_type’ function (Section 6.4)
</p>
</li>
<li>
<p>
Remove section about ‘Context-based entity names’ (Section 
6.6)
</p>
</li>
<li>
<p>
Remove sections about “Metadata keynames” (Section 5.2.1.1.1, 
Section 5.2.1.3.4, Section 5.2.1.3.5, Section 5.2.1.3.6)
</p>
</li>
<li>
<p>
Document new metadata grammar (Section 5.2.1.3.3)
</p>
</li>
<li>
<p>
Document short notation for schema definitions (Section 
5.4.5.2)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD05, Rev03
</td>
<td>
2022-09-28
</td>
<td>
<p>
Chris Lauwers
</p>
<p>
Calin Curescu
</p>
</td>
<td>
<ul>
<li>
<p>
Change default count range to [0, UNBOUNDED] (Section 
5.3.5.5)
</p>
</li>
<li>
<p>
Clarify semantics of profile keynames in imported TOSCA files 
(Section 5.2.2.2)
</p>
</li>
<li>
<p>
Add section about function syntax (Section 6.1)
</p>
</li>
<li>
<p>
Add section about defining user-defined custom functions (Section 
6.6)
</p>
</li>
<li>
<p>
Update all intrinsic functions with the new dollar sign 
syntax.
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD05, Rev04
</td>
<td>
2022-11-21
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Remove Normative Values (Section 5.8). Removal of the Simple 
Profile has made this section obsolete.
</p>
</li>
<li>
<p>
Add Condition functions (Section 6.5)
</p>
</li>
<li>
<p>
Update policy trigger syntax to use Boolean expressions.
</p>
</li>
<li>
<p>
Update workflow precondition syntax to use Boolean 
expressions
</p>
</li>
<li>
<p>
Move sections about functions and function definitions into the 
TOSCA Definitions chapter
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD05, Rev05
</td>
<td>
2022-11-21
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Introduce new syntax for defining validation clauses on data 
types and property definitions.
</p>
</li>
<li>
<p>
Update node filter syntax to use Boolean expressions.
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD05, Rev06
</td>
<td>
2022-11-28
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Validation syntax examples.
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD05, Rev07
</td>
<td>
2022-12-14
</td>
<td>
Calin Curescu
</td>
<td>
<ul>
<li>
<p>
Added the short string-value form for functions without arguments 
and changed section Function syntax (Section 5.4.14) 
accordingly.
</p>
</li>
<li>
<p>
Added all the existing comparison operators as Boolean functions, 
the new Boolean logic functions and the new string, list and map 
membership Boolean functions (Section 6.2) and set manipulation
(section 
6.4) and arithmetic functions (Section 6.5).
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD05, Rev08
</td>
<td>
2023-01-17
</td>
<td>
<p>
Chris Lauwers
</p>
<p>
Calin Curescu
</p>
</td>
<td>
<ul>
<li>
<p>
Cleanup for correctness and consistency.
</p>
</li>
<li>
<p>
Additional built-in functions (Section 6)
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD05, Rev09
</td>
<td>
2023-01-18
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Document the ‘value’ function (Section 6.1.5)
</p>
</li>
</ul>
</td>
</tr>
<tr class="even">
<td>
WD06, Rev01
</td>
<td>
2023-02-19
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Fix document problems found when publishing CSD05.
</p>
</li>
</ul>
</td>
</tr>
<tr class="odd">
<td>
WD06, Rev02
</td>
<td>
</td>
<td>
Chris Lauwers
</td>
<td>
<ul>
<li>
<p>
Remove support for the “range” built-in type (Section 
5.4.2)
</p>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<hr/>
<h1 id="appendix-e.-example-appendix-with-subsections">Appendix E.
Example Appendix with subsections</h1>
<h2 id="e.1-subsection-title">E.1 Subsection title</h2>
<h3 id="e.1.1-sub-subsection">E.1.1 Sub-subsection</h3>
<hr/>
<h1 id="appendix-f.-notices">Appendix F. Notices</h1>
<!-- Required section. Do not modify. -->
<p>Copyright © OASIS Open 2024. All Rights Reserved.</p>
<p>All capitalized terms in the following text have the meanings assigned to them in the OASIS Intellectual Property Rights Policy (the “OASIS IPR Policy”). The full <a href="https://www.oasis-open.org/policies-guidelines/ipr/">Policy</a> may be found at the OASIS website. <br/></p>
<p>This document and translations of it may be copied and furnished to
others, and derivative works that comment on or otherwise explain it or
assist in its implementation may be prepared, copied, published, and
distributed, in whole or in part, without restriction of any kind,
provided that the above copyright notice and this section are included
on all such copies and derivative works. However, this document itself
may not be modified in any way, including by removing the copyright
notice or references to OASIS, except as needed for the purpose of
developing any document or deliverable produced by an OASIS Technical
Committee (in which case the rules applicable to copyrights, as set
forth in the OASIS IPR Policy, must be followed) or as required to
translate it into languages other than English.</p>
<p>The limited permissions granted above are perpetual and will not be
revoked by OASIS or its successors or assigns.</p>
<p>This document and the information contained herein is provided on an
“AS IS” basis and OASIS DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED,
INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
INFORMATION HEREIN WILL NOT INFRINGE ANY OWNERSHIP RIGHTS OR ANY IMPLIED
WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>
<p>As stated in the OASIS IPR Policy, the following three paragraphs in
brackets apply to OASIS Standards Final Deliverable documents (Committee
Specification, Candidate OASIS Standard, OASIS Standard, or Approved
Errata).</p>
<p>[OASIS requests that any OASIS Party or any other party that believes
it has patent claims that would necessarily be infringed by
implementations of this OASIS Standards Final Deliverable, to notify
OASIS TC Administrator and provide an indication of its willingness to
grant patent licenses to such patent claims in a manner consistent with
the IPR Mode of the OASIS Technical Committee that produced this
deliverable.]</p>
<p>[OASIS invites any party to contact the OASIS TC Administrator if it
is aware of a claim of ownership of any patent claims that would
necessarily be infringed by implementations of this OASIS Standards
Final Deliverable by a patent holder that is not willing to provide a
license to such patent claims in a manner consistent with the IPR Mode
of the OASIS Technical Committee that produced this OASIS Standards
Final Deliverable. OASIS may include such claims on its website, but
disclaims any obligation to do so.]</p>
<p>[OASIS takes no position regarding the validity or scope of any
intellectual property or other rights that might be claimed to pertain
to the implementation or use of the technology described in this OASIS
Standards Final Deliverable or the extent to which any license under
such rights might or might not be available; neither does it represent
that it has made any effort to identify any such rights. Information on
OASIS’ procedures with respect to rights in any document or deliverable
produced by an OASIS Technical Committee can be found on the OASIS
website. Copies of claims of rights made available for publication and
any assurances of licenses to be made available, or the result of an
attempt made to obtain a general license or permission for the use of
such proprietary rights by implementers or users of this OASIS Standards
Final Deliverable, can be obtained from the OASIS TC Administrator.
OASIS makes no representation that any information or list of
intellectual property rights will at any time be complete, or that any
claims in such list are, in fact, Essential Claims.]</p>
<p>The name “OASIS” is a trademark of <a href="https://www.oasis-open.org/">OASIS</a>, the owner and developer of this specification, and should be used only to refer to the organization and its official outputs. OASIS welcomes reference to, and implementation and use of, specifications, while reserving the right to enforce its marks against misleading uses. Please see <a class="uri" href="https://www.oasis-open.org/policies-guidelines/trademark/">https://www.oasis-open.org/policies-guidelines/trademark/</a> for above guidance. <br/></p>
</body>
</html>
